<html lang="ko" class="desktop winos chrome nexus5 mobile"><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no">
<meta name="format-detection" content="telephone=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<title>현대Hmall - 주문서</title>

    



<meta charset="UTF-8">
<meta name="viewport" content="user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, width=device-width, height=device-height">
<meta name="HandheldFriendly" content="true">
<meta name="format-detection" content="telephone=no, email=no, address=no">
<meta name="apple-mobile-web-app-capable" content=" yes">
<meta name="robots" content="index,follow">
<meta name="title" content="https://hmall.com">
<meta name="author" content="@Hmall">
<meta name="description" content="백화점, 브랜드, 홈쇼핑까지- 당신의 모든 취향을 읽다.">
<meta name="keywords" content="">
<meta http-equiv="imagetoolbar" content="no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<!-- OpenGraph -->
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-TileImage" content="//image.hmall.com/m/img/co/favicon/ms-icon-144x144.png">
<meta name="theme-color" content="#ffffff">
<meta property="og:title" content="현대Hmall-백화점,홈쇼핑">
<meta property="og:url" content="https://hmall.com">
<meta property="og:type" content="현대Hmall-백화점,홈쇼핑">
<meta property="og:description" content="백화점, 브랜드, 홈쇼핑까지- 당신의 모든 취향을 읽다. 볼거리 가득! 쓸 곳 많은 h.point 혜택">
<meta property="og:image" content="//image.hmall.com/m/img/co/meta/hmall_meta.jpg">
<meta property="og:image:width" content="1000">
<meta property="og:image:height" content="750">

<!-- favicon -->
<meta itemprop="image" content="//image.hmall.com/m/img/co/favicon/favicon_128.png">
<link rel="shortcut icon" type="image/x-icon" href="//image.hmall.com/m/img/co/favicon/favicon.ico">
<link rel="apple-touch-icon" sizes="57x57" href="//image.hmall.com/m/img/co/favicon/apple-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="//image.hmall.com/m/img/co/favicon/apple-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="//image.hmall.com/m/img/co/favicon/apple-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="//image.hmall.com/m/img/co/favicon/apple-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="//image.hmall.com/m/img/co/favicon/apple-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="//image.hmall.com/m/img/co/favicon/apple-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="//image.hmall.com/m/img/co/favicon/apple-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="//image.hmall.com/m/img/co/favicon/apple-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="//image.hmall.com/m/img/co/favicon/apple-icon-180x180.png">
<link rel="icon" type="image/png" sizes="192x192" href="//image.hmall.com/m/img/co/favicon/android-icon-192x192.png">
<link rel="icon" type="image/png" sizes="32x32" href="//image.hmall.com/m/img/co/favicon/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="96x96" href="//image.hmall.com/m/img/co/favicon/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="16x16" href="//image.hmall.com/m/img/co/favicon/favicon-16x16.png">
<link rel="manifest" href="//image.hmall.com/m/img/co/favicon/manifest.json">

<!-- UI/UX Style -->
<link rel="stylesheet" type="text/css" href="//image.hmall.com/m/css/co/common.css?ver=8060106"> <!-- 공통 css -->
<link rel="stylesheet" type="text/css" href="//image.hmall.com/m/css/co/layout.css?ver=8060106"> <!-- 공통 Layout css -->
<link rel="stylesheet" type="text/css" href="//image.hmall.com/m/css/co/popup.css?ver=8060106"> <!-- 공통 popup/layer css -->
<link rel="stylesheet" type="text/css" href="//image.hmall.com/m/css/co/jquery-ui.css?ver=8060106"> <!-- 공통 jQuery UI css -->

<script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://www.google-analytics.com/plugins/ua/ec.js"></script><script async="" src="https://www.google-analytics.com/analytics.js"></script><script async="" src="https://www.googletagmanager.com/gtm.js?id=GTM-MZFFDJ8"></script><script type="text/javascript" src="//image.hmall.com/m/js/co/jquery-3.4.1.min.js?ver=8060106"></script> <!-- 공통 jQuery Plugin -->
<script type="text/javascript" src="//image.hmall.com/m/js/co/jquery.easing.min.js?ver=8060106"></script> <!-- 공통 jQuery UI Effect -->
<script type="text/javascript" src="//image.hmall.com/m/js/co/jquery-ui.1.12.1.min.js?ver=8060106"></script> <!-- 공통 jQuery UI js -->
<script type="text/javascript" src="//image.hmall.com/m/js/co/jquery.touchFlow.js?ver=8060106"></script> <!-- 공통 UI에 사용하는 Touch Swipe -->
<script type="text/javascript" src="//image.hmall.com/m/js/co/jquery.dg.fslide.js?ver=8060106"></script>
<script type="text/javascript" src="//image.hmall.com/m/js/co/ukDetect.min.js?ver=8060106"></script> <!-- 공통 UI에 사용하는 Detect -->
<script type="text/javascript" src="//image.hmall.com/m/js/co/slick.min.js?ver=8060106"></script> <!-- 공통 Slick Slider Plugin -->
<script type="text/javascript" src="//image.hmall.com/m/js/co/common.js?ver=8060106"></script> <!-- 공통 UI에 사용하는 js -->
<script type="text/javascript" src="//image.hmall.com/m/js/co/common_lib.js?ver=8060106"></script> <!-- 라이브러리 관련 공통 UI에 사용하는 js -->
<script type="text/javascript" src="//image.hmall.com/m/js/co/co.js?ver=8060106"></script> <!-- 공통 개발팀에서 사용하는 js -->

<script type="text/javascript" src="//image.hmall.com/m/js/co/jquery.cookie-1.4.1.min.js?ver=8060106"></script>
<script type="text/javascript" src="//image.hmall.com/m/js/co/GoogleAnalyticsBuilder.js?ver=8060106"></script>
<script type="text/javascript" src="//image.hmall.com/m/js/dp/dp.js?ver=8060106"></script>
<script type="text/javascript" src="//image.hmall.com/m/js/co/section_tab.js?ver=8060106"></script>
<script type="text/javascript" src="//image.hmall.com/m/js/co/mobileUtil.js?ver=8060106"></script>
<script type="text/javascript" src="//image.hmall.com/m/js/co/ScreenNameObj.js?ver=8060106"></script>







<script type="text/javascript">
var gaForTabNm = "";

function setDimension(){
    
    
    if(location.pathname.indexOf("/m/smLoginP.do") > -1){
        return;
    }
    
    var GA_info = {};
    
    
    GA_info = setDimenData(GA_info);

    
    GA_Init(GA_info);
    
    
    if(location.pathname.replace("//", "/") == '/m/pda/smItemDetailR.do' || location.pathname.replace("//", "/") == '/m/pda/itemPtc.do'){
        var product_array = []; 
        product_array.push(
            {
            'id':'2101185938',
            'name':'[나인닷] 비 런닝머신 ND1000 / 홈트레이닝 트레드밀 접이식런닝머신 워킹머신',
            'brand': '231231(나인닷)',
            'category' : '스포츠레져/헬스용품/헬스기구/런닝머신',
            'dimension51': 'default',
            'dimension52':'현대Hmall',
            'dimension53':'S7(스포츠/레져)',
            'dimension54':'S706(헬스용품)',
            'dimension55':'S70601(헬스기구)',
            'dimension56':'S7060101(런닝머신)',
            'dimension57':'8099스포츠용품(이홍)',
            'dimension58':'e홈레저팀',
            'dimension59':'009809(주식회사 온니포유)',
            
            'dimension60':'default',
            'dimension62':'유형상품',
            'dimension63':'딜상품',
            'dimension64':'809586(헬스용품/헬스소품)'
            }
        );
        
        var ecommerce_hit = new Object();
        ecommerce_hit[GAHitKey.NonInteraction] = '1';
        var action_obj = new Object();
        
        
        GADataSend_Ecommerce(GAEcommerceStepKey.Detail, action_obj, product_array, ecommerce_hit);

    }else if(location.pathname == '/m/orderComplete.do'){
        var product_array = [];
        
        
        
        var ecommerce_hit = new Object();
        ecommerce_hit[GAHitKey.NonInteraction] = '1';
        ecommerce_hit[GAHitKey.currencyCode] = 'KRW';
        
        ecommerce_hit[GACustomKey.Dimension74] = '';
        ecommerce_hit[GACustomKey.Dimension75] = '';
        
        ecommerce_hit[GACustomKey.Metric1] = 0;
        
        ecommerce_hit[GACustomKey.Metric2] = 0;
        
        
        var action_obj = new Object();
        action_obj[GAActionFieldKey.TransactionID]='';
        action_obj[GAActionFieldKey.TransactionRevenue]='0';
        action_obj[GAActionFieldKey.TransactionShipping]='0';
        
        action_obj[GAActionFieldKey.TransactionCouponCode]='';
        
        
        GADataSend_Ecommerce(GAEcommerceStepKey.Purchase, action_obj, product_array, ecommerce_hit);
    }
}


function setDimenData(GA_info){
    var _ga = getCookieGA('_ga');
    if(_ga != null){
        GA_info[GACustomKey.Dimension1] = _ga;
    }
    var uid = getCookieGA('ENCEHCustNO');
    if(uid == null || uid == '' || uid == undefined ){
        
    }else{
        GA_info[GACustomKey.Dimension2] = uid;
        GA_info[GAHitKey.UserId] = uid;
        
        
    }
    /*  GA_info[GACustomKey.Dimension2] = "201809357435";  */
     GA_info[GACustomKey.Dimension3] = "20180923"; 
     GA_info[GACustomKey.Dimension4] = "일반"; 
     GA_info[GACustomKey.Dimension5] = "df59a4a0af2ac2b5e433cf2986e61357"; 
     GA_info[GACustomKey.Dimension6] = "Y"; 
     GA_info[GACustomKey.Dimension7] = "Y"; 
     GA_info[GACustomKey.Dimension8] = "20210321"; 
     GA_info[GACustomKey.Dimension9] = "20210601"; 
    
    var _gaid = getCookieGA('GAID');
    if(_gaid != null){GA_info[GACustomKey.Dimension11] = _gaid;}
     GA_info[GACustomKey.Dimension12] = "Y"; 
    
     GA_info[GACustomKey.Dimension13] = "U"; 
     GA_info[GACustomKey.Dimension14] = "3"; 
     GA_info[GACustomKey.Dimension15] = "골드"; 
    
    if(location.pathname == '/m/pde/smSearchL.do' || location.pathname == '/m/pde/search.do'){
        
        
        
            
            
                GA_info[GACustomKey.Dimension19] = "N";
            
        
    }
    
    if(appYn == 'Y'){
        GA_info[GACustomKey.Dimension16] = "APP";
    }else{
        GA_info[GACustomKey.Dimension16] = "MOWEB";
    }
    
    GA_info[GACustomKey.Dimension35] = location.href.replace("http://", "").replace("https://", "");

    return GA_info;
}


function setGaDataSend_Event(evntType){
	if (evntType == GAEcommerceStepKey.Checkout) {
		console.log("Checkout");
	} else if (evntType == GAEcommerceStepKey.Add) {
		console.log("Add");
	}

    var product_array = [];
    var ecommerce_hit = new Object();
    var action_obj = new Object();
    
    
    if(location.pathname == '/m/pda/smItemDetailR.do' || location.pathname == '/m/pda/itemPtc.do' || location.pathname == '/m/smMblLiveTalkMain.do'){
         $("#divOptionArea div.selectedUitm").each(function() {
             $(this).find("ul.selectedUitmUl").each(function() {
                 var SlitmCd = $(this).find("li.quantity1").attr('subslitmcd');
                 var curItem = $('.selectingLayerScrollCont ul').find('#' + SlitmCd + 'Li a');
                try {
                     product_array.push(
                            {
                                'id':SlitmCd,
                                'name':curItem.attr('slitmNm'),
                                'brand': curItem.attr('brndNm'),
                                'category' : curItem.attr('gacategory')
                            }
                        );
                } catch (e) { 
                    // TODO: handle exception
                }
             });
         });
        if(location.pathname == '/m/smMblLiveTalkMain.do'){
            ecommerce_hit[GAHitKey.EventLabel] = '모바일 라이브';
        }
         
        if(evntType == GAEcommerceStepKey.Checkout){
            action_obj[GAActionFieldKey.CheckoutStep] = '1';
            GADataSend_Ecommerce(evntType, action_obj, product_array, ecommerce_hit);
        }else{
            ecommerce_hit[GAHitKey.NonInteraction] = '1';
            GADataSend_Ecommerce(evntType, action_obj, product_array, ecommerce_hit);
        }
    
    }else if(appYn == 'Y' && typeof pageTemplate != 'undefined'){
        
         $("#divOptionArea div.selectedUitm").each(function() {
            $(this).find("ul.selectedUitmUl").each(function() {
             var SlitmCd = $(this).find("li.quantity1").attr('subslitmcd');
                 var curItem = $('.selectingLayerScrollCont ul').find('#' + SlitmCd + 'Li a');

                 try {
                     product_array.push(
                                {
                                    'id':SlitmCd,
                                    'name':curItem.attr('slitmNm'),
                                    'brand': curItem.attr('brndNm'),
                                    'category' : curItem.attr('gacategory')
                                }
                            );
                } catch (e) {
                    // TODO: handle exception
                }
            });
        });
        if(evntType == GAEcommerceStepKey.Checkout){
            action_obj[GAActionFieldKey.CheckoutStep] = '1';
            GADataSend_Ecommerce(evntType, action_obj, product_array, ecommerce_hit);
        }else{
            ecommerce_hit[GAHitKey.NonInteraction] = '1';
            GADataSend_Ecommerce(evntType, action_obj, product_array, ecommerce_hit);
        }
    }
    else if(location.pathname == '/m/order.do'){
        
        try {
        	var itemGbcd = ""; // 무형상품체크
            
                 
                        itemGbcd = "00";
                        product_array.push(
                            {
                                'id':'2101185938',
                                'name':'[나인닷] 비 런닝머신 ND1000 / 홈트레이닝 트레드밀 접이식런닝머신 워킹머신',
                                'brand': '231231(나인닷)',
                                'category' : '스포츠레져/헬스용품/헬스기구/런닝머신'
                            }
                        );
                
            
        } catch (e) {
            // TODO: handle exception
        } 
        
        if(evntType == GAEcommerceStepKey.Checkout){
            var ecommerce_hit = new Object();
            var action_obj = new Object();
            action_obj[GAActionFieldKey.CheckoutStep] = '2';
            
            //var selOrderType = $(".payment_select.boxtype li.selected").find("input[name='pay']").val();
            var selOrderType = $(".payment-wrap a.on").find("input[name=pay]").val();
            if(selOrderType == '1'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '01 카드';
                ecommerce_hit[GACustomKey.Dimension75] = '01 카드';
            }else if(selOrderType == '4'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '02 현금';
                ecommerce_hit[GACustomKey.Dimension75] = '02 현금';
            }else if(selOrderType == '3'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '12 휴대폰결제';
                ecommerce_hit[GACustomKey.Dimension75] = '12 휴대폰결제';
            }else if(selOrderType == 'payco'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '15 페이코';
                ecommerce_hit[GACustomKey.Dimension75] = '15 페이코';
            }else if(selOrderType == 'naverpay'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '21 네이버페이';
                ecommerce_hit[GACustomKey.Dimension75] = '21 네이버페이';
            }else if(selOrderType == 'smilepay'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '22 스마일페이';
                ecommerce_hit[GACustomKey.Dimension75] = '22 스마일페이';
            }else if(selOrderType == 'newkakaopay'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '23 카카오페이';
                ecommerce_hit[GACustomKey.Dimension75] = '23 카카오페이';
            }else if(selOrderType == 'hpay'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '24 현금간편결제';
                ecommerce_hit[GACustomKey.Dimension75] = '24 현금간편결제';
            }else if(selOrderType == 'toss'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '25 토스';
                ecommerce_hit[GACustomKey.Dimension75] = '25 토스';
            }else if(selOrderType == 'nfc'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '26 NFC결제';
                ecommerce_hit[GACustomKey.Dimension75] = '26 NFC결제';
            }else if(selOrderType == 'callpay'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '97 상담원 결제';
                ecommerce_hit[GACustomKey.Dimension75] = '97 상담원 결제';
            }else if(selOrderType == 'samsungpay'){
                action_obj[GAActionFieldKey.CheckoutOptions] = '99 삼성페이';
                ecommerce_hit[GACustomKey.Dimension75] = '99 삼성페이';
            }else if(selOrderType == undefined){
                action_obj[GAActionFieldKey.CheckoutOptions] = '무형상품';
                ecommerce_hit[GACustomKey.Dimension75] = '무형상품';
            }
            
            // 무형상품이면
            if (itemGbcd == "04") {
            	console.log("무형상품이므로 Dimension75:무형상품");
                action_obj[GAActionFieldKey.CheckoutOptions] = '무형상품';
                ecommerce_hit[GACustomKey.Dimension75] = '무형상품';
            }
            GADataSend_Ecommerce(evntType, action_obj, product_array, ecommerce_hit);
        }
    }else{
        GADataSend_Ecommerce(evntType, action_obj, product_array, ecommerce_hit);
    }
    
}

function onAppMainPageTab(mainseq, tabNm){
    var virtual_Obj = new Object();
    
    
    virtual_Obj = setDimenData(virtual_Obj);
    var tabNm = tabNm;
    var tabMn = "메인";
    
    //안드로이드 왼쪽 메뉴에서 호출할 경우 tabNm을 재정의한다.
    if(location.pathname == "/m/api/leftMenu.do"){
        tabNm = '공통';
        tabMn = "좌측메뉴";
    }else if(tabNm == ''){
        //아이폰/ 웹 일 경우 탭 정보가 없어서 추가한다.
        tabNm = dupPrevent;
    }
    
    virtual_Obj[GACustomKey.Dimension31] = tabMn;
    virtual_Obj[GACustomKey.Dimension32] = tabMn +'>'+ tabNm;
    virtual_Obj[GACustomKey.Dimension33] = tabMn +'>'+ tabNm;
    virtual_Obj[GACustomKey.Dimension34] = tabMn +'>'+ tabNm;
    
    virtual_Obj[GAHitKey.Title] = tabMn +'>' + tabNm;
    
    if(mainseq == '193')
    {
        virtual_Obj[GAHitKey.URL] = ''; 
    }
    GADataSend_Page(virtual_Obj);
    virtual_Obj[GAHitKey.URL] = undefined;
}


/*
function sendSlitmClick(slitmNm, slitmCd, tabNm){
    if(slitmNm == "" || slitmCd == "" || tabNm == "")
        return;
    
    var product_array = [];
    product_array.push({'id': slitmCd, 'name': slitmNm});
    
    var action_obj = new Object();
    action_obj[GAActionFieldKey.ProductActionList] = tabNm;
    
    var ecommerce_hit = new Object();
    GADataSend_Ecommerce(GAEcommerceStepKey.Click, action_obj, product_array, ecommerce_hit);
}
*/


function getGaParameterByName(url, name) {
    if(url == "" || name == "" || url == undefined || name == undefined){
        return;
    }
    
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(url);
    return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
}

function setGaPromotion(title, name, position, creative, id){
    var action_obj = new Object();
    var ecommerce_hit = new Object();
    var tabNm = title;
    if (tabNm.length > 0) { 
        tabNm = tabNm.substring(tabNm.indexOf(">")+1, tabNm.length);
    }
    
    ecommerce_hit[GAHitKey.Title] = title;
    if (name == "좌측메뉴") { 
        ecommerce_hit[GACustomKey.Dimension31] = '공통';
        ecommerce_hit[GACustomKey.Dimension32] = '공통>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension33] = '공통>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension34] = '공통>'+ tabNm;
    }else if (name == "마이페이지") { 
        ecommerce_hit[GACustomKey.Dimension31] = '마이페이지';
        ecommerce_hit[GACustomKey.Dimension32] = '마이페이지>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension33] = '마이페이지>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension34] = '마이페이지>'+ tabNm;
    } else if(name == "검색결과") {
        ecommerce_hit[GACustomKey.Dimension31] = '검색';
        ecommerce_hit[GACustomKey.Dimension32] = '검색>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension33] = '검색>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension34] = '검색>'+ tabNm;
    } else if(name == "검색창") {
        ecommerce_hit[GACustomKey.Dimension31] = '검색';
        ecommerce_hit[GACustomKey.Dimension32] = '검색>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension33] = '검색>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension34] = '검색>'+ tabNm;
    } else if(name == "상품상세") {
        ecommerce_hit[GACustomKey.Dimension31] = '상품';
        ecommerce_hit[GACustomKey.Dimension32] = '상품>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension33] = '상품>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension34] = '상품>'+ tabNm;
    } else if(name == "주문완료") {
        ecommerce_hit[GACustomKey.Dimension31] = '주문/장바구니';
        ecommerce_hit[GACustomKey.Dimension32] = '주문/장바구니>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension33] = '주문/장바구니>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension34] = '주문/장바구니>'+ tabNm;
    } else if(name == "방송알리미") {
        ecommerce_hit[GACustomKey.Dimension31] = '마이페이지';
        ecommerce_hit[GACustomKey.Dimension32] = '마이페이지>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension33] = '마이페이지>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension34] = '마이페이지>'+ tabNm;
    } 
    /*else if(name.indexOf('기획전매장_') == 0 || name.indexOf('폐쇄매장_') == 0 || name.indexOf('브랜드매장_') == 0 || name == "HPet샵") {
        if(title){
            var splTitle = title.split('>');
            if(splTitle.length > 2){
                ecommerce_hit[GACustomKey.Dimension31] = splTitle[0];
                ecommerce_hit[GACustomKey.Dimension32] = splTitle[0]+'>'+splTitle[1];
                ecommerce_hit[GACustomKey.Dimension33] = splTitle[0]+'>'+splTitle[1]+'>'+splTitle[2];
                if(splTitle.length > 3){
                    ecommerce_hit[GACustomKey.Dimension34] = splTitle[0]+'>'+splTitle[1]+'>'+splTitle[2]+'>'+splTitle[3];
                }else{
                    ecommerce_hit[GACustomKey.Dimension34] = splTitle[0]+'>'+splTitle[1]+'>'+splTitle[2];
                }
            }
        }
    } 
    */
    else if(title && title.indexOf('매장/전시') == 0) {
        var splTitle = title.split('>');
        ecommerce_hit[GACustomKey.Dimension31] = splTitle[0];
        if(splTitle.length > 1){
            ecommerce_hit[GACustomKey.Dimension32] = splTitle[0]+'>'+splTitle[1];
            if(splTitle.length > 2){
                ecommerce_hit[GACustomKey.Dimension33] = splTitle[0]+'>'+splTitle[1]+'>'+splTitle[2];
                if(splTitle.length > 3){
                    ecommerce_hit[GACustomKey.Dimension34] = splTitle[0]+'>'+splTitle[1]+'>'+splTitle[2]+'>'+splTitle[3];
                }else{
                    ecommerce_hit[GACustomKey.Dimension34] = splTitle[0]+'>'+splTitle[1]+'>'+splTitle[2];
                }
            }else{
                ecommerce_hit[GACustomKey.Dimension33] = splTitle[0]+'>'+splTitle[1];
                ecommerce_hit[GACustomKey.Dimension34] = splTitle[0]+'>'+splTitle[1];
            }
        }else{
            ecommerce_hit[GACustomKey.Dimension32] = splTitle[0];
            ecommerce_hit[GACustomKey.Dimension33] = splTitle[0];
            ecommerce_hit[GACustomKey.Dimension34] = splTitle[0];
        }
    }
    else {
        ecommerce_hit[GACustomKey.Dimension31] = '메인';
        ecommerce_hit[GACustomKey.Dimension32] = '메인>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension33] = '메인>'+ tabNm;
        ecommerce_hit[GACustomKey.Dimension34] = '메인>'+ tabNm;
    }
    
    action_obj["promo1"] = {};
    action_obj["promo1"][GAActionFieldKey.PromotionName] = name;
    action_obj["promo1"][GAActionFieldKey.PromotionPosition] = position;
    action_obj["promo1"][GAActionFieldKey.PromotionCreative] = creative;
    action_obj["promo1"][GAActionFieldKey.PromotionID] = id;
    
    GADataSend_Ecommerce(GAEcommerceStepKey.PromotionClick, action_obj, null, ecommerce_hit);
}

function setGaDataSend_MainPage(){
	
	var virtual_Obj = new Object();
	var tabMn = "메인";	
	var tabNm = "index.do";
	
	if($('#mblHmallTopMenu > li.current').length > 0){
		tabNm = $('#mblHmallTopMenu > li.current')[0].innerText;
	}
	
	virtual_Obj = setDimenData(virtual_Obj);
	virtual_Obj[GACustomKey.Dimension31] = tabMn;
	virtual_Obj[GACustomKey.Dimension32] = tabMn +'>'+ tabNm;
	virtual_Obj[GACustomKey.Dimension33] = tabMn +'>'+ tabNm;
	virtual_Obj[GACustomKey.Dimension34] = tabMn +'>'+ tabNm;
	
	virtual_Obj[GAHitKey.Title] = tabMn +'>' + tabNm;
	
	GADataSend_Page(virtual_Obj);	
	virtual_Obj[GAHitKey.URL] = undefined;	
}

function setGaDataSend_Page(tabMn, tabNm){
    var virtual_Obj = new Object();
    
    virtual_Obj = setDimenData(virtual_Obj);
    virtual_Obj[GACustomKey.Dimension31] = tabMn;
    virtual_Obj[GACustomKey.Dimension32] = tabMn +'>'+ tabNm;
    virtual_Obj[GACustomKey.Dimension33] = tabMn +'>'+ tabNm;
    virtual_Obj[GACustomKey.Dimension34] = tabMn +'>'+ tabNm;
    
    virtual_Obj[GAHitKey.Title] = tabMn +'>' + tabNm;
    
    GADataSend_Page(virtual_Obj);
    virtual_Obj[GAHitKey.URL] = undefined;
}

// 비즈스프링 쓸때까지는 이 함수를 호출. GA 호출 후 BIZ 호출.
function gaTagging(obj_GA, msg1, msg2, msg3){
    
    var title =     $(obj_GA).attr("ga-custom-title") == undefined ? "" : $(obj_GA).attr("ga-custom-title");            
    var name =      $(obj_GA).attr("ga-custom-name") == undefined ? "" : $(obj_GA).attr("ga-custom-name");  
    var position =  $(obj_GA).attr("ga-custom-position") == undefined ? "" : $(obj_GA).attr("ga-custom-position");
    var creative =  $(obj_GA).attr("ga-custom-creative") == undefined ? "" : $(obj_GA).attr("ga-custom-creative");
    var id =        $(obj_GA).attr("ga-custom-id") == undefined ? "" : $(obj_GA).attr("ga-custom-id");
    var etc =       $(obj_GA).attr("ga-custom-etc") == undefined ? "" : $(obj_GA).attr("ga-custom-etc");
    var etc2 =      $(obj_GA).attr("ga-custom-etc2") == undefined ? "" : $(obj_GA).attr("ga-custom-etc2");
    
    //마케팅플랫폼 전용 >>> 마케팅 플랫폼은 Tab명이 다르기 때문에 if문 처리
    if(gaForTabNm != "" && gaForTabNm != null && gaForTabNm != undefined && etc2 == "Y"){
        title = "메인>"+gaForTabNm;
        name = "메인_"+gaForTabNm+"탭";
    }
    
    if(etc2 == "N"){//마케팅플랫폼 전용 >>> 마케팅플랫폼 jsp가 기획전에도 쓰이기 때문에 if문 처리.(mainTabYn)
        //추후 이곳에 마케팅플랫폼 기획전일 경우 분기분 넣는다...
        
    }else{
        setGaPromotion(title, name, position, creative, id);    
    }
    //Plan_spex는 파라미터가 4개
    var msg4 = "";
    if(etc == "untdSpexDtl"){
        msg4 = msg1.split("^")[1]; //url
        msg1 = msg1.split("^")[0]; //id
    }
    
    if(etc == "onAir"){
        bizSpringTagForOnair(msg1, msg2, msg3);
    }else if(etc == "home"){
        bizSpringTagForHome(msg1, msg2, msg3);
    }else if(etc == "moLive"){ // 모바일라이브는 실제로 brodTitl > bfmtNo > url 임!! 
        bizMoLiveHome(msg1, msg2, msg3);
    }else if(etc == "talkEtvHome"){  // VodEtvHm
        broadTalkEtvHome(msg1);
    }else if(etc == "vodEtvHm"){  // 
        notifyVodEtvHm(obj_GA);
    }else if(etc == "app"){
        bizSpringTagForApp(msg1, msg2, msg3);
    }else if(etc == "moLive2"){
        bizMoLive(msg1, msg2, msg3);
    }else if(etc == "clickTrace"){
        bizSpringTagClickTrace(msg1, msg2, msg3);
    }else if(etc == "talkHome"){
        broadTalkHome(msg1);    
    }else if(etc == "gotoSpexSect"){
        goToSpexSect(msg1);
    }else if(etc == "custDefItemLCst"){
        custDefItemLCst(msg1, msg2);    
    }else if(etc == "openMobileLive"){
        openMobileLive(msg1);   
    }else if(etc == "urlAction"){ //비즈스프링 없고 url 이동만 할 경우
        if(msg1.length > 1) {
            event.preventDefault();
            location.href = msg1;       
        }
    }else if(etc == "grpItemBuy"){ //다른고객이 많이 구매한 상품추천
        custGrpItemBuy(msg1, msg2);     
    }else if(etc == "goodCategoryTag"){
        goGoodCategoryTag(msg1, msg2, msg3);        
    }else if(etc == "goEvntCombine"){//goEvntCombine
        goEvntCombine(msg1, msg2, msg3);        
    }else if(etc == "goodCpCdTag"){
        goGoodCpCdTag(msg1, msg2);      
    }else if(etc == "goDptsCp"){
        goDptsCp(msg1, msg2);   
    }else if(etc == "srchAsctLst"){
        itemSrchAsctLst(msg1, msg2);    
    }else if(etc == "untdSpexDtl"){
        bizSpringUntdSpexDtl(msg1, msg2, msg3, msg4);   
    }else if(etc == "untdSpexItemDtl"){
        bizSpringUntdSpexItemDtl(msg1, msg2, msg3);     
    } else{
    
    }
}

//for chrome debugger
//# sourceURL=script-for-TrackerGoogleAnalytics.js
</script>

<!-- GA Custum lib -->




<script type="text/javascript" src="//image.hmall.com/m/js/co/netfunnel.js?8060106"></script>
<script type="text/javascript">
try{
NetFunnel_AliveNotice({action_id:"smart_1"});
} catch(e) {}
var ck_nfn = getCookie('ck_nfn');
if(ck_nfn != "" && ck_nfn != null){
    var d = new Date();
    d.setTime(d.getTime() + (3*60*1000));
    var expires = "expires=" + d.toUTCString();
    var cname = "ck_nfn";
    var cvalue = "check";
    document.cookie = cname + "=" + cvalue + "; " + expires + ";path=/;domain=.hmall.com";
}

</script>



<script type="text/javascript">
document.domain = "hmall.com";
var appYn = 'N';
var appOldVerYn = 'N';
var imageServerV5 = "https://image.hmall.com/static/smart/2015/mobile/images/image_5.0";
var appOpsyNm = "android";
var appOpsyVerNm = "6.0";
var appVerNm = "0";
var appType = "2015";
var onlyWebYn = "N";

//Google Analytics
var init_Obj = new Object();

// app 인 경우 클래스 추가
if (appYn == "Y") {
    $('html').addClass('app');
}

//GAID 리턴
function getAddId(os) {
    var adid = "";
    try {
        if (os == "android") {
            adid = window.AndroidJS.getAdId();
            //alert("gaid=" + adid + "--" + appVerNm);
        }
    } catch(e) {
    }

    $.cookie('GAID', adid, { expires: 1, path: '/', domain: '.hmall.com', secure: false });
}

//Android Version Check
function getAndroidVersion(ua) {
	ua = (ua || navigator.userAgent).toLowerCase();
	var match = ua.match(/android\s([0-9\.]*)/i);
	return match ? match[1] : undefined;
}

//아이폰
function setAdIdWebFromApp(adid){
    if (isEmpty(adid)) {
        adid = "";
    }
    $.cookie('GAID', adid, { expires: 1, path: '/', domain: '.hmall.com', secure: false });
}

$(window).on("load",function() {
    
    if (appYn == "Y") {
    	
    	// app 인 경우 클래스 추가
    	// $('html').addClass('app');
    	
        // 2016 모바일이주형 2016리뉴얼 페이지에서는 .back 클래스에 btn_none을 붙이지 않음
        var uri = "/m/jsp/mobile/od/smOrder2020.jsp";
            if (uri.indexOf("smMypageL") > -1) {
            } else if (uri.indexOf("smBaskList") > -1) {
            } else if (uri.indexOf("smOrderComplete") > -1) {
            } else if (uri.indexOf("smOrder") > -1) {
            } else {
                $(".back").attr("class", "btn_none");
                $(".btn_none").text('');
            }

            if (appOpsyNm == "ios") {
                if (Number(appVerNm) > 33 && isEmpty($.cookie('GAID'))) {
                    setTimeout(function() {
                        window.location = "jscall:getAdId";
                    }, 1000);
                }
            } else {
                if (Number(appVerNm) > 62 && isEmpty($.cookie('GAID'))) {
                    getAddId(appOpsyNm);
                }
            }
        }
        //init GA
        console.log("setDimension and useWindload 호출");
        setDimension();
        useWinload();
    });

    function getCookieGA(name) {
        var cname = name + "=";
        var dc = document.cookie;
        if (dc.length > 0) {
            begin = dc.indexOf(cname);
            if (begin != -1) {
                begin += cname.length;
                end = dc.indexOf(";", begin);
                if (end == -1)
                    end = dc.length;
                if ("EHCustName" == name || "LAST_SECT" == name) {
                    return decodeURIComponent(dc.substring(begin, end));
                } else {
                    return unescape(dc.substring(begin, end)).replace('GA1.2.',
                            '');
                }
            }
        }
        return null;
    }

    function cookieParsing() {

        var gc = getRecentItemCookie('RECENT_VIEW_ITEMS');
        var itemArray = new Array();
        var cArray = gc.split("|");

        if (cArray.length > 0) {
            for (var i = 0; i < cArray.length; i++) {
                itemArray[i] = cArray[i].split("/")[0].substring(1);
            }

            window.AndroidJS.setRecentItemList(itemArray.toString());
        }
    }

    function getRecentItemCookie(cookieName) {

        cookieName = cookieName + '=';
        var cookieData = document.cookie;
        var start = cookieData.indexOf(cookieName);
        var cookieValue = '';

        if (start != -1) {
            start += cookieName.length;
            var end = cookieData.indexOf(';', start);

            if (end == -1)
                end = cookieData.length;
            cookieValue = cookieData.substring(start, end);
        }
        return unescape(cookieValue);
    }

	//모바일라이브 어플 화면 맵핑 2020.04.13
	function openMobileLive(vdoType) {
		if (isEmpty(vdoType))
			vdoType = "02";

		if (appYn == "Y") {
			window.location.href = "/m/goAppLiveChat.do?vdoType=" + vdoType;
		} else {
			window.location.href = "/m/smMobileLiveChat.do";
		}
	}
	
	//레이어팝업 활성여부 체크 : 해당 CSS 변경 확인필요.
	function layerPopupCheck(){
	    var layerCheck = false;
	    // 레이어팝업체크
	    //if($("section[id='content']").css("display") == "block"){
	    if($("main div.container").css("display") == "block"){	
	        layerCheck = true;
	    }

	    // LNB 체크
	    if($("div.dimScreen").css("display") == "block"){
	        layerCheck = false;
	    }

	    return layerCheck;
	}

	$.fn.size = function() {
	    return this.length;
	}

    /**
     * 입력창 Byte 계산
     * @param input
     * @returns {Number}
     */
    function getByteLength(input) {
        var iByteLength = 0;
        for (var i = 0; i < input.length; i++) {
            var sChar = escape(input.charAt(i));
            if (sChar.length == 1 ) {
                iByteLength ++;
            } else if (sChar.indexOf("%u") != -1) {
                iByteLength += 2;
            } else if (sChar.indexOf("%") != -1) {
                iByteLength += sChar.length/3;
            }
        }
        return iByteLength;
    }

     /**
      * emoji 입력 제외 함수
      * @param input
      * @returns
      */ 
    function removeEmojis (e) {
   	    const regex = /(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff]|[\u0023-\u0039]\ufe0f?\u20e3|\u3299|\u3297|\u303d|\u3030|\u24c2|\ud83c[\udd70-\udd71]|\ud83c[\udd7e-\udd7f]|\ud83c\udd8e|\ud83c[\udd91-\udd9a]|\ud83c[\udde6-\uddff]|\ud83c[\ude01-\ude02]|\ud83c\ude1a|\ud83c\ude2f|\ud83c[\ude32-\ude3a]|\ud83c[\ude50-\ude51]|\u203c|\u2049|[\u25aa-\u25ab]|[\u25fb-\u25fe]|\u00a9|\u00ae|\u2122|\u2139|\ud83c\udc04|\u2b05|\u2b06|\u2b07|\u2b1b|\u2b1c|\u2b50|\u2b55|\u231a|\u231b|\u2328|\u23cf|[\u23e9-\u23f3]|[\u23f8-\u23fa]\ud83c\udccf|\u2934|\u2935|[\u2600-\u2604]|[\u2610-\u2659]|[\u2667-\u26FF]|[\u219a-\u21ff])/g;
   	    if(regex.test($(e).val())) {
   	        //alert("Unable to Enter Emoji!");
   	        let strVal = $(e).val().replace(regex,'');
   	        $(e).val(strVal);
   	    }
   	} 
     console.log('include scripts js loaded');
</script>

    
    <link rel="stylesheet" type="text/css" href="//image.hmall.com/m/css/od/order.css?80601062647">
    <script type="text/javascript" src="https://image.hmall.com/mo/js/js_4.0/json2.js?8060106"></script>
    
    <script type="text/javascript">
        var isBack = false;
        var isPayCopnPayTypeSet = false;
    </script>
    
    <script src="//image.hmall.com/m/js/od/order.js?80601062647"></script>

    <!-- 2016.11.09 모바일이주형 주문관련 스크립트 js 기존꺼와 분리 -->
    <script type="text/javascript" src="https://image.hmall.com/mo/js/js_5.0/spk_sdk.js?8060106"></script>
    <!-- 
    <script type="text/javascript" src="https://image.hmall.com/mo/js/od/order.js?80601062647"></script>
     -->
    <script type="text/javascript" src="https://image.hmall.com/mo/js/js_5.0/902_Insight_WebAnalytics.js?8"></script>
    <link rel="stylesheet" href="https://image.hmall.com/mo/css/css_5.0/slick.css">
    <script src="https://image.hmall.com/mo/js/js_5.0/slick.custom.js"></script>
    
    

    
    
    
    
    

    
    

    
    

    <!-- 스크립트 -->
    <script type="text/javascript">

        /*

1. 스크립트. 할인 및 결제금액 처리 시작
2. 스크립트. 결제 및 주문 처리 시작
3. 스크립트. 결제영역 처리 시작
4. 스크립트. 포인트 제어 시작
5. 스크립트. 유틸 처리 시작
6. 스크립트. 오포인트 처리 시작
7. 스크립트. 배송 처리 시작

*/

        // 추천할인 동작 여부를 위한 변수
        var isAutoDcIng = false;
        //카드 무이자 공지 팝업 값 셋팅
        var longWintPopList = new Array();
        
        longWintPopList.push({crdcCd:"03",insmPossMths:"2",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"03",insmPossMths:"3",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"03",insmPossMths:"4",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"03",insmPossMths:"5",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"03",insmPossMths:"6",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"07",insmPossMths:"2",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"07",insmPossMths:"3",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"07",insmPossMths:"4",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"07",insmPossMths:"5",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"07",insmPossMths:"6",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"09",insmPossMths:"2",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"09",insmPossMths:"3",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"09",insmPossMths:"4",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"09",insmPossMths:"5",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"09",insmPossMths:"6",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"16",insmPossMths:"2",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"16",insmPossMths:"3",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"16",insmPossMths:"4",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"16",insmPossMths:"5",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"16",insmPossMths:"6",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"20",insmPossMths:"2",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"20",insmPossMths:"3",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"20",insmPossMths:"4",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"20",insmPossMths:"5",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"20",insmPossMths:"6",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"40",insmPossMths:"2",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"40",insmPossMths:"3",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"40",insmPossMths:"4",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"40",insmPossMths:"5",bsicSlitmAmt:"50000"});
        
        longWintPopList.push({crdcCd:"40",insmPossMths:"6",bsicSlitmAmt:"50000"});
        
        /////////////////////////////////////////////////////////
        //스크립트. 할인 및 결제금액 처리 시작
        ////////////////////////////////////////////////////////

        var afcoDcVenCopnList =
            [
                
            ];
        /*
 * 주문금액 계산 2016
 */
        function calculateOrderAmt(exceptGubun) {

            $("#slitmInfDiv span").each(function() {
                $(this).data({prmoDcAmt : 0, copnDcAmt : 0});
            });


            // ars할인여부
            var arsDcYn = isEmpty($("#discount0:checked").val()) ? "N" : "Y";
            // 일시불할인여부
            var spymDcYn = isEmpty($("#discount1:checked").val()) ? "N" : "Y";
            // 깜짝할인여부
            var prmoDcYn = isEmpty($("#discount2:checked").val()) ? "N" : "Y";
            // 제휴할인여부
            var alliDcYn = isEmpty($("input[name='discountType1']:checked").val()) ? "N" : "Y";
            // 적립금즉시할인여부
            var svmtDcYn = isEmpty($("#sale:checked").val()) ? "N" : "Y";
            
            // 1 : 제휴카드, 2 : 직원할인(카드), 3 : 제휴할인, 4 : 임직원할인(제휴), 5 : 고객사할인
            var kind = $("input[name='discountType1']:checked").attr("kind");
            var payAlliGbcd = "";
            var aplyTcCd = "";
            var alliCrdCd = "";
            var aplyAlliKind = "";
            var b2BCustDcAplyYn = $("input[name='b2BCustDcAplyYn']").val();

            if (alliDcYn == "Y") {
                if(b2BCustDcAplyYn == "Y" && kind == "5") {
                    kind = "5";
                } else if(kind == "1") {
                    payAlliGbcd = $("input[name='discountType1']:checked").val();
                    alliCrdCd = $("input[name='discountType1']:checked").attr("crdCd");
                } else if(kind == "2") {
                    alliCrdCd = $("input[name='discountType1']:checked").val();
                } else {
                    aplyTcCd = $("input[name='discountType1']:checked").val();
                }

                aplyAlliKind = kind;
            }

            var totArsDcAmt = 0;
            var totSpymDcAmt = 0;
            var totPrmoDcAmt = 0;
            var totCopnDcAmt = 0;
            var totFreeDlvCopnDcAmt = 0;
            var totAlliDcAmt = 0;
            var totMassBuyPrmoDcAmt = 0;
            var totSvmtDcAmt = 0;
            var totPaymentCopnDcAmt = 0;


            // H.Point 적립 20170413 박승택 추가
            var savePrmoUPoint = 0;
            var saveItemUPoint = 0;
            var slitmPrmoUpoint = [];
            var slitmPrmoUpointLn = 0;

            // 적립금 적립
            var savePrmoHPoint = 0;
            var saveItemHPoint = 0;
            var slitmPrmoHpoint = [];
            var slitmPrmoHpointLn = 0;

            //ft014_프로모션+간편결제+적립
            var savePrmoSmplPoint       = 0;
            var savePrmoSmplPointArr    = new Array();
            var savePrmoSmplPointArrCo  = new Array();
            var savePrmoSmplPointArrPo  = new Array();
            var savePrmoSmplPointArrDp  = new Array();
            var savePrmoSmplPointCnt    = 0;
            var savePrmoSmplPointPrc    = 0;
            var savePrmoSmplPointDcAmt  = 0;
            var savePrmoSmplPointSw     = "";

            if( $("#hnmPromotionCodePossYn").val() == "Y"){
                if($("div.hnm-promotion-code input[name='hnmPaymentCopnInf']").length == 0) {
                    // H&M 일반쿠폰
                    $("div.hnm-promotion-code input[name='copnInf']").each(function() {
                        // H&M 일반 쿠폰
                        var copnInfArr = $(this).val().split("|");  // (copnNo|slitmCd|uitmCd|aspItemCd|famtFxrtGbcd|famtFxrtVal|copnGb|itemIdx|copnPblcNo|maxDcPossAmt|copnTypeGbcd)
                        var copnDcAmt = 0;
                        var copnAmt = 0;
                        var copnItemIdx = copnInfArr[7];
                        var maxDcPossAmt = copnInfArr[9];
                        var sellPrc = isEmpty($("span#" + copnInfArr[1] + copnInfArr[2] + copnInfArr[3]).data("sellPrc")) ? 0 : Number($("span#" + copnInfArr[1] + copnInfArr[2] + copnInfArr[3]).data("sellPrc"));

                        if(copnInfArr[4] == '1') {
                            copnAmt = Math.floor(Number(copnInfArr[5]) * Number(sellPrc) / 1000) * 10;
                        } else {
                            copnAmt = Number(copnInfArr[5]);
                        }

                        if(maxDcPossAmt > 0 && copnAmt > maxDcPossAmt) {
                            copnAmt = Number(maxDcPossAmt);
                        }

                        copnDcAmt += copnAmt;
                        totCopnDcAmt += copnDcAmt;
                    });
                }
            } else {
                // 상품단위로 loop
                $("#slitmInfDiv span").each(function() {

                    var obj = $(this);

                    var slitmCd = obj.data("slitmCd");
                    var uitmCd = obj.data("uitmCd");
                    var aspItemCd = obj.data("aspItemCd");
                    var sellPrc = Number(obj.data("sellPrc"));
                    var ordQty = Number(obj.data("ordQty"));
                    var svmtRate = obj.data("svmtRate");
                    var dcSvmt = isEmpty(obj.data("dcSvmt")) ? 0 : Number(obj.data("dcSvmt"));

                    /* 20170413 박승택 추가 */
                    //var upntAcmRate = obj.data("upntAcmRate");

                    // 상품의 수량별로 할인금액 보관
                    var dcAmtArr = new Array();

                    var alliDcAmt = 0;
                    var massBuyPrmoDcAmt = 0;
                    var svmtDcAmt = 0;

                    // 상품의 수량만큼 loop
                    for (var i=0; i<ordQty; i++) {

                        var dcAmt = 0;
                        var arsDcAmt = 0;
                        var spymDcAmt = 0;
                        var prmoDcAmt = 0;
                        var copnDcAmt = 0;
                        var plusCopnDcAmt = 0;

                        // ARS 할인
                        if (arsDcYn == "Y") {
                            arsDcAmt = Number(obj.data("arsDcAmt"));
                            totArsDcAmt += arsDcAmt;
                            dcAmt += arsDcAmt;
                        }

                        // 일시불할인
                        if (spymDcYn == "Y") {
                            spymDcAmt = Number(obj.data("spymDcAmt"));
                            totSpymDcAmt += spymDcAmt;
                            dcAmt += spymDcAmt;
                        }

                        // 깜짝할인
                        if (prmoDcYn == "Y") {
                            var prmoDcRate = $(this).data("dcRate");
                            if(prmoDcRate > 0) {
                                prmoDcAmt = Math.floor(sellPrc * Number(prmoDcRate) / 1000) * 10;
                            } else {
                                prmoDcAmt = Number(obj.data("dcAmt"));
                            }
                            totPrmoDcAmt += prmoDcAmt;
                            dcAmt += prmoDcAmt;
                        }

                        // 일반 쿠폰
                        var copnInfArrString = $("#gnrlCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).val();

                        if (!isEmpty(copnInfArrString)) {
                            // (0:copnNo|1:slitmCd|2:uitmCd|3:aspItemCd|4:famtFxrtGbcd|5:famtFxrtVal|6:copnGb|7:itemIdx|8:copnPblcNo|9:maxDcPossAmt|10:copnTypeGbcd)
                            var copnInfArr = copnInfArrString.split("|");
                            var copnItemIdx = copnInfArr[7];
                            var maxDcPossAmt = copnInfArr[9];
                            if(copnInfArr[4] == '1') {
                                copnDcAmt = Math.floor(Number(copnInfArr[5]) * Number(sellPrc - dcAmt) / 1000) * 10;

                                if(maxDcPossAmt > 0 && copnDcAmt > maxDcPossAmt) {
                                    copnDcAmt = Number(maxDcPossAmt);
                                }
                            } else {
                                copnDcAmt = Number(copnInfArr[5]);

                                if(maxDcPossAmt > 0 && copnDcAmt > maxDcPossAmt) {
                                    copnDcAmt = Number(maxDcPossAmt);
                                }
                            }

                            totCopnDcAmt += copnDcAmt;
                            dcAmt += copnDcAmt;

                            // 플러스 쿠폰
                            copnInfArrString = $("#plusCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).val();

                            if (!isEmpty(copnInfArrString)) {

                                // (0:copnNo|1:slitmCd|2:uitmCd|3:aspItemCd|4:famtFxrtGbcd|5:famtFxrtVal|6:copnGb|7:itemIdx|8:copnPblcNo|9:maxDcPossAmt|10:copnTypeGbcd)
                                var copnInfArr = copnInfArrString.split("|");
                                var copnItemIdx = copnInfArr[7];
                                var maxDcPossAmt = copnInfArr[9];
                                if(copnInfArr[4] == '1') {
                                    plusCopnDcAmt = Math.floor(Number(copnInfArr[5]) * Number(sellPrc - dcAmt) / 1000) * 10;

                                    if(maxDcPossAmt > 0 && plusCopnDcAmt > maxDcPossAmt) {
                                        plusCopnDcAmt = Number(maxDcPossAmt);
                                    }
                                } else {
                                    plusCopnDcAmt = Number(copnInfArr[5]);

                                    if(maxDcPossAmt > 0 && plusCopnDcAmt > maxDcPossAmt) {
                                        plusCopnDcAmt = Number(maxDcPossAmt);
                                    }
                                }

                                totCopnDcAmt += plusCopnDcAmt;
                                dcAmt += plusCopnDcAmt;

                            }

                        }


                        // 쿠폰할인금액 디스플레이
                        if (copnDcAmt > 0)
                            if($("#gnrlCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).parents().find("input[name=isCuponAreaShowN]").val() == "Y") {
                                if(i == 0) {
                                    $("#gnrlCopnTxt_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).html("-" + gfn_appendComma(Number(copnDcAmt) * Number($("span[id^='gnrlCopnTxt_']").size())) + "원");
                                } else {
                                    $("#gnrlCopnTxt_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).html("-" + gfn_appendComma(Number(copnDcAmt)) + "원");
                                }
                            } else {
                                $("#gnrlCopnTxt_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).html("-" + gfn_appendComma(Number(copnDcAmt)) + "원");
                            }
                        else
                            $("#gnrlCopnTxt_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).html("0원");
                        if (plusCopnDcAmt > 0)
                            $("#plusCopnTxt_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).html("-" + gfn_appendComma(Number(plusCopnDcAmt)) + "원");
                        else
                            $("#plusCopnTxt_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).html("0원");


                        // 단위수량단위로 할인가격 보관(쿠폰때문에 가격이 다를수 있음)
                        dcAmtArr[i] = dcAmt;

                    } // for (var i=0; i<ordQty; i++) {

                    // 제휴 할인
                    if (alliDcYn == "Y") {

                        var dcRate = 0;

                        if(kind == "1") {
                            var alliCrdDcYn = $(this).data("alliCrdDcYn");
                            var empDcYn = $(this).data("empDcYn");

                            if($("input[name='discountType1']:checked").attr("crdCd") == "04") { // 현대패밀리카드선택여부 체크
                                if(empDcYn == "Y") {
                                    dcRate = isEmpty($("input[name='discountType1']:checked").attr("dcRate")) ? 0 : Number($("input[name='discountType1']:checked").attr("dcRate"));
                                }
                            } else if(alliCrdDcYn == "Y") {
                                dcRate = isEmpty($("input[name='discountType1']:checked").attr("dcRate")) ? 0 : Number($("input[name='discountType1']:checked").attr("dcRate"));
                            }
                        } else if(kind == "2") {
                            var empDcYn = $(this).data("empDcYn");
                            if(empDcYn == "Y") {
                                dcRate = isEmpty($("input[name='discountType1']:checked").attr("dcRate")) ? 0 : Number($("input[name='discountType1']:checked").attr("dcRate"));
                            }
                        } else if(kind == "3") {
                            var baseDcRate = isEmpty($(this).data("tcBaseDcRate")) ? 0 : Number($(this).data("tcBaseDcRate"));
                            // 2018.07.19 할인한도액
                            dcRate = (isEmpty($(this).data("tcDcRate")) || $(this).data("tcDcRate") == 0)? baseDcRate : Number($(this).data("tcDcRate"));

                            var tcDcType  = isEmpty($(this).data("tcDcType")) ? "03" : $(this).data("tcDcType");

                            // 최저가 할인일 경우 정액 금액으로 처리
                            if(tcDcType == "01"){
                                var tcDcAmt    = isEmpty($(this).data("tcDcAmt")) ? 0 : Number($(this).data("tcDcAmt"));
                                dcRate =  tcDcAmt;
                            }
                        } else if(kind == "5") {
                            dcRate = isEmpty($(this).data("b2BDcRate")) ? 0 : Number($(this).data("b2BDcRate"));
                        }

                        for (var i=0; i < dcAmtArr.length; i++) {
                            alliDcAmt = gfn_getTcDcAmt(aplyAlliKind, (sellPrc - dcAmtArr[i]), dcRate, 1, $(this));
                            dcAmtArr[i]  += alliDcAmt;
                            totAlliDcAmt += alliDcAmt;
                        }
                    }

                    // 대량구매할인
                    var massBuyDcRate = Number(obj.data("massBuyDcRate"));
                    var massBuyDcAmt = Number(obj.data("massBuyDcAmt"));

                    if (massBuyDcRate > 0 || massBuyDcAmt > 0) {
                        for (var i=0; i < dcAmtArr.length; i++) {
                            if(massBuyDcRate > 0) {
                                massBuyPrmoDcAmt = Math.floor((sellPrc - dcAmtArr[i]) * Number(massBuyDcRate) / 1000) * 10;
                                dcAmtArr[i] += massBuyPrmoDcAmt;
                                totMassBuyPrmoDcAmt += massBuyPrmoDcAmt;
                            } else if(massBuyDcAmt > 0) {
                                massBuyPrmoDcAmt = massBuyDcAmt;
                                dcAmtArr[i] += massBuyPrmoDcAmt;
                                totMassBuyPrmoDcAmt += massBuyPrmoDcAmt;
                            }
                        }
                    }

                    // 적립금 즉시할인
                    if (svmtDcYn == "Y") {
                        if (dcSvmt > 0) {
                            if (Math.round(svmtRate) >= 5) {
                                for (var i=0; i < dcAmtArr.length; i++) {
                                    svmtDcAmt = Math.floor((Math.floor((sellPrc - dcAmtArr[i]) * Number(svmtRate) / 1000) * 10) * 80 / 1000) * 10;
                                    dcAmtArr[i] += svmtDcAmt;
                                    totSvmtDcAmt += svmtDcAmt;
                                }
                            } else {
                                for (var i=0; i < dcAmtArr.length; i++) {
                                    svmtDcAmt = Math.floor((Math.floor((sellPrc - dcAmtArr[i]) * Number(svmtRate) / 1000) * 10) * 70 / 1000) * 10;
                                    dcAmtArr[i] += svmtDcAmt;
                                    totSvmtDcAmt += svmtDcAmt;
                                }
                            }
                        }
                    }

                    // 적립금(적립금) + H.Point 적립
                    if (svmtDcYn == "N") {

                        var hmallPntAcmRate = obj.data("hmallPntAcmRate");
                        var upntAcmRate = obj.data("upntAcmRate");  //TODO 박승택 20170403 통합포인트 적립율 소스 추가

                        /*필링크 flk 부여한도 추가*/
                        var bndsAmt = obj.data("bndsAmt");
                        var famtFxrtGbcd = obj.data("famtFxrtGbcd");
                        var famtFxrtVal = obj.data("famtFxrtVal");

                        var sellPrcTmp = sellPrc;


                        if( famtFxrtGbcd == "2") {  //정액이면 할인금액 모두 부여
                            savePrmoHPoint += Number(famtFxrtVal) * ordQty;
                            slitmPrmoHpoint[slitmPrmoHpointLn++] = {famtFxrtGbcd:famtFxrtGbcd, famtFxrtVal:famtFxrtVal, svmt:famtFxrtVal, bndsAmt : bndsAmt, ordQty : ordQty};

                            //20170413 박승택 추가
                            savePrmoUPoint += Number(famtFxrtVal) * ordQty;
                            slitmPrmoUpoint[slitmPrmoUpointLn++] = {famtFxrtGbcd:famtFxrtGbcd, famtFxrtVal:famtFxrtVal, svmt:famtFxrtVal, bndsAmt : bndsAmt, ordQty : ordQty};


                        } else {
                            for (var i=0; i < dcAmtArr.length; i++) {
                                sellPrcTmp = sellPrc - dcAmtArr[i];
                                hpoint = Math.floor(sellPrcTmp * Number(svmtRate) / 1000) * 10;

                                // 20170413 박승택 추가
                                // HPoint마케팅개선 kjh 20190408 쿠폰적용시 H.Point적립금액 표시 오류 수정
                                upoint = Math.floor(sellPrcTmp * Number(svmtRate) / 1000) * 10;

                                if(bndsAmt !="") {
                                    bndsAmt = Number(bndsAmt);
                                    savePrmoHPoint += bndsAmt < hpoint ? bndsAmt : hpoint;

                                    // 20170413 박승택 추가
                                    savePrmoUPoint += bndsAmt < upoint ? bndsAmt : upoint;

                                } else {
                                    savePrmoHPoint += hpoint;

                                    // 20170413 박승택 추가
                                    savePrmoUPoint += upoint;
                                }
                                slitmPrmoHpoint[slitmPrmoHpointLn++] = {famtFxrtGbcd:famtFxrtGbcd, famtFxrtVal:famtFxrtVal, svmt:hpoint, bndsAmt : bndsAmt, ordQty : 1};

                                // 20170413 박승택 추가
                                slitmPrmoUpoint[slitmPrmoUpointLn++] = {famtFxrtGbcd:famtFxrtGbcd, famtFxrtVal:famtFxrtVal, svmt:upoint, bndsAmt : bndsAmt, ordQty : 1};

                            }
                        }
                        if(hmallPntAcmRate > 0) {
                            for (var i=0; i < dcAmtArr.length; i++) {
                                sellPrcTmp = sellPrc - dcAmtArr[i];
                                saveItemHPoint += (Math.floor(sellPrcTmp * Number(hmallPntAcmRate) / 1000) * 10) ;
                            }
                        }


                        // 20170413 박승택 추가
                        if(upntAcmRate > 0) {
                            for (var i=0; i < dcAmtArr.length; i++) {
                                sellPrcTmp = sellPrc - dcAmtArr[i];
                                saveItemUPoint += (Math.floor(sellPrcTmp * Number(upntAcmRate) / 1000) * 10) ;
                            }
                        }
                    }

                    // ft014 20190814 hmallpay간편결제 예상 H.point 계산
                    // hmallpay간편결제 적립대상여부 + 프로모션별 그룹핑
                    var wPayType = $(".payment-wrap a.on").find("input[name=pay]").val(); //Hmall pay 선택
                    wPayType =  wPayType == undefined ? stlmWayType : wPayType;

                    //alert("wPayType : "+wPayType);
                    if(wPayType == '99' || wPayType == 'hpay'){
                        var prmoNo = fnGetPrmoSmplPointYn(slitmCd);
                        if(prmoNo != "N"){
                            savePrmoSmplPointArr[savePrmoSmplPointCnt] = new Array();
                            savePrmoSmplPointArr[savePrmoSmplPointCnt][0]   = slitmCd;            //제품코드
                            savePrmoSmplPointPrc                            = sellPrc*ordQty;
                            savePrmoSmplPointArr[savePrmoSmplPointCnt][1]   = savePrmoSmplPointPrc; //합계금액
                            savePrmoSmplPointDcAmt = 0;
                            for (var i=0; i < dcAmtArr.length; i++) {
                                savePrmoSmplPointDcAmt += dcAmtArr[i];
                            }
                            savePrmoSmplPointArr[savePrmoSmplPointCnt][2]   = savePrmoSmplPointDcAmt; //할인금액
                            savePrmoSmplPointArr[savePrmoSmplPointCnt][3]   = prmoNo; //프로모션번호

                            savePrmoSmplPointCnt    ++;
                        }
                    }
                    ///

                }); // $("#slitmInfDiv span").each(function() {
            }
            // 2019.10.08 HMALL개선이주형 무료배송비쿠폰 다중적용
            //console.log("freeDlvCopnInf size : " + $("#cuponSearch input[name='freeDlvCopnInf']").length);
            $("div[name='cuponSearch'] input[name='freeDlvCopnInf']").each(function() {
                //console.log(this.value);
                if (!isEmpty(this.value)) {
                    var freeDlvCopnInfArr = this.value.split("|");  // copnNo|copnPblcNo|freeDlvVenCd|freeDlvOshpVenAdrSeq|dcPrice
                    //console.log("freeDlvCopnInfArr : " + freeDlvCopnInfArr);
                    totFreeDlvCopnDcAmt += isEmpty(freeDlvCopnInfArr[4]) ? 0 : Number(freeDlvCopnInfArr[4]);
                }
            });
            //console.log("totFreeDlvCopnDcAmt : " + totFreeDlvCopnDcAmt);

            var orderAmt = ufnToNum($("input[name='orderAmt']:last").val());
            var addDlvAmt = ufnToNum($("input[name='addDlvAmt']").val());
            var tmpTotDlvCost = ufnToNum($("input[name='totDlvCost']").val());

            // 결제금액할인쿠폰
            if($("input[name='paymentCopnInf']").length > 0) {
                var tmpTotDcAmt = totArsDcAmt + totSpymDcAmt + totPrmoDcAmt + totCopnDcAmt + totFreeDlvCopnDcAmt + totAlliDcAmt + totMassBuyPrmoDcAmt + totSvmtDcAmt;
                var tmpRealStlmAmt = orderAmt - tmpTotDcAmt;

                if(setPaymentCopnHide(tmpRealStlmAmt)) {
                    $("#stlmAmtDcDiv").show();
                    var paymentCopnInfString = $("input[name=paymentCopnInf]").val();

                    if(!isEmpty(paymentCopnInfString)) {
                        var copnInfArr = paymentCopnInfString.split("|");
                        var famtFxrtGbcd = copnInfArr[2];
                        var famtFxrtVal = Number(copnInfArr[3]);
                        var maxDcPossAmt = Number(copnInfArr[4]);

                        if(famtFxrtGbcd == "2") {
                            totPaymentCopnDcAmt = famtFxrtVal;
                        } else {
                            totPaymentCopnDcAmt = Math.floor(tmpRealStlmAmt * famtFxrtVal / 1000) * 10;
                        }

                        if(maxDcPossAmt > 0 && !isEmpty(maxDcPossAmt)) {
                            if(totPaymentCopnDcAmt > maxDcPossAmt) {
                                totPaymentCopnDcAmt = maxDcPossAmt;
                            }
                        }

                        var deffRealStlmAmt = orderAmt - tmpTotDlvCost - tmpTotDcAmt;
                        if((deffRealStlmAmt - totPaymentCopnDcAmt) < 1000 && !isAutoDcIng) {
                            // 추천할인에서 예상하지 못한 오류가 생겨서 쿠폰을 숨기지 못했을 경우를 위한 방어 코드임
                            var copnNm = $("input[name='selPaymentCopn']:checked").siblings("label").text();
                            alert(copnNm + " 할인 적용시 상품 결제금액이 1,000원 미만이므로 사용할 수 없습니다.");
                            $("input[name=paymentCopnInf]").val("");
                            $("input[name='selPaymentCopn']").eq(0).click();
                            totPaymentCopnDcAmt = 0;
                        }
                    }
                } else {
                    if($("input[name='discountType1']").length > 0 || $("#sale").length > 0) {
                        $("#stlmAmtDcDiv").hide();
                    }
                    $("input[name=paymentCopnInf]").val("");

                    isPayCopnPayTypeSet = false;
                    $("input[name='selPaymentCopn']").eq(0).click();
                }
            }
            // 결제금액할인쿠폰

            // H&M 결제금액할인쿠폰
            if($("div.hnm-promotion-code input[name='hnmPaymentCopnInf']").length > 0) {
                // H&M 결제금액할인
                $("div.hnm-promotion-code input[name='copnInf']").each(function() {
                    var copnInfArr = $(this).val().split("|"); // (copnNo|slitmCd|uitmCd|aspItemCd|famtFxrtGbcd|famtFxrtVal|copnGb|itemIdx|copnPblcNo|maxDcPossAmt|copnTypeGbcd|ulmtUseYn|dcPrice)

                    var copnAmt = 0;

                    if(copnInfArr[10] == '10'){      // 결제금액할인코드
                        copnAmt = Number(copnInfArr[12]);
                    }

                    totPaymentCopnDcAmt += copnAmt;
                });
            }
            // H&M 결제금액할인쿠폰

            // 상품권 사용(지류/문화상품권)
            var stlmPaperGcAmt = ufnToNum($("input[name='useGcAmt']").val());

            // 온라인상품권 사용(컬쳐캐쉬)
            var stlmOnlnGcAmt = ufnToNum($("span[name='useCultureCashAmt']").text());

            // 예치금 사용
            var useDeposit = ufnToNum($("input[name='useDeposit']").val());


            // H.Point 사용  20170413 박승택 추가
            var useUPoint = ufnToNum($("input[name='useUPoint']").val());

            // 적립금 사용
            var useHPoint = ufnToNum($("input[name='useHPoint']").val());

            // W포인트 사용
            var useWPoint = ufnToNum($("input[name='useWPoint']").val());

            // 하나머니 사용
            var useHanamoneyAmt = ufnToNum($("span[name='useHanamoneyAmt']").text());
            
            // 블루포인트 사용
            var useBluePointAmt = ufnToNum($("span[name='useBluePointAmt']").text());
            
            var totDcAmt = totArsDcAmt + totSpymDcAmt + totPrmoDcAmt + totCopnDcAmt + totFreeDlvCopnDcAmt + totAlliDcAmt + totMassBuyPrmoDcAmt + totSvmtDcAmt + totPaymentCopnDcAmt;

            /* TODO START 통합포인트 주가 소스 수정 20170403 박승택 */
            var totUseAmt = stlmPaperGcAmt + useDeposit + useHPoint + useUPoint + useWPoint + useHanamoneyAmt + useBluePointAmt + stlmOnlnGcAmt;
            if(exceptGubun == "useDeposit") {
                totUseAmt = stlmPaperGcAmt + useHPoint + useUPoint + useWPoint + useHanamoneyAmt + useBluePointAmt + stlmOnlnGcAmt;
            }
            if(exceptGubun == "useHPoint" || exceptGubun == "useUPoint") {
                totUseAmt = stlmPaperGcAmt + useDeposit + useWPoint + useHanamoneyAmt + useBluePointAmt + stlmOnlnGcAmt;
            }
            if(exceptGubun == "useWPoint") {
                totUseAmt = stlmPaperGcAmt + useDeposit + useHPoint +useUPoint + useHanamoneyAmt + useBluePointAmt + stlmOnlnGcAmt;
            }

            /* TODO END 통합포인트 주가 소스 수정 20170403 박승택 */

            //카드즉시할인KJH
            var vPayType = $(".payment-wrap a.on").find("input[name=pay]").val();
            var totCrdImdtDcPrmoAmt = 0;
            var crdImdtDcPrmoNo = "";
            var crdImdtDcPrmoCondGrpSeq = "";

            $("#cardPrmoCmt").empty();
            if( vPayType == '1'){
                var crdImdtDcPrmoNoArr = fn_getCrdImdtDcPrmoList();
                if( crdImdtDcPrmoNoArr != null && crdImdtDcPrmoNoArr.length > 0){
                    var stlmCrdInf = $("select[name='stlmCrdInf'] option:selected").val();
                    
                    var smileCrdPoint = $("input[name='smileCrdPointYn']").val();
                    var smileCrdCd = stlmCrdInf.split('|')[0];
                    //현대(스마일카드)체크시 진행 
                    if(smileCrdPoint == 'Y' && smileCrdCd =='04'){
                        stlmCrdInf = "04|N|4|21" ;
                    }                     
                    
                    //카드즉시할인계산금액 = 주문금액 - 할인금액 - 자산사용금액 - 무통장입금액 - 배송비
                    var tmpCrdImdtCalcStlmAmt = orderAmt - totDcAmt - totUseAmt - tmpTotDlvCost;

                    
                    if(!isEmpty(stlmCrdInf) && tmpCrdImdtCalcStlmAmt > 0) {

                        var crdImdtDcInf = null;
                        var crdCd = stlmCrdInf.split('|')[3];
                        for ( var i = 0; i < crdImdtDcPrmoNoArr.length; i++){
                            if( crdImdtDcPrmoNoArr[i].crdcCd == crdCd){
                                crdImdtDcInf = crdImdtDcPrmoNoArr[i];
                            }
                        }

                        if(crdImdtDcInf != null) {
                            for(var i = 0; i < crdImdtDcInf.condList.length; i++) {
                                var cond = crdImdtDcInf.condList[i];
                                if(tmpCrdImdtCalcStlmAmt >= cond.strtVal && tmpCrdImdtCalcStlmAmt <= cond.endVal) {
                                    var totCrdImdtDcPrmoAmt = cond.famtFxrtVal;
                                    if(cond.famtFxrtGbcd == '1') {
                                        //totCrdImdtDcPrmoAmt = Math.floor(tmpCrdImdtCalcStlmAmt * cond.famtFxrtVal / 1000) * 10;
                                        totCrdImdtDcPrmoAmt = Math.floor(tmpCrdImdtCalcStlmAmt * cond.famtFxrtVal / 100);
                                    }

                                    if(!isEmpty(crdImdtDcInf.bndsAmt) && crdImdtDcInf.bndsAmt != 0 && totCrdImdtDcPrmoAmt > crdImdtDcInf.bndsAmt) {
                                        totCrdImdtDcPrmoAmt = crdImdtDcInf.bndsAmt;
                                    }

                                    if( totCrdImdtDcPrmoAmt > 0){
                                        var vTxt = "";
                                        if(cond.famtFxrtGbcd == '1' && crdImdtDcInf.bndsAmt != totCrdImdtDcPrmoAmt) {
                                            vTxt = crdImdtDcInf.crdcNm + " " + cond.famtFxrtVal + "% 즉시할인 적용";
                                        } else {
                                            vTxt = crdImdtDcInf.crdcNm + " 즉시할인 적용";
                                        }

                                        $("#cardPrmoCmt").text(vTxt);

                                        crdImdtDcPrmoNo = crdImdtDcInf.prmoNo;
                                        crdImdtDcPrmoCondGrpSeq = cond.condGrpSeq;
                                        //카드즉시할인 적용되면 청구할인정보 초기화
                                        $("input[name=dmndDcProTotItemTrgtYn]").val("");
                                        $("input[name=dmndDcPrmoNo]").val("");
                                    }
                                    break;
                                }
                            }
                        }
                    }
                    //총할인금액에 카드즉시할인금액 추가
                    totDcAmt = totDcAmt + totCrdImdtDcPrmoAmt;

                    //addDlvAmt- 추가배송비
                    var tmpCrdStlmAmt = (orderAmt + addDlvAmt) - totDcAmt - totUseAmt;
                    //신용카드결제금액
                    //$("#stlmCrdAmt").val(tmpCrdStlmAmt);
                    //$(".stlmAmtInfArea").text(gfn_appendComma(tmpCrdStlmAmt) + "원");
                    //$("#stlmCrdAmtDl dd").html(gfn_appendComma(tmpCrdStlmAmt) + "원");
                }
            }

            // 카드, 무통장, 휴대폰 결제 금액
            var totStlmAmt = (orderAmt + addDlvAmt) - totDcAmt - totUseAmt;
            var realStlmAmt = (orderAmt + addDlvAmt) - totDcAmt;
            //임직원 할인 한도 체크(배송비는 제외한 실결제금액)
            empDcOrderAmt = orderAmt - tmpTotDlvCost - totDcAmt;


            //카드즉시할인KJH 적립금/H.Point 계산시 카드즉시할인금액 추가
            /* 20170403 박승택 */
            if((orderAmt + addDlvAmt) - totDcAmt != (useHPoint+useUPoint+useWPoint) && (useHPoint > 0 || useUPoint > 0 || totPaymentCopnDcAmt > 0 || totCrdImdtDcPrmoAmt > 0)) {
                // flk
                // savePrmoHPoint = Math.floor(savePrmoHPoint * ((realStlmAmt - useHPoint) / realStlmAmt) / 10) * 10;
                /* 20170403 박승택 수정*/
                saveItemHPoint = Math.floor(saveItemHPoint * ((realStlmAmt - (useHPoint+useUPoint+useWPoint)) / (realStlmAmt + totPaymentCopnDcAmt + totCrdImdtDcPrmoAmt)) / 10) * 10;
                savePrmoHPoint  = 0;
                /* 20170403 박승택 추가*/
                saveItemUPoint = Math.floor(saveItemUPoint * ((realStlmAmt - (useHPoint+useUPoint+useWPoint)) / (realStlmAmt + totPaymentCopnDcAmt + totCrdImdtDcPrmoAmt)) / 10) * 10;
                savePrmoUPoint  = 0;

                //TODO 상품마다 포인트 * 결제
                for(var i=0; i < slitmPrmoHpoint.length; i++) {
                    if(slitmPrmoHpoint[i].famtFxrtGbcd == "2") {
                        savePrmoHPoint += Number(slitmPrmoHpoint[i].famtFxrtVal)*slitmPrmoHpoint[i].ordQty;
                    } else {

                        //TODO 20170403 박승택 수정
                        var slitmSvmt = Math.floor(Number(slitmPrmoHpoint[i].svmt) * ((realStlmAmt - (useHPoint+useUPoint)) / (realStlmAmt+totPaymentCopnDcAmt + totCrdImdtDcPrmoAmt)) / 10) * 10;
                        if(slitmPrmoHpoint[i].bndsAmt != "" && slitmPrmoHpoint[i].bndsAmt < slitmSvmt) {
                            slitmSvmt = Number(slitmPrmoHpoint[i].bndsAmt);
                        }
                        savePrmoHPoint += slitmSvmt * slitmPrmoHpoint[i].ordQty ;   //상품마다 포인트이므로 상품의 수량을 곱해준다.
                    }
                }

                //TODO 20170403 박승택 추가
                for(var i=0; i < slitmPrmoUpoint.length; i++) {
                    if(slitmPrmoUpoint[i].famtFxrtGbcd == "2") {
                        savePrmoUPoint += Number(slitmPrmoUpoint[i].famtFxrtVal)*slitmPrmoUpoint[i].ordQty;
                    } else {

                        var slitmSvmt = Math.floor(Number(slitmPrmoUpoint[i].svmt) * ((realStlmAmt - (useHPoint+useUPoint)) / (realStlmAmt+totPaymentCopnDcAmt + totCrdImdtDcPrmoAmt)) / 10) * 10;
                        if(slitmPrmoUpoint[i].bndsAmt != "" && slitmPrmoUpoint[i].bndsAmt < slitmSvmt) {
                            slitmSvmt = Number(slitmPrmoUpoint[i].bndsAmt);
                        }
                        savePrmoUPoint += slitmSvmt * slitmPrmoUpoint[i].ordQty ;   //상품마다 포인트이므로 상품의 수량을 곱해준다.
                    }
                }

                //TODO 20170403 박승택 수정
            } else if((orderAmt + addDlvAmt) - totDcAmt == (useHPoint+useUPoint+useWPoint)) {   // 전액 포인트결제
                savePrmoHPoint = 0;
                saveItemHPoint = 0;

                //TODO 20170403 박승택 추가
                savePrmoUPoint = 0;
                saveItemUPoint = 0;

                for(var i=0; i < slitmPrmoHpoint.length; i++) {
                    if(slitmPrmoHpoint[i].famtFxrtGbcd == "2") {
                        savePrmoHPoint += Number(slitmPrmoHpoint[i].famtFxrtVal)*slitmPrmoHpoint[i].ordQty;
                    }
                }

                //TODO 20170403 박승택 추가
                for(var i=0; i < slitmPrmoUpoint.length; i++) {
                    if(slitmPrmoUpoint[i].famtFxrtGbcd == "2") {
                        savePrmoUPoint += Number(slitmPrmoUpoint[i].famtFxrtVal)*slitmPrmoUpoint[i].ordQty;
                    }
                }

            }

            $("form[name='orderDataForm'] input[name='totStlmAmt']").val(totStlmAmt);
            $("form[name='orderDataForm'] input[name='realStlmAmt']").val(realStlmAmt);
            $("form[name='orderDataForm'] input[name='arsDcAmt']").val(totArsDcAmt);                // ARS 할인금액
            $("form[name='orderDataForm'] input[name='spymDcAmt']").val(totSpymDcAmt);              // 일시불할인금액
            $("form[name='orderDataForm'] input[name='spdcAmt']").val(totPrmoDcAmt);                // 깜짝할인금액
            $("form[name='orderDataForm'] input[name='copnDcAmt']").val(Number(totCopnDcAmt) + Number(totFreeDlvCopnDcAmt));  // 쿠폰할인
            $("form[name='orderDataForm'] input[name='itemCopnDcAmt']").val(totCopnDcAmt);          // 쿠폰할인
            $("form[name='orderDataForm'] input[name='alliRefDcAmt']").val(totAlliDcAmt);           // 제휴할인
            $("form[name='orderDataForm'] input[name='payCopnDcAmt']").val(totPaymentCopnDcAmt);    // 결제금액할인쿠폰
            $("form[name='orderDataForm'] input[name='aplyAlliKind']").val(aplyAlliKind);           // 적용 제휴할인 종류
            $("form[name='orderDataForm'] input[name='aplyTcCd']").val(aplyTcCd);                   // 적용 제휴 레퍼코드
            $("form[name='orderDataForm'] input[name='payAlliGbcd']").val(payAlliGbcd);             // 적용 제휴카드
            $("form[name='orderDataForm'] input[name='alliCrdCd']").val(alliCrdCd);
            $("form[name='orderDataForm'] input[name='svmtDcAmt']").val(totSvmtDcAmt);              // 적립금 즉시할인
            $("form[name='orderDataForm'] input[name='massBuyDcAmt']").val(totMassBuyPrmoDcAmt);    // 대량구매할인
            $("form[name='orderDataForm'] input[name='stlmHPointAmt']").val(useHPoint);
            $("form[name='orderDataForm'] input[name='stlmWPointAmt']").val(useWPoint);             // W포인트

            //20140413 박승택 추가
            $("form[name='orderDataForm'] input[name='stlmUPointAmt']").val(useUPoint);

            $("form[name='orderDataForm'] input[name='stlmCdpstAmt']").val(useDeposit);
            $("form[name='orderDataForm'] input[name='stlmHanaMoneyAmt']").val(useHanamoneyAmt);
            $("form[name='orderDataForm'] input[name='stlmBlpntAmt']").val(useBluePointAmt);
            $("form[name='orderDataForm'] input[name='stlmOnlnGcAmt']").val(stlmOnlnGcAmt);
            $("form[name='orderDataForm'] input[name='stlmPaperGcAmt']").val(stlmPaperGcAmt);
            
            $("input[name='totDcAmtCalc']").val(totDcAmt);              // 총 할인내역
            //카드즉시할인KJH
            $("form[name='orderDataForm'] input[name='crdImdtDcPrmoNo']").val(crdImdtDcPrmoNo); // 카드즉시할인프로모션번호
            $("form[name='orderDataForm'] input[name='crdImdtDcPrmoCondGrpSeq']").val(crdImdtDcPrmoCondGrpSeq); // 카드즉시할인프로모션조건그룹순번
            $("form[name='orderDataForm'] input[name='crdImdtDcPrmoAmt']").val(totCrdImdtDcPrmoAmt);    // 카드즉시할인금액

           
            /* 2016 모바일이주형 안쓰는 로직 주석처리 */
//    if (totArsDcAmt > 0)
//      $("#arsDcTxt").html("-" + gfn_appendComma(Number(totArsDcAmt)) + "원");
//    else
//      $("#arsDcTxt").html("0원");
//    if (totSpymDcAmt > 0)
//      $("#spymDcTxt").html("-" + gfn_appendComma(Number(totSpymDcAmt)) + "원");
//    else
//      $("#spymDcTxt").html("0원");
//    if (totPrmoDcAmt > 0)
//      $("#prmoDcTxt").html("-" + gfn_appendComma(Number(totPrmoDcAmt)) + "원");
//    else
//      $("#prmoDcTxt").html("0원");

            if (totAlliDcAmt > 0)
                $("#totAlliDcTxt").html(gfn_appendComma(Number(totAlliDcAmt)) + "원");
            else
                $("#totAlliDcTxt").html("0원");
            if (totMassBuyPrmoDcAmt > 0)
                $("#massDcTxt").html("-" + gfn_appendComma(Number(totMassBuyPrmoDcAmt)) + "원");
            else
                $("#massDcTxt").html("0원");
            if (totSvmtDcAmt > 0)
                $("#svmtDcTxt").html("-" + gfn_appendComma(Number(totSvmtDcAmt)) + "원");
            else
                $("#svmtDcTxt").html("0원");
            if(totPaymentCopnDcAmt > 0) {
                $("#stlmAmtDcTxt").html("-" + gfn_appendComma(Number(totPaymentCopnDcAmt)) + "원");
            } else {
                $("#stlmAmtDcTxt").html("0원");
            }
            if (totDcAmt > 0)
                $("#totDcTxt").html("(-)" + gfn_appendComma(Number(totDcAmt)) + "원");
            else
                $("#totDcTxt").html("0원");

//    if(totPaymentCopnDcAmt > 0) {
//      savePrmoHPoint = 0;
//      saveItemHPoint = 0;
//    }
//
//    //20140419 박승택 추가
//    if(totPaymentCopnDcAmt > 0) {
//        savePrmoUPoint = 0;
//        saveItemUPoint = 0;
//    }

            // 적립예상 적립금 화면
            //HPoint마케팅개선 kjh 20190218 프로모션적립금을 H.Point 로 전환 시작
            if (Number(saveItemHPoint) > 0) {
                $("#totHPointArea").show();
            } else {
                $("#totHPointArea").hide();
            }

            $("#totHPointTxt").html(gfn_appendComma(Number(saveItemHPoint)) + "원");


            //ft014_간편결제프로모션+HmallPay+적립 시 금액 추가
            /*    console.log("savePrmoSmplPointArr.length : "+savePrmoSmplPointArr.length);
    for(var i=0; i<savePrmoSmplPointArr.length; i++){
        console.log("i = "+i+", savePrmoSmplPointArr[i][0] = "+savePrmoSmplPointArr[i][0]+", savePrmoSmplPointArr[i][1] = "+savePrmoSmplPointArr[i][1]+
                ", savePrmoSmplPointArr[i][2] = "+savePrmoSmplPointArr[i][2]+", savePrmoSmplPointArr[i][3] = "+savePrmoSmplPointArr[i][3]);
    }*/

            // cd Grouping
            savePrmoSmplPointCnt = 0;
            for(var i=0; i<savePrmoSmplPointArr.length; i++){
                if(i == 0){
                    savePrmoSmplPointSw     = savePrmoSmplPointArr[i][0];   //slitmCd
                    savePrmoSmplPointArrCo[savePrmoSmplPointCnt]  = new Array();
                }

                if(savePrmoSmplPointSw == savePrmoSmplPointArr[i][0]){
                    savePrmoSmplPointArrCo[savePrmoSmplPointCnt][0]  = savePrmoSmplPointArr[i][0];
                    if(isNaN(savePrmoSmplPointArrCo[savePrmoSmplPointCnt][1]))
                        savePrmoSmplPointArrCo[savePrmoSmplPointCnt][1]  = savePrmoSmplPointArr[i][1];
                    else
                        savePrmoSmplPointArrCo[savePrmoSmplPointCnt][1]  += savePrmoSmplPointArr[i][1];
                    if(isNaN(savePrmoSmplPointArrCo[savePrmoSmplPointCnt][2]))
                        savePrmoSmplPointArrCo[savePrmoSmplPointCnt][2]  = savePrmoSmplPointArr[i][2];
                    else
                        savePrmoSmplPointArrCo[savePrmoSmplPointCnt][2]  += savePrmoSmplPointArr[i][2];
                    savePrmoSmplPointArrCo[savePrmoSmplPointCnt][3]  = savePrmoSmplPointArr[i][3];

                }else{
                    savePrmoSmplPointCnt    ++;
                    savePrmoSmplPointSw     = savePrmoSmplPointArr[i][0];   //slitmCd
                    savePrmoSmplPointArrCo[savePrmoSmplPointCnt]  = new Array();
                    savePrmoSmplPointArrCo[savePrmoSmplPointCnt][0]  = savePrmoSmplPointArr[i][0];
                    savePrmoSmplPointArrCo[savePrmoSmplPointCnt][1]  = savePrmoSmplPointArr[i][1];
                    savePrmoSmplPointArrCo[savePrmoSmplPointCnt][2]  = savePrmoSmplPointArr[i][2];
                    savePrmoSmplPointArrCo[savePrmoSmplPointCnt][3]  = savePrmoSmplPointArr[i][3];
                }
            }
            /*console.log("savePrmoSmplPointArrCo.length : "+savePrmoSmplPointArrCo.length);
    for(var i=0; i<savePrmoSmplPointArrCo.length; i++){
        console.log("i = "+i+", savePrmoSmplPointArrCo[i][0] = "+savePrmoSmplPointArrCo[i][0]+", savePrmoSmplPointArrCo[i][1] = "+savePrmoSmplPointArrCo[i][1]+
                ", savePrmoSmplPointArrCo[i][2] = "+savePrmoSmplPointArrCo[i][2]+", savePrmoSmplPointArrCo[i][3] = "+savePrmoSmplPointArrCo[i][3]);
    }*/
            // promono Grouping
            savePrmoSmplPointCnt = 0;
            var prcYn = false;
            var tCnt    = 0;
            var rCnt    = 0;
            for (var i=0; i<savePrmoSmplPointArrCo.length; i++) {
                for(var j = 0; j < savePrmoSmplPointArrDp.length; j++) {

                    if(savePrmoSmplPointArrCo[i][3] == savePrmoSmplPointArrDp[j]) {
                        prcYn = true;
                        break;
                    }
                }
                //console.log("prcYn = "+prcYn+",rCnt = "+rCnt);
                if(!prcYn) {
                    savePrmoSmplPointArrPo[rCnt] = new Array();
                    for(var j = 0; j < savePrmoSmplPointArrCo.length; j++) {
                        //console.log("savePrmoSmplPointArrCo[i][3] = "+savePrmoSmplPointArrCo[i][3]+",savePrmoSmplPointArrCo[j][3] = "+savePrmoSmplPointArrCo[j][3]);
                        if(savePrmoSmplPointArrCo[i][3] == savePrmoSmplPointArrCo[j][3]) {
                            savePrmoSmplPointArrPo[rCnt][0] = savePrmoSmplPointArrCo[j][0];
                            if(isNaN(savePrmoSmplPointArrPo[rCnt][1]))
                                savePrmoSmplPointArrPo[rCnt][1]  = Number(savePrmoSmplPointArrCo[j][1]);
                            else
                                savePrmoSmplPointArrPo[rCnt][1]  += Number(savePrmoSmplPointArrCo[j][1]);
                            if(isNaN(savePrmoSmplPointArrPo[rCnt][2]))
                                savePrmoSmplPointArrPo[rCnt][2]  = Number(savePrmoSmplPointArrCo[j][2]);
                            else
                                savePrmoSmplPointArrPo[rCnt][2]  += Number(savePrmoSmplPointArrCo[j][2]);
                            savePrmoSmplPointArrPo[rCnt][3] = savePrmoSmplPointArrCo[j][3];
                        }
                    }
                    rCnt ++;
                    savePrmoSmplPointArrDp[tCnt]        = savePrmoSmplPointArrCo[i][3];
                    tCnt ++;

                }

            }

            //console.log("결제수단 hmallpay적립 프로모션 데이터확인=============================================================");
            var totSavePrmoSmplPointAmt = 0;
            for (var i=0; i<savePrmoSmplPointArrPo.length; i++) {
                totSavePrmoSmplPointAmt += savePrmoSmplPointArrPo[i][1];
            }
            //console.log("총금액 : " + totSavePrmoSmplPointAmt);
            //console.log("총배송 : " + tmpTotDlvCost);
            //console.log("총사용 : " + totUseAmt);
            //console.log("총할인 : " + totDcAmt);
            totSavePrmoSmplPointAmt -= totDcAmt;
            //console.log("총금액 - 총할인 : " + totSavePrmoSmplPointAmt);
            for (var i=0; i<savePrmoSmplPointArrPo.length; i++) {
                var wSavePrmoSmplPoint = 0;

                var slitmCd = savePrmoSmplPointArrPo[i][0];
                var stlmAmt = Number(savePrmoSmplPointArrPo[i][1]);
                //console.log(slitmCd + "상품의 판매가 : " + stlmAmt);
                var dcAmt   = Number(savePrmoSmplPointArrPo[i][2]);
                //console.log(slitmCd + "상품의 할인액 : " + dcAmt);
                var prmoNo  = savePrmoSmplPointArrPo[i][3];
                //console.log(slitmCd + "상품의 대상프로모션 : " + prmoNo);

                var lastPrc = stlmAmt - dcAmt;
                //console.log(slitmCd + "상품의 최종가 : " + lastPrc);

                var totDlvDiv = tmpTotDlvCost * lastPrc / totSavePrmoSmplPointAmt;
                //console.log(slitmCd + "상품의 배송비분 : " + totDlvDiv);

                var useAmtDiv = totUseAmt * lastPrc / totSavePrmoSmplPointAmt;
                //console.log(slitmCd + "상품의 사용비분 : " + useAmtDiv);

                stlmAmt += totDlvDiv; //배송비 분배한것을 판매가에 더함
                dcAmt   += useAmtDiv; //사용 포인트 비용 분배한것을 할인액에 더함

                //console.log(slitmCd + "상품의 계산된 최종가 : " + (stlmAmt - dcAmt));

                wSavePrmoSmplPoint += fnGetPrmoSmplPoint(slitmCd, stlmAmt, dcAmt, prmoNo); //hmallpay간편결제 + 프로모션 + 적립
                //console.log(savePrmoSmplPointArrPo[i][0] + "상품의 최종 H.Point 예상  : " + wSavePrmoSmplPoint);

                savePrmoSmplPoint += wSavePrmoSmplPoint;
            }
            //console.log("총H.Point : " + savePrmoSmplPoint);
            //console.log("결제수단 hmallpay적립 프로모션 데이터확인 끝=============================================================");

            ////////////

            //HPoint마케팅개선 kjh 20190214 통멤 비회원인 경우 가격적립금과 프로모션적립금만 적용
            // 적립예상 통합포인트 화면
            if($("#totUPointArea").length > 0 ){
                if (Number(savePrmoHPoint + saveItemUPoint + savePrmoSmplPoint) > 0) {
                    $("#totUPointArea").show();
                } else {
                    $("#totUPointArea").hide();
                }

                $("#totUPointTxt").html(gfn_appendComma(Number(savePrmoHPoint + saveItemUPoint + savePrmoSmplPoint)) + "P"); //ft014_간편결제프로모션+HmallPay+적립 시 금액 추가
            }else if($("#totUPointArea_upoint_nonmember").length > 0 ){
                if (Number(savePrmoHPoint) > 0) {
                    $("#totUPointArea_upoint_nonmember").show();
                } else {
                    $("#totUPointArea_upoint_nonmember").hide();
                }
                $("#totUPointTxt").html(gfn_appendComma(Number(savePrmoHPoint)) + "P");
            }
            //HPoint마케팅개선 kjh 20190218 프로모션적립금을 H.Point 로 전환 끝

            $("#lastStlmAmtTxt").html(gfn_appendComma(Number(totStlmAmt))+"원");  // 최종결제금액

            var itemType = "GENERAL";
            if(itemType == "GENERAL"){

                if(Number(totStlmAmt) > 0){
                    $("#orderBtn").text(gfn_appendComma(Number(totStlmAmt))+"원 결제하기");  // 최종결제금액
                }else{
                    $("#orderBtn").text("결제하기");
                }
            }
            if(totDcAmt > 0) {
                var dcPercent = Math.round(totDcAmt / (orderAmt + addDlvAmt) * 100);
                $("#lastStlmDcTxt i").text(dcPercent+"%");

                /*2017.09.13 최연태 모바일 주문표 할인 % 추가*/
                $("#totDcPer").text("약 "+dcPercent+"%");
                $("#totDcPer").show();
                //$("#acdLastStlmDcTxt").html(dcPercent+"%할인 / <i>"+gfn_appendComma(Number(savePrmoHPoint + saveItemHPoint)) + "원 적립 </i><strong> △ </strong>");
            } else {
                $("#lastStlmDcTxt i").text("0%");

                /*2017.09.13 최연태 모바일 주문표 할인 % 추가*/
                $("#totDcPer").text("0%");
                $("#totDcPer").hide();
                //$("#acdLastStlmDcTxt").html("0%할인 / <i>"+gfn_appendComma(Number(savePrmoHPoint + saveItemHPoint))+"원 적립 </i> <strong> △ </strong>");
            }

            // 현금영수증 금액 계산
            calculateCashRcptAmt();

            // 결제수단이 고정이면 신용카드 선택 못하게 한다
            if(isPayCopnPayTypeSet) {
                if(getPayCopnFixGbcd($("input[name=paymentCopnInf]").val().split("|")[9]) == "10") {
                    $("select[name=stlmCrdInf]").prop("disabled", true);
                }
            }

            // 결제수단 화면
            if (totStlmAmt > 0) {
                $("#wibkBankCd").show();
                $(".payment-area").show();
                $("#receiptSelect").hide();
                //$("#stlmWaySaveYnArea").show();
                $("form[name='orderDataForm'] input[name='stlmWaySaveYn']").val("Y");

                if(isPayCopnPayTypeSet) {
                    var stlmFixGbcd = $("input[name=paymentCopnInf]").val().split("|")[9];
                    //카드즉시할인KJH 결제수단고정- 신용카드일때 이미 신용카드가 선택되면 후로직 타지 않도록 수정
                    if(!(vPayType == '1' && getPayCopnFixGbcd(stlmFixGbcd) == "10")){
                        clearPayTypeArea();
                        setPayCopnPayType(stlmFixGbcd);
                    }
                }
            } else {
                if(isPayCopnPayTypeSet) {
                    var msgCopnNm = $.trim($("#selPaymentCopn option:selected").text());
                    alert(msgCopnNm + " 할인이 적용 된 경우 적립금 등 보조결제수단 전액결제를 사용 하실수 없습니다.");
                    selectPaymentCopn($("#selPaymentCopn")[0]);
                } else {
                    /* $("#stlmWaySaveYn").prop("checked", false);
            $("#stlmWaySaveYnArea").hide(); */
                    $("form[name='orderDataForm'] input[name='stlmWaySaveYn']").val("N");
                    if(useDeposit > 0) {
                        $(".payment-wrap a.on").removeClass("on");
                        $(".paymentArea ul.simple_pay li.selected").removeClass("selected");

                        $(".payment-wrap a.type-bankacc").addClass("on");
                        //$(".paymentArea li.select_bank").addClass("selected");
                        $("#selectBank").show();
                        $(".payment_select.boxtype").hide();
                        $(".payment-option-area").show();

                        $(".payment-area").hide();
                        $("#wibkBankCd").hide();
                        $("#receiptSelect").show();
                    } else {
                        $(".payment-area").hide();
                        clearPayTypeArea();
                    }
                }
            }

            freeDlvCopnDiv(); // ft014 무료배송비쿠폰 할인금액은 별도표기

            discountChoice();

            copnChoice();
            
            //2021.05.11 KJH 
            calculateCashRcptAmt(); //현금영수증           
        }


        /**
         * ARS 할인 2016
         */
        function chkTotArsDcAmt(obj) {

            if(obj.checked) {
                $("#totArsDcAmtArea").text("-" + gfn_appendComma($("#totArsDcAmtArea").next("input[name=totArsDcAmt]").val()) + "원");
            }
            else {
                $("#totArsDcAmtArea").text("0원");
            }

            var kind = $("input[name='discountType1']:checked").attr("kind");
            if(kind != "1" && kind != "2") {
                // 결제수단 선택 영역 초기화
                clearPayTypeArea();
            }

            clearSubPayTypeArea();
            calculateOrderAmt();
            restoreLastPayType();
            discountChoice();
        }


        /**
         * 일시불할인 2016
         */
        function chkTotSpymDcAmt(obj) {

            // 일시불할인 적용시 상품권 사용 불가능
            if(obj.checked) {
                $("input[name='useGcAmt']").val("").prop("disabled", true);
                $("#chk18").prop("disabled", true).prop("checked", false);
                $("#ch08").prop("disabled", true);
                $("#ch08 option:eq(0)").prop("selected", true);
                /* 2016 모바일이주형 text에 세팅하면 히든인풋이 없어져버려서 체크해제할때 오류발생하여 영역밖으로 옮김 */
                $("#totSpymDcAmtArea").text("-" + gfn_appendComma($("input[name=totSpymDcAmt]").val()) + "원");
            } else {
                decisionSubPayAreaIsEnable("useGc");
                /* 2016 모바일이주형 일시불할인 체크해제할때 0원으로 텍스트 초기화함 */
                $("#totSpymDcAmtArea").text("0원");
            }

            var kind = $("input[name='discountType1']:checked").attr("kind");
            if(kind != "1" && kind != "2") {
                // 결제수단 선택 영역 초기화
                clearPayTypeArea();
            }

            clearSubPayTypeArea();
            calculateOrderAmt();
            restoreLastPayType();
            discountChoice();
        }

        /**
         * 깜짝할인 2016
         */
        function chkTotPrmoDcAmt(obj) {

            if(obj.checked) {

                var tcDcType = isEmpty($("input[name='discountType1']:checked").attr("tcDcType")) ? "03" : $("input[name='discountType1']:checked").attr("tcDcType");
                if(tcDcType == "04"){
                    if(hasHsPrchMdaYn == "Y" || hasDtvItmYn == "Y") {  // 바로사용 쿠폰사용시 임직원 할인 사용 불가
                        alertMsg("방송상품은 홈쇼핑 임직원 할인 시 깜짝할인 중복적용이 불가합니다.");
                        $("#discount2").attr("checked", false);
                        return;
                    }
                }

                $("#totPrmoDcAmtArea").text("-" + gfn_appendComma($("#totPrmoDcAmtArea").next("input[name=totPrmoDcAmt]").val()) + "원");

            }
            else {
                $("#totPrmoDcAmtArea").text("0원");
            }

            var kind = $("input[name='discountType1']:checked").attr("kind");
            if(kind != "1" && kind != "2") {
                // 결제수단 선택 영역 초기화
                clearPayTypeArea();
            }

            clearSubPayTypeArea();
            calculateOrderAmt();
            restoreLastPayType();
            discountChoice();
        }


        /**
         * 적립금 즉시할인 2016
         * - 적립금 사용 불가능 처리
         * - 적립예정 포인트 0원 처리
         */
        function imdtUseHpoint() {
            //HPoint마케팅개선 kjh 20190220 H.Point 선할인 적용
            if(!isEmpty($("#sale:checked").val())) {
                $("input[name='useUPoint']").val(0).prop("disabled", true);
                $("#chk21").prop("checked", false).prop("disabled", true);
                $("input[name='useUPoint']").val("0원");
            } else {
                decisionSubPayAreaIsEnable("useUPoint");
                $("input[name='useUPoint']").val(0).prop("disabled", false);
            }
            /*    if(!isEmpty($("#sale:checked").val())) {
        $("input[name='useHPoint']").val(0).prop("disabled", true);
        $("#chk20").prop("checked", false).prop("disabled", true);
        $("input[name='useHPoint']").val("0원");
    } else {
        decisionSubPayAreaIsEnable("useHPoint");
         2016 모바일이주형 포인트즉시할인 취소하면 포인트 사용 입력이 원복이 안되서 추가함
        $("input[name='useHPoint']").val(0).prop("disabled", false);
    }
*/
            var kind = $("input[name='discountType1']:checked").attr("kind");
            if(kind != "1" && kind != "2") {
                // 결제수단 선택 영역 초기화
                clearPayTypeArea();
            }

            clearSubPayTypeArea();
            calculateOrderAmt();
            restoreLastPayType();

            discountChoice();
        }


        /**
         * 현금영수증 금액계산 2016
         * (예치금, 지류상품권, 무통장)
         */
        function calculateCashRcptAmt() {
            var payType = $(".payment-wrap a.on").find("input[name=pay]").val();
            var stlmCdpstAmt = ufnToNum($("input[name='useDeposit']").val());     // 예치금
            var stlmPaperGcAmt = ufnToNum($("input[name='useGcAmt']").val());     // 지류상품권
            var stlmOnlnGcAmt = ufnToNum($("span[name='useCultureCashAmt']").text());     // 온라인 상품권
            var stlmWpointAmt = $("input[name='wpntCashRcptYn']").val() == "Y" ? (isEmpty(ufnToNum($("input[name='useWPoint']").val())) ? 0 : ufnToNum($("input[name='useWPoint']").val())) : 0;     // W포인트

            var stlmWibkAmt = 0;    // 무통장
            if(payType == "4" || payType == "hpay") {
                stlmWibkAmt = ufnToNum($("input[name='totStlmAmt']").val());
            }

            stlmPaperGcAmt = (stlmPaperGcAmt == "NaN") ? 0 : stlmPaperGcAmt; /* 2016 모바일이주형 버그수정 */

            var cashRcptAmt = Number(stlmCdpstAmt) + Number(stlmPaperGcAmt) + Number(stlmWibkAmt) + Number(stlmWpointAmt) + Number(stlmOnlnGcAmt);
            $("#cashRcptAmtSpan").text(gfn_appendComma(cashRcptAmt) + "원");
            $("form[name='orderDataForm'] input[name='cashRcptSendAmt']").val(cashRcptAmt);

            var cashReceiptExceptYn = "N";           

            if (cashRcptAmt > 0 && cashReceiptExceptYn != "Y") {
                $("#receiptSelect").show();
            } else {
                $("#receiptSelect").hide();

                $("input[name='receiptYn']:eq(0)").prop("checked", false);    // 현금영수증 초기화
                $("input[name='receiptYn']:eq(1)").prop("checked", true);    // 현금영수증 초기화
                receiptInit();
            }
        }


        /**
         * 무이자 할부개월수 2016
         */
        function getWintInsmMths(stlmCrdAmt) {

            var totalSellPrc = 0;
            var existMdSetWintInsmMthsYn = "N"; // MD 임의 조정 상품 존재여부

            var slitmCount = $("#slitmInfDiv span").length;

            $("#slitmInfDiv span").each(function() {
                var mdSetWintInsmMthsYn = $(this).data("mdSetWintInsmMthsYn");
                if(mdSetWintInsmMthsYn == 'Y') {
                    existMdSetWintInsmMthsYn = "Y";
                }

                var sellPrc = Number($(this).data("sellPrc"));
                var ordQty = Number($(this).data("ordQty"));
                totalSellPrc += sellPrc * ordQty;
            });

            var lastWintInsmMths = -1;
            //if(existMdSetWintInsmMthsYn == 'Y') {
            //  lastWintInsmMths = 99;
            //}

            $("#slitmInfDiv span").each(function() {
                var mdSetWintInsmMthsYn = $(this).data("mdSetWintInsmMthsYn");
                var wintInsmMths = isEmpty($(this).data("wintInsmMths")) ? 0 : Number($(this).data("wintInsmMths"));
                var prmoInsmPossMths = isEmpty($(this).data("prmoInsmPossMths")) ? 0 : Number($(this).data("prmoInsmPossMths"));

                /*
        if(existMdSetWintInsmMthsYn == 'Y') { // MD임의 조정상품이 있으면 MD임의조정상품중 제일 높은 무이자할부개월수
            if(mdSetWintInsmMthsYn == "Y" && Number(wintInsmMths) < Number(lastWintInsmMths)) {
                lastWintInsmMths = wintInsmMths;
            }
        } else { // MD임의 조정상품이 없으면 제일 높은 무이자할부개월수
            if(slitmCount == 1 && Number(prmoInsmPossMths) > Number(lastWintInsmMths)) {
                lastWintInsmMths = prmoInsmPossMths;
            }

            if(Number(wintInsmMths) > Number(lastWintInsmMths)) {
                lastWintInsmMths = wintInsmMths;
            }
        }
        */

                //할부 개월수는 가장 낮은 것을 적용으로 변경 (2018.11.26)
                if(lastWintInsmMths == -1 || Number(wintInsmMths) < Number(lastWintInsmMths)) {
                    lastWintInsmMths = wintInsmMths;
                }
            });

            if(Number(lastWintInsmMths) == 99) {
                lastWintInsmMths = 0;
            }

            if(stlmCrdAmt == null) {
                stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            /*
    if(existMdSetWintInsmMthsYn == "N") {   // MD 임의 조정이 없을시 금액기준 할부개월수
        for(var i = 0; i < crdInsmMthsInfList.length; i++) {
            if(stlmCrdAmt >= crdInsmMthsInfList[i].aplyStrtAmt && stlmCrdAmt <= crdInsmMthsInfList[i].aplyEndAmt) {
                if(Number(crdInsmMthsInfList[i].crdMths) > Number(lastWintInsmMths)) {
                    lastWintInsmMths = Number(crdInsmMthsInfList[i].crdMths);
                }
                break;
            }
        }
    }
    */

            return lastWintInsmMths;
        }



        /**
         *
         */
        function reloadCardAfterDmnd(crdCd, cmCrdcCd, stlmCrdAmt) {
            //카드즉시할인KJH 주문금액 재계산
            calculateOrderAmt();
            //카드즉시할인KJH 즉시할인 프로모션 적용시 후청구할인 적용안함
            if(!isEmpty($("input[name='crdImdtDcPrmoNo']").val())){
                //$("#stlmAlliDcAmtDl").hide();
                $("input[name=dmndDcPrmoNo]").val("");
                return;
            }
            var prmoCnt = 0;
            var dmnd = null;

            if(stlmCrdAmt == null) {
                stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            //하나, 외환카드 청구할인 통합
            if(cmCrdcCd == "03"){
                cmCrdcCd = "12";
            }

            var dmndDcPrmoNo = "";
            var dmndFinal = null;
            $("#slitmInfDiv span").each(function(index, element) {

                var dmndMap = $(this).data("crdAftDmndPrmoMap");
                if(dmndMap != null && dmndMap['crdcCd' + cmCrdcCd] != null) {
                    dmnd = dmndMap['crdcCd' + cmCrdcCd];

                    var isTarget = true;
                    if(cmCrdcCd == "02"){
                        if(dmnd.crdStlmWayGbcd == "024"){//카카오카드(crdCd:16)
                            if(crdCd != "16"){
                                isTarget = false;
                            }
                        }else{
                            if(crdCd == "16"){
                                isTarget = false;
                            }
                        }
                    }

//            if(index != 0 || (dmnd.mblAppAplyYn == 'Y' && appYn != 'Y')){
//              if(!$("#popup11").hasClass("selected")){
//                  cardAfterDmndtLayerBtn.click();
//              }
//              return;
//            }
                    if(isTarget){
                        if(dmndDcPrmoNo == "" || dmndDcPrmoNo > dmnd.prmoNo){
                            dmndDcPrmoNo = dmnd.prmoNo;
                            dmndFinal = dmnd;
                        }
                        prmoCnt++;
                    }

                }
            });

            dmnd = dmndFinal;

            $("#stlmAlliDcAmtDl").hide();
            $("input[name=dmndDcPrmoNo]").val("");

            if(prmoCnt > 0 && $("#slitmInfDiv span").length != prmoCnt) {
                $("#stlmAlliDcAmtDl").hide();
                $("input[name=dmndDcPrmoNo]").val("");
                $("input[name=dmndDcProTotItemTrgtYn]").val("");
                cardAfterDmndtLayerBtn.click();
                return;
            } else if($("#slitmInfDiv span").length == prmoCnt) {
                if(dmnd != null) {
                    for(var i = 0; i < dmnd.condList.length; i++) {
                        var cond = dmnd.condList[i];
                        if(stlmCrdAmt >= cond.strtVal && stlmCrdAmt <= cond.endVal) {
                            var dmndDcAmt = cond.famtFxrtVal;
                            if(cond.famtFxrtGbcd == '1') {
                                dmndDcAmt = Math.floor(stlmCrdAmt * cond.famtFxrtVal / 1000) * 10;
                            }

                            if(!isEmpty(dmnd.bndsAmt) && dmnd.bndsAmt != 0 && dmndDcAmt > dmnd.bndsAmt) {
                                dmndDcAmt = dmnd.bndsAmt;
                            }

                            if(cond.famtFxrtGbcd == '1' && dmnd.bndsAmt != dmndDcAmt) {
                                $("#stlmAlliDcAmtDl span").html(dmnd.crdcNm + " <strong>" + cond.famtFxrtVal + "%</strong> 할인으로 <strong>"+gfn_appendComma(stlmCrdAmt - dmndDcAmt)+"</strong> 청구예정");
                            } else if(cond.famtFxrtGbcd == '2' && stlmCrdAmt > cond.famtFxrtVal) {
                                $("#stlmAlliDcAmtDl span").html(dmnd.crdcNm + " <strong>" + gfn_appendComma(cond.famtFxrtVal) + "원<strong> 할인으로 <strong>"+gfn_appendComma(stlmCrdAmt - dmndDcAmt)+"</strong> 청구예정");
                            } else {
                                $("#stlmAlliDcAmtDl span").html(dmnd.crdcNm + " <strong>"+gfn_appendComma(stlmCrdAmt - dmndDcAmt)+"</strong> 청구예정");
                            }
                            //$("#stlmAlliDcAmtDl").show();

                            $("input[name=dmndDcPrmoNo]").val(dmnd.prmoNo);
                            $("input[name=dmndDcProTotItemTrgtYn]").val(dmnd.totItemTrgtYn);
                            break;
                        }
                    }
                }
            }
        }


        /*
 * 신용카드 청구할인 정보 노출 jgh 2016
 */
        function cardPromInf() {
            //카드즉시할인KJH 즉시할인정보 노출
            cardImdtDcPromInf();

            var dmndArr = new Array();
            var stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());

            var dmndDcPrmoNoArr = new Array();
            var prmoCrdcCdArr = new Array();

            $("#slitmInfDiv span").each(function(index, element) {
                var dmndMap = $(this).data("crdAftDmndPrmoMap");
                var crdcCdList = $(this).data("crdcCdList");

                if(index == 0 && dmndMap != null && crdcCdList != null){
                    for(var i = 0; i < crdcCdList.length; i++){

                        var crdcCd = crdcCdList[i].cd;
//              if(crdcCd == '03'){
//                  crdcCd = '12';
//              }

                        if(dmndMap['crdcCd' + crdcCd] != null){
                            var isTarget = true;
                            for(var j = 0; j < prmoCrdcCdArr.length; j++){
                                if(prmoCrdcCdArr[j] == crdcCd){
                                    isTarget = false;
                                    break;
                                }
                            }
                            if(isTarget){
                                prmoCrdcCdArr.push(crdcCd);
                            }
                        }
                    }
                }
                if(dmndMap != null) {
                    for(var i = 0; i < prmoCrdcCdArr.length; i++){
                        if(index == 0){
                            if(dmndMap['crdcCd' + prmoCrdcCdArr[i]] != null){
                                dmndDcPrmoNoArr.push(dmndMap['crdcCd' + prmoCrdcCdArr[i]]);
                            }
                        }
                        else if (dmndMap['crdcCd' + prmoCrdcCdArr[i]] != null){
                            for(var j = 0; j < dmndDcPrmoNoArr.length; j++){
                                if(dmndDcPrmoNoArr[j].crdcCd == prmoCrdcCdArr[i]){
                                    var flag = true;
                                    for(var k = 0; k < dmndArr.length; k++){
                                        if(dmndArr[k].crdcCd == prmoCrdcCdArr[i]){
                                            flag = false;
                                            break;
                                        }
                                    }
                                    if(flag){
                                        dmndArr.push(dmndMap['crdcCd' + prmoCrdcCdArr[i]]);
                                    }
                                }
                            }
                        }
                    }
                }
                if(index != 0) {
                    dmndDcPrmoNoArr = dmndArr.slice(0);
                }
            });

            if($("#slitmInfDiv span").length == 1) {
                dmndArr = dmndDcPrmoNoArr.slice(0);
            }


            if(isEmpty(dmndArr)) {
                $("#pay1 .cardPromInfSpan,#pay1CrdAftDmndPrmo .cardPromInfSpan").remove();
                $("#pay1 .marginT10,#pay1CrdAftDmndPrmo .marginT10").remove();
                $(".paymentArea .select_simple .cardPromInfSpan").remove();
                return;
            } else {
                $("#pay1 .cardPromInfSpan,#pay1CrdAftDmndPrmo .cardPromInfSpan").remove();
                $("#pay1 .marginT10,#pay1CrdAftDmndPrmo .marginT10").remove();
                $(".paymentArea .select_simple .cardPromInfSpan").remove();

                var vhtml = "";
                var cardPromNm = "";
                var cardPromNotInf = "";
                var isPromo = false;
                var cardEventYn = 'N';

                if(cardEventYn != 'Y'){
                    for(var j = 0; j < dmndArr.length; j++){
                        if(dmndArr[j] != null) {
                            for(var i = 0; i < dmndArr[j].condList.length; i++) {
                                var cond = dmndArr[j].condList[i];
                                if(stlmCrdAmt >= cond.strtVal && stlmCrdAmt <= cond.endVal) {
                                    isPromo = true;
                                    var dmndDcAmt = cond.famtFxrtVal;
                                    if(cond.famtFxrtGbcd == '1') {
                                        dmndDcAmt = Math.floor(stlmCrdAmt * cond.famtFxrtVal / 1000) * 10;
                                    }

                                    if(!isEmpty(dmndArr[j].bndsAmt) && dmndArr[j].bndsAmt != 0 && dmndDcAmt > dmndArr[j].bndsAmt) {
                                        dmndDcAmt = dmndArr[j].bndsAmt;
                                    }

                                    var $a = '<span class="payment-notice"><a class="ico-notice btn-slpopup" data-sub-lpopup="popup-notice-card-discount" href="javascript:;"><span class="txt-notice txt-orange">체크카드 청구할인 제외</span></a></span>';
                                    if(cond.famtFxrtGbcd == '1' && dmndArr[j].bndsAmt != dmndDcAmt) {
                                        $("#pay1,#pay1CrdAftDmndPrmo").append("<span class='cardPromInfSpan payment-notice'><strong>" + dmndArr[j].crdcNm + "</strong> 결제시 <strong>" + cond.famtFxrtVal + "%</strong> 청구할인 예상금액 <strong>" + gfn_appendComma(stlmCrdAmt - dmndDcAmt) + "원</strong></span>");
                                        vhtml += "<span class='paynowSub cardPromInfSpan payment-notice'><strong>" + dmndArr[j].crdcNm + "</strong> 결제시 <strong>" + cond.famtFxrtVal + "%</strong> 청구할인 예상금액 <strong>" + gfn_appendComma(stlmCrdAmt - dmndDcAmt) + "원</strong></span>";
                                        if((dmndArr[j].crdcNm).indexOf("현대") > -1 || (dmndArr[j].crdcNm).indexOf("삼성") > -1 || (dmndArr[j].crdcNm).indexOf("롯데") > -1 || (dmndArr[j].crdcNm).indexOf("씨티") > -1) {
                                            cardPromNm = (dmndArr[j].crdcNm).replace("카드", "");
                                            cardPromNotInf = "<sub class='marginT10 crdcd" + crdNmToCd(cardPromNm) + "' style='display: none;'>" + $a + "<span class='_cyantxt'>" + cardPromNm + " 체크카드는 청구할인 제외</span></sub>";
                                            if(!isEmpty(crdNmToCd(cardPromNm))) {
                                                vhtml += "<span class='paynowSub cardPromInfSpan payment-notice'>" + $a + "<span class='_cyantxt'>" + cardPromNm + " 체크카드는 청구할인 제외</span></span>";
                                            }
                                            $("#pay1,#pay1CrdAftDmndPrmo").append(cardPromNotInf);
                                        }
                                    } else if(cond.famtFxrtGbcd == '2' && stlmCrdAmt > cond.famtFxrtVal) {
                                        $("#pay1,#pay1CrdAftDmndPrmo").append("<span class='cardPromInfSpan payment-notice'><strong>" + dmndArr[j].crdcNm + "</strong> 결제시 <strong>" + gfn_appendComma(cond.famtFxrtVal) + "원</strong> 할인 <strong>" + gfn_appendComma(stlmCrdAmt - dmndDcAmt) + "원</strong></span>");
                                        vhtml += "<span class='paynowSub cardPromInfSpan payment-notice'><strong>" + dmndArr[j].crdcNm + "</strong> 결제시 <strong>" + gfn_appendComma(cond.famtFxrtVal) + "원</strong> 할인 <strong>" + gfn_appendComma(stlmCrdAmt - dmndDcAmt) + "원</strong></span>";
                                        if((dmndArr[j].crdcNm).indexOf("현대") > -1 || (dmndArr[j].crdcNm).indexOf("삼성") > -1 || (dmndArr[j].crdcNm).indexOf("롯데") > -1 || (dmndArr[j].crdcNm).indexOf("씨티") > -1) {
                                            cardPromNm = (dmndArr[j].crdcNm).replace("카드", "");
                                            cardPromNotInf = "<sub class='marginT10 crdcd" + crdNmToCd(cardPromNm) + "' style='display: none;'>" + $a + "<span class='_cyantxt'>" + cardPromNm + " 체크카드는 청구할인 제외</span></sub>";
                                            if(!isEmpty(crdNmToCd(cardPromNm))) {
                                                vhtml += "<span class='paynowSub cardPromInfSpan payment-notice'>" + $a + "<span class='_cyantxt'>" + cardPromNm + " 체크카드는 청구할인 제외</span></span>";
                                            }
                                            $("#pay1,#pay1CrdAftDmndPrmo").append(cardPromNotInf);
                                        }
                                    } else {
                                        $("#pay1,#pay1CrdAftDmndPrmo").append("<span class='cardPromInfSpan payment-notice'><strong>" + dmndArr[j].crdcNm + "</strong> 결제시 <strong>" + cond.famtFxrtVal + "%</strong> 청구할인 예상금액 <strong>" + gfn_appendComma(stlmCrdAmt - dmndDcAmt) + "원</strong></span>");
                                        vhtml += "<span class='paynowSub cardPromInfSpan payment-notice'><strong>" + dmndArr[j].crdcNm + "</strong> 결제시 <strong>" + cond.famtFxrtVal + "%</strong> 청구할인 예상금액 <strong>" + gfn_appendComma(stlmCrdAmt - dmndDcAmt) + "원</strong></span>";
                                        if((dmndArr[j].crdcNm).indexOf("현대") > -1 || (dmndArr[j].crdcNm).indexOf("삼성") > -1 || (dmndArr[j].crdcNm).indexOf("롯데") > -1 || (dmndArr[j].crdcNm).indexOf("씨티") > -1) {
                                            cardPromNm = (dmndArr[j].crdcNm).replace("카드", "");
                                            cardPromNotInf = "<sub class='marginT10 crdcd" + crdNmToCd(cardPromNm) + "' style='display: none;'>" + $a + "<span class='_cyantxt'>" + cardPromNm + " 체크카드는 청구할인 제외</span></sub>";
                                            if(!isEmpty(crdNmToCd(cardPromNm))) {
                                                vhtml += "<span class='paynowSub cardPromInfSpan payment-notice'>" + $a + "<span class='_cyantxt'>" + cardPromNm + " 체크카드는 청구할인 제외</span></span>";
                                            }
                                            $("#pay1,#pay1CrdAftDmndPrmo").append(cardPromNotInf);
                                        }
                                    }
                                    break;
                                }
                            }
                        }
                    }
                    //$(".paymentArea .select_simple").prepend(vhtml + "<br class='cardPromInfSpan'>");
                    if(isPromo == true) {
                        $("#pay1,#pay1CrdAftDmndPrmo").append("<div class='cardPromInfSpan sub-area'><span>표시되는 청구할인 예상금액은 1인당 일 최대 청구할인 한도에 따라 달라질 수 있습니다. (이벤트안내 참고)</span></div>");
                    }
                    if(vhtml != ""){
                        vhtml += "<div class='paynowSub cardPromInfSpan sub-area'><span>표시되는 청구할인 예상금액은 1인당 일 최대 청구할인 한도에 따라 달라질 수 있습니다. (이벤트안내 참고)</span></div>";
                    }
                    $(".paymentArea .select_simple").append(vhtml);
                    //$("#pay1").append("<p class='marginT10'>※ 일부 체크카드 청구할인 제외<br>&nbsp;&nbsp;&nbsp;&nbsp;(현대/삼성/롯데/씨티/NH)</p>");
                }
            }
        }

        /*
 * 카드즉시할인 유효 프로모션 목록 생성
 * 카드즉시할인KJH
 */
        function fn_getCrdImdtDcPrmoList(){
            var tmpTotDlvCost = isEmpty($("input[name='totDlvCost']").val()) ? 0 : Number($("input[name='totDlvCost']").val()); // 배송비 제외
            var stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val()) - tmpTotDlvCost;

            // 1. 프로모션 목록 전체 리스트 생성 - 결제 가능 카드만
            // 2. 프로모션 별 카운트가 span 길이와 같은 프로모션 목록 생성
            // 3. 2. 프로모션 목록의 카드코드로 아래 로직 진행
            var allCrdImdtDcPrmoNoArr = new Array();
            //프로모션 목록 전체 리스트 생성
            $("#slitmInfDiv span").each(function(index, element) {
                var prmoNoArr = $(this).data("crdImdtDcPrmoMap");
                var crdcCdList = $(this).data("crdcCdList");
                if( prmoNoArr != null )
                {
                    for(var i = 0; i < prmoNoArr.length; i++){
                        for(var j = 0; j < crdcCdList.length; j++){
                            //결제 가능 카드만
                            if( prmoNoArr[i].crdcCd == crdcCdList[j].cd){
                                allCrdImdtDcPrmoNoArr.push(prmoNoArr[i]);
                                break;
                            }
                        }
                    }
                }
            });
            //프로모션이 장바구니 전체에 적용되어있는지 체크
            var crdImdtDcPrmoNoArr = new Array();
            for(var i = 0; i < allCrdImdtDcPrmoNoArr.length; i++){
                var prmoNo = allCrdImdtDcPrmoNoArr[i].prmoNo;
                var prmoCnt = 0;
                for(var j = 0; j < allCrdImdtDcPrmoNoArr.length; j++){
                    if( prmoNo == allCrdImdtDcPrmoNoArr[j].prmoNo){
                        prmoCnt++;
                    }
                }

                if(prmoCnt > 0 && $("#slitmInfDiv span").length == prmoCnt){
                    var bChk = false;
                    for(var j = 0; j < crdImdtDcPrmoNoArr.length; j++){
                        //기적용여부 체크
                        if( prmoNo == crdImdtDcPrmoNoArr[j].prmoNo){
                            bChk = true;
                        }
                    }
                    if( !bChk ){
                        //장바구니 전체 적용된 프로모션 목록 생성
                        crdImdtDcPrmoNoArr.push(allCrdImdtDcPrmoNoArr[i]);
                    }
                }
            }
            //동일 카드에 대한 프로모션 존재 시 구간에 가장 낮은 요율
            var delPrmoNoArr = new Array();
            for(var j = 0; j < crdImdtDcPrmoNoArr.length; j++){
                for(var k = 0; k < crdImdtDcPrmoNoArr.length; k++){
                    //동일 카드에 대한 프로모션 존재
                    if(crdImdtDcPrmoNoArr[j].prmoNo != crdImdtDcPrmoNoArr[k].prmoNo
                        && crdImdtDcPrmoNoArr[j].crdcCd == crdImdtDcPrmoNoArr[k].crdcCd){

                        var crdImdtDcAmt1 = 0; //j 프로모션 할인금액
                        for(var i = 0; i < crdImdtDcPrmoNoArr[j].condList.length; i++) {
                            var cond = crdImdtDcPrmoNoArr[j].condList[i];

                            if(stlmCrdAmt >= cond.strtVal && stlmCrdAmt <= cond.endVal) {
                                crdImdtDcAmt1 = cond.famtFxrtVal;
                                if(cond.famtFxrtGbcd == '1') {
                                    crdImdtDcAmt1 = Math.floor(stlmCrdAmt * cond.famtFxrtVal / 100);
                                }
                                if(!isEmpty(crdImdtDcPrmoNoArr[j].bndsAmt) && crdImdtDcPrmoNoArr[j].bndsAmt != 0 && crdImdtDcAmt1 > crdImdtDcPrmoNoArr[j].bndsAmt) {
                                    crdImdtDcAmt1 = crdImdtDcPrmoNoArr[j].bndsAmt;
                                }
                                break;
                            }
                        }
                        var crdImdtDcAmt2 = 0; //k 프로모션 할인금액
                        for(var i = 0; i < crdImdtDcPrmoNoArr[k].condList.length; i++) {
                            var cond = crdImdtDcPrmoNoArr[k].condList[i];

                            if(stlmCrdAmt >= cond.strtVal && stlmCrdAmt <= cond.endVal) {
                                crdImdtDcAmt2 = cond.famtFxrtVal;
                                if(cond.famtFxrtGbcd == '1') {
                                    crdImdtDcAmt2 = Math.floor(stlmCrdAmt * cond.famtFxrtVal / 100);
                                }
                                if(!isEmpty(crdImdtDcPrmoNoArr[k].bndsAmt) && crdImdtDcPrmoNoArr[k].bndsAmt != 0 && crdImdtDcAmt2 > crdImdtDcPrmoNoArr[k].bndsAmt) {
                                    crdImdtDcAmt2 = crdImdtDcPrmoNoArr[k].bndsAmt;
                                }
                                break;
                            }
                        }
                        //첫번째 대상의 할인금액이 더 크면 해당 프로모션 번호 삭제
                        //console.log('stlmCrdAmt=' + stlmCrdAmt + ' crdImdtDcAmt1=' + crdImdtDcAmt1 + ' crdImdtDcAmt2=' + crdImdtDcAmt2 );
                        var delPrmoNo = "";
                        if(crdImdtDcAmt1 > crdImdtDcAmt2){
                            delPrmoNo = crdImdtDcPrmoNoArr[j].prmoNo;
                        }else{
                            delPrmoNo = crdImdtDcPrmoNoArr[k].prmoNo;
                        }
                        delPrmoNoArr[delPrmoNo] = [];
                        delPrmoNoArr[delPrmoNo].push(delPrmoNo);
                    }
                }
            }
            //console.log("삭제 prmo");
            //console.log(delPrmoNoArr);
            //삭제 대상
            for(var j = crdImdtDcPrmoNoArr.length-1; j >= 0; j--){
                if( crdImdtDcPrmoNoArr[j].prmoNo in delPrmoNoArr ){
                    crdImdtDcPrmoNoArr.splice(j, 1);
                }
            }

            return crdImdtDcPrmoNoArr;
        }
        /*
 * 신용카드 즉시할인 정보 노출
 *  카드즉시할인KJH
 */
        function cardImdtDcPromInf() {
            var tmpTotDlvCost = isEmpty($("input[name='totDlvCost']").val()) ? 0 : Number($("input[name='totDlvCost']").val());
            var addDlvAmt = isEmpty($("input[name='addDlvAmt']").val()) ? 0 : Number($("input[name='addDlvAmt']").val());
            var stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            var crdImdtDcPrmoAmt = Number($("form[name='orderDataForm'] input[name='crdImdtDcPrmoAmt']").val());//카드즉시할인금액

            // 배송비 제외 + 카드즉시할인금액이 이미 계산된 경우 포함해서 계산
            var crdImdtCalcStlmAmt = stlmCrdAmt - tmpTotDlvCost - addDlvAmt + crdImdtDcPrmoAmt;

            var crdImdtDcPrmoNoArr = fn_getCrdImdtDcPrmoList();
            $("div[name='pay1CardPrmo']").empty();

            //전체 적용 프로모션이 없으면 안내영역 숨김
            if(isEmpty(crdImdtDcPrmoNoArr)) {
                $("form[name='orderDataForm'] input[name='smileCrdExceptYn']").val("Y"); //제외여부체크
                $(".smileCrdArea").hide();
            	return;
            } else {
                var appendText = '';
                for(var j = 0; j < crdImdtDcPrmoNoArr.length; j++){
                    for(var i = 0; i < crdImdtDcPrmoNoArr[j].condList.length; i++) {
                        var cond = crdImdtDcPrmoNoArr[j].condList[i];
                        if(crdImdtDcPrmoNoArr[j].crdcCd =='21' && cond.strtVal > crdImdtCalcStlmAmt ){
                            $("form[name='orderDataForm'] input[name='smileCrdPointYn']").val("N");
                            $("form[name='orderDataForm'] input[name='smileCrdExceptYn']").val("Y"); //제외여부체크
                            $(".smileCrdArea").hide();
                            $("#smileCrdpoint1").prop("checked", false);
                            $("#smileCrdpoint2").prop("checked", false);
                       } 
                        if(crdImdtCalcStlmAmt >= cond.strtVal && crdImdtCalcStlmAmt <= cond.endVal) {
                            var crdImdtDcAmt = cond.famtFxrtVal;
                            if(cond.famtFxrtGbcd == '1') {
                                crdImdtDcAmt = Math.floor(crdImdtCalcStlmAmt * cond.famtFxrtVal / 100);
                            }

                            if(!isEmpty(crdImdtDcPrmoNoArr[j].bndsAmt) && crdImdtDcPrmoNoArr[j].bndsAmt != 0 && crdImdtDcAmt > crdImdtDcPrmoNoArr[j].bndsAmt) {
                                crdImdtDcAmt = crdImdtDcPrmoNoArr[j].bndsAmt;
                            }
                            if( crdImdtDcAmt> 0 ){
                                //정율 한도초과 아닐때
                                if(cond.famtFxrtGbcd == '1' && crdImdtDcPrmoNoArr[j].bndsAmt != crdImdtDcAmt) {
                                    appendText += "<span class='payment-notice'><strong>" + crdImdtDcPrmoNoArr[j].crdcNm + "</strong> 결제 후 <strong>" + cond.famtFxrtVal + "%</strong> 즉시할인 받으시면 <strong>" + gfn_appendComma(crdImdtCalcStlmAmt + tmpTotDlvCost + addDlvAmt - crdImdtDcAmt) + "원</strong> 입니다.</span>";
                                    //정액 + ( 카드결제금액 > 할인액 )
                                } else if(cond.famtFxrtGbcd == '2' && crdImdtCalcStlmAmt > cond.famtFxrtVal) {
                                    appendText += "<span class='payment-notice'><strong>" + crdImdtDcPrmoNoArr[j].crdcNm + "</strong> 결제 후 <strong>" + gfn_appendComma(crdImdtDcAmt) + "원</strong> 즉시할인 받으시면 <strong>" + gfn_appendComma(crdImdtCalcStlmAmt + tmpTotDlvCost + addDlvAmt - crdImdtDcAmt) + "원</strong> 입니다.</span>";
                                } else {
                                    //정율  && 한도초과
                                    appendText += "<span class='payment-notice'><strong>" + crdImdtDcPrmoNoArr[j].crdcNm + "</strong> 결제 후 <strong> " + cond.famtFxrtVal + "%</strong> 즉시할인 받으시면 <strong>" + gfn_appendComma(crdImdtCalcStlmAmt + tmpTotDlvCost + addDlvAmt - crdImdtDcAmt) + "원</strong> 입니다.</span>";
                                }
                                if(crdImdtDcPrmoNoArr[j].crdcCd =='21'){
                                    //$(".smileCrdArea").show();
                                    $("form[name='orderDataForm'] input[name='smileCrdExceptYn']").val("N"); //제외여부체크
                                }
                            }

                            break;
                        }
                    }
                }
                if(appendText != ''){
                    appendText += "<div class='sub-area'>표시되는 즉시할인 예상금액은 1인당 일 최대 즉시할인 한도에 따라 달라질 수 있습니다. (이벤트안내 참고)</div>";
                    $("div[name='pay1CardPrmo']").append(appendText);
                }
            }
        }

        function crdNmToCd(Nm) {
            var result = "";

            if(Nm == "현대") {
                result = "04";
            } else if(Nm == "삼성") {
                result = "02";
            } else if(Nm == "롯데") {
                result = "08";
            } else if(Nm == "씨티") {
                result = "20";
            } else if(Nm == "NH") {
                result = "40";
            }

            return result;
        }

        function reloadStlmWayPrmo(cmCrdcCd, stlmCrdAmt) {
            var prmoCnt = 0;
            var dmnd = null;

            var totStlmAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());

            if(stlmCrdAmt == null) {
                stlmCrdAmt = totStlmAmt;
            }

            $("input[name=stlmDcPrmoNo]").val("");
            $("input[name=stlmDcAmt]").val("0");

            var dmndDcPrmoNo = "";
            if(cmCrdcCd == "4"){ //페이나우
                cmCrdcCd = "90";
            }

            $("#slitmInfDiv span").each(function(index, element) {
                var dmndMap = $(this).data("stlmWayPrmoMap");
                if(dmndMap != null && dmndMap['crdcCd' + cmCrdcCd] != null) {
                    dmnd = dmndMap['crdcCd' + cmCrdcCd];
                    if(dmnd != null && dmnd.prmoNo != dmndMap['crdcCd' + cmCrdcCd].prmoNo) {
                        $(this).val("");

                        //showPdmdcInfPup(dmnd.prmoNo);
                        return;
                    }

                    dmndDcPrmoNo = dmnd.prmoNo;
                    prmoCnt++;
                }
            });

            if(prmoCnt > 0 && $("#slitmInfDiv span").length != prmoCnt) {
                //showPdmdcInfPup(dmnd.prmoNo);
                return;
            } else if($("#slitmInfDiv span").length == prmoCnt) {
                if(dmnd != null) {

                    if($("input[name=stlmDcPrmoYn]").val() == 'N' ){
                        alert("단일 상품 1개 구매시에만 "+dmnd.crdcNm+" 할인이 적용됩니다.");
                        return;
                    }

                    for(var i = 0; i < dmnd.condList.length; i++) {
                        var cond = dmnd.condList[i];
                        if(stlmCrdAmt >= cond.strtVal && stlmCrdAmt <= cond.endVal) {
                            var dmndDcAmt = Number(cond.famtFxrtVal);
                            if(cond.famtFxrtGbcd == '1') {
                                dmndDcAmt = Math.floor(stlmCrdAmt * cond.famtFxrtVal / 1000) * 10;
                            }

                            if(!isEmpty(dmnd.bndsAmt) && dmnd.bndsAmt != 0 && dmndDcAmt > dmnd.bndsAmt) {
                                dmndDcAmt = dmnd.bndsAmt;
                            }

                            $("input[name=stlmDcAmt]").val(dmndDcAmt);
                            $("input[name=stlmDcPrmoNo]").val(dmnd.prmoNo);

                            $("form[name='orderDataForm'] input[name='totStlmAmt']").val(totStlmAmt - dmndDcAmt);
                            $("#lastStlmAmtTxt").html(gfn_appendComma(Number(totStlmAmt - dmndDcAmt)));  // 최종결제금액

                            var itemType = "GENERAL";
                            if(itemType == "GENERAL"){

                                if(Number(totStlmAmt - dmndDcAmt) > 0){
                                    $("#orderBtn").text(gfn_appendComma(Number(totStlmAmt - dmndDcAmt))+"원 결제하기");  // 최종결제금액
                                }else{
                                    $("#orderBtn").text("결제하기");
                                }
                            }

                            var realStlmAmt= $("form[name='orderDataForm'] input[name='realStlmAmt']").val();
                            $("form[name='orderDataForm'] input[name='realStlmAmt']").val(realStlmAmt - dmndDcAmt);

                            var totDcAmt = Number($("input[name='totDcAmtCalc']").val());
                            $("input[name='totDcAmtCalc']").val(totDcAmt + dmndDcAmt);
                            //할인금액
                            $("#totDcTxt").html("(-)" + gfn_appendComma(Number(totDcAmt + dmndDcAmt)) + "원");

                            break;
                        }
                    }
                }
            }
        }


        function payNowCardAfterDmnd() {

            var stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            var allCrdDmndDcPrmoStr = "";


            $("select[name='stlmCrdInf'] option").each(function() {

                var cmCrdcCd = $(this).val().split('|')[3];
                var dmnd = null;
                var prmoCnt = 0;
                var dmndDcPrmoNo = "";
                $("#slitmInfDiv span").each(function(index, element) {

                    var dmndMap = $(this).data("crdAftDmndPrmoMap");
                    if(dmndMap != null && dmndMap['crdcCd' + cmCrdcCd] != null) {
                        dmnd = dmndMap['crdcCd' + cmCrdcCd];
                        if(dmnd != null && dmnd.prmoNo != dmndDcPrmoNo) {
                            if (index != 0) {
                                return;
                            }
                        }
                        dmndDcPrmoNo = dmnd.prmoNo;
                        prmoCnt++;
                    }
                });


                if(prmoCnt > 0 && $("#slitmInfDiv span").length != prmoCnt) {

                } else if($("#slitmInfDiv span").length == prmoCnt) {
                    if(dmnd != null) {
                        for(var i = 0; i < dmnd.condList.length; i++) {
                            var cond = dmnd.condList[i];
                            if(stlmCrdAmt >= cond.strtVal && stlmCrdAmt <= cond.endVal) {
                                var dmndDcAmt = cond.famtFxrtVal;
                                if(cond.famtFxrtGbcd == '1') {
                                    dmndDcAmt = Math.floor(stlmCrdAmt * cond.famtFxrtVal / 1000) * 10;
                                }

                                if(!isEmpty(dmnd.bndsAmt) && dmnd.bndsAmt != 0 && dmndDcAmt > dmnd.bndsAmt) {
                                    dmndDcAmt = dmnd.bndsAmt;
                                }

                                if (allCrdDmndDcPrmoStr != "")
                                    allCrdDmndDcPrmoStr += "@";
                                allCrdDmndDcPrmoStr += cmCrdcCd + "$" + dmnd.prmoNo + "$" + dmnd.totItemTrgtYn;
                                break;
                            }
                        }
                    }
                }
            });
            return allCrdDmndDcPrmoStr;
        }


        /**
         * 추가배송비 조회 2016
         */
        function getAddDlvcAmtByDlvcoArea(postNo, multiIndex) {
            var addDlvcAmt = null;
            if(!isEmpty(postNo)) {
                $.ajax({
                    type: "post"
                    , url: "/m/getAddDlvcAmtByDlvcoArea.do"
                    , dataType: "json"
                    , data : {postNo : postNo}
                    , success : function(data) {
                        if(!isEmpty(data.addDlvcAmt) && Number(data.addDlvcAmt) > 0) {

                            addDlvcAmt = data.addDlvcAmt;

                            // 추가배송비 있는 상품은 멀티배송 불가 처리
                            if (multiIndex != undefined && multiIndex != 0) {
                                alert("추가배송비가 존재하는 상품은 멀티배송 하실수 없습니다.");
                                return "noMulti";
                            }
                            else {
                                $(".addDlvCostArea").show();
                                $("#totAddDlvCostTxt").html("+" + gfn_appendComma(data.addDlvcAmt) + "원");
                                $("input[name='addDlvAmt']").val(Number(data.addDlvcAmt));
                                calculateOrderAmt();
                                cardImdtDcPromInf();
                            }

                            // 현금영수증
                            calculateCashRcptAmt();
                        }
                    }
                    , error: function(data) {
                    }
                });
            }

            if (isEmpty(addDlvcAmt) || Number(addDlvcAmt) == 0) {
                $(".addDlvCostArea").hide();
                $("#totAddDlvCostTxt").html("");
                $("input[name='addDlvAmt']").val(0);
                calculateOrderAmt();
                cardImdtDcPromInf();

                // 현금영수증
                calculateCashRcptAmt();
            }
        }
        
        
        /**
         * 도서지역 구분 조회
         * 2020.07.17  추가배송비 선결제 
         * @param postNo
         */
        var glAddDlvAmt = 0;
        var glIrgnAreaGbcd = "";
        function getIrgnAreaGbcd(postNo, multiIndex) {
            glIrgnAreaGbcd = "";
            var addDlvCostTxt = "";
            var addDlvCostNum = 0;
            
            if(!isEmpty(postNo) || postNo != "") {
                $.ajax({
                    type: "post"
                    , url: "/m/selectIrgnAreaGbcd.do"
                    , dataType: "json"
                    , data : {postNo : postNo}
                    , success : function(data) {
                        //alert("data.irgnAreaGbcd >> "+data.irgnAreaGbcd);
                        if(!isEmpty(data.irgnAreaGbcd)) { 
                            
                            glIrgnAreaGbcd = data.irgnAreaGbcd;
                            
                            if($("#multi_false input[name='irgnAreaGbcd']").val() == ""){
                                $("#multi_false input[name='irgnAreaGbcd']").val(glIrgnAreaGbcd);
                            }
                            if(multiIndex != null &&  multiIndex != 0){
                                $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=irgnAreaGbcd]").val(glIrgnAreaGbcd); // 2020.08.11 추가배송비 선결제 추가
                                
                            }else if(multiIndex == 0){
                                $("#multiaddress_depth2_a1").find("input[name=irgnAreaGbcd]").val(glIrgnAreaGbcd); // 2020.08.11 추가배송비 선결제 추가                  
                            }
                           
                        }else{
                            $("#multi_false input[name='irgnAreaGbcd']").val("XX");
                            if(multiIndex != null &&  multiIndex != 0){
                                $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=irgnAreaGbcd]").val("XX"); // 2020.08.11 추가배송비 선결제 추가
                                
                            }else if(multiIndex == 0){
                                $("#multiaddress_depth2_a1").find("input[name=irgnAreaGbcd]").val("XX"); // 2020.08.11 추가배송비 선결제 추가                  
                            }
                        }
                        calculateAddDlvAmt();    
                            
                    }
                    , error: function(data) {
                        // 추가배송비 영역 초기화
                        calculateAddDlvAmt(); 
                    }
                });
            } else {
                // 추가배송비 영역 초기화
                calculateAddDlvAmt(); 
            }
        }

        /**
         * 여러곳으로 배송지 삭제시 추가 배송비 계산
         * @param 
         */
        function calculateAddDlvAmt(){
            // 여러곳으로 배송지 삭제시 추가 배송비 재계산
            var totalAddDvlCost = 0;   
            var multiDlvYn = (isEmpty($("#multi").prop("checked")) || $("#multi").prop("checked") == false) ? "N" : "Y"; 
            //console.log("multiDlvYn>>> "+multiDlvYn);
            if (multiDlvYn == "Y") { // 여러곳으로 배송일경우    
                $(".shipping-step-2 .addr-list li").each(function(addrIdx) {                    
                    var irgnAreaGbcd = $(this).find("input[name=irgnAreaGbcd]").val();
                    //console.log("irgnAreaGbcd =  >>>" +irgnAreaGbcd);
                    $("#depth3_content_" + (addrIdx+1)).each(function(itmIdx) {                       
                        $(this).find("li[name='itemboxList']").each(function(index) { 
                            var areaDlvCostAddYn = $(this).find("input[name='itemAreaDlvCostAddYn']").val();
                            var jejuAddDlvCost   = Number($(this).find("input[name='itemJejuAddDlvCost']").val());
                            var irgnAddDlvCost   = Number($(this).find("input[name='itemIrgnAddDlvCost']").val());
                            var grpItemNum       = $(this).find("input[name='grpItemNum']").val();
                            var ordQty = Number($(this).find("select[name=ordQty]").val());
                            //console.log("areaDlvCostAddYn =w  >>>" +areaDlvCostAddYn);
                            //console.log("jejuAddDlvCost = w >>>" +jejuAddDlvCost);
                            //console.log("irgnAddDlvCost =w  >>>" +irgnAddDlvCost);
                            //console.log("grpItemNum =  >w>>" +grpItemNum);
                            //console.log("ordQty =  >w>>" +ordQty);                            
                            if(areaDlvCostAddYn == "Y" && ordQty > 0){
                                if(irgnAreaGbcd == "01"){ // 제주지역
                                    totalAddDvlCost = totalAddDvlCost + jejuAddDlvCost;  
                                }else if(irgnAreaGbcd == "02"){ // 도서지역
                                    totalAddDvlCost = totalAddDvlCost + irgnAddDlvCost;  
                                }
                            }
                        });
                        
                    });
                    
                });
                //alert("totalAddDvlCost >>>>>"+totalAddDvlCost);
                if(totalAddDvlCost > 0){
                    $(".addDlvCostArea").show();
                    $("#totAddDlvCostTxt").html("<strong>(+)" + gfn_appendComma(totalAddDvlCost) + "원</strong>");
                    $("input[name='addDlvAmt']").val(totalAddDvlCost);
                }else{
                    $(".addDlvCostArea").hide();
                    $("#totAddDlvCostTxt").html("<strong>(+)0원</strong>");
                    $("input[name='addDlvAmt']").val("0");
                }
            }else{
                //console.log(">>>>>>>>>>>>>>>>>>>>>>>>>>");      
                // 단일배송지 묶음배송일 경우 max 추가배송비
                var tmpJejuAddDlvCost = 0;
                var tmpIrgnAddDlvCost = 0;
                var tempGrpItemNum    = "";
                $("ul.order2020_item").each(function() {
                    //console.log("glIrgnAreaGbcd =  >>>" +glIrgnAreaGbcd);                   
                    
                    $(this).find("li[name='itemInfoLi']").each(function(index) {   
                        console.log("index =  >>>" +index);
                        var slitmCd          = $(this).find("input[name='slitmCd']").val();
                        var areaDlvCostAddYn = $(this).find("input[name='itemAreaDlvCostAddYn']").val();
                        var jejuAddDlvCost   = Number($(this).find("input[name='itemJejuAddDlvCost']").val());
                        var irgnAddDlvCost   = Number($(this).find("input[name='itemIrgnAddDlvCost']").val());
                        var grpItemNum       = $(this).find("input[name='grpItemNum']").val();                        
                        //console.log("areaDlvCostAddYn =  >>>" +areaDlvCostAddYn);
                        //console.log("jejuAddDlvCost =  >>>" +jejuAddDlvCost);
                        //console.log("irgnAddDlvCost =  >>>" +irgnAddDlvCost);
                        //console.log("grpItemNum =  >>>" +grpItemNum);
                        var calcSkipYn = "N";
                        if(areaDlvCostAddYn == "Y"){
                            if(tempGrpItemNum != grpItemNum){                               
                                tempGrpItemNum    = grpItemNum;             
                                tmpJejuAddDlvCost = jejuAddDlvCost;
                                tmpIrgnAddDlvCost = irgnAddDlvCost;
                                //console.log("1tmpJejuAddDlvCost =  >>>" +tmpJejuAddDlvCost);
                                //console.log("1tmpIrgnAddDlvCost =  >>>" +tmpIrgnAddDlvCost);
                            }else{              
                                //console.log("2tmpJejuAddDlvCost =  >>>" +tmpJejuAddDlvCost);
                                //console.log("2tmpIrgnAddDlvCost =  >>>" +tmpIrgnAddDlvCost);
                                
                                if(glIrgnAreaGbcd == "01"){ // 제주지역
                                    if(tmpJejuAddDlvCost < jejuAddDlvCost){                 
                                        totalAddDvlCost = totalAddDvlCost - tmpJejuAddDlvCost;
                                        tmpJejuAddDlvCost = jejuAddDlvCost;
                                    }else{
                                        calcSkipYn = "Y";
                                    }   
                                }else if(glIrgnAreaGbcd == "02"){ // 도서지역
                                    if(tmpIrgnAddDlvCost < irgnAddDlvCost){
                                        totalAddDvlCost = totalAddDvlCost - tmpIrgnAddDlvCost;
                                        tmpIrgnAddDlvCost = irgnAddDlvCost;
                                    }else{
                                        calcSkipYn = "Y";
                                    }
                                }else{ // 추가배송비가 없는경우 
                                    totalAddDvlCost = 0;
                                }
                            }
                            //console.log("3tmpJejuAddDlvCost =  >>>" +tmpJejuAddDlvCost);
                            //console.log("3tmpIrgnAddDlvCost =  >>>" +tmpIrgnAddDlvCost);
                            if(calcSkipYn == "N"){
                                if(glIrgnAreaGbcd == "01"){ // 제주지역
                                    totalAddDvlCost = totalAddDvlCost + tmpJejuAddDlvCost;
                                }else if(glIrgnAreaGbcd == "02"){ // 도서지역
                                    totalAddDvlCost = totalAddDvlCost + tmpIrgnAddDlvCost;
                                }else{ // 추가배송비가 없는경우 
                                    totalAddDvlCost = 0;
                                }
                            }
                            
                            //console.log("3totalAddDvlCost =  >>>" +totalAddDvlCost);
                        }
                        
                    }); 
                }); 
                
                var freeDlvCopnChkCnt = 0;
                // 도서지역 추가배송비가 있을경우 무료배송 쿠폰 사용불가 2020.08.31
                $("div[name='cuponSearch'] input[name='freeDlvCopnInf']").each(function() {
                    if(!isEmpty($(this).val())) {
                        freeDlvCopnChkCnt++;
                    }
                });
             
                if(freeDlvCopnChkCnt > 0 && totalAddDvlCost > 0){
                    //alert("제주/도서지역 배송 주문은 무료배송 쿠폰을 사용할 수 없습니다.");  
                    $("div[name='cuponSearch'] input[name^='freeDlvCopn']").each(function() {
                    
                        if($(this).hasClass("noneCopn")){
                            $(this).prop("checked", true);
                            selectDlvCopn($(this).parents("div[name='cuponSearch']"));
                        }
                    });
                }
                
                if(totalAddDvlCost > 0){
                    //alert("totalAddDvlCost >>>>>"+totalAddDvlCost);
                    $("div.addDlvCostArea").show();
                    $("#totAddDlvCostTxt").html("<strong>(+)" + gfn_appendComma(totalAddDvlCost) + "원</strong>");
                    $("input[name='addDlvAmt']").val(totalAddDvlCost);
                }else{
                    $(".addDlvCostArea").hide();
                    $("#totAddDlvCostTxt").html("<strong>(+)0원</strong>");
                    $("input[name='addDlvAmt']").val("0");
                }
            }
            calculateOrderAmt();
            cardImdtDcPromInf();

        }

        function selectNoneCopnBtn(obj){
            $(obj).parents("div[name='cuponSearch']").find(".noneCopn").prop("checked", true);
            
            var $obj = $(obj).parents("div[name='cuponSearch']");
            selectCopn($obj);
        }
        
        function selectCopnBtn(obj){
        	if ( $(obj).parents("div[name='cuponSearch']").find("input[type=radio]:checked").val().split("|")[0] == "" ) {
        		alert("쿠폰이 선택되지 않았습니다.");
        		return;
        	}
        	
            var $obj = $(obj).parents("div[name='cuponSearch']");
            selectCopn($obj);
            backStateLayerPopup();
        }

        /**
         * 쿠폰선택 2016
         */
        function selectCopn(obj, calculate_yn) {

            var $obj = $(obj);

            var cpnType = $(obj).find("input[name='copnTypeCd']").val();
            var selectValues = $obj.find("input[name^='"+cpnType+"_']:checked").val().split("|");

            var copnNo = selectValues[0];
            var slitmCd = selectValues[1];
            var uitmCd = selectValues[2];
            var aspItemCd = selectValues[3];
            var copnTypeGbcd = selectValues[4];
            var famtFxrtGbcd = selectValues[5];
            var famtFxrtVal = selectValues[6];
            var itemIdx = selectValues[7];
            var copnPblcNo = selectValues[8];
            var maxDcPossAmt = selectValues[9];
            var copnGb = selectValues[10];
            var prchMdaGbcd = selectValues[12];
            var dtvItemYn = selectValues[13];

            var selectedAlliCrd = isEmpty($("input[name='discountType1']:checked").val()) ? "N" : "Y";

            var cardEventYn = 'N';

            if(isEmpty(copnNo)) {
                //$obj.prev("input[name='copnInf']").val("");
                $obj.find("input[name='copnInf']").val("");

                // 일반쿠폰 취소할 경우 플러스쿠폰 존재하는 경우 초기화 시킴
                if($obj.hasClass("gnrlCopn")) {
                    $(".coupon-detail-select_plusCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+itemIdx).find("input[name='copnInf']").val("");
                    $("input[name=plusCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+itemIdx+"][value='|"+slitmCd+"|"+uitmCd+"|"+aspItemCd+"||||"+itemIdx+"|||2']").prop("checked","true");
                }

                // 결제수단 선택 영역 초기화
                if(cardEventYn != "Y"){
                    clearSubPayTypeArea();
                    clearPayTypeArea();
                }

                decisionSubPayAreaIsEnable("useGc");
				
                if(calculate_yn != "N"){
                	calculateOrderAmt();
                }
            } else {
                var kind = selectedAlliCrd == "Y" ? $("input[name='discountType1']:checked").attr("kind") : -1;

                if(copnTypeGbcd == "02") {  // 플러스쿠폰 (일반쿠폰 선택 후 선택 가능, 한주문에 한개만 사용 가능)
                    if(kind == '3') {
                        var tcCd = $("input[name='discountType1']:checked").val();
                        if(tcCd != '0000000704' && tcCd != '0000000172' && tcCd != '0000000559' && tcCd != '0000000171') {
                            if(tcCd == '0000002991'){
                                alertMsg("임직원 할인 시 플러스쿠폰/무적쿠폰/무료배송쿠폰 사용이 불가능합니다.");
                            }else{
                                alertMsg("제휴 할인 시\n플러스 쿠폰/무적쿠폰/무료배송 쿠폰 사용이 불가능합니다.");
                            }
                            $obj.find("input[name^='"+cpnType+"'].noneCopn").prop("checked","true");
                            return;
                        }
                    }

                    if(isEmpty($(".coupon-detail-select_gnrlCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+itemIdx).find("input[name='copnInf']").val())) {
                        alertMsg("플러스쿠폰은 일반쿠폰과 같이 사용하셔야합니다.");
                        $obj.find("input[name^='"+cpnType+"'].noneCopn").prop("checked","true");
                        return;
                    }
                }

                var tcDcType = isEmpty($("input[name='discountType1']:checked").attr("tcDcType")) ? "03" : $("input[name='discountType1']:checked").attr("tcDcType");
                if(tcDcType == "04") {
                    if((prchMdaGbcd == "20" || dtvItemYn == "Y") && (copnTypeGbcd == "01" || copnTypeGbcd == "03" || copnTypeGbcd == "04" || copnTypeGbcd == "05")) {  // 바로사용 쿠폰사용시 임직원 할인 사용 불가
                        alertMsg("방송상품은 홈쇼핑 임직원할인시 바로사용 쿠폰 사용이 불가합니다.");
                        $obj.find("input[name^='"+cpnType+"'].noneCopn").prop("checked","true");
                        return;
                    }
                    for(var i = 0; i < afcoDcVenCopnList.length; i++){
                        if(afcoDcVenCopnList[i] == copnNo){
                        	alertMsg("방송상품은 홈쇼핑 임직원할인시 일반 결제할인쿠폰에 한하여 중복 적용이 가능합니다.(VIP쿠폰 불가)");
                            $obj.find("input[name^='"+cpnType+"'].noneCopn").prop("checked","true");
                            return;
                        }
                    }
                }

                if(copnTypeGbcd == "07") {  // 무적할인
                    if(kind == '3') {
                        var tcCd = $("input[name='discountType1']:checked").val();
                        if(tcCd != '0000000704' && tcCd != '0000000172' && tcCd != '0000000559' && tcCd != '0000000171') {
                            if(tcCd == '0000002991'){
                                alertMsg("임직원 할인 시 플러스쿠폰/무적쿠폰/무료배송쿠폰 사용이 불가능합니다.");
                            }else{
                                alertMsg("추가할인 시 플러스쿠폰/무적쿠폰/무료배송 쿠폰 사용이 불가능합니다.");
                            }
                            $obj.find("input[name^='"+cpnType+"'].noneCopn").prop("checked","true");
                            return;
                        }
                    }
                }

                if(copnTypeGbcd != "03" && copnTypeGbcd != "04" && copnTypeGbcd != "05") {
                    // 중복체크
                    var dupYn = false;
                    $("div[name='cuponSearch'] input[name='copnInf']").each(function() {
                        var copnSlitmCd = $(this).siblings("input[name='copnSlitmCd']").val();
                        var copnUitmCd = $(this).siblings("input[name='copnUitmCd']").val();
                        var copnInfIdx = $(this).siblings("input[name='copnItemIdx']").val();
                        if(!dupYn && !isEmpty($(this).val())) {
                            var copnInfArr = $(this).val().split("|");
                            if((slitmCd + uitmCd + itemIdx) != (copnSlitmCd + copnUitmCd + copnInfIdx)  && copnInfArr[0] == copnNo && copnInfArr[8] == copnPblcNo) {
                                dupYn = true;
                            }
                        }
                    });

                    if(dupYn) {
                        alertMsg("이미 사용중인 쿠폰입니다.");
                        $obj.find("input[name^='"+cpnType+"'].noneCopn").prop("checked","true");
                        // 이미 다른쿠폰을 선택하고 있는 경우에도 초기화
                        $obj.find("input[name='copnInf']").val("");

                        // 일반쿠폰 취소할 경우 플러스쿠폰 존재하는 경우 초기화 시킴
                        if($obj.hasClass("gnrlCopn")) {
                            $(".coupon-detail-select_plusCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+itemIdx).find("input[name='copnInf']").val("");
                            $("input[name=plusCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+itemIdx+"][value='|"+slitmCd+"|"+uitmCd+"|"+aspItemCd+"||||"+itemIdx+"|||2']").prop("checked","true");
                        }

                        // 결제수단 선택 영역 초기화
                        clearSubPayTypeArea();
                        clearPayTypeArea();

                        decisionSubPayAreaIsEnable("useGc");

                        calculateOrderAmt();
                        restoreLastPayType();
                        return;
                    }
                }


                $obj.find("input[name='copnInf']").val(copnNo + "|" + slitmCd + "|" + uitmCd + "|" + aspItemCd + "|" + famtFxrtGbcd + "|" + famtFxrtVal + "|" + copnGb + "|" + itemIdx + "|" + copnPblcNo + "|" + maxDcPossAmt + "|" + copnTypeGbcd + "|" + prchMdaGbcd + "|" + dtvItemYn);

                // 결제수단 선택 영역 초기화
                if(cardEventYn != "Y"){
                    //카드 이벤트 상품 결제수단 고정 요청
                    clearSubPayTypeArea();
                    clearPayTypeArea();
                }
                
                if(calculate_yn != "N"){
                	calculateOrderAmt();
                }
            }

            if(cardEventYn != "Y" && calculate_yn != "N"){
                restoreLastPayType();
            }
        }
        
        function selectNoneDlvCopnBtn(obj){
        	$(obj).parents("div[name='cuponSearch']").find(".noneCopn").prop("checked", true);
            selectDlvCopnBtn(obj);
        }

        function selectDlvCopnBtn(obj){
            var $obj = $(obj).parents("div[name='cuponSearch']");
            selectDlvCopn($obj);
        }

        /**
         * 무료배송 쿠폰선택
         * |||||||
         */
        function selectDlvCopn(obj) {

            var $obj = $(obj);
            var cpnType = $obj.find("input[name='copnTypeCd']").val();
            var itemIdx = $obj.find("input[name='itemIdx']").val();
            var selectValues = $obj.find("input[name^='"+cpnType+"_']:checked").val().split("|");

            var copnNo = selectValues[0];
            var slitmCd = selectValues[1];
            var uitmCd = selectValues[2];
            var aspItemCd = selectValues[3];
            var copnPblcNo = selectValues[4];
            var dcPrice = selectValues[5];
            var freeDlvVenCd = selectValues[6];
            var freeDlvOshpVenAdrSeq = selectValues[7];

            var totlAddDlvAmt = isEmpty($("input[name='addDlvAmt']").val()) ? 0 : Number($("input[name='addDlvAmt']").val());   
            if(Number(dcPrice) > 0 && totlAddDlvAmt > 0){
                alert("제주/도서지역 배송 주문은 무료배송 쿠폰을 사용할 수 없습니다.");
                return false;
            }
            
            if(isEmpty(copnNo)) {
                $obj.find("input[name='freeDlvCopnInf']").val("");
                $("#freeDlvCopnTxt_"+slitmCd+"_"+uitmCd+"_"+aspItemCd).html("0원");

                // 결제수단 선택 영역 초기화
                clearSubPayTypeArea();
                clearPayTypeArea();

                calculateOrderAmt();
                restoreLastPayType();

            } else {

                // TODO 직원할인(+현대패밀리)은 무료배송쿠폰과 중복사용 불가능 체크

                var selectedAlliCrd = isEmpty($("input[name='discountType1']:checked").val()) ? "N" : "Y";
                var kind = selectedAlliCrd == "Y" ? $("input[name='discountType1']:checked").attr("kind") : -1;
                if(kind == '3') {
                    var tcCd = $("input[name='discountType1']:checked").val();
                    if(tcCd != '0000000704' && tcCd != '0000000172' && tcCd != '0000000559' && tcCd != '0000000171') {
                        if(tcCd == '0000002991'){
                            alertMsg("임직원 할인 시 플러스쿠폰/무적쿠폰/무료배송쿠폰 사용이 불가능합니다.");
                        }else{
                            alertMsg("추가할인 시 플러스쿠폰/무적쿠폰/무료배송 쿠폰 사용이 불가능합니다.");
                        }
                        $obj.find("input[name^='"+cpnType+"'].noneCopn").prop("checked","true");

                        return;
                    }
                }

                $obj.find("input[name='freeDlvCopnInf']").val("");

                // 2019.10.08 HMALL개선이주형 무료배송비쿠폰을 상품마다 적용가능하게 처리
                // 동일쿠폰은 한번만 적용가능하게 중복사용 금지처리
                var freeDlvCopnCnt = 0;
                $("div[name='cuponSearch'] input[name='freeDlvCopnInf']").each(function() {
                    if($(this).val().indexOf(copnPblcNo) > -1) {
                        freeDlvCopnCnt += 1;
                    }
                });
                if (freeDlvCopnCnt >= 1) {
                    alertMsg("다른상품에 적용한 무료배송쿠폰 입니다.");
                    $obj.find("input[name^='"+cpnType+"'].noneCopn").prop("checked","true");
                    $("#freeDlvCopnTxt_"+slitmCd+"_"+uitmCd+"_"+aspItemCd).html("0원");
                    return;
                }

                $("#freeDlvCopnTxt_"+slitmCd+"_"+uitmCd+"_"+aspItemCd).html("-" + gfn_appendComma(Number(dcPrice)) + "원");
                $obj.find("input[name='freeDlvCopnInf']").val(copnNo + "|" + copnPblcNo + "|" + freeDlvVenCd + "|" + freeDlvOshpVenAdrSeq + "|" + dcPrice);

                // 결제수단 선택 영역 초기화
                clearSubPayTypeArea();
                clearPayTypeArea();

                calculateOrderAmt();
                restoreLastPayType();
            }
        }

        //ft014_추가
        function freeDlvCopnDiv() {
            var freeDlvCopnAmt = 0;
            $("div[name='cuponSearch'] input[name='freeDlvCopnInf']").each(function() {
                if (!isEmpty(this.value)) {
                    var freeDlvCopnInfArr = this.value.split("|");  // copnNo|copnPblcNo|freeDlvVenCd|freeDlvOshpVenAdrSeq|dcPrice
                    freeDlvCopnAmt += isEmpty(freeDlvCopnInfArr[4]) ? 0 : Number(freeDlvCopnInfArr[4]);
                }
            });

            if(Number(freeDlvCopnAmt) > 0){
                var totDcTxtVal = Number(($("#totDcTxt").html()).replace("(-)", "").replace("원", "").replace(",", ""));
                totDcTxtVal =  Number(totDcTxtVal) - Number(freeDlvCopnAmt);
                $("#totDcTxt").html((totDcTxtVal > 0 ? "(-)" : "") + gfn_appendComma(totDcTxtVal) + "원");

                $(".dcDlvCostArea").show();
                $("#dcDlvCostTxt").html("(-)" + gfn_appendComma(Number(freeDlvCopnAmt)) + "원");
            }
            else{
                $(".dcDlvCostArea").hide();
                $("#dcDlvCostTxt").html("0원");
            }
        }


        /**
         * 제휴카드(직원할인/제휴) 선택
         */

        var empDcOrderAmt = 0;

        //홈쇼핑 임직원 할인 한도 체크
        function checkLimitEmpDcAmt() {
            var limitEmpDcAmt = $("input[name='limitEmpDcAmt']").val()
            var tcDcType = isEmpty($("input[name='discountType1']:checked").attr("tcDcType")) ? "03" : $("input[name='discountType1']:checked").attr("tcDcType");
            if(tcDcType == "04" && empDcOrderAmt > limitEmpDcAmt){
                $("input[name='discountType1']").eq(0).prop("checked",true);
                selectAlliCrd();
                alertMsg("최종결제금액이 임직원할인 잔여 한도를 초과했습니다.");
                return;
            }
        }

        function selectAlliCrd() {

            var kind = $("input[name='discountType1']:checked").attr("kind");
            var alliCrdCd = $("input[name='discountType1']:checked").attr("crdCd");
            var tcDcType = isEmpty($("input[name='discountType1']:checked").attr("tcDcType")) ? "03" : $("input[name='discountType1']:checked").attr("tcDcType");


            if(tcDcType == "04"){
                $("div[name='cuponSearch'] input[name='copnInf']").each(function() {
                    var copnNo = $(this).val().split("|")[0];
                    var copnTypeGbcd = $(this).val().split("|")[10];
                    var prchMdaGbcd = $(this).val().split("|")[11];
                    var dtvItemYn = $(this).val().split("|")[12];

                    if(prchMdaGbcd == "20" || dtvItemYn == "Y") {
                        if(copnTypeGbcd == "03" || copnTypeGbcd == "04" || copnTypeGbcd == "05"){
                            $("input[name='discountType1']").eq(0).prop("checked",true);
                            selectAlliCrd();
                            alertMsg("홈쇼핑상품은 바로사용쿠폰 사용시 홈쇼핑임직원 할인을 받으실수 없습니다.");
                            return;
                        }
                        for(var i = 0; i < afcoDcVenCopnList.length; i++){
                            if(afcoDcVenCopnList[i] == copnNo){
                                $("input[name='discountType1']").eq(0).prop("checked",true);
                                selectAlliCrd();
                                alertMsg("방송상품은 홈쇼핑 임직원할인시 일반 결제할인쿠폰에 한하여 중복 적용이 가능합니다.(VIP쿠폰 불가)");
                                return;
                            }
                        }
                    }

                });

                if(hasHsPrchMdaYn == "Y" || hasDtvItmYn == "Y"){
                    var prmoDcYn = isEmpty($("#discount2:checked").val()) ? "N" : "Y";
                    if(prmoDcYn == "Y"){
                        $("input[name='discountType1']").eq(0).prop("checked",true);
                        selectAlliCrd();
                        alertMsg("방송상품은 홈쇼핑 임직원 할인 시 깜짝할인 중복적용이 불가합니다.");
                        return;
                    }

                    $("div[name='cuponSearch'] input[name='paymentCopnInf']").each(function() {
                        var copnNo = $(this).val().split("|")[0];
                        for(var i = 0; i < afcoDcVenCopnList.length; i++){
                            if(afcoDcVenCopnList[i] == copnNo){
                                $("input[name='discountType1']").eq(0).prop("checked",true);
                                selectAlliCrd();
                                alertMsg("방송상품은 홈쇼핑 임직원할인시 일반 결제할인쿠폰에 한하여 중복 적용이 가능합니다.(VIP쿠폰 불가)");
                                return;
                            }
                        }
                    });

                }

            }

            if(kind == "2" || (kind == "1" && alliCrdCd == "04")) {   // 직원할인(+현대패밀리)은 쿠폰과 중복사용 불가능
                if($("div[name='cuponSearch'] input[name='copnInf'][value!='']").length > 0 || $("div[name='cuponSearch'] input[name='paymentCopnInf'][value!='']").length > 0) {
                    alertMsg("쿠폰할인과 직원할인은\n동시에 이용하실 수 없습니다.");
                    $("div[name='cuponSearch'] input[name='copnInf']").val("")
                    $("div[name='cuponSearch'] input[name^='gnrlCopn_'].noneCopn").prop("checked",true);
                    $("div[name='cuponSearch'] input[name^='plusCopn_'].noneCopn").prop("checked",true);

                    var stlmFixYn = $("div[name='cuponSearch'] input[name='paymentCopnInf']").val();
                    if(stlmFixYn != null){
                        $("input[name='paymentCopnInf']").val("");
                        $("input[name='selPaymentCopn'].noneCopn").prop("checked",true);
                        selectPaymentCopn();
                        isPayCopnPayTypeSet = false;
                    }
                }
                $("button[name='gnrlCopnBtn']").prop("disabled", true);
                $("button[name='pluslCopnBtn']").prop("disabled", true);
                $("div[name='cuponSearch'] input[name^='gnrlCopn_']").prop("disabled", true);
                $("div[name='cuponSearch'] input[name^='plusCopn_']").prop("disabled", true);
            } else {
                $("button[name='gnrlCopnBtn']").prop("disabled", false);
                $("button[name='pluslCopnBtn']").prop("disabled", false);
                $("div[name='cuponSearch'] input[name^='gnrlCopn_']").prop("disabled", false);
                $("div[name='cuponSearch'] input[name^='plusCopn_']").prop("disabled", false);
            }

            if(kind == "1") {   // 제휴카드 (보조결제수단 사용 불가능 - 상품권, 적립금, 예치금)
                $("input[name='useGcAmt'], input[name='useDeposit'], input[name='useHPoint']").val("0원").prop("disabled", true);
                $("#chk18, #chkDeposit, #chk20").prop("checked", false).prop("disabled", true);
                $("#ch08").prop("disabled", true);
                $("#ch08 option:eq(0)").prop("selected", true);
            } else {
                decisionSubPayAreaIsEnable("useGc");
                decisionSubPayAreaIsEnable("useDeposit");
                decisionSubPayAreaIsEnable("useHPoint");
            }

            if(kind == "3") {   // 제휴
                var tcCd = $("input[name='discountType1']:checked").val();
                if(tcCd != '0000000704' && tcCd != '0000000172' && tcCd != '0000000559' && tcCd != '0000000171') {
                    // 임직원 추가, 즐겨찾기의 경우 예외 (모든 쿠폰 중복 가능)
                    // 무적다운로드, 플러스쿠폰, 무료배송쿠폰 불가
                    var plusCopnCnt = 0;
                    var unbeatableCopnCnt = 0;
                    $("div[name='cuponSearch'] input[name='copnInf']").each(function() {
                        var copnGb = $(this).val().split("|")[6];
                        var copnTypeGbcd = $(this).val().split("|")[10];

                        if(copnGb == "2") {
                            plusCopnCnt++;
                        }

                        if(copnTypeGbcd == "07") {
                            unbeatableCopnCnt++;
                        }
                    });

                    // 2019.10.08 HMALL개선이주형 무료배송비쿠폰 멀티사용처리
                    var freeDlvcopnCnt = 0;
                    $("div[name='cuponSearch'] input[name='freeDlvCopnInf']").each(function() {
                        if(!isEmpty($(this).val())) {
                            freeDlvcopnCnt++;
                        }
                    });
                    if(plusCopnCnt > 0 || unbeatableCopnCnt > 0 || freeDlvcopnCnt > 0) {
                        if(tcCd == '0000002991'){
                            alertMsg("임직원 할인 시 플러스쿠폰/무적쿠폰/무료배송쿠폰 사용이 불가능합니다.");
                        }else{
                            alertMsg("추가할인 시 플러스쿠폰/무적쿠폰/무료배송쿠폰 사용이 불가능합니다.");
                        }
                    }

                    if(plusCopnCnt > 0) {
                        $("div[name='cuponSearch'] input[name='copnInf'].plusCopn").val("");
                        $("div[name='cuponSearch'] input[name^='plusCopn_'].noneCopn").prop("checked", true);
                    }

                    if(unbeatableCopnCnt > 0) {
                        $("div[name='cuponSearch'] input[name='copnInf'].gnrlCopn").each(function() {
                            if (!isEmpty(this.value)) {
                                var copnTypeGbcd = $(this).val().split("|")[10];
                                if(copnTypeGbcd == "07") {
                                    $(this).val("");
                                    var name = $(this).attr("id");
                                    $("input[name='"+name+"'].noneCopn").prop("checked", true);
                                }
                            }
                        });
                    }

                    if(freeDlvcopnCnt > 0) {
                        // 2019.10.31 HMALL개선이주형 제휴할인일때 무료배송비쿠폰 사용불가하므로 풀리도록 함
                        $("div[name='cuponSearch'] input[name^='freeDlvCopn']").each(function() {
                            if($(this).hasClass("noneCopn")){
                                $(this).prop("checked", true);
                                selectDlvCopn($(this).parents("div[name='cuponSearch']"));
                            }
                        });
                    }
                }
            }

            if(kind == "5") {   // 고객사 할인
                // 플러스쿠폰 불가
                var plusCopnCnt = 0;
                var unbeatableCopnCnt = 0;
                $("div[name='cuponSearch'] input[name='copnInf']").each(function() {
                    var copnGb = $(this).val().split("|")[6];
                    var copnTypeGbcd = $(this).val().split("|")[10];

                    if(copnGb == "2") {
                        plusCopnCnt++;
                    }

                    if(copnTypeGbcd == "07") {
                        unbeatableCopnCnt++;
                    }
                });

                // 2019.10.08 HMALL개선이주형 무료배송비쿠폰 멀티사용처리
                var freeDlvcopnCnt = 0;
                $("div[name='cuponSearch'] input[name='freeDlvCopnInf']").each(function() {
                    if(!isEmpty($(this).val())) {
                        freeDlvcopnCnt++;
                    }
                });

                if(plusCopnCnt > 0 || unbeatableCopnCnt > 0 || freeDlvcopnCnt > 0) {
                    if(tcCd == '0000002991'){
                        alertMsg("임직원 할인 시 플러스 쿠폰/무적쿠폰/무료배송 쿠폰 사용이 불가능합니다.");
                    }else{
                        alertMsg("추가할인 시 플러스 쿠폰/무적쿠폰/무료배송 쿠폰 사용이 불가능합니다.");
                    }
                }

                if(plusCopnCnt > 0) {
                    $("div[name='cuponSearch'] input[name='copnInf'].plusCopn").val("");
                    $("div[name='cuponSearch'] input[name^='plusCopn_'].noneCopn").prop("checked", true);
                }

                if(freeDlvcopnCnt > 0) {
                    // 2019.10.31 HMALL개선이주형 제휴할인일때 무료배송비쿠폰 사용불가하므로 풀리도록 함
                    $("div[name='cuponSearch'] input[name^='freeDlvCopn']").each(function() {
                        if($(this).hasClass("noneCopn")){
                            $(this).prop("checked", true);
                            selectDlvCopn($(this).parents("div[name='cuponSearch']"));
                        }
                    });
                }
            }

            // 결제수단 초기화
            clearSubPayTypeArea();
            clearPayTypeArea();

            // 제휴할인이 있는경우 상품권사용 불가
            if ($("input[name='discountType1']:checked").val() != 0) {
                var tcCd = $("input[name='discountType1']:checked").val();
                if(tcCd != '0000000704' && tcCd != '0000002991') {
                    $("input[name='useGcAmt']").val("0원").prop("disabled", true);
                    $("#chk18").prop("disabled", true).prop("checked", false);
                    $("#ch08").prop("disabled", true);
                    $("#ch08 option:eq(0)").prop("selected", true);
                }
            } else {
                decisionSubPayAreaIsEnable("useGc");
            }

            calculateOrderAmt();
            restoreLastPayType();

            checkLimitEmpDcAmt(); // 홈쇼핑 임직원 할인 한도 체크

            // 선택된 카드로만 구매가능한 UI로 변경
            if(kind == "1" || kind == "2") {
                if(!isEmpty(alliCrdCd)) {
                    $(".payment-wrap").find("a.on").removeClass("on");
                    $(".payment-option-area").hide();
                    $(".payment-option-area div.sub-area").hide();
                    $(".payment-option-area div.card-option-area").hide();
                    $(".payment-option-area div.bankacc-option-area").hide();

                    if(alliCrdCd == "99") { // 무통장
                        $(".payment-wrap a.type-bankacc").addClass("on");
                        $("#selectBank").show();
                        $(".payment-option-area").show();
                    } else {    // 특정 카드만 가능
                        $(".payment-wrap a.type-card").addClass("on");
                        $("#pay1").show();
                        $("div[name='pay1CardPrmo'],#pay1CrdAftDmndPrmo").show();
                        $(".payment-option-area").show();

                        $("select[name='stlmCrdInf'] option").each(function() {
                            var stlmCrdInf = $(this).val();
                            if(!isEmpty(stlmCrdInf) && stlmCrdInf.split("|")[0] == alliCrdCd) {
                                $(this).prop("selected", true);
                            }
                        });
                        $("select[name='stlmCrdInf']").prop("disabled", true);
                        selectCrdcCd($("select[name='stlmCrdInf']"));
                    }

                    choicePayType('N');
                } else {
                    $("select[name='stlmCrdInf']").prop("disabled", false).prop("selected", false);
                }
            } else {
                $("select[name='stlmCrdInf']").prop("disabled", false);
            }

            // 결제수단이 고정이면 신용카드 선택 못하게 한다
            if(isPayCopnPayTypeSet) {
                if(getPayCopnFixGbcd($("input[name=paymentCopnInf]").val().split("|")[9]) == "10") {
                    $("select[name=stlmCrdInf]").prop("disabled", true);
                }
            }

        }

        /////////////////////////////////////////////////////////
        //스크립트. 할인 및 결제 금액 처리 끝
        ////////////////////////////////////////////////////////




        /////////////////////////////////////////////////////////
        //스크립트. 결제 및 주문 처리 시작
        ////////////////////////////////////////////////////////



        /**
         * 결제하기
         */
        function order() {

            if(!$("#multi").prop("checked")){
                // 배송불가 처리
                var noDlvMsg = checkNoDlvArea(nowApocGbcd);
                if(!isEmpty(noDlvMsg)) {
                    alert(noDlvMsg);
                    return;
                }
            }

            //적립금 우선결제 체크
            var hpntPrtyStlmYn = $('input[name="hpntPrtyStlmYn"]').val();
            if(!isEmpty(hpntPrtyStlmYn) && (hpntPrtyStlmYn == 'Y')){
                // HPoint마케팅개선 kjh 20190219 H.Point 우선결제 적용
                // 2020.01 H포인트 최소결제금액 1000p->100p
                var useUPoint = ufnToNum($("input[name='useUPoint']").val());
                if(useUPoint < 100){
                    alert("H.Point 우선결제 상품입니다. 최소 H.Point 100P를 사용해야 합니다.");
                    $("input[name='useUPoint']").val(100);
                    directInsertUPoint($("input[name='useUPoint']"));
                    return;
                }
            }
            // 주문데이터 초기화

            // 신용카드
            $("form[name='orderDataForm'] input.cardInfInput").val("")
            $("form[name='orderDataForm'] input[name='cardAllotMonth']").val("0");
            $("form[name='orderDataForm'] input[name='stlmCrdAmt']").val("0");

            // 페이코
            $("form[name='orderDataForm'] input[name='stlmPaycoAmt']").val("0");

            // 시럽페이 추가
            $("form[name='orderDataForm'] input[name='stlmSyrupPayAmt']").val("0");

            // 카카오페이 추가 : goodsin
            $("form[name='orderDataForm'] input[name='stlmKakaoPayAmt']").val("0");

            // 네이버페이 추가
            $("form[name='orderDataForm'] input[name='stlmNaverpayAmt']").val("0");

            // 스마일페이 추가
            $("form[name='orderDataForm'] input[name='stlmSmilepayAmt']").val("0");

            // 신카카오페이 추가
            $("form[name='orderDataForm'] input[name='stlmNewkakaopayAmt']").val("0");

            // 상담원결제 추가
            $("form[name='orderDataForm'] input[name='stlmCallpayAmt']").val("0");

            // HPAY결제 추가
            $("form[name='orderDataForm'] input[name='stlmHpayAmt']").val("0");

            // 토스결제 추가
            $("form[name='orderDataForm'] input[name='stlmTossAmt']").val("0");
            
            // nfc결제 추가
            $("form[name='orderDataForm'] input[name='stlmNfcAmt']").val("0");

            // 무통장
            $("form[name='orderDataForm'] input.wibkInfInput").val("");
            $("form[name='orderDataForm'] input[name='stlmWibkAmt']").val("0");

            // 휴대폰 결제
            $("form[name='orderDataForm'] input[name='hppayPrice']").val("0");
            $("form[name='orderDataForm'] input[name='stlmHppayAmt']").val("0");
            $("form[name='orderDataForm'] input.hppayInfInput").val("");

            // 현금영수증
            $("form[name='orderDataForm'] input[name='cashRcptRcptTskGbcd']").val("");
            $("form[name='orderDataForm'] input[name='cashRcptCustIdntVal']").val("");

            // 주문데이터 유효성 체크 및 주문 데이터 셋팅
            if(!checkOrderInf()) {
                return;
            }

            if (beferSaveOrder()) {
                // 사은품 확인 및 결제
                showSelectGiftLayerPup();
            }

            // 이전 결제수단 저장
            $("form[name='orderDataForm'] input[name='stlmNstdWayCd']").val(CurStlmWayType);
            if(CurStlmWayType == '10'){
                var stlmCrdInf = $("select[name='stlmCrdInf'] option:selected").val();
                var cmCrdcCd = stlmCrdInf.split('|')[0];
                $("form[name='orderDataForm'] input[name='stlmWaySaveCardCd']").val(cmCrdcCd);
            }else if(CurStlmWayType == '20'){
                var wibkBankCd = $("select[name='wibkBankCd'] option:selected").val();
                $("form[name='orderDataForm'] input[name='stlmWaySaveCardCd']").val(wibkBankCd);
            }

            <!-- GA -->
            try {
                setGaDataSend_Event(GAEcommerceStepKey.Checkout);
            } catch (e) {
                console.log("google analytics 실패");
            }

            return false;
        }

        /**
         * 주문저장전 세션 확인
         */
        function beferSaveOrder() {
            var isContinue = false;

            // 주문저장전 세션 확인
            $.ajax({
                type: "post"
                , url: "/m/smBeferSaveOrder.do"
                , dataType: "json"
                , async: false
                , success : function(data) {
                    if(data != null && data.saveOrderYn == 'Y') {
                        isContinue = true;
                    }
                }
            });

            if (!isContinue) {
                alert("고객님 죄송합니다.\n30분이상 아무 동작을 안하셨거나 네트워크가 불안정하여 서버와의 연결이 끊겼습니다.\n주문을 다시 진행하여 주시기 바랍니다.같은 오류가 지속적으로 발생 시 고객센터 1600-000으로 문의 주시거나 고객센터 1:1문의를 통하여 문의 주시기 바랍니다.");
            }
            return isContinue;
        }

        /**
         * 사은품 선택 팝업 2016
         * @param obj
         */
        function showSelectGiftLayerPup() {
            $.ajax({
                type: "post"
                , url: "/m/selectGiftLayerPup.do"
                , dataType: "html"
                , success : function(data) {
                    if(isEmpty(data)) {    // 사은품이 없는 경우
                        settlement();
                    } else {
                        $("#giftSelection").html(data);
                        var gnrlGiftExstYn = $("input[name='gnrlGiftExstYn']").val();
                        var onlyEssenInGiftYn = $("input[name='onlyEssenInGiftYn']").val();

                        if(gnrlGiftExstYn == "N") {
                            setMxpkOfrInf();
                        }else if(onlyEssenInGiftYn == "Y"){
                            $("#giftSelection").hide();
                            selectGift();
                        } else {
                            //사은품 팝업창 열기
                            $("#giftBtn").click();
                        }
                    }
                }
                , error: function(data) {
                    alert("주문진행중 에러가 발생하였습니다. 만약 동일한 현상이 반복되면 1600-0000으로 주문을 요청해주시기 바랍니다.\n확인을 누르시면 메인페이지로 이동합니다.")
                    window.location.href = '/m/index.do';
                }
            });
        }


        /**
         * 사은품 선택 2016
         */
        function selectGift() {
            $("form[name='orderDataForm'] input[name='giftOfrInf']").remove();

            $("#giftSelection input[name='giftTrgtSlitmInf']").each(function() {
                var giftTrgtSlitmInf = $(this).val();   // slitmCd|uitmCd
                if($(this).siblings("input[name='ofrInf']").length == 1) {
                    var ofrInf = $(this).siblings("input[name='ofrInf']").val();
                    if ($(this).siblings("label").find("select option:selected").size() > 0) {
                        ofrInf += $(this).siblings("label").find("select option:selected").val();
                    } else {
                        ofrInf += $(this).siblings("label").find("input[name=ofrInfOptoin]").val();
                    }
                    ofrInf = ofrInf + "|" + $(this).siblings("label").find("input[name=giftChtpOfrYn]").val();

                    $("form[name='orderDataForm']").append("<input type='hidden' name='giftOfrInf' value='" + giftTrgtSlitmInf + "|" + ofrInf + "'/>");
                }

                // 이주형 선택형 사은품 라디오체크가 인식되지 않는 문제 수정
                var isRadioAndSelected = ($(this).next().prop("type") == "radio" && $(this).next().prop("checked"));

                if(isRadioAndSelected) {
                    var ofrInf = $(this).next().val();
                    if ($(this).siblings("label").find("select option:selected").size() > 0) {
                        ofrInf += $(this).siblings("label").find("select option:selected").val();
                    } else {
                        ofrInf += $(this).siblings("label").find("input[name=ofrInfOptoin]").val();
                    }
                    ofrInf = ofrInf + "|" + $(this).siblings("label").find("input[name=giftChtpOfrYn]").val();

                    $("form[name='orderDataForm']").append("<input type='hidden' name='giftOfrInf' value='" + giftTrgtSlitmInf + "|" + ofrInf + "'/>");
                }
            });

            $("input[name='mxpkOfrInf']").each(function() {
                $("form[name='orderDataForm']").append("<input type='hidden' name='giftOfrInf' value='" + $(this).val() + "'/>");
            });

            settlement();
        }

        /**
         * 합포장 사은품
         */
        function setMxpkOfrInf() {
            $("form[name='orderDataForm'] input[name='giftOfrInf']").remove();
            $("input[name='mxpkOfrInf']").each(function() {
                $("form[name='orderDataForm']").append("<input type='hidden' name='giftOfrInf' value='" + $(this).val() + "'/>");
            });
            $("#giftSelection").html("");
            settlement();
        }

        /**
         * 결제 2016
         */
        function settlement() {
            // 쿠폰 데이터 셋팅
            $("form[name='orderDataForm'] input[name='copnInf'], form[name='orderDataForm'] input[name='freeDlvCopnInf'], form[name='orderDataForm'] input[name='']").remove();

            $("div[name='cuponSearch'] input[name='copnInf']").each(function() {
                if(!isEmpty($(this).val())) {
                    $("form[name='orderDataForm']").append($(this));
                }
            });

            // 2019.10.08 HMALL개선이주형 무료배송비쿠폰 멀티사용처리
            var freeDlvCopnInfArr = "";
            $("div[name='cuponSearch'] input[name='freeDlvCopnInf']").each(function() {
                if(!isEmpty($(this).val())) {
                    freeDlvCopnInfArr += $(this).val() + "^";
                    if ($("form[name='orderDataForm'] input[name='freeDlvCopnInf']").length == 0) {
                        $("form[name='orderDataForm']").append($(this));
                    }
                }
            });
            freeDlvCopnInfArr = freeDlvCopnInfArr.substr(0, freeDlvCopnInfArr.length-1);
            $("form[name='orderDataForm'] input[name='freeDlvCopnInf']").val(freeDlvCopnInfArr);


            if($("input[name='paymentCopnInf']").length > 0) {
                $("form[name='orderDataForm']").append($("input[name='paymentCopnInf']"));
            }

            var payType = $(".payment-wrap a.on").find("input[name=pay]").val();

            //return false;

            $("div.hnm-promotion-code input[name='copnInf']").each(function() {
                if(!isEmpty($(this).val())) {
                    $("form[name='orderDataForm']").append($(this));
                }
            });
            $("div.hnm-promotion-code input[name='hnmPaymentCopnInf']").each(function() {
                if(!isEmpty($(this).val())) {
                    $("form[name='orderDataForm']").append($(this));
                }
            });

            var payType = $(".payment-wrap a.on").find("input[name=pay]").val();
            /*
     * 결제 처리
     */
            // 카드결제 팝업
            if(payType == "1") { // 신용카드
                stlmCardInfo();
            } else if(payType == "4") { // 무통장
                saveOrder();
            } else if(payType == "3") { // 휴대폰 결제
                saveOrder();
            } else if(payType == "paynow") { // 페이나우
                stlmPayNowInfo();
            } else if(payType == "payco") { // 페이코
                stlmPaycoInfo();
            } else if(payType == "syruppay") { // 시럽페이
                stlmSyrupPayInfo();
            } else if(payType == "samsungpay") { // 삼성페이
                // 삼성페이 지원 단말기만 결제수단에 노출
                $.getScript(runnableDeviceUrl, function() {
                    if(!isRunnableDevice()){
                        alert("해당 단말기는 삼성페이를 지원하지 않습니다.");
                        return;
                    }
                });
                stlmSamsungPayInfo();
            } else if(payType == "kakaopay") { // 카카오페이 : 20170210 goodsin 카카오페이 추가
                stlmKakaoPayInfo();
            } else if(payType == "naverpay") { // 네이버페이
                stlmNaverPayInfo();
            } else if(payType == "smilepay") { // 스마일페이
                stlmSmilePayInfo();
            } else if(payType == "callpay") { // 상담원결제
                saveOrder();
            } else if(payType == "newkakaopay") { // 신카카오페이
                stlmNewkakaoPayInfo();
            } else if(payType == "hpay") { // hmallPay
                if(appYn== "N") {
                    try {
                        _trk_clickTrace("EVT","주문서_결제수단_현금간편결제(HmallPay)");
                    } catch(e) {}
                }else if((appOpsyNm == "android" && parseInt(appVerNm) >= 86 ) || (appOpsyNm == "ios" && parseInt(appVerNm) >= 83)){
                    WiseTracker.setCustomMvtTag(WiseTracker.CUSTOM_MVT_TAG_3, "주문서_결제수단_현금간편결제(HmallPay)");
                    WiseTracker.sendTransaction();
                }

                saveOrder();
            } else if(payType == "toss") { // 토스
                saveOrder();
            } else if(payType == "nfc") { // nfc 결제
                saveOrder();
            }else {
                saveOrder();
            }

        }


        /*
 * PayNow
 */
        function stlmPayNowInfo() {

            var crdStlmType = "P";
            //기존 카드결제
            $("form[name='orderDataForm'] input[name='crdCd']").val("");
            $("form[name='orderDataForm'] input[name='cardSelect']").val(crdStlmType);
            $("form[name='orderDataForm'] input[name='cmCrdcCd']").val("");
            //페이나우용 청구할인, 할부개월수, 무이자 할부개월수
            $("form[name='orderDataForm'] input[name='allCrdDmndDcPrmoStr']").val("");
            $("form[name='orderDataForm'] input[name='payNowAllotValue']").val("");
            $("form[name='orderDataForm'] input[name='payNowInstmt']").val("");
            $("form[name='orderDataForm'] input[name='CARD_PAY_TYPE']").val("PN");

            var stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            var wintInsmMths = getWintInsmMths(stlmCrdAmt);
            $("input[name='wintInsmMths']").val(wintInsmMths);




            var instYN = "N"; // N->무이자, Y->일시불
            if(!isEmpty($("#discount1").prop("checked"))) {
                instYN = "Y";
            }

            if (Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val()) < 50000) {
                instYN = "Y";   // 5만원 이하는 무조건 일시불
            }

            //var longWintInsmMths = getLongWintInsmMths(cmCrdcCd);
            // TODO : 카드 관련 데이터 초기화

            var crdCd = "";
            var crdStlmType = "";
            var cardCode = "";
            var cmCrdcCd = "";
            var stlmCrdInf = "";

            //var paymentType = $("input[name='paymentType']:checked").val();

            // 청구할인 프로모션
            var allCrdDmndDcPrmoStr = payNowCardAfterDmnd();
            $("form[name='orderDataForm'] input[name='allCrdDmndDcPrmoStr']").val(allCrdDmndDcPrmoStr);
            // 페이나우 여부
            $("form[name='orderDataForm'] input[name='payNowYn']").val("Y");

            var payNowAllotValue = "";
            var instmt = "0";

            if (instYN != "Y") {

                // 할부개월수
                instmt = "0:2:3:4:5:6:7:8:9:10:11:12:13:14:15:16:17:18";


                // 무이자 할부 처리
                var allotValue = "NONE";
                var allotValueKbAppCrd = "NONE";
                var hdCard = "NONE";
                var norestAllotMonth = Number($("input[name='wintInsmMths']").val()); // 무이자 할부정보
                if (norestAllotMonth > 0) {   // 무이자 할부
                    if (norestAllotMonth > 1) {
                        allotValue = "";
                        for (var i = 0; i <= norestAllotMonth; i++) {
                            allotValue += i;
                            if (i < norestAllotMonth) {
                                allotValue += ":";
                            }
                        }

                        $("select[name='stlmCrdInf'] option").each(function() {
                            stlmCrdInf = $(this).val();
                            if(!isEmpty(stlmCrdInf)){
                                /*crdCd = crdCd + "|" + stlmCrdInf.split("|")[0];
                        crdStlmType = crdStlmType + "|" + stlmCrdInf.split("|")[1];
                        cardCode = cardCode + "|" + stlmCrdInf.split("|")[2];
                        cmCrdcCd = cmCrdcCd + "|" + stlmCrdInf.split('|')[3];
                        */
                                //alert("crdCd : " + crdCd + ", crdStlmType : " + crdStlmType + ", cardCode : " + cardCode, ", cmCrdcCd : " + cmCrdcCd);

                                if(stlmCrdInf.split("|")[0] == "01"){
                                    // 비씨카드
                                    cardCode = "031";
                                } else if (stlmCrdInf.split("|")[0] == "02") {
                                    // 삼성카드
                                    cardCode = "051";
                                } else if(stlmCrdInf.split("|")[0] == "03"){
                                    // KB국민카드
                                    cardCode = "011";
                                } else if(stlmCrdInf.split("|")[0] == "04") {
                                    // 현대카드
                                    cardCode = "061";
                                } else if(stlmCrdInf.split("|")[0] == "06") {
                                    // 외환
                                    cardCode = "021";
                                } else if(stlmCrdInf.split("|")[0] == "07") {
                                    // 신한카드
                                    cardCode = "041";
                                } else if(stlmCrdInf.split("|")[0] == "08") {
                                    // 롯데카드
                                    cardCode = "071";
                                } else if(stlmCrdInf.split("|")[0] == "10") {
                                    // 하나카드
                                    cardCode = "032";
                                } else if(stlmCrdInf.split("|")[0] == "11"){
                                    // 수협비자카드
                                    cardCode = "034";
                                } else if(stlmCrdInf.split("|")[0] == "12"){
                                    // 제주비자
                                    cardCode = "042";
                                } else if(stlmCrdInf.split("|")[0] == "13"){
                                    // 전북비자카드
                                    cardCode = "035";
                                } else if(stlmCrdInf.split("|")[0] == "20"){
                                    // 씨티카드
                                    cardCode = "036";
                                } else if(stlmCrdInf.split("|")[0] == "40") {
                                    // 농협NH카드
                                    cardCode = "091";
                                }

                                if(stlmCrdInf.split("|")[0] == "04"){
                                    hdCard = allotValue.replace(":2", "");
                                    payNowAllotValue += cardCode + "-" + hdCard + ",";
                                }else{
                                    payNowAllotValue += cardCode + "-" + allotValue + ",";
                                }
                            }
                        });

                        $("form[name='orderDataForm'] input[name='cardCode']").val(cardCode);


                        //**신규카드 추가시 아래 코드값 추가 및 무이자 할부개월수 부분도 수정필요**//
                        //allotValueKbAppCrd = "0204-"+allotValue; // KB국민 앱카드의 경우 0204-...만 세팅
                        //allotValueKbAppCrd = allotValueKbAppCrd.replace(/0:1:/gi,""); // 무이자 할부정보 세팅 ("0:1:"을 빼야 아이폰 KB앱카드 어플에서도 호환 됨)
                        //payNowAllotValue = "0100-"+allotValue+",0204-"+allotValue+",0400-"+allotValue+",0700-"+allotValue+",1800-"+allotValue+",1600-"+allotValue+",1500-"+allotValue;
                        //payNowAllotValue = "0100-"+allotValue+",0204-"+allotValue+",0400-"+allotValue+",0700-"+allotValue+",1800-"+allotValue+",1600-"+allotValue+",1500-"+allotValue;
                    }
                }
            }
            $("form[name='orderDataForm'] input[name='payNowInstmt']").val(instmt); //할부개월수
            $("form[name='orderDataForm'] input[name='payNowAllotValue']").val(payNowAllotValue); //카드사별 무이자 할부개월수
            $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();
        }

        function stlmPaycoInfo(){

            var idPayco = $("#idPayco");

            var prdtnm = $("input[name='slitmNm']:eq(0)").val();    // 상품명

            if ($("input[name='slitmNm']").length > 1){
                prdtnm += "외 "+ ($("input[name='slitmNm']").length - 1) + "건";
            }

            //$(idPayco).find("input[name='productName']").val(prdtnm);
            //$(idPayco).find("input[name='totalPaymentAmt']").val($("form[name='orderDataForm'] input[name='stlmPaycoAmt']").val());


            $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();

        }



        function setPaycoResult(reserveOrderNo,sellerOrderReferenceKey,paymentCertifyToken) {

            alert("setPaycoResult");
            if(reserveOrderNo == "" || sellerOrderReferenceKey == "" || paymentCertifyToken == ""){
                alert("페이코 인증정보가 올바르지 않습니다.");
                return;
            }

            $("form[name='orderDataForm'] input[name='paycoReserveOrderNo']").val(reserveOrderNo);
            $("form[name='orderDataForm'] input[name='paycoSellerOrderReferenceKey']").val(sellerOrderReferenceKey);
            $("form[name='orderDataForm'] input[name='paycoPaymentCertifyToken']").val(paymentCertifyToken);

            // 주문
            saveOrder();
        }

        //시럽페이
        function stlmSyrupPayInfo() {
            ///////////////////////////

            $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();
        }

        //결제 방법을 삼성페이로 선택한 경우
        function stlmSamsungPayInfo() {

            var crdStlmType = "S";

            // 기존 카드결제
            $("form[name='orderDataForm'] input[name='crdCd']").val("");
            $("form[name='orderDataForm'] input[name='cardSelect']").val(crdStlmType);
            $("form[name='orderDataForm'] input[name='cmCrdcCd']").val("");
            // 삼성페이용 청구할인, 할부개월 수, 무이자 할부개월 수
            $("form[name='orderDataForm'] input[name='allCrdDmndDcPrmoStr']").val("");
            $("form[name='orderDataForm'] input[name='samsungPayInstmt']").val("");
            $("form[name='orderDataForm'] input[name='CARD_PAY_TYPE']").val("SP");

            var stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            var wintInsmMths = getWintInsmMths(stlmCrdAmt);
            $("input[name='wintInsmMths']").val(wintInsmMths);

            var instmt = "0";
            var instYN = "N"; // N->무이자, Y->일시불

            if($("#discount1:checked").is(":checked")) {
                instYN = "Y";  // 일시불 할인 체크 시 할부 불가
            }

            if (Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val()) < 50000) {
                instYN = "Y";  // 5만원 이하는 무조건 일시불
            }

            if (instYN != "Y") {
                instmt = "0:2:3:4:5:6:7:8:9:10:11:12";
                instYN = "N";
            }

            // 청구할인 프로모션
            var allCrdDmndDcPrmoStr = payNowCardAfterDmnd();
            $("form[name='orderDataForm'] input[name='allCrdDmndDcPrmoStr']").val(allCrdDmndDcPrmoStr);

            // 무이자 할부 처리
            var allotValue = "";

            if (wintInsmMths > 1) {
                allotValue = "";
                for (var i = 0; i <= wintInsmMths; i++) {
                    allotValue += i;
                    if (i < wintInsmMths) {
                        allotValue += ":";
                    }
                }
            }

            // 삼성페이의 무이자 없음은 00
            if($("#discount1:checked").is(":checked") || allotValue == ""){
                allotValue = "00";
            }

            //$("form[name='orderDataForm'] input[name='samsungPayInstmt']").val(instmt); // 할부개월 수
            //$("form[name='orderDataForm'] input[name='samsungPayAllotValue']").val(allotValue); //카드사별 무이자 할부개월 수

            // 카드사/무이자할부개월수/일반할부개월수/ 포인트결제지원여부(A102:포인트미지원, A101포인트지원)
            // 카드별 할부 및 포인트설정시 사용
            // 삼성페이에서 지원하는 전체카드 표시 예) ALL/02-26/02-05/A102
            // 특정카드선택 표시 예  04/02-06/07/A101, 05/02-06/07-12:18/A102, 02/02-06/07-12:18/A102, 03/02-06/07-12:18/A102

            var samsungPayInfoTemp = "/" + allotValue + "/" + instmt + "/A102";

            // 삼성페이는 무이자+유이자 정보 한큐에 세팅
            var samsungPayInfo = "01" + samsungPayInfoTemp; //신한카드
            samsungPayInfo += ",02" + samsungPayInfoTemp;   //국민카드
            samsungPayInfo += ",03" + "/" + allotValue.replace(":2", "") + "/" + instmt + "/A102";  //현대카드
            samsungPayInfo += ",04" + samsungPayInfoTemp;   //삼성카드
            samsungPayInfo += ",05" + samsungPayInfoTemp;   //롯데카드
            samsungPayInfo += ",06" + samsungPayInfoTemp;   //NH카드
            //samsungPayInfo += ",10" + samsungPayInfoTemp; //씨티카드
            samsungPayInfo += ",11" + samsungPayInfoTemp;   //BC카드
            samsungPayInfo += ",12" + samsungPayInfoTemp;   //하나카드


            $("form[name='orderDataForm'] input[name='samsungPayInstmt']").val(samsungPayInfo); // 할부개월 수
            $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();

        }

        //결제 방법을 카카오페이로 선택한 경우
        function stlmKakaoPayInfo() {

            var crdStlmType = "X";

            // 기존 카드결제
            $("form[name='orderDataForm'] input[name='crdCd']").val("");
            $("form[name='orderDataForm'] input[name='cardSelect']").val(crdStlmType);
            $("form[name='orderDataForm'] input[name='cmCrdcCd']").val("");
            // 삼성페이용 청구할인, 할부개월 수, 무이자 할부개월 수
            $("form[name='orderDataForm'] input[name='allCrdDmndDcPrmoStr']").val("");
            $("form[name='orderDataForm'] input[name='CARD_PAY_TYPE']").val("KP");
            $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();
        }

        //결제 방법을 네이버페이로 선택한 경우
        function stlmNaverPayInfo() {

            $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();
        }

        //결제 방법을 스마일페이로 선택한 경우
        function stlmSmilePayInfo() {

            var crdStlmType = "X";

            // 기존 카드결제
            $("form[name='orderDataForm'] input[name='crdCd']").val("");
            $("form[name='orderDataForm'] input[name='cardSelect']").val(crdStlmType);
            $("form[name='orderDataForm'] input[name='cmCrdcCd']").val("");
            // 삼성페이용 청구할인, 할부개월 수, 무이자 할부개월 수
            $("form[name='orderDataForm'] input[name='allCrdDmndDcPrmoStr']").val("");
            $("form[name='orderDataForm'] input[name='CARD_PAY_TYPE']").val("KP");
            $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();
        }

        //결제 방법을 신카카오페이로 선택한 경우
        function stlmNewkakaoPayInfo() {

            $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();
        }

        /*
 * 카드결제 2016
 */
        function stlmCardInfo() {

            //01|I||01
            //02|N|2|04
            var stlmCrdInf = $("select[name='stlmCrdInf'] option:selected").val();
            var crdCd = stlmCrdInf.split("|")[0];
            var crdStlmType = stlmCrdInf.split("|")[1];
            var cardCode = stlmCrdInf.split("|")[2];
            var cmCrdcCd = stlmCrdInf.split('|')[3];
            var paymentType = $("input[name='paymentType']:checked").val();
            var cardIssuerCode = "";

            $("form[name='orderDataForm'] input[name='crdCd']").val(crdCd);
            $("form[name='orderDataForm'] input[name='cardSelect']").val(crdStlmType);
            $("form[name='orderDataForm'] input[name='cmCrdcCd']").val(cmCrdcCd);


            var norestAllotMonth = $("input[name='wintInsmMths']").val();
            var useCardAllotMonth = $("select[name='allotMonth'] option:selected").val();
            if(!isEmpty(useCardAllotMonth) && useCardAllotMonth != "할부기간 선택") {
                $("input[name='cardAllotMonth']").val(useCardAllotMonth);
            } else {
                useCardAllotMonth = "0";
            }

            var longWintInsmMthsArr = getLongWintInsmMths(cmCrdcCd);

            /*
        01  비씨카드
        02  삼성카드
        03  KB국민카드
        04  현대카드(다이너스포함)
        06  외환카드
        07  신한카드(엘지카드포함)
        08  롯데카드(아멕스포함)
        10  하나SK카드
        20  씨티카드
        40  농협NH카드
    */

            if(crdStlmType == "I") {    // ISP 결제
                // 일시불할인 체크
                var instYN = "N";
                if(!isEmpty($("#discount1").attr("checked"))) {
                    instYN = "Y";
                }

                if (Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val()) < 50000) {
                    instYN = "Y";   // 5만원 이하는 무조건 일시불
                }

                $("form[name='orderDataForm'] input[name='KVP_NOINT']").val("0");

                if(useCardAllotMonth == '0'){
                    $("form[name='orderDataForm'] input[name='KVP_NOINT']").val("0");
                } else if(Number(useCardAllotMonth) <= Number(norestAllotMonth)){
                    $("form[name='orderDataForm'] input[name='KVP_NOINT']").val("1");
                } else {
                    for (var i = 0; i < longWintInsmMthsArr.length; i++) {
                        if(Number(useCardAllotMonth) == Number(longWintInsmMthsArr[i].insmPossMths)){
                            $("form[name='orderDataForm'] input[name='KVP_NOINT']").val("1");
                        }
                    }
                }

                $("form[name='orderDataForm'] input[name='CARD_PAY_TYPE']").val("");
                $("form[name='orderDataForm'] input[name='KVP_QUOTA']").val(useCardAllotMonth);
                $("form[name='orderDataForm'] input[name='KVP_PRICE']").val($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val());
                $("form[name='orderDataForm'] input[name='x_SP_CHAIN_CODE']").val("0");
                var cardCode = "";
                if(crdCd == "01" || crdCd == "30" || crdCd == "12"){
                    // 비씨카드, 조흥비자 ->비씨카드 , 제주비자카드
                    if(crdCd == "01") {
                        cardCode = "0100" ;
                        cardIssuerCode = "" ;
                    }
                    if (paymentType == "speed") {
                        $("form[name='orderDataForm'] input[name='x_SP_CHAIN_CODE']").val("1");
                        $("form[name='orderDataForm'] input[name='CARD_PAY_TYPE']").val("011");

                    }
                } else if(crdCd == "03"){
                    //KB국민카드
                    cardCode = "0204";
                    cardIssuerCode = "KBO";//카카오뱅크 제외된 KB카드(KB카드+KB증권)
                } else if(crdCd == "16"){
                    //카카오뱅크카드
                    cardCode = "0204";
                    cardIssuerCode = "KA";
                } else if(crdCd == "11"){
                    //수협비자카드
                    cardCode = "1800";
                } else if(crdCd == "13"){
                    //전북비자카드
                    cardCode = "1600";
                } else if(crdCd == "44"){
                    //산림조합카드
                    cardCode = "0100";
                    cardIssuerCode = "64";
                } else if(crdCd == "99"){
                    //우리카드
                    cardCode = "0170";
                } else if(crdCd == "80"){
                    //카카오페이카드
                    cardCode = "0100";
                } else if(crdCd == "81"){
                    //미래에셋카드
                    cardCode = "0100";
                }
                $("form[name='orderDataForm'] input[name='cardCode']").val(cardCode);
                $("form[name='orderDataForm'] input[name='cardIssuerCode']").val(cardIssuerCode);



                // KB국민 앱카드 인증 프로세스 시작
                if (crdCd == "03"  || crdCd == "16") {  // KB국민 앱카드 (인증 ISP 방식과 유사)
                    var orderDataForm = $("form[name='orderDataForm']");
//          var saveService = $("input[name='saveService']:checked").val();     // 선택 시 P
//          var cardPoint   = $("input[name='cardPoint']:checked").val();       // 선택 시 Y
                    var noint_flag1 = "TRUE";       // 무이자 포함여부                                         // 앱카드 할부개월수 표시 : FALSE, 미표시 : TRUE

                    var nointChk = $("form[name='orderDataForm'] input[name='KVP_NOINT']").val();

                    var allotValueKbAppCrd = "NONE";

                    if(useCardAllotMonth.length == 1){
                        useCardAllotMonth = "0" + useCardAllotMonth;
                    }

                    if(nointChk == '1'){
                        allotValueKbAppCrd = "0204-"+useCardAllotMonth;
                    }
                    if(crdCd == "16"){
                        $(orderDataForm).find("input[name='kMotionIssue_code']").val("KA");
                    }else{
                        $(orderDataForm).find("input[name='kMotionIssue_code']").val("KBO");
                    }
                    $(orderDataForm).find("input[name='kMotionNoint_inf']").val(allotValueKbAppCrd);    // 무이자할부
                    $(orderDataForm).find("input[name='kMotionQuota_inf']").val(useCardAllotMonth);             // 일반할부
                    $(orderDataForm).find("input[name='kMotionNoint_flag1']").val(noint_flag1);     // 무이자 포함(?)여부
//          $(kMotionForm).find("input[name='kb_savepointree']").val((saveService == "P") ? "FALSE" : "FALSE");  // 세이브포인트리 사용여부 (앱카드 사용 X)
//          $(kMotionForm).find("input[name='fixpayflag']").val((cardPoint == "Y") ? "TRUE" : "FALSE");          // 포인트리 사용여부 (일반 ISP와 같이 전체만 사용)
                }


                $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();

            } else if(crdStlmType == "N") { // 안심클릭

                var cardCode = "";
                $("form[name='orderDataForm'] input[name='x_CARDTYPE']").val("");
                $("form[name='orderDataForm'] input[name='x_SP_CHAIN_CODE']").val("0");
                if (crdCd == "02") {
                    // 삼성카드
                    cardCode = "51";
                    // 안심클릭으로 강제
                    paymentType = "safeClck";
                } else if(crdCd == "04") {
                    // 현대카드
                    cardCode = "61";
                } else if(crdCd == "07") {
                    // 신한카드
                    cardCode = "81";
                } else if(crdCd == "40") {
                    // 농협NH카드
                    cardCode = "91";
                }

                $("form[name='orderDataForm'] input[name='x_CARDTYPE']").val(cardCode);

                $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();
            }
        }


        /**
         * 주문
         */
        function saveOrder(){
            $("form[name='orderDataForm']").attr("action", "/m/saveOrder.do").submit();
        }

        /*
 * 20151120>김주명>SK-2 카드번호 체크 2016
 */
        function checkSk2No() {

            if(!$("#sk2lawY").is(":checked")) {
                alert("SK-2 마일리지 적립을 위하여 제3자의 정보 제공에 동의하여 주시기 바랍니다.");
                return false;
            }

            var sk2CardNo = $(".point_sk2 input[name='sk2CardNo']").val()

            if(sk2CardNo == ""){
                alert("SK-2 마일리지 적립을 위하여 멥버쉽번호를 입력해주세요.");
                return false;
            }

            $("form[name='orderDataForm'] input[name='sk2CardNo']").val(sk2CardNo);
            return true;
        }

        /**
         * 주문 데이터 유효성 체크 및 주문정보 셋팅 2016
         * 유효성 체크(모바일 상품 여부(모바일 상품 정보), 배송정보, 금액, 결제수단 선택, 결제금액 입력, 카드종류, 은행, 최저 결제 가능 금액 등)
         */
        function checkOrderInf() {

            // 이전 주문 데이터 초기화
            $("input[name='ordCustMsgInf'], input[name='dsrvCoMsgInf'], input[name='dlvHopeDtInf'], input[name='rcvCustMsgInf'], input[name='mblCopnInf'], input[name='mmsMsgTitlInf'], input[name='mmsMsgCntnInf'], input[name='prsnMsgCrdImgNmInf']").remove();

            var insuranceYn = $("input[name='insuranceYn']").val() == "Y" ? "Y" : "N";

            var senderEmail = $("input[name='senderEmail']").val();
            var nonMemberEmail = $("input[name='nonMemberEmail']").val();


            var ordAgreeChk = $("input[name='ordAgreeChk']:checked").val();
            if(isEmpty(ordAgreeChk) && insuranceYn == "N") {
                if(confirm("주문 내용에 동의하셔야 결제가 가능합니다.\n동의하시겠습니까?")){
                    $("input[name='ordAgreeChk']").prop("checked",true);
                }else{
                    return false;
                }
            }

            //무이자 카드 팝업에 있는 할부가 선택되었는가의 여부 - 주문완료페이지 활용
            var longWintPopYn = $("select[name='allotMonth'] option:selected").attr("longWintPopYn");
            if(longWintPopYn == "Y"){
                $("form[name='orderDataForm'] input[name='longWintPopYn']").val(longWintPopYn);
            }


            if(nonMemberCertYn != ""){
                if(nonMemberCertYn != "Y"){
                    alert("비회원 주문시 휴대폰 인증을 하셔야 주문이 가능합니다.");
                    return false;
                }
                var nonMemeberAgreeChk = $("input[name='nonMemeberAgreeChk']:checked").val();
                if(isEmpty(nonMemeberAgreeChk)){
                    if(confirm("비회원 개인정보 수집에 동의하셔야 결제가 가능합니다.\n동의하시겠습니까?")){
                        $("input[name='nonMemeberAgreeChk']").prop("checked",true);
                    }else{
                        return false;
                    }
                }
            }

            // 2016 모바일이주형 해외배송 선택시 관세동의 체크해야만 결제가능
            if ($("form[name='orderDataForm'] input[name='frdlvYn']").val() == "Y") {
                var frdlvAgreeChk = $("input[name='frdlvAgreeChk']:checked").val();
                if(isEmpty(frdlvAgreeChk)) {
                    alert("관세 발생시 추후 납부에 동의하셔야 결제가 가능합니다.");
                    return false;
                }
            }

            //임직원 할인 한도 체크
            checkLimitEmpDcAmt();

            if(isEmpty(senderEmail)) {
                if(isEmpty(nonMemberEmail)) {
                    //회원가입개선Prj 2019.01.03 주석처리 S
                    //alert("이메일 주소를 입력해주세요.");
                    //$("input[name='nonMemberEmail']").focus();
                    //return false;
                    //회원가입개선Prj 2019.01.03 주석처리 E
                } else {
                    var pattern = /^([0-9a-zA-Z_\.-]+)@([0-9a-zA-Z_-]+)(\.[0-9a-zA-Z_-]+){1,2}$/;
                    if(!pattern.test(nonMemberEmail)) {
                        alert("이메일 주소가 올바르지 않습니다.");
                        $("input[name='nonMemberEmail']").focus();
                        return false;
                    }

                    $("input[name='senderEmail']").val(nonMemberEmail);
                }
            }

            var alliRefCd = $("input[name='alliRefCd']").val();
            if(alliRefCd == "175" || alliRefCd == "176" || alliRefCd == "179") {   // OK 캐쉬백
                var okCashCrdNo = $("input[name='okCardNum']").val();
                if (!isEmpty(okCashCrdNo)) {
                    if(!$("input[name='okCardOk1']").prop("checked")){
                        alert("OK캐쉬백 적립을 원하실 경우엔 정보수집동의를 하셔야 적립이 가능합니다.");
                        $("input[name='okCardOk1']").focus();
                        return false;
                    }
                    if(!$("input[name='okCardOk2']").prop("checked")){
                        alert("OK캐쉬백 적립을 원하실 경우엔 제3자 개인정보 제공에 동의하셔야 적립이 가능합니다.");
                        $("input[name='okCardOk2']").focus();
                        return false;
                    }
                    if (okCashCrdNo.replace(/-/g,"").length != 16) {
                        alert("OK캐쉬백카드 번호 16자리를 입력해 주세요.");
                        $("input[name='okCashCrdNo1']").focus();
                        return false;
                    }
                }
                $("form[name='orderDataForm'] input[name='okCashCrdNo']").val(okCashCrdNo.replace(/-/g,""));
            }

            /*2018.12.27 SK-Ⅱ 마일리지 적립종료*/
            /*if($("form[name='orderDataForm'] input[name='sk2ItemYn']").val() == "Y") {   // 20151120>김주명>sk2

        var sk2CardNo = $(".point_sk2 input[name='sk2CardNo']").val();
        var sk2UncheckFlag = false;

        if(sk2CardNo == "" || sk2CardNo == "숫자만 입력가능합니다."){
            sk2UncheckFlag = confirm("SK-Ⅱ 멤버십번호를 입력하지 않으셨습니다. 마일리지를 적립하지 않으시겠습니까?.");
            $(".point_sk2 input[name='sk2CardNo']").val("");
        }

        if(!sk2UncheckFlag){
            if(!checkSk2No()) {
                return false;
            }
        }
    }*/

            var orgPayType = "";
            var payType = $(".payment-wrap a.on").find("input[name=pay]").val();

            // 카드결제 팝업
            if (payType == "1") { // 신용카드
                orgPayType = "1";
            }
            else if (payType == "4") { // 무통장
                orgPayType = "2";
            }
            else if (payType == "3") { // 휴대폰 결제
                orgPayType = "3";
            }
            else if (payType == "paynow") { // 페이나우
                orgPayType = "4";
            }
            else if (payType == "payco") { // 페이코
                orgPayType = "5";
            }
            else if (payType == "syruppay") { // 시럽페이
                orgPayType = "6";
            }
            else if (payType == "samsungpay") { // 삼성페이
                orgPayType = "7";
            }
            else if (payType == "kakaopay") { // 카카오페이 : 20170210 goodsin 카카오페이 추가
                orgPayType = "8";
            }
            else if (payType == "naverpay") { // 네이버페이
                orgPayType = "9";
            }
            else if (payType == "smilepay") { // 스마일페이
                orgPayType = "10";
            }
            else if (payType == "newkakaopay") { // 신카카오페이
                orgPayType = "11";
            }
            else if (payType == "callpay") { // 상담원결제
                orgPayType = "12";
            }
            else if (payType == "hpay") { // hmallpay
                orgPayType = "13";
            }
            else if (payType == "toss") { // 토스
                orgPayType = "14";
            }
            else if (payType == "nfc") { // nfc 결제
                orgPayType = "15";
            }

            payType = orgPayType;

            $("form[name='orderDataForm'] input[name='payType']").val(payType); //paytype
            var stlmPaperGcAmt = isEmpty($("input[name='stlmPaperGcAmt']").val()) ? 0 : Number($("input[name='stlmPaperGcAmt']").val());
            var stlmOnlnGcAmt = isEmpty($("input[name='stlmOnlnGcAmt']").val()) ? 0 : Number($("input[name='stlmOnlnGcAmt']").val());
            var useHPoint = ufnToNum($("input[name='useHPoint']").val());

            if(useHPoint > 0 && useHPoint < 1000) {
                alert("적립금은 1,000원이상 사용가능합니다.");
                return false;
            }

            //시작 통합포인트 추가 박승택 20170519
            // 2020.01 H포인트 최소결제금액 1000p->100p
            var useUPoint = ufnToNum($("input[name='useUPoint']").val());
            if(useUPoint > 0 && useUPoint < 100) {
                alert("H.Point는 100P이상 사용가능합니다.");
                return false;
            }
            //종료 통합포인트 추가 박승택 20170519

            if(payType == "3" && (stlmPaperGcAmt > 0 || stlmOnlnGcAmt > 0)) {
                alert("휴대폰결제시에는 상품권을 사용하실 수 없습니다.\n할인받기 또는 결제수단을 다시 확인하여주시기 바랍니다.");
                return false;
            }

            var mobileYn = $("input[name='mobileYn']").val();
            var giftOrderYn = $("input[name='giftOrderYn']").val();
            var mobileGcYn = $("input[name='mobileGcYn']").val();
            var foreignYn = $("form[name='orderDataForm'] input[name='frdlvYn']").val();
            //var multiDlvYn = (isEmpty($("#multiSelect").val()) || $("#multiSelect").val() == "1") ? "N" : "Y";
            var multiDlvYn = (isEmpty($("#multi").prop("checked")) || $("#multi").prop("checked") == false) ? "N" : "Y";

            // burujee
            var mblGcVenCd = $("input[name='mblGcVenCd']").val();

            // 모바일 상품권
            if (mobileYn == "Y" || giftOrderYn == "Y") {

                // 2016 모바일이주형 모바일상품권 여러명에게 전송 기능은 없애기로함
            	// 선물하기 다중배송 추가  2020.07 김지영 
                if( giftOrderYn == "Y"){
                    var mblCopnLimitCnt = isEmpty($("#multiSelectMobile").val()) ? 1 : Number($("#multiSelectMobile").val());
                    var dstnInfInputArr = new Array();
                }else{
                    var mblCopnLimitCnt = 1;
                }

                var dstnHpIdntNo = $("#mobileDlvArea input[name='dstnHpIdntNo']").val();
                var dstnHpNo = $("#mobileDlvArea input[name='dstnHpNo']").val();
                var dstnHpIntmNo;
                var dstnHpBckNo;

                if (dstnHpNo.length == 7) {
                    dstnHpIntmNo = dstnHpNo.substring(0, 3);
                    dstnHpBckNo = dstnHpNo.substring(3, 7);
                }
                else {
                    dstnHpIntmNo = dstnHpNo.substring(0, 4);
                    dstnHpBckNo = dstnHpNo.substring(4, 8);
                }

                var slitmCd = $("#mobileDlvArea input[name='slitmCd']").val();

                $("form[name='orderDataForm'] input[name='senderMobileDdd']").val(dstnHpIdntNo);
                $("form[name='orderDataForm'] input[name='senderMobilePhone1']").val(dstnHpIntmNo);
                $("form[name='orderDataForm'] input[name='senderMobilePhone2']").val(dstnHpBckNo);
                $("form[name='orderDataForm'] input[name='slitmCd']").val(slitmCd);

                // 2016 모바일이주형 모바일상품권 여러명에게 전송 기능은 없애기로함
                if (mblCopnLimitCnt > 1 && $("#mobileDlvArea div[name=mobileDlv]").length > 1) {
//                     // 선물하기 다중배송 추가 2020.07 김지영 
                    if( giftOrderYn == "Y"){    
                        $("form[name='orderDataForm'] input[name='mltiDlvYn']").val("Y");
                        var basktOrdQty = isEmpty($("input[name='orderItemTotCount']").val()) ? 0 : Number($("input[name='orderItemTotCount']").val());
                        var totOrdQty = 0;
                        var mblCopnInfArr = new Array();
                        var flag = true;
                        var mmsMsgTitlArr = new Array();
                        var mmsMsgCntnArr = new Array();
                        var prsnMsgCrdImgNmArr = new Array();
                        
                      // 다중배송
                      $("#mobileDlvArea div[name=mobileDlv]").each(function() {
                            var idx = $("#mobileDlvArea div[name=mobileDlv]").index(this);
                            var idxCnt = Number(idx+1);
                            // 유효성 체크
                            if(flag) {
                                //totOrdQty += Number($(this).find("select[name='ordQty']").val());
                                $("#depth3_content_"+idxCnt+" select[name='ordQty']").each(function(i){totOrdQty += Number( $(this).val()); });
                                
                                var rcvCustNm = $(this).find("input[name='rcvCustNm']").val();
                                var slitmCd = $(this).find("input[name='slitmCd']").val();
                                var venItemCd = $(this).find("input[name='venItemCd']").val();
                                var uitmCd = $(this).find("input[name='uitmCd']").val();
                                
                                //var ordQty = $(this).find("select[name='ordQty']").val();
                                var ordQty = $("#depth3_content_"+idxCnt+" select[name='ordQty']").val();
                                
                                var mmsMsgTitl = $(this).find("input[name='mmsMsgTitl']").val();
                                var mmsMsgCntn = $(this).find("textarea[name='mmsMsgCntn']").val();
                                var prsnMsgCrdImgNm = $(this).find("input[name='prsnMsgCrdImgNm']").val();
                                var senderName = $(this).find("input[name='senderName']").val();
                                //var dstnSeq = $(this).find("input[name='dstnSeq']").val();  생성전
                                
                                if(isEmpty(senderName)){
                                    senderName = $("form[name='orderDataForm'] input[name='senderName']").val();   //회원명
                                }
                                if(isEmpty(rcvCustNm)) {
                                    alert("받으시는분 이름을 입력해주세요.");
                                    $(this).find("input[name='rcvCustNm']").focus();
                                    flag = false;
                                }
                                //alert(basktOrdQty+"+"+ totOrdQty+"+"+idx+"+"+slitmCd+"+"+venItemCd+"+"+uitmCd+"+"+ordQty);
                                if(flag && (isEmpty(slitmCd) || isEmpty(uitmCd) || isEmpty(ordQty))) {
                                    alert("상품 정보가 없습니다.");
                                    flag = false;
                                }
                                
                                
                                var rcvCustHpTel1 = $(this).find("select[name='rcvCustHpTel1'] option:selected").val();
                                var rcvCustHpTel2 = $(this).find("input[name='rcvCustHpTel2']").val();
                                var rcvCustHpTel3;
                                if (isEmpty(rcvCustHpTel2) || rcvCustHpTel2.length < 7) {
                                    alert("수신자 전화번호를 정확히 입력해주세요.");
                                    $("#mobileDlvArea input[name='rcvCustHpTel2']").focus();
                                    flag = false;
                                }
                                else {
                                    rcvCustHpTel3 = rcvCustHpTel2.substring(4, 8);
                                    rcvCustHpTel2 = rcvCustHpTel2.substring(0, 4);
                                    
                                    if (!chkPhone(rcvCustHpTel1, rcvCustHpTel2, rcvCustHpTel3)) {
                                        alert("받으시는분 전화번호를 정확히 입력해주세요.");
                                        $("#mobileDlvArea input[name='rcvCustHpTel2']").focus();
                                        flag = false;
                                    }
                                }
                                
                                /*if(flag && (isEmpty(rcvCustHpTel1) || isEmpty(rcvCustHpTel2) || isEmpty(rcvCustHpTel3))) {
                                    alert("받으시는분 번호를 입력해주세요.");
                                    $(this).find("input[name='rcvCustHpTel2']").focus();
                                    flag = false;
                                }*/
                                
                                if (mblGcVenCd != "006283" && mblGcVenCd != "008082") {
                                  
                                  /* 선물하기는 제목없음
                                  if(flag && isEmpty(mmsMsgTitl)) {
                                      alert("메시지 제목을 입력해주세요.");
                                      $(this).find("input[name='mmsMsgTitl']").focus();
                                      flag = false;
                                  } else if (flag && mmsMsgTitl.match("∮")) {
                                      alert("메시지 제목에 특수기호를 사용하실수 없습니다");
                                      $(this).find("input[name='mmsMsgTitl']").focus();
                                      flag = false;
                                  }*/
                                  
                                  if(flag && isEmpty(mmsMsgCntn)) {
                                      alert("메시지 내용을 입력해주세요.");
                                      $(this).find("textarea[name='mmsMsgCntn']").focus();
                                      flag = false;
                                  } else if (flag && mmsMsgCntn.match("∮")) {
                                      alert("메시지 내용에 특수기호를 사용하실수 없습니다");
                                      $(this).find("textarea[name='mmsMsgCntn']").focus();
                                      flag = false;
                                  }
                                }
                                
                                var returnVal = chkMblGcOrdCnt(rcvCustHpTel1 + rcvCustHpTel2 + rcvCustHpTel3);
                                
                                if(flag && mobileGcYn == 'Y' && (Number(ordQty) + returnVal > 3)) {
                                  alert("본 상품은 시간당 3개를 초과하여 구매하실 수 없습니다.\n(받으시는 분 번호 기준)");
                                    flag = false;
                                }
                                
            
                                if(flag) {
                                    var args = rcvCustHpTel1 + "-" + rcvCustHpTel2 + "-" + rcvCustHpTel3 + "|" ;
                                    $("#depth3_content_"+idxCnt+" li").each(function(i){
                                        args +=  $(this).find("input[name='slitmCd']").val()+"^"+$(this).find("input[name='venItemCd']").val()+"^"+$(this).find("input[name='uitmCd']").val()+"^"+$(this).find("select[name='ordQty']").val()+"$"; 
                                    });
                                    
                                    //args +=  slitmCd + "^" + venItemCd + "^" + uitmCd + "^" + ordQty + + "$" ;
                                    //다중배송은 보내는사람 이름 변경 가능함 //mblCopnInfArr 에서 orderDataForm 의 senderName 과 다르게 저장함.
                                    args += "|" + rcvCustNm + "|" + idx + "|" + senderName ;
                                    mblCopnInfArr.push(args);
                                    mmsMsgTitlArr.push(idx + "∮" + mmsMsgTitl);
                                    mmsMsgCntnArr.push(idx + "∮" + mmsMsgCntn);
                                    prsnMsgCrdImgNmArr.push(idx + "∮" + prsnMsgCrdImgNm);
                                }
                                
                                if(!flag) {
                                  return false;
                                }
                                
                                if(flag) {
                                    var args = rcvCustHpTel1 + "-" + rcvCustHpTel2 + "-" + rcvCustHpTel3 + "|" + slitmCd + "^" + venItemCd + "^" + uitmCd + "^" + ordQty + "|" + rcvCustNm + "|" + mmsMsgCntn + "|" + idx;
                                    dstnInfInputArr.push($("<input type='hidden' name='dstnInf' value='" + args + "'/>"));
                                }
                                
                            }
                        });
            
                        if(!flag) {
                            return false;
                        }
            
                        if(basktOrdQty != totOrdQty) {
                            alert("주문하신 상품 수량과 배송하실 상품 수량이 맞지 않습니다.\n다시 확인하시고 주문해주세요.");
                            return false;
                        }
            
                        for(var i in mblCopnInfArr) {
                            $("form[name='orderDataForm']").append("<input type='hidden' name='mblCopnInf' value='" + mblCopnInfArr[i] + "'/>");
                            $("form[name='orderDataForm']").append("<input type='hidden' name='mmsMsgTitlInf' value='" + mmsMsgTitlArr[i] + "'/>");
                            $("form[name='orderDataForm']").append("<input type='hidden' name='mmsMsgCntnInf' value='" + mmsMsgCntnArr[i] + "'/>");
                            $("form[name='orderDataForm']").append("<input type='hidden' name='prsnMsgCrdImgNmInf' value='" + prsnMsgCrdImgNmArr[i] + "'/>");
                        }
                        

                        for(var j in dstnInfInputArr) {
                            $("form[name='orderDataForm']").append(dstnInfInputArr[j]);
                        }
                        
                    }
                }
                // 단일배송
                else {
                	$("form[name='orderDataForm'] input[name='mltiDlvYn']").val("N");
                    var rcvCustNm = $("#mobileDlvArea input[name='rcvCustNm']").val();
                    if(isEmpty(rcvCustNm)) {
                        alert("받으시는 분을 입력해 주세요.");
                        $("#mobileDlvArea input[name='rcvCustNm']").focus();
                        return false;
                    }

                    var rcvCustHpTel1 = $("#mobileDlvArea select[name='rcvCustHpTel1']").val();
                    var rcvCustHpTel2 = $("#mobileDlvArea input[name='rcvCustHpTel2']").val();
                    var rcvCustHpTel3;
                    if (isEmpty(rcvCustHpTel2) || rcvCustHpTel2.length < 7) {
                        alert("수신자 전화번호를 정확히 입력해주세요.");
                        $("#mobileDlvArea input[name='rcvCustHpTel2']").focus();
                        return false;
                    }
                    else {
                        rcvCustHpTel3 = rcvCustHpTel2.substring(4, 8);
                        rcvCustHpTel2 = rcvCustHpTel2.substring(0, 4);

                        if (!chkPhone(rcvCustHpTel1, rcvCustHpTel2, rcvCustHpTel3)) {
                            alert("받으시는분 전화번호를 정확히 입력해주세요.");
                            $("#mobileDlvArea input[name='rcvCustHpTel2']").focus();
                            return false;
                        }
                    }

                    var slitmCd = $("#mobileDlvArea input[name='slitmCd']").val();
                    var venItemCd = $("#mobileDlvArea input[name='venItemCd']").val();
                    var uitmCd = $("#mobileDlvArea input[name='uitmCd']").val();
                    var ordQty = $("#mobileDlvArea input[name='basktOrdQty']").val();

                    var mmsMsgCntn = "";
                    //2017.09.19 최연태 메시지 내용 선택 처리
                    if (mobileGcYn != 'Y' && mblGcVenCd != "006283" && mblGcVenCd != "008082") {
                        mmsMsgCntn = $.trim($("#mobileDlvArea textarea[name='mmsMsgCntn']").val());
                        if(giftOrderYn != "Y" && isEmpty(mmsMsgCntn)) {
                            mmsMsgCntn = $("input[name='senderName']").val()+" 고객님께서 현대 Hmall 을 통해 보내신 모바일 상품권입니다.";
                        }
                    }

                    var returnVal = chkMblGcOrdCnt(rcvCustHpTel1 + rcvCustHpTel2 + rcvCustHpTel3);

                    if(mobileGcYn == 'Y' && Number(ordQty) + returnVal > 3) {
                        alert("본 상품은 시간당 3개를 초과하여 구매하실 수 없습니다.\n(받으시는 분 번호 기준)");
                        return false;
                    }

                    var mblCopnInf = rcvCustHpTel1 + "-" + rcvCustHpTel2 + "-" + rcvCustHpTel3 + "|" + slitmCd + "^" + venItemCd + "^" + uitmCd + "^" + ordQty + "|" + rcvCustNm + "|0";
                    $("form[name='orderDataForm']").append("<input type='hidden' name='mblCopnInf' value='" + mblCopnInf + "'/>");

                    // 배송지 정보( dstnInf )
                    var args = rcvCustHpTel1 + "-" + rcvCustHpTel2 + "-" + rcvCustHpTel3 + "|" 
                                + slitmCd + "^" + venItemCd + "^" + uitmCd + "^" + ordQty + "|" 
                                + rcvCustNm + "|" 
                                + mmsMsgCntn + "|" 
                                + "1";
                    
                    var dstnInfInputArr = new Array();
                    
                    dstnInfInputArr.push($("<input type='hidden' name='dstnInf' value='" + args + "'/>"));
                    
                    for(var j in dstnInfInputArr) {
                        $("form[name='orderDataForm']").append(dstnInfInputArr[j]);
                    }
                    
                    
                    /* 2016 모바일이주형 메세지제목 입력안받음 기프티쇼, 기프티콘 업체에서는 메시지 제목이 필수여서 예외처리 */
                    if(mblGcVenCd == "008117" || mblGcVenCd == "012665") {
                        $("form[name='orderDataForm'] input[name='mmsMsgTitl']").val("모바일 상품권");
                    } else if(mblGcVenCd == "019026" ){
                        $("form[name='orderDataForm'] input[name='mmsMsgTitl']").val("[현대Hmall]교환권 발송");
                    } else {
                        $("form[name='orderDataForm'] input[name='mmsMsgTitl']").val("");
                    }

                    if (!isEmpty(mmsMsgCntn)) {
                        $("form[name='orderDataForm'] input[name='mmsMsgCntn']").val(mmsMsgCntn);
                    }
                    
                    //선물 메세지 카드 2020.08 김지영
                    if(giftOrderYn == "Y"){
                        var prsnMsgCrdImgNm = $("#mobileDlvArea input[name='prsnMsgCrdImgNm']").val();
                        if (!isEmpty(prsnMsgCrdImgNm)) {
                            $("form[name='orderDataForm'] input[name='prsnMsgCrdImgNm']").val(prsnMsgCrdImgNm);
                        }
                        //보내는 사람 이름 수정 가능  -> setOwnCustNm 으로도 쓰임 (카드결제이름 등.)-> 수정해도 우선 회원정보 이름으로 들어가게함.
                        //유효성 체크 하지 않아도 기본 회원정보에서 회원명 추출
                        var senderName = $("#mobileDlvArea input[name='senderName']").val();
                        if(!isEmpty(senderName)){
                            $("form[name='orderDataForm'] input[name='senderName']").val(senderName);
                        }
                        mmsMsgCntn = $.trim($("#mobileDlvArea textarea[name='mmsMsgCntn']").val());
                        if(isEmpty(mmsMsgCntn)) {
                            alert("메시지 내용을 입력해주세요.");
                            $(this).find("textarea[name='mmsMsgCntn']").focus();
                            return false;
                        } else if (mmsMsgCntn.match("∮")) {
                            alert("메시지 내용에 특수기호를 사용하실수 없습니다");
                            $(this).find("textarea[name='mmsMsgCntn']").focus();
                            return false;
                        }
                    }
                    
                    $("form[name='orderDataForm'] input[name='slitmNm']").val($("input[name='slitmNm']:eq(0)").val());
                }
            }
            // 해외배송
            else if (foreignYn == "Y") {

//      var senderMobile1 = $("#delivery_type_foreign").find("#senderMobile1").val();
//        var senderMobile2 = $("#senderMobile2").val();
//        var senderMobile3 = $("#senderMobile3").val();
//
//        if(isEmpty(senderMobile1) || isEmpty(senderMobile2) || isEmpty(senderMobile3)) {
//            alert("보내시는분 휴대폰을 입력하세요");
//            $("#senderMobile2").focus();
//            return false;
//        }
//
//        $("form[name='orderDataForm'] input[name='senderMobileDdd']").val(senderMobile1);
//        $("form[name='orderDataForm'] input[name='senderMobilePhone1']").val(senderMobile2);
//        $("form[name='orderDataForm'] input[name='senderMobilePhone2']").val(senderMobile3);

                // 해외배송지 검증
                var cnryCd = $("#delivery_type_foreign select[name='cnryCd'] option:selected").val();
                if(isEmpty(cnryCd)) {
                    alert("Country를 선택해주세요.");
                    $("#delivery_type_foreign select[name='cnryCd']").focus();
                    return false;
                }

                var rcvCustNm = $("#delivery_type_foreign input[name='rcvCustNm']").val();
                if(isEmpty(rcvCustNm)) {
                    alert("Receiver's Name을 입력해주세요.");
                    $("#delivery_type_foreign input[name='rcvCustNm']").focus();
                    return false;
                }

                var dsptCustNm = $("#delivery_type_foreign input[name='dsptCustNm']").val();
                if(isEmpty(dsptCustNm)) {
                    alert("Sender's Name을 입력해주세요.");
                    $("#delivery_type_foreign input[name='dsptCustNm']").focus();
                    return false;
                }

                /* 단일 폰번호 입력폼 처리
         * 5자리 미만 입력불가이고 앞부터 채워나가는 규칙
         * 8자리 이하 규칙 2 2 4
         * 12345 > 12 34 5
         * 123456 > 12 34 56
         * 1234567 > 12 34 567
         * 12345678 > 12 34 5678
         * 9자리 이상 규칙 4 4 4
         * 123456789 > 1234 5678 9
         * 1234567890 > 1234 5678 90
         * 1234567890A > 1234 5678 90A
         * 1234567890AB > 1234 5678 90AB
         * */
                var dstnTela = "";
                var dstnTels = "";
                var dstnTeli = "";

                var dstnTel = $("#delivery_type_foreign input[name='dstnTel']").val();
                if (dstnTel.length < 5 || 12 < dstnTel.length) {
                    alert("Phone Number를 다시 확인해주세요. (5~12 digits available)");
                    $("#delivery_type_foreign input[name='dstnTel']").focus();
                    return false;
                }
                else {
                    switch (dstnTel.length) {
                        case 5:
                        case 6:
                        case 7:
                        case 8:
                            dstnTela = dstnTel.substring(0, 2);
                            dstnTels = dstnTel.substring(2, 4);
                            dstnTeli = dstnTel.substring(4, dstnTel.length);
                            break;
                        case 9:
                        case 10:
                        case 11:
                        case 12:
                            dstnTela = dstnTel.substring(0, 4);
                            dstnTels = dstnTel.substring(4, 8);
                            dstnTeli = dstnTel.substring(8, dstnTel.length);
                            break;
                    }
                }

                var dstnHpIdntNo = "";
                var dstnHpIntmNo = "";
                var dstnHpBckNo = "";

                var dstnHpNo = $("#delivery_type_foreign input[name='dstnHpNo']").val();
                if (dstnHpNo.length < 5 || 12 < dstnHpNo.length) {
                    alert("Phone Number를 다시 확인해주세요. (5~12 digits available)");
                    $("#delivery_type_foreign input[name='dstnHpNo']").focus();
                    return false;
                }
                else {
                    switch (dstnHpNo.length) {
                        case 5:
                        case 6:
                        case 7:
                        case 8:
                            dstnHpIdntNo = dstnHpNo.substring(0, 2);
                            dstnHpIntmNo = dstnHpNo.substring(2, 4);
                            dstnHpBckNo = dstnHpNo.substring(4, dstnHpNo.length);
                            break;
                        case 9:
                        case 10:
                        case 11:
                        case 12:
                            dstnHpIdntNo = dstnHpNo.substring(0, 4);
                            dstnHpIntmNo = dstnHpNo.substring(4, 8);
                            dstnHpBckNo = dstnHpNo.substring(8, dstnHpNo.length);
                            break;
                    }
                }
                /* 단일 폰번호 입력폼 처리 끝 */

                var dstnPostNo = $("#delivery_type_foreign input[name='dstnPostNo']").val();
                if(isEmpty(dstnPostNo)) {
                    alert("Zip Code을 입력해주세요.");
                    $("#delivery_type_foreign input[name='dstnPostNo']").focus();
                    return false;
                }

                var dstnBaseAdr = $("#delivery_type_foreign input[name='dstnBaseAdr']").val();
                var dstnPtcAdr = $("#delivery_type_foreign input[name='dstnPtcAdr']").val();
                if(isEmpty(dstnPtcAdr)) {
                    alert("Address을 입력해주세요.");
                    $("#delivery_type_foreign input[name='dstnPtcAdr']").focus();
                    return false;
                }

                var cityNm = $("#delivery_type_foreign input[name='cityNm']").val();
                if(isEmpty(cityNm)) {
                    alert("City를 입력해주세요.");
                    $("#delivery_type_foreign input[name='cityNm']").focus();
                    return false;
                }

                var distNmInputYn = $("#delivery_type_foreign").find("input[name=distNmInputYn]").val();
                var distCd = "";
                var distNm = "";
                if(distNmInputYn == "Y") {
                    distNm = $("#delivery_type_foreign input[name='distCdInput']").val();
                } else {
                    distCd = $("#delivery_type_foreign select[name='distCd'] option:selected").val();
                    if(!isEmpty($("#delivery_type_foreign select[name='distCd'] option:selected").text())) {
                        distNm = getdistNm($("#delivery_type_foreign select[name='distCd'] option:selected").text());
                    }
                }

                if(isEmpty(distNm)) {
                    if(distNmInputYn == "Y") {
                        alert("State/Province/Region를 입력해주세요.");
                        $("#delivery_type_foreign input[name='distCdInput']").focus();
                    } else {
                        alert("State/Province/Region를 선택해주세요.");
                        $("#delivery_type_foreign select[name='distCd']").focus();
                    }
                    return false;
                }

                /*if (!isEmpty(dstnPtcAdr)) {
            dstnBaseAdr = dstnBaseAdr + "" + dstnPtcAdr;
        }*/

                $("form[name='orderDataForm'] input[name='cnryCd']").val(cnryCd);
                $("form[name='orderDataForm'] input[name='rcvCustNm']").val(rcvCustNm);
                $("form[name='orderDataForm'] input[name='dsptCustNm']").val(dsptCustNm);
                $("form[name='orderDataForm'] input[name='frgnDstnTela']").val(dstnTela);
                $("form[name='orderDataForm'] input[name='frgnDstnTels']").val(dstnTels);
                $("form[name='orderDataForm'] input[name='frgnDstnTeli']").val(dstnTeli);
                $("form[name='orderDataForm'] input[name='frgnDstnHpIdntNo']").val(dstnHpIdntNo);
                $("form[name='orderDataForm'] input[name='frgnDstnHpIntmNo']").val(dstnHpIntmNo);
                $("form[name='orderDataForm'] input[name='frgnDstnHpBckNo']").val(dstnHpBckNo);
                $("form[name='orderDataForm'] input[name='frgnDstnPostNo']").val(dstnPostNo);
                $("form[name='orderDataForm'] input[name='frgnDstnPtcAdr']").val(dstnPtcAdr);
                $("form[name='orderDataForm'] input[name='frgnDstnCityNm']").val(cityNm);
                $("form[name='orderDataForm'] input[name='frgnDstnDistCd']").val(distCd);
                $("form[name='orderDataForm'] input[name='frgnDstnDistNm']").val(distNm);
                $("form[name='orderDataForm'] input[name='frgnDlvcoCd']").val("88");

            }
            // 일반배송
            else {
                var orderItemTotCount = isEmpty($("input[name='orderItemTotCount']").val()) ? 0 : Number($("input[name='orderItemTotCount']").val());
                var totCount = 0;
                var orderItemInfInputArr = new Array();
                var dstnInfInputArr = new Array();
                var flag = true;

                if (insuranceYn == "N") {
//          var senderMobile1 = $("#senderMobile1").val();
//          var senderMobile2 = $("#senderMobile2").val();
//          var senderMobile3 = $("#senderMobile3").val();
//
//          if(isEmpty(senderMobile1) || isEmpty(senderMobile2) || isEmpty(senderMobile3)) {
//              alert("보내시는분 휴대폰을 입력하세요");
//              $("#senderMobile2").focus();
//              return false;
//          }
//
//          $("form[name='orderDataForm'] input[name='senderMobileDdd']").val(senderMobile1);
//          $("form[name='orderDataForm'] input[name='senderMobilePhone1']").val(senderMobile2);
//          $("form[name='orderDataForm'] input[name='senderMobilePhone2']").val(senderMobile3);
                }
                // #########################
                // 스토어픽 주문일경우
                // #########################
                var stpicOrderYn = $("form[name='orderDataForm'] input[name='stpicOrderYn']").val();
                if(stpicOrderYn == "Y"){

                    var slitmCdIn = "";
                    var slitmNm   = "";
                    var itemOrdQtyInfo = {};
                    // 상품단위로 loop
                    $("#slitmInfDiv span").each(function() {
                        var obj       = $(this);
                        var slitmCd   = obj.data("slitmCd");
                        var uitmCd    = obj.data("uitmCd");
                        var aspItemCd = obj.data("aspItemCd");
                        var ordQty    = Number(obj.data("ordQty"));

                        itemOrdQtyInfo[slitmCd+"|"+uitmCd+"|"+aspItemCd] = {ordQty : ordQty};
                    });

                    $("li[name='itemInfoLi']").each(function(index) {
                        var selectedSlitmCd     = $(this).find("input[name='slitmCd']").val();
                        var selectedUitmCd      = $(this).find("input[name='uitmCd']").val();
                        var selectedAspItemCd   = $(this).find("input[name='aspItemCd']").val();
                        var selectedOrdQty      = isEmpty($(this).find("input[name='itemOrdQty']").val()) ? 0 : Number($(this).find("input[name='itemOrdQty']").val());
                        var selectedRcvCustMsg  = "";
                        var selectedDlvHopeDt   = isEmpty($(this).find("input[name='dlvHopeDt']").val()) ? "" : ($(this).find("input[name='dlvHopeDt']").val()).replace(/-/g, "");

                        if (selectedOrdQty > 0) {
                            itemOrdQtyInfo[selectedSlitmCd+"|"+selectedUitmCd+"|"+selectedAspItemCd].ordQty -= Number(selectedOrdQty);
                            totCount    += selectedOrdQty;

                            if(selectedOrdQty > 0){
                                var stpicOrdQty = 1;
                                for(var i=0; i<selectedOrdQty; i++ ){
                                    orderItemInfInputArr.push($("<input type='hidden' name='orderItemInf' value='" + index + "∮" + selectedSlitmCd + "∮" + selectedUitmCd + "∮" + selectedAspItemCd + "∮" + stpicOrdQty + "∮" + selectedRcvCustMsg + "∮" + selectedDlvHopeDt + "'/>"));
                                }
                            }

                            if(index == 0) {
                                slitmCdIn = selectedSlitmCd;
                                slitmNm = $(this).find("input[name='slitmNm']").val();
                            }
                        }
                    });


                    var rcvnCustNm    = $("#delivery_type_delivery1 input[name='senderName']").val();
                    var dispSenderHpTel = $("#delivery_type_delivery1 input[name='dispSenderHpTel']").val();

                    dispSenderHpTel = dispSenderHpTel.replace((/-/gi), "");

                    var hpRegExp = /(^02.{0}|^01.{1}|[0-9]{3})([0-9]{3,4})([0-9]{4})/g;
                    if(!hpRegExp.test(dispSenderHpTel)) {
                        alert("잘못된 휴대폰 번호입니다.");
                        return ;
                    }

                    dispSenderHpTel = dispSenderHpTel.replace((/[^(0-9)]/gi), "");

                    $("#delivery_type_delivery1 input[name='senderHpTel']").val(dispSenderHpTel);
                    var rcvnCustHpTel = $("#delivery_type_delivery1 input[name='senderHpTel']").val();

                    $("div[name='pickupInfoArea']").each(function(idx2) {
                        var prsnMsg       = "";
                        var dlvHopeDt     = $(this).find("input[name='dlvHopeDt']").val();
                        var prsnYn        = $(this).find("input[name='prsn_yn']").val();  // 선물하기 여부
                        if(prsnYn == "Y"){
                            rcvnCustNm    = $(this).find("input[name='rcvnCustNm']").val();
                            rcvnCustHpTel = $(this).find("input[name='rcvnCustHpTel']").val();
                            prsnMsg       = $(this).find("input[name='prsnMsg']").val();
                        }

                        dlvHopeDt = dlvHopeDt.replace((/[^(0-9)]/gi), "");

                        if (isEmpty(rcvnCustNm) && flag) {
                            alert("받으시는 분을 입력해 주세요.");
                            flag = false;
                        }

                        if (isEmpty(rcvnCustHpTel) && flag) {
                            alert("휴대폰번호를 입력해주세요");
                            flag = false;
                        }

                        console.log(idx2);


                        if (flag) {
                            dstnInfInputArr.push($("<input type='hidden' name='dstnInf' value='" + idx2 + "∮" + rcvnCustNm + "∮" + rcvnCustHpTel + "∮" + prsnMsg + "∮" + prsnYn + "∮" + dlvHopeDt + "'/>"));
                        }
                    });

                    if(!flag) {
                        return false;
                    }


                    for (var att in itemOrdQtyInfo) {
                        if (itemOrdQtyInfo[att].ordQty != 0) {
                            alert("주문하신 상품수량과 배송하실 상품수량이 맞지 않습니다.\n다시 확인하시고 주문해주세요.");
                            flag = false;
                            return false;
                        }
                    }

                    if(orderItemTotCount != totCount) {
                        alert("주문하신 상품수량과 배송하실 상품수량이 맞지 않습니다.\n다시 확인하시고 주문해주세요.");
                        return false;
                    }

                    for(var i in orderItemInfInputArr) {
                        $("form[name='orderDataForm']").append(orderItemInfInputArr[i]);
                    }

                    for(var j in dstnInfInputArr) {
                        $("form[name='orderDataForm']").append(dstnInfInputArr[j]);
                    }

                    $("form[name='orderDataForm'] input[name='mltiDlvYn']").val("Y");
                    $("form[name='orderDataForm'] input[name='slitmCd']").val(slitmCdIn);
                    $("form[name='orderDataForm'] input[name='slitmNm']").val(slitmNm);




                    // #########################
                    // 일반배송처리
                    // #########################
                }else{

                    // 다중배송
                    if (multiDlvYn == "Y") {
                        var slitmCdIn = "";
                        var slitmNm = "";
                        var itemOrdQtyInfo = {};
                        // 상품단위로 loop
                        $("#slitmInfDiv span").each(function() {
                            var obj = $(this);
                            var slitmCd = obj.data("slitmCd");
                            var uitmCd = obj.data("uitmCd");
                            var aspItemCd = obj.data("aspItemCd");
                            var ordQty = Number(obj.data("ordQty"));

                            itemOrdQtyInfo[slitmCd+"|"+uitmCd+"|"+aspItemCd] = {ordQty : ordQty};
                        });

                        $("#multiaddress4th div.multiaddress_depth4 li[name='domesticDstnLi']").each(function() {
                            var idx = $("#multiaddress4th div.multiaddress_depth4 li[name='domesticDstnLi']").index(this);
                            var dlvTotCount = 0;

                            if(flag) {
                            	// 2020.08.12 추가배송비 선결제관련 추가
                                var irgnAreaGbcd = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='irgnAreaGbcd']").val();
                                $(this).find("li[name='itemboxList']").each(function(index) {
                                    var selectedSlitmCd = $(this).find("input[name='slitmCd']").val();
                                    var selectedUitmCd = $(this).find("input[name='uitmCd']").val();
                                    var selectedAspItemCd = $(this).find("input[name='aspItemCd']").val();
                                    var selectedOrdQty = isEmpty($(this).find("select[name='ordQty']").val()) ? 0 : Number($(this).find("select[name='ordQty']").val());
                                    var selectedRcvCustMsg = "";
                                    var selectedDlvHopeDt = isEmpty($(this).find("input[name='dlvHopeDt']").val()) ? "" : ($(this).find("input[name='dlvHopeDt']").val()).replace(/-/g, "");

                                    // 2020.08.12 추가배송비 선결제관련 추가
                                    var jejuAddDlvCost = $(this).find("input[name='itemJejuAddDlvCost']").val();
                                    var irgnAddDlvCost = $(this).find("input[name='itemIrgnAddDlvCost']").val();
                                    var grpItemNum = $(this).find("input[name='grpItemNum']").val();    
                                    grpItemNum = idx+""+grpItemNum;
                                    
                                    if (selectedOrdQty > 0) {
                                        itemOrdQtyInfo[selectedSlitmCd+"|"+selectedUitmCd+"|"+selectedAspItemCd].ordQty -= Number(selectedOrdQty);
                                        totCount += selectedOrdQty;
                                        dlvTotCount += selectedOrdQty;
                                        //orderItemInfInputArr.push($("<input type='hidden' name='orderItemInf' value='" + idx + "∮" + selectedSlitmCd + "∮" + selectedUitmCd + "∮" + selectedAspItemCd + "∮" + selectedOrdQty + "∮" + selectedRcvCustMsg + "∮" + selectedDlvHopeDt + "'/>"));
                                        // 2020.08.12 추가배송비 선결제관련 추가
                                        console.log(">>>" + idx + "∮" + selectedSlitmCd + "∮" + selectedUitmCd + "∮" + selectedAspItemCd + "∮" + selectedOrdQty + "∮" + selectedRcvCustMsg + "∮" + selectedDlvHopeDt + "∮" + irgnAreaGbcd + "∮" + jejuAddDlvCost + "∮" + irgnAddDlvCost + "∮" + grpItemNum + "");
                                        orderItemInfInputArr.push($("<input type='hidden' name='orderItemInf' value='" + idx + "∮" + selectedSlitmCd + "∮" + selectedUitmCd + "∮" + selectedAspItemCd + "∮" + selectedOrdQty + "∮" + selectedRcvCustMsg + "∮" + selectedDlvHopeDt + "∮" + irgnAreaGbcd + "∮" + jejuAddDlvCost + "∮" + irgnAddDlvCost + "∮" + grpItemNum + "'/>"));
                                        if(index == 0) {
                                            slitmCdIn = selectedSlitmCd;
                                            slitmNm = $(this).find("input[name='slitmNm']").val();
                                        }
                                    }
                                });


                                if (dlvTotCount <= 0 && flag) {
                                    alert((idx+1) +"번째 배송지에 선택된 상품이 없습니다.");
                                    flag = false;
                                    return false;
                                }

                                /* 2016 모바일이주형 멀티배송 메세지도 인풋으로 받도록 변경되어 거기서 꺼냄 */
                                var rcvCustNm = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='rcvCustNm']").val();
                                var dstnHpIdntNo = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='dstnHpIdntNo']").val();
                                var dstnHpIntmNo = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='dstnHpIntmNo']").val();
                                var dstnHpBckNo = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='dstnHpBckNo']").val();
                                var dstnTela = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='dstnTela']").val();
                                var dstnTels = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='dstnTels']").val();
                                var dstnTeli = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='dstnTeli']").val();
                                var dstnPostNo1 = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='dstnPostNo']").val();
                                var dstnBaseAdr = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='dstnBaseAdr']").val();
                                var dstnPtcAdr = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='dstnPtcAdr']").val();
                                var dlvAdr = dstnBaseAdr + " " + dstnPtcAdr;
                                var adrKndGbcd = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='adrKndGbcd']").val();
                                var ordCustMsg = "";
                                var dsrvCoMsg = $(this).find("textarea[name=mmsMsgCntnMulti]").val();
                                var dsrvCoMsgInfCustInsrYn = $(this).find("input[name=dsrvCoMsgInfCustInsrYn]").val();
                                
                                var rcvCustSms = $(this).find("input[name='rcvCustSms']:checked").val();
                                var baseDstnYn = $(this).find("input[name='baseDstnYn']:checked").val();

                                if(dsrvCoMsg == "요청사항 선택하기") dsrvCoMsg = "";

                                if(isEmpty(rcvCustNm) && flag) {
                                    alert("받으시는 분을 입력해 주세요.");
                                    flag = false;
                                }

                                if(isEmpty(dstnPostNo1) && flag) {
                                    alert("'주소검색' 버튼을 눌러서 주소를 입력해 주세요.");
                                    flag = false;
                                }

                                if(isEmpty(dstnPtcAdr) && flag) {
                                    alert("배송지 상세주소를 입력해 주세요.");
                                    $(this).find("input[name='dstnPtcAdr']").focus();
                                    flag = false;
                                }

                                if((isEmpty(dstnHpIdntNo) || isEmpty(dstnHpIntmNo) || isEmpty(dstnHpBckNo)) && flag) {
                                    alert("휴대폰번호를 입력해주세요.");
                                    $(this).find("input[name='dstnHpIntmNo']").focus();
                                    flag = false;
                                } else if(flag && !chkPhone(dstnHpIdntNo, dstnHpIntmNo, dstnHpBckNo)) {
                                    alert("휴대폰번호을 정확히 입력해주세요.");
                                    $(this).find("input[name='dstnHpIntmNo']").focus();
                                    flag = false;
                                }

                                if((isEmpty(dstnTela) || isEmpty(dstnTels) || isEmpty(dstnTeli)) && flag) {
                                    dstnTela = "";
                                    dstnTels = "";
                                    dstnTeli = "";
                                } else {
                                    if(!chkPhone(dstnTela, dstnTela, dstnTeli)) {
                                        alert("전화번호를 정확히 입력해주세요.");
                                        $(this).find("input[name='dstnTels']").focus();
                                        flag = false;
                                    }
                                }

                                if(dstnBaseAdr.indexOf("오정구") > -1 || dstnBaseAdr.indexOf("원미구") > -1 || dstnBaseAdr.indexOf("소사구") > -1) {
                                    alert("부천시의 오정구, 원미구, 소사구는 폐지된 주소 입니다.\n새로 주소지를 검색하여 사용하여 주세요.");
                                    flag = false;
                                }

                                if(flag) {
                                    dstnInfInputArr.push($("<input type='hidden' name='dstnInf' value='" + idx + "∮" + rcvCustNm + "∮" + dstnHpIdntNo + "∮" + dstnHpIntmNo + "∮" + dstnHpBckNo + "∮" + dstnTela + "∮" + dstnTels + "∮" + dstnTeli + "∮" + dstnPostNo1 + "∮" + dlvAdr + "∮" + dstnBaseAdr + "∮" + dstnPtcAdr + "∮" + adrKndGbcd + "∮" + ordCustMsg + "∮" + dsrvCoMsg + "∮" + dsrvCoMsgInfCustInsrYn +  "∮" + rcvCustSms + "∮" + baseDstnYn + "'/>"));
                                }
                            }
                        });

                        if(!flag) {
                            return false;
                        }


                        for (var att in itemOrdQtyInfo) {
                            if (itemOrdQtyInfo[att].ordQty != 0) {
                                alert("주문하신 상품수량과 배송하실 상품수량이 맞지 않습니다.\n다시 확인하시고 주문해주세요.");
                                flag = false;
                                return false;
                            }
                        }


                        if(orderItemTotCount != totCount) {
                            alert("주문하신 상품수량과 배송하실 상품수량이 맞지 않습니다.\n다시 확인하시고 주문해주세요.");
                            return false;
                        }

                        for(var i in orderItemInfInputArr) {
                            $("form[name='orderDataForm']").append(orderItemInfInputArr[i]);
                        }

                        for(var j in dstnInfInputArr) {
                            $("form[name='orderDataForm']").append(dstnInfInputArr[j]);
                        }

                        $("form[name='orderDataForm'] input[name='mltiDlvYn']").val("Y");
                        $("form[name='orderDataForm'] input[name='slitmCd']").val(slitmCdIn);
                        $("form[name='orderDataForm'] input[name='slitmNm']").val(slitmNm);


                    }
                    // 단일배송
                    else {
                        // 보험상품인경우
                        if (insuranceYn == "Y") {

                            var rcvCustNm = $("#insurance input[name='rcvCustNm']").val();
                            if(isEmpty(rcvCustNm)) {
                                alert("이름을 입력해 주세요.");
                                return false;
                            }

                            /*
                var rcvBymd = $("#insurance input[name='rcvBymd']").val();
                if(isEmpty(rcvBymd) || rcvBymd.length != 8) {
                    alert("생년월일을 정확히 입력해 주세요.");
                    $("#insurance input[name='rcvBymd']").focus();
                    return false;
                }
                */

                            var dstnHpIdntNo = $("#insurance select[name='dstnHpIdntNo']").val();
                            if(isEmpty(dstnHpIdntNo)){
                                dstnHpIdntNo = $("#insurance input[name='dstnHpIdntNo']").val();
                            }
                            var dstnHpNo = $("#insurance input[name='dstnHpNo']").val();
                            var dstnHpIntmNo;
                            var dstnHpBckNo;
                            if (isEmpty(dstnHpIdntNo) || isEmpty(dstnHpNo) || dstnHpNo.length < 7) {
                                alert("연락처를 입력해주세요.");
                                $("#insurance input[name='dstnHpNo']").focus();
                                return false;
                            }
                            else {
                                if (dstnHpNo.length == 7) {
                                    dstnHpIntmNo = dstnHpNo.substring(0, 3);
                                    dstnHpBckNo = dstnHpNo.substring(3, 7);
                                }
                                else {
                                    dstnHpIntmNo = dstnHpNo.substring(0, 4);
                                    dstnHpBckNo = dstnHpNo.substring(4, 8);
                                }

                                if (!chkPhone(dstnHpIdntNo, dstnHpIntmNo, dstnHpBckNo)) {
                                    alert("연락처를 정확히 입력해주세요.");
                                    $("#insurance input[name='dstnHpNo']").focus();
                                    return false;
                                }
                            }

                            $("form[name='orderDataForm'] input[name='senderMobileDdd']").val(dstnHpIdntNo);
                            $("form[name='orderDataForm'] input[name='senderMobilePhone1']").val(dstnHpIntmNo);
                            $("form[name='orderDataForm'] input[name='senderMobilePhone2']").val(dstnHpBckNo);

                            var rentalYn = $("#rentalYn").val(); //렌탈상품

                            var insuranceTakeYn = $("#insuranceTakeYn").val();
                            var insuAreaGbcd = $("#insuAreaGbcd option:selected").val();
                            var gaAgrYn = "N";  /*내용 : 14(보험직영GA)에 대해서는 테이블 : OD_RNTL_ITEM_ORD_DTL GA_AGR_YN이 NULL로 들어가도록 */
                            if(rentalYn == "Y"){
                                var ordAgreeChk = $("input[name='ordAgreeChk']:checked").val();
                                if(isEmpty(ordAgreeChk)) {
                                    if(confirm("주문 내용에 동의하셔야 결제가 가능합니다.\n동의하시겠습니까?")){
                                        $("input[name='ordAgreeChk']").prop("checked",true);
                                    }else{
                                        return false;
                                    }
                                }
                            }else{
                                if(insuranceTakeYn == "Y"){
                                    if(isEmpty(insuAreaGbcd)) {
                                        alert("거주지역 정보를 입력해주세요.");
                                        $("#insuAreaGbcd").focus();
                                        return false;
                                    }
                                }

                                var ordPsnInfAgreeChk = $("input[name='ordPsnInfAgreeChk']:checked").val();
                                if(isEmpty(ordPsnInfAgreeChk)) {
                                    alert("개인정보 수집이용에 동의하셔야 신청이 가능합니다.");
                                    return false;
                                }

                                var funeralYn = $("#funeralYn").val(); //상조상품
                                var insuCustYn = $("#insuCustYn").val(); //보험(고객)
                                var insuAdrOrdYn = $("#insuAdrOrdYn").val(); //모객(주소)

                                var ordPsnInfOtherAgreeChkYn = $("#ordPsnInfOtherAgreeChkYn").val(); //보험(고객)

                                var gaAgrChkYn = $("#gaAgrChkYn").val();
                                if(ordPsnInfOtherAgreeChkYn == "Y"){
                                    var ordPsnInfOtherAgreeChk = $("input[name='ordPsnInfOtherAgreeChk']:checked").val();
                                    if(isEmpty(ordPsnInfOtherAgreeChk)) {
                                        alert("개인정보 제3자 제공에 동의해주셔야 상담신청이 가능합니다.");
                                        return false;
                                    }
                                    gaAgrYn = "Y";
                                }

                                if(gaAgrChkYn == "Y"){
                                    gaAgrYn = "";
                                }

                                var ordPsnInfUseAgreeChk = $("input[name='ordPsnInfUseAgreeChk']:checked").val();
                                if(isEmpty(ordPsnInfUseAgreeChk)) {
                                    ordPsnInfUseAgreeChk = "N";
                                } else {
                                    ordPsnInfUseAgreeChk = "Y";
                                }
                                
                                
                                if(insuAdrOrdYn == "Y"){
                                    if($("#insurance input[name='dstnBaseAdr']").val() == '' 
                                            || $("#insurance input[name='dstnPtcAdr']").val() == ''
                                            ){
                                        alert("상세주소를 입력해 주세요.");
                                        return false;
                                    }
                                }
                            }

                            var dsrvCoMsg = $("#insurance textarea[name='dsrvCoMsg']").val();
                            if (isEmpty(dsrvCoMsg)) {
                                dsrvCoMsg = "";
                            }

                            dsrvCoMsg = "연락받을 전화번호 : " + dstnHpIdntNo + "-" + dstnHpIntmNo + "-" + dstnHpBckNo + " " + dsrvCoMsg;

                            $("form[name='orderDataForm']").append($("<input type='hidden' name='dsrvCoMsgInf' value='" + $.trim(dsrvCoMsg) + "'/>"));

                            $("form[name='orderDataForm'] input[name='rcvCustNm']").val($("#insurance input[name='rcvCustNm']").val());
                            $("form[name='orderDataForm'] input[name='rcvBymd']").val($("#insurance input[name='rcvBymd']").val());
                            $("form[name='orderDataForm'] input[name='rcvMobileDdd']").val(dstnHpIdntNo);
                            $("form[name='orderDataForm'] input[name='rcvMobilePhone1']").val(dstnHpIntmNo);
                            $("form[name='orderDataForm'] input[name='rcvMobilePhone2']").val(dstnHpBckNo);
                            $("form[name='orderDataForm'] input[name='rcvDstnTela']").val($("#insurance input[name='dstnTela']").val());
                            $("form[name='orderDataForm'] input[name='rcvDstnTels']").val($("#insurance input[name='dstnTels']").val());
                            $("form[name='orderDataForm'] input[name='rcvDstnTeli']").val($("#insurance input[name='dstnTeli']").val());
                            $("form[name='orderDataForm'] input[name='dstnPostNo1']").val($("#insurance input[name='dstnPostNo1']").val());
                            $("form[name='orderDataForm'] input[name='dstnAdrKndGbcd']").val($("#insurance input[name='adrKndGbcd']").val());
                            $("form[name='orderDataForm'] input[name='dstnPtcAdr']").val($("#insurance input[name='dstnPtcAdr']").val());
                            $("form[name='orderDataForm'] input[name='dstnBaseAdr']").val($("#insurance input[name='dstnBaseAdr']").val());
                            $("form[name='orderDataForm'] input[name='dstnAdr']").val($("#insurance input[name='dstnBaseAdr']").val() + ' ' +$("#insurance input[name='dstnPtcAdr']").val());
                            $("form[name='orderDataForm'] input[name='slitmCd']").val($("input[name='slitmCd']:eq(0)").val());
                            $("form[name='orderDataForm'] input[name='slitmNm']").val($("input[name='slitmNm']:eq(0)").val());
                            $("form[name='orderDataForm'] input[name='ordPsnInfUseAgreeChk']").val(ordPsnInfUseAgreeChk);
                            $("form[name='orderDataForm'] input[name='insuAreaGbcd']").val(insuAreaGbcd);
                            $("form[name='orderDataForm'] input[name='gaAgrYn']").val(gaAgrYn);
                        }
                        // 일반상품
                        else {
                            if(!$("#delivery_type_delivery1 input[name='senderName']").is(":disabled")){
                                if(isEmpty($("#delivery_type_delivery1 input[name='senderName']").val())) {
                                    alert("보내시는 분을 입력해 주세요.");
                                    $("#delivery_type_delivery1 input[name='senderName']").focus();
                                    return false;
                                }
                            }

                            //반반배송인 경우 값세팅
                            var halfDlvYn = 'N';
                            if(halfDlvYn == "Y"){
                                if($("#multiaddress4th div.multiaddress_depth4 li[name='domesticDstnLi']").length < 2){
                                    alert("배송지를 올바르게 선택해 주세요.");
                                    return false;
                                }

                                $("#multiaddress4th div.multiaddress_depth4 li[name='domesticDstnLi']").each(function(idx) {
                                    var dstnSeq = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnSeq']").val();
                                    var baseYn = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='baseYn']").val();
                                    var rcvCustNm = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='rcvCustNm']").val();
                                    var dstnHpIdntNo = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnHpIdntNo']").val();
                                    var dstnHpIntmNo = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnHpIntmNo']").val();
                                    var dstnHpBckNo = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnHpBckNo']").val();
                                    var dstnTela = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnTela']").val();
                                    var dstnTels = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnTels']").val();
                                    var dstnTeli = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnTeli']").val();
                                    var dstnPostNo = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnPostNo']").val();
                                    var dstnBaseAdr = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnBaseAdr']").val();
                                    var dstnPtcAdr = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='dstnPtcAdr']").val();
                                    var dlvAdr = dstnBaseAdr + " " + dstnPtcAdr;
                                    var adrKndGbcd = $("#multiaddress_depth2_a" + (idx + 1)).find("input[name='adrKndGbcd']").val();
                                    var ordCustMsg = "";
                                    var dsrvCoMsg = $(this).find("textarea[name=mmsMsgCntnMulti]").val();
                                    var dsrvCoMsgInfCustInsrYn = $(this).find("input[name=dsrvCoMsgInfCustInsrYn]").val();

                                    if(isEmpty(dstnPostNo) || dstnPostNo == "undefined") {
                                        alert("배송지를 올바르게 선택해 주세요.");
                                        return false;
                                    }

                                    if(idx == 0){
                                        //원주문
                                        $("#multi_false input[name=dstnSeq]").val(dstnSeq);
                                        $("#multi_false input[name=baseYn]").val(baseYn);
                                        $("#multi_false input[name=rcvCustNm]").val(rcvCustNm);
                                        $("#multi_false input[name=dstnPostNo]").val(dstnPostNo);
                                        $("#multi_false input[name=dstnBaseAdr]").val(dstnBaseAdr);
                                        $("#multi_false input[name=dstnPtcAdr]").val(dstnPtcAdr);
                                        $("#multi_false input[name=dstnHpIdntNo]").val(dstnHpIdntNo);
                                        $("#multi_false input[name=dstnHpIntmNo]").val(dstnHpIntmNo);
                                        $("#multi_false input[name=dstnHpBckNo]").val(dstnHpBckNo);addressInfoBaseYn_1
                                        $("#multi_false input[name=dstnTela]").val(dstnTela);
                                        $("#multi_false input[name=dstnTels]").val(dstnTels);
                                        $("#multi_false input[name=dstnTeli]").val(dstnTeli);
                                        $("#multi_false input[name=adrKndGbcd]").val(adrKndGbcd);

                                        $("#delivery_type_delivery1 textarea[name='mmsMsgCntn']").val(dsrvCoMsg);
                                        $("#delivery_type_delivery1 input[name='dsrvCoMsgInfCustInsrYn']").val(dsrvCoMsgInfCustInsrYn);

                                    }else{
                                        //필수 구성품
                                        $("form[name='orderDataForm']").append("<input type='hidden' name='halfDlvDstnInf' value='" + idx + "∮" + rcvCustNm + "∮" + dstnHpIdntNo + "∮" + dstnHpIntmNo + "∮" + dstnHpBckNo + "∮" + dstnTela + "∮" + dstnTels + "∮" + dstnTeli + "∮" + dstnPostNo + "∮" + dlvAdr + "∮" + dstnBaseAdr + "∮" + dstnPtcAdr + "∮" + adrKndGbcd + "∮" + ordCustMsg + "∮" + dsrvCoMsg + "∮" + dsrvCoMsgInfCustInsrYn + "'/>")
                                    }
                                });
                            }

                            // 특수배송인 경우 값세팅
                            if ($("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() != "" && !isEmpty($("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val())) {

                                //CJ 제일제당일 경우
                                var cjDawndlvYn = 'N';
                                if(cjDawndlvYn == "Y"){
                                    $("#multi_false input[name='rcvCustNm']").val($("#dawnDlvInfoDiv input[name='rcvCustNm']").val());

                                    var dstnHpIdntNo = $("#dawnDlvInfoDiv select[name='dstnHpIdntNo']").val();
                                    var dstnHpNo = $("#dawnDlvInfoDiv input[name='dstnHpNo']").val();
                                    var dstnHpIntmNo;
                                    var dstnHpBckNo;
                                    if (isEmpty(dstnHpIdntNo) || isEmpty(dstnHpNo) || dstnHpNo.length < 7) {
                                        alert("휴대폰번호를 입력해주세요.");
                                        $("#dawnDlvInfoDiv input[name='dstnHpNo']").focus();
                                        return false;
                                    }
                                    else {
                                        if (dstnHpNo.length == 7) {
                                            dstnHpIntmNo = dstnHpNo.substring(0, 3);
                                            dstnHpBckNo = dstnHpNo.substring(3, 7);
                                        }
                                        else {
                                            dstnHpIntmNo = dstnHpNo.substring(0, 4);
                                            dstnHpBckNo = dstnHpNo.substring(4, 8);
                                        }

                                        if (!chkPhone(dstnHpIdntNo, dstnHpIntmNo, dstnHpBckNo)) {
                                            alert("휴대폰번호를 정확히 입력해주세요.");
                                            $("#dawnDlvInfoDiv input[name='dstnHpNo']").focus();
                                            return false;
                                        }
                                    }

                                    $("#multi_false input[name='dstnHpIdntNo']").val(dstnHpIdntNo);
                                    $("#multi_false input[name='dstnHpIntmNo']").val(dstnHpIntmNo);
                                    $("#multi_false input[name='dstnHpBckNo']").val(dstnHpBckNo);
                                }

                                $("#multi_false input[name=baseYn]").val("N");
                            }

                            var rcvCustNm = $("#multi_false input[name='rcvCustNm']").val();
                            if( !($("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "20"
                                    || $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "21"
                                    || $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "40")
                                && isEmpty(rcvCustNm)) {
                                alert("받으시는 분을 입력해 주세요.");
                                return false;
                            }
                            // 프리미엄 상세주소
                            if ($("form[name='orderDataForm'] input[name='premDlvYn']").val() == "Y") {
                                $("#multi_false input[name='dstnPtcAdr']").val($("input[name='premDstnPtcAdr']").val());
                            }

                            // 새벽배송 상세주소 20180630특화배송조유진
                            if ($("form[name='orderDataForm'] input[name='dawnDlvYn']").val() == "Y") {
                                $("#multi_false input[name='dstnPtcAdr']").val($("input[name='dawnDstnPtcAdr']").val());

                                var mmsMsgCntnPwd;
                                mmsMsgCntnPwd = $("input[name='mmsMsgCntnPwd']").val();      //20180622_공동현관비밀번호_조유진

                                $("#dawnAddInfo textarea[name='mmsMsgCntn']").each(function() {
                                    if(isEmpty(mmsMsgCntnPwd)){
                                        $(this).val($("#dawnAddInfo textarea[name='mmsMsgCntn']").val());
                                    }else{
                                        $(this).val(mmsMsgCntnPwd+"/"+$("#dawnAddInfo textarea[name='mmsMsgCntn']").val());
                                    }
                                });
                            }

                            var dstnPostNo = $("#multi_false input[name='dstnPostNo']").val();
                            var dstnPtcAdr = $("#multi_false input[name='dstnPtcAdr']").val();
                            if(isEmpty(dstnPostNo)) {
                                if($("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "10"){
                                    alert("'주소검색' 버튼을 눌러서 주소를 입력해 주세요.");
                                    return false;
                                }else if($("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "20"){
                                    alert("'편의점 찾기' 버튼을 눌러서 주소를 입력해 주세요.");
                                    return false;
                                }else if($("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "30"){
                                    alert("'지하철역 찾기' 버튼을 눌러서 주소를 입력해 주세요.");
                                    return false;
                                }else if($("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "40"){
                                    alert("'배송지 찾기' 버튼을 눌러서 주소를 입력해 주세요.");
                                    return false;
                                }else{
                                    alert("'주소검색' 버튼을 눌러서 주소를 입력해 주세요.");
                                    return false;
                                }
                            }
                            if(isEmpty(dstnPtcAdr)) {
                                alert("배송지 상세주소를 입력해 주세요.");
                                $("#multi_false input[name='dstnPtcAdr']").focus();
                                return false;
                            }
                            if(dstnPtcAdr == "주소확인요망" || dstnPtcAdr == "등록대기고객" || dstnPtcAdr == "고객님" || dstnPtcAdr == "재확인고객님" || dstnPtcAdr == "주소 확인중") {
                                alert("배송지 주소를 다시한번 확인 하신 후 결제 진행 해주시기 바랍니다.");
                                $("#multi_false input[name='dstnPtcAdr']").focus();
                                return false;
                            }


                            var dstnHpIdntNo = $("#multi_false input[name='dstnHpIdntNo']").val();
                            var dstnHpIntmNo = $("#multi_false input[name='dstnHpIntmNo']").val();
                            var dstnHpBckNo = $("#multi_false input[name='dstnHpBckNo']").val();
                            if ( !($("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "20"
                                    || $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "21"
                                    || $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "40") ) {
	                            if(isEmpty(dstnHpIdntNo) || isEmpty(dstnHpIntmNo) || isEmpty(dstnHpBckNo)) {
	                                alert("전화번호1을 입력해주세요.");
	                                return false;
	                            }
	                            else {
	                                if(!chkPhone(dstnHpIdntNo, dstnHpIntmNo, dstnHpBckNo)) {
	                                    alert("전화번호1을 정확히 입력해주세요.");
	                                    $("#multi_false input[name='dstnHpIntmNo']").focus();
	                                    return false;
	                                }
	                            }
                            }
                            var dstnTela = isEmpty($("#multi_false input[name='dstnTela']").val()) ? "" : $("#multi_false input[name='dstnTela']").val();
                            var dstnTels = isEmpty($("#multi_false input[name='dstnTels']").val()) ? "" : $("#multi_false input[name='dstnTels']").val();
                            var dstnTeli = isEmpty($("#multi_false input[name='dstnTeli']").val()) ? "" : $("#multi_false input[name='dstnTeli']").val();
                            if(isEmpty(dstnTela) || isEmpty(dstnTels) || isEmpty(dstnTeli)) {
                                dstnTela = "";
                                dstnTels = "";
                                dstnTeli = "";
                            }
                            else {
                                if(!chkPhone(dstnTela, dstnTela, dstnTeli)) {
                                    alert("전화번호2를 정확히 입력해주세요.");
                                    $("#multi_false input[name='dstnTels']").focus();
                                    return false;
                                }
                            }
                            var dstnBaseAdr = $("#multi_false input[name='dstnBaseAdr']").val();
                            if(dstnBaseAdr.indexOf("오정구") > -1 || dstnBaseAdr.indexOf("원미구") > -1 || dstnBaseAdr.indexOf("소사구") > -1) {
                                alert("부천시의 오정구, 원미구, 소사구는 폐지된 주소 입니다.\n새로 주소지를 검색하여 사용하여 주세요.");
                                return false;
                            }

                            $("form[name='orderDataForm'] input[name='rcvCustNm']").val(rcvCustNm);
                            $("form[name='orderDataForm'] input[name='rcvMobileDdd']").val(dstnHpIdntNo);
                            $("form[name='orderDataForm'] input[name='rcvMobilePhone1']").val(dstnHpIntmNo);
                            $("form[name='orderDataForm'] input[name='rcvMobilePhone2']").val(dstnHpBckNo);
                            $("form[name='orderDataForm'] input[name='rcvDstnTela']").val(dstnTela);
                            $("form[name='orderDataForm'] input[name='rcvDstnTels']").val(dstnTels);
                            $("form[name='orderDataForm'] input[name='rcvDstnTeli']").val(dstnTeli);
                            $("form[name='orderDataForm'] input[name='dstnPostNo1']").val(dstnPostNo);
                            $("form[name='orderDataForm'] input[name='dstnAdrKndGbcd']").val($("#multi_false input[name='adrKndGbcd']").val());
                            $("form[name='orderDataForm'] input[name='dstnPtcAdr']").val(dstnPtcAdr);
                            $("form[name='orderDataForm'] input[name='dstnBaseAdr']").val(dstnBaseAdr);
                            $("form[name='orderDataForm'] input[name='dstnAdr']").val(dstnBaseAdr + ' ' + dstnPtcAdr);
                            $("form[name='orderDataForm'] input[name='slitmCd']").val($("input[name='slitmCd']:eq(0)").val());
                            $("form[name='orderDataForm'] input[name='slitmNm']").val($("input[name='slitmNm']:eq(0)").val());
                            
                            $("form[name='orderDataForm'] input[name='rcvCustSms']").val($("#rcvCustSms input[name='rcvCustSms']:checked").val());
                            $("form[name='orderDataForm'] input[name='baseDstnYn']").val($("#set-default:input[name='baseDstnYn']:checked").val());

                            $("#delivery_type_delivery1 input[name='dlvHopeDt']").each(function() {
                                if(!isEmpty($(this).val()) && !isEmpty($.trim($(this).val()))) {
                                    var dlvHopeDt = ($(this).val()).replace(/-/g, "");
                                    var itemInf = $(this).siblings("input[name='itemInf']").val();
                                    $("form[name='orderDataForm']").append($("<input type='hidden' name='dlvHopeDtInf' value='" + itemInf + "∮" + dlvHopeDt + "'/>"));
                                }
                            });

                            /*
                $("#domestic textarea[name='rcvCustMsg']").each(function() {
                    if(!isEmpty($(this).val()) && !isEmpty($.trim($(this).val()))) {
                        $("form[name='orderDataForm']").append($("<input type='hidden' name='rcvCustMsgInf' value='" + $.trim($(this).val()) + "'/>"));
                    }
                });
                */

                            var nonMemberYn = $("#multi_false input[name='nonMemberYn']").val();

                            if(nonMemberYn == "Y") {
                                var delivery_message = $.trim($("#delivery_type_delivery1  textarea[name='mmsMsgCntn']").val());
                                $("form[name='orderDataForm']").append($("<input type='hidden' name='dsrvCoMsgInf' value='" + delivery_message  + "'/>"));
                            } else {
                                $("#delivery_type_delivery1 textarea[name='mmsMsgCntn']").each(function() {
                                    if(!isEmpty($(this).val()) && !isEmpty($.trim($(this).val()))) {
                                        $("form[name='orderDataForm']").append($("<input type='hidden' name='dsrvCoMsgInf' value='" + $.trim($(this).val()) + "'/>"));
                                    }
                                });
                                var dsrvCoMsgInfCustInsrYn = $("#delivery_type_delivery1 input[name='dsrvCoMsgInfCustInsrYn']").val();
                                if($("form[name='orderDataForm']").find("input[name=dsrvCoMsgInfCustInsrYn]").length > 0) {
                                    $("form[name='orderDataForm']").find("input[name=dsrvCoMsgInfCustInsrYn]").val(dsrvCoMsgInfCustInsrYn);
                                } else {
                                    $("form[name='orderDataForm']").append("<input type='hidden' name='dsrvCoMsgInfCustInsrYn' value='" + dsrvCoMsgInfCustInsrYn  + "'/>");
                                }
                            }
                            
                            // 편의점, 안심택배함.
                            if ( $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "20"
                            		|| $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "21"
                            		|| $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val() == "40" ) {
                            	if ( isEmpty($("input[name=specialRcvCustNm]").val()) ) {
                            		alert("받으실분을 입력해주세요.");
                            		return false;
                            	}
                            	if ( isEmpty($("input[name=specialRcvCustTel2]").val()) || $("input[name=specialRcvCustTel2]").val().length < 8 ) {
                                    alert("휴대폰번호를 입력해주세요.");
                                    return false;
                                }
                                $("form[name='orderDataForm'] input[name='rcvCustNm']").val($("input[name=specialRcvCustNm]").val());
                                $("form[name='orderDataForm'] input[name='rcvMobileDdd']").val($("select[name=specialRcvCustTel1] option:selected").val());
                                $("form[name='orderDataForm'] input[name='rcvMobilePhone1']").val($("input[name=specialRcvCustTel2]").val().substring(0, 4));
                                $("form[name='orderDataForm'] input[name='rcvMobilePhone2']").val($("input[name=specialRcvCustTel2]").val().substring(4));
                            }
                        }
                    }
                }
            }

            // 보내시는분
            if (insuranceYn == "Y") {
                $("form[name='orderDataForm'] input[name='senderName']").val($("#insurance input[name='rcvCustNm']").val());
            }
            else {
                if(!isEmpty($("#delivery_type_delivery1 input[name='senderName']").val())) {
                    $("form[name='orderDataForm'] input[name='senderName']").val($("#delivery_type_delivery1 input[name='senderName']").val());
                }
            }

            if($("input[name='dlvAdrSaveYn']") != null && $("input[name='dlvAdrSaveYn']").prop("checked")){
                $("form[name='orderDataForm'] input[name='dlvAdrInfSaveYn']").val("Y");
            }else{
                $("form[name='orderDataForm'] input[name='dlvAdrInfSaveYn']").val("N");
            }

            if($("form[name='orderDataForm'] input[name='frgnDrctBuyYn']").val() == "Y"){
                var psnCucrInntCodeInput = $("input[name='psnCucrInntCodeInput']").val();
                if(psnCucrInntCodeInput.length == 13){
                    $("form[name='orderDataForm'] input[name='psnCucrInntCode']").val(psnCucrInntCodeInput);
                }else{
                    alert("개인통관고유부호를 입력해주세요.");
                    return false;
                }
                var psnCucrArgCheck = $("input[name='psnCucrArgCheck']").is(":checked");
                var psnCucrVenArgCheck = $("input[name='psnCucrVenArgCheck']").is(":checked");
                var psnCucrReUseYnCheck = $("input[name='psnCucrReUseYnCheck']").is(":checked") ? "Y" : "N";

                if(psnCucrArgCheck && psnCucrVenArgCheck){
                    $("form[name='orderDataForm'] input[name='psnCucrReUseYn']").val(psnCucrReUseYnCheck);
                }else if (psnCucrArgCheck && !psnCucrVenArgCheck){
                    alert("주문 정보 해외 이동에 동의하셔야 결제가 가능합니다.");
                    return false;
                }else{
                    alert("개인통관고유번호 수집 및 이용에 동의하셔야 결제가 가능합니다.");
                    return false;
                }
            }

            var totStlmAmt = isEmpty($("form[name='orderDataForm'] input[name='totStlmAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());

            if(totStlmAmt < 0) {
                alert("결제 금액에 오류가 있습니다.\n결제수단을 다시 선택해 주세요.");
                clearPayTypeArea();

                $("input[name='useDeposit'], input[name='useHPoint'], input[name='useGcAmt']").val("0원").prop("disabled", true);
                $("span[name='useHanamoneyAmt'] , span[name='useCultureCashAmt'], span[name='useBluePointAmt']").text("0P").prop("disabled", true);
                $("#chkGcAmt, #chkDeposit, #chk20").prop("checked", false);

                return false;
            }

            var isIntangibleItem = false;
            $("#slitmInfDiv span").each(function() {
                if($(this).data('itemType') != 'GENERAL') {
                    isIntangibleItem = true;
                }
            });

            if(isIntangibleItem) {
                return true;
            }


            if(totStlmAmt > 0 && isEmpty(payType)) {
                alert("결제수단을 선택해주세요.");
                return false;
            }

            if(payType == "1") {   // 신용카드
                var stlmCrdInf = $("select[name='stlmCrdInf'] option:selected").val();

                $("form[name='orderDataForm'] input[name='stlmCrdAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
                var stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val());

                if(isEmpty(stlmCrdInf)) {
                    alert("카드종류를 선택해주세요.");
                    $("select[name='stlmCrdInf']").focus();
                    return false;
                }

                if((stlmCrdInf.split("|")[1] != "I") && isEmpty($("select[name='allotMonth'] option:selected").val()) && stlmCrdAmt >= 50000) {
                    alert("할부개월을 선택해주세요.");
                    return false;
                }

                var crdCd = stlmCrdInf.split("|")[0];
                //20140929>김주명>MPoint
                if(crdCd == "01" || crdCd == "02" || crdCd == "03" || crdCd == "06" || crdCd == "07" || crdCd == "20" || crdCd == "04" || crdCd == "10") {
                    if($("input[name='cardPoint']:checked").val() == "Y") {
                        //현대카드 M포인트 합주문 추가
                        /*var orderItemTotCount = $("input[name='orderItemTotCount']").val();
                if (orderItemTotCount != 1 && crdCd == "04") {
                    alert("M포인트는 단일상품 1개 구매시에만 사용 가능합니다.");
                    return false;
                }*/
                        $("form[name='orderDataForm'] input[name='cardPointUseYn']").val("Y");
                    } else {
                        $("form[name='orderDataForm'] input[name='cardPointUseYn']").val("N");
                    }
                } else {
                    $("form[name='orderDataForm'] input[name='cardPointUseYn']").val("N");
                }

                // 외한카드
//        if (crdCd == "06") {
//            if(totStlmAmt > 300000) {
//              alert('신용카드로 30만원 이상 구매시 BC, KB, 삼성, 현대, 신한, 하나SK, 롯데카드로만 결제 가능합니다.');
//                return false;
//            }
//        }

            }

            if(payType == "2" && totStlmAmt != 0) {    // 무통장
                var wibkBankCd = $("select[name='wibkBankCd'] option:selected").val();
                var wibkCustNm = $("input[name='wibkCustNm']:eq(0)").val();

                if(isEmpty(wibkBankCd)) {
                    alert("입금은행을 선택해주세요.");
                    $("select[name='wibkBankCd']").focus();
                    return false;
                }

                if(isEmpty(wibkCustNm)) {
                    alert("입금자명을 입력해주세요.");
                    $("input[name='wibkCustNm']").focus();
                    return false;
                }

                $("form[name='orderDataForm'] input[name='wibkBankCd']").val(wibkBankCd);
                $("form[name='orderDataForm'] input[name='wibkCustNm']").val(wibkCustNm);
                $("form[name='orderDataForm'] input[name='wibkAcntSmsYn']").val($("input[name='wibkAcntSmsYn']").val());
                $("form[name='orderDataForm'] input[name='wibkIamtInfSmsYn']").val($("input[name='wibkIamtInfSmsYn']").val());
                $("form[name='orderDataForm'] input[name='stlmWibkAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "3") {    // 휴대폰 결제

                var orderItemTotCount = $("input[name='orderItemTotCount']").val();
                /*
        if (orderItemTotCount != 1) {
            alert("죄송합니다. 현대Hmall 휴대폰결제에서는 복수상품의 결제를 지원하지 않습니다");
            return false;
        }
        */
                // 30만원 이하만 결제 가능 처리
                if(totStlmAmt > 500000) {
                    alert("휴대폰결제는 50만원이하 결제시에만 이용가능합니다.");
                    $("input[name='pay']").prop("checked", false);
                    return false;
                }

                $("form[name='orderDataForm'] input[name='stlmHppayAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "4") {   // 페이나우
                $("form[name='orderDataForm'] input[name='stlmCrdAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "5") {   // 페이코
                $("form[name='orderDataForm'] input[name='stlmPaycoAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "6") {   // 시럽페이
                $("form[name='orderDataForm'] input[name='stlmSyrupPayAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "7") {   // 삼성페이
                $("form[name='orderDataForm'] input[name='stlmCrdAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "8") {   // 카카오페이 : 20170210 goodsin 카카오페이 추가
                $("form[name='orderDataForm'] input[name='stlmKakaoPayAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "9") {   // 네이버페이
                $("form[name='orderDataForm'] input[name='stlmNaverpayAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "10") {   // 스마일페이
                $("form[name='orderDataForm'] input[name='stlmSmilepayAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "11") {   // 신카카오페이
                $("form[name='orderDataForm'] input[name='stlmNewkakaopayAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "12" && totStlmAmt != 0) {    // 무통장
                $("form[name='orderDataForm'] input[name='stlmCallpayAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "13") {    // HPAY
                $("form[name='orderDataForm'] input[name='stlmHpayAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            if(payType == "14") {    // 토스
                $("form[name='orderDataForm'] input[name='stlmTossAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }
            
            if(payType == "15") {    // nfc결제
                $("form[name='orderDataForm'] input[name='stlmNfcAmt']").val($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            }

            // 제휴할인 선택 시
            if(!isEmpty($("input[name='discountType1']:checked").val())) {
                var kind = $("input[name='discountType1']:checked").attr("kind");
                var stlmCrdAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val());
                if(kind == "1" && !payType == "1" && stlmCrdAmt == 0) {
                    alert("카드 할인을 받기위해서는 카드 결제 금액이 있어야 합니다.");
                    return false;
                }
            }

            if(payType == "1") {
                var stlmCrdAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val());
                if(stlmCrdAmt < 1000) {
                    alert("카드결제는 1,000원이상만 가능합니다");
                    return false;
                }
            }

            if(payType == "4") {
                var stlmCrdAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val());
                if(stlmCrdAmt < 1000) {
                    alert("페이나우결제는 1,000원이상만 가능합니다");
                    return false;
                }
            }

            if(payType == "5") {
                var stlmPaycoAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmPaycoAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmPaycoAmt']").val());
                if(stlmPaycoAmt < 1000) {
                    alert("페이코결제는 1,000원이상만 가능합니다");
                    return false;
                }
            }

            //시럽페이 추가
            if(payType == "6") {
                var stlmSyrupPayAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmSyrupPayAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmSyrupPayAmt']").val());
                if(stlmSyrupPayAmt < 1000) {
                    alert("11Pay결제는 1,000원이상만 가능합니다");
                    return false;
                }
            }

            //삼성페이
            if(payType == "7") {
                var stlmCrdAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val());
                if(stlmCrdAmt < 1000) {
                    alert("삼성페이결제는 1,000원이상만 가능합니다");
                    return false;
                }
            }

            //카카오페이 : 20170210 goodsin 카카오페이 추가
            if(payType == "8") {
                var stlmCrdAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmKakaoPayAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmKakaoPayAmt']").val());
                if(stlmCrdAmt < 1000) {
                    alert("카카오페이결제는 1,000원이상만 가능합니다");
                    return false;
                }
            }

            //네이버페이 : 20180611 네이버페이 추가
            if(payType == "9") {
                var stlmCrdAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmNaverpayAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmNaverpayAmt']").val());
                if(stlmCrdAmt < 100) {
                    alert("네이버페이는 100원 이상일 때 결제 가능합니다");
                    return false;
                }
            }

            //스마일페이
            if(payType == "10") {
                var stlmCrdAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmSmilepayAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmSmilepayAmt']").val());
                if(stlmCrdAmt < 100) {
                    alert("스마일페이는 100원 이상일 때 결제 가능합니다");
                    return false;
                }
            }

            //신카카오페이
            if(payType == "11") {
                var stlmCrdAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmNewkakaopayAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmNewkakaopayAmt']").val());
                if(stlmCrdAmt < 100) {
                    alert("카카오페이는 100원 이상일 때 결제 가능합니다");
                    return false;
                }
            }

            //토스
            if(payType == "14") {
                var stlmTossAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmTossAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmTossAmt']").val());
                if(stlmTossAmt < 100) {
                    alert("토스결제는 100원 이상일 때 결제 가능합니다");
                    return false;
                }
            }
            
            // nfc결제
            if(payType == "15") {
                var stlmNfcAmt = isEmpty($("form[name='orderDataForm'] input[name='stlmNfcAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='stlmNfcAmt']").val());
                if(stlmNfcAmt < 1000) {
                    alert("카드터치(NFC)결제는 1000원 이상일 때 결제 가능합니다");
                    return false;
                }
            }
            
            // 현금영수증(신청 가능한 금액이 존재하는 경우 처리한다.)
            var cashRcptSendAmt = isEmpty($("form[name='orderDataForm'] input[name='cashRcptSendAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='cashRcptSendAmt']").val());
            if(cashRcptSendAmt > 0) {
                var receiptYn = $("#receiptSelect input[name='receiptYn']").prop("checked");
                if(receiptYn) receiptYn = "Y";
                else receiptYn = "N";
                $("form[name='orderDataForm'] input[name='receiptYn']").val(receiptYn);

                if(receiptYn == "Y") {
                    var rcptTskGbcd = $("input[name='rcptTskGbcd']:checked").val();

                    if(isEmpty(rcptTskGbcd)) {
                        alert("현금영수증 사용 용도를 선택해 주세요.");
                        return false;
                    }

                    if(rcptTskGbcd == "0") {

                        var cashRcptType = $("select[name='cashRcptType'] option:selected").val();
                        var cashRcptCustIdntVal = "";

                        if(cashRcptType == "1"){
                            var cashRcptCreditCrdNum = $("input[name='cashRcptCreditCrdNum']").val().replace(/-/g,"");
                            if(isEmpty(cashRcptCreditCrdNum) || (cashRcptCreditCrdNum.length < 16)) {
                                alert("소득공제용 현금영수증 발급을 위한 신용카드번호를 정확히 입력해 주세요.");
                                $("input[name='cashRcptCreditCrdNum']").focus();
                                return false;
                            }
                            cashRcptCustIdntVal = cashRcptCreditCrdNum;
                        }else if(cashRcptType == "2"){
                            var cashRcptCrdNum = $("input[name='cashRcptCrdNum']").val().replace(/-/g,"");
                            if(isEmpty(cashRcptCrdNum) || (cashRcptCrdNum.length < 18)) {
                                alert("소득공제용 현금영수증 발급을 위한 현금영수증카번호를 정확히 입력해 주세요.");
                                $("input[name='cashRcptCrdNum']").focus();
                                return false;
                            }
                            cashRcptCustIdntVal = cashRcptCrdNum;
                        }else{
                            var cashRcptHpNum1 = $("#receiptSelect select[name='cashRcptHpNum1'] option:selected").val();
                            var cashRcptHpNum2 = $("#receiptSelect input[name='cashRcptHpNum2']").val();
                            if(isEmpty(cashRcptHpNum2) || (cashRcptHpNum2.length < 7)) {
                                alert("소득공제용 현금영수증 발급을 위한 전화번호를 정확히 입력해 주세요.");
                                $("#receiptSelect input[name='cashRcptHpNum2']").focus();
                                return false;
                            }
                            cashRcptCustIdntVal = cashRcptHpNum1 + cashRcptHpNum2;
                        }

                        $("form[name='orderDataForm'] input[name='cashRcptRcptTskGbcd']").val(rcptTskGbcd);
                        $("form[name='orderDataForm'] input[name='cashRcptCustIdntVal']").val(cashRcptCustIdntVal);
                    }
                    else if(rcptTskGbcd == "1") {
                        var rgno1 = $("#receiptSelect input[name='rgno1']").val();
                        var rgno2 = $("#receiptSelect input[name='rgno2']").val();
                        var rgno3 = $("#receiptSelect input[name='rgno3']").val();
                        if(isEmpty(rgno1) || isEmpty(rgno2) || isEmpty(rgno3) || rgno1.length != 3 || rgno2.length < 2 || rgno3.length < 5) {
                            alert("지출증빙용 현금영수증 사업자 번호를 정확히 입력해 주세요.");
                            $("#receiptSelect input[name='rgno1']").focus();
                            return false;
                        }

                        if (!isValidRno(rgno1, rgno2, rgno3)) {
                            alert("입력하신 사업자 번호가 유효하지 않습니다. 정확히 입력해 주세요.");
                            $("#receiptSelect input[name='rgno1']").focus();
                            return false;
                        }

                        $("form[name='orderDataForm'] input[name='cashRcptRcptTskGbcd']").val(rcptTskGbcd);
                        $("form[name='orderDataForm'] input[name='cashRcptCustIdntVal']").val(rgno1 + rgno2 + rgno3);
                    }
                }
            }

            var replacePdNoticeYn = 'N';
            if(replacePdNoticeYn == "Y"){
                $("form[name='orderDataForm'] input[name='rplcItemChocYn']").val($("input[name='rplcItemChocYnRadio']:checked").val());
                if ($("input[name='rplcItemChocYnRadio']:checked").val() == "Y") {
                    GA_Event('주문서', '품절 시 대체상품 안내', '안내 받겠음');
                } else {
                	GA_Event('주문서', '품절 시 대체상품 안내', '안내 받지않고 주문취소');
                }
            }

            // 마지막 결제 일때 쿠폰 데이터 셋팅 되도록 이동
            /*$("form[name='orderDataForm'] input[name='copnInf'], form[name='orderDataForm'] input[name='freeDlvCopnInf']").remove();

    $("#cuponSearch input[name='copnInf']").each(function() {
        if(!isEmpty($(this).val())) {
            $("form[name='orderDataForm']").append($(this));
        }
    });


    $("#cuponFreeDlvSearch input[name='freeDlvCopnInf']").each(function() {
        if(!isEmpty($(this).val())) {
            $("form[name='orderDataForm']").append($(this));
        }
    });*/

            return true;

        }



        /////////////////////////////////////////////////////////
        //스크립트. 결제 및 주문 처리 끝
        ////////////////////////////////////////////////////////



        /////////////////////////////////////////////////////////
        // 스크립트. 결제영역 처리 시작
        ////////////////////////////////////////////////////////

        /**
         * 기타 결제수단 선택 영역 초기화 2016
         * - 적립금, 예치금, 상품권 등
         */
        function clearSubPayTypeArea() {

            var hpntPrtyStlmYn = $('input[name="hpntPrtyStlmYn"]').val();

            if($("#chkDeposit").is(":checked")) {
                $("#chkDeposit").prop("checked", false);
            }
            if($("#chk18").is(":checked")) {
                $("#chk18").prop("checked", false);
            }
            if($("#chk20").is(":checked")) {
                $("#chk20").prop("checked", false);
            }
            if(hpntPrtyStlmYn != 'Y') {
                //HPoint마케팅개선 kjh 20190219 H.Point 우선결제 적용
                if($("#chk21").is(":checked")) {
                    $("#chk21").prop("checked", false);
                }
            }

            //20170414 박승택 추가
            if($("#chk21").is(":checked")) {
                $("#chk21").prop("checked", false);
            }

            if($("#wPoint").is(":checked")) {
                $("#wPoint").prop("checked", false);
            }


            $("input[name='useGcAmt']").val("0원");
            $("input[name='useDeposit']").val("0원");
            $("span[name='useHanamoneyAmt']").text("0P");
            $("span[name='useCultureCashAmt']").text("0P");
            $("span[name='useBluePointAmt']").text("0P");

            etcPointTotal();

            //HPoint마케팅개선 kjh 20190219 H.Point 우선결제 적용
            $("input[name='useHPoint']").val("0원");
            if((hpntPrtyStlmYn != 'Y')) $("input[name='useUPoint']").val("0P");
            //20170414 박승택 추가
            //$("input[name='useUPoint']").val("0P");

            $("#stlmAmtDcTxt").html("0원");
            $("#useWPoint").val("0원");
        }


        /**
         * 결제수단 선택 영역 초기화 2016
         */
        function clearPayTypeArea(payChecked) {
            // 결제영역 히든
            //$("#pay1, #pay2, #pay3").hide();

            // 결제수단을 클릭해서 발생한 경우에 스킵
            if (!payChecked) {
                $("input[name='pay']").prop("disabled", false).prop("checked", false);    // 결제수단 비활성화 해제
            }
            $("select[name='stlmCrdInf'] option").prop("selected", false);                      // 카드목록 초기화
            $("select[name='stlmCrdInf'] option:first").prop("selected", true);
            $("select[name='allotMonth']").children().remove();                                 // 할부 목록 제거
            $("select[name='allotMonth']").append("<option>할부기간 선택</option>");
            $("#allotMonth").attr('disabled', 'disabled');

            $("div[name='pay1CardPrmo'],#pay1CrdAftDmndPrmo").hide();
            $(".crdPntArea").hide();      // 카드 포인트 영역
            $(".smileCrdArea ").hide(); //스마일카드프로모션영역
            $("#smileCrdpoint1").prop("checked", false);
            $("#smileCrdpoint2").prop("checked", false);
            $("#pay1 span.marginB10.crd01.crd03.crd11.crd12.crd13.crd30").hide();      // 카드 결제방식(안심,간편,PayAll)
            $(".payment-wrap").show();
            $(".payment-option-area").hide();
            $(".payment-option-area").children("div").hide();
            //일단 주석
            //$('.payment_select > li.selected, .paymentArea > li.selected').removeClass('selected');
            $(".sub-area.pay4, .sub-area.pay5, .sub-area.pay6, .sub-area.pay7, .sub-area.pay8, .sub-area.pay9, .sub-area.pay10, .sub-area.pay11, .sub-area.pay12, .sub-area.pay13, .sub-area.pay14, .sub-area.pay15, .sub-area.hpDesc").hide();   // 카카오페이추가 : 20170210 goodsin 카카오페이 추가
            $("#stlmAlliDcAmtDl").hide();       // 청구할인
            $("input[name=dmndDcPrmoNo]").val(""); // 청구할인 프로모션 번호

            $("input[name='paymentType'], input[name='cardPoint']").prop("checked", false);  // 결제방식 초기화, 포인트 사용 초기화
            $("#point2").prop("checked", false);  // 결제방식 초기화, 포인트 사용 초기화

            $("input[name='paymentType']").filter("input[value='simp']").prop("checked", true);
            $("input[name='paymentType']").filter("input[value='safe']").prop("checked", true);


            $("select[name='wibkBankCd'] option").prop("selected", false);  // 입금은행 초기화
            $("select[name='wibkBankCd'] option:first").prop("selected", true);
            $("input[name='wibkCustNm']").val($("form[name='orderDataForm'] input[name='senderName']").val());   // 입금자명 초기화

            $("input[name='receiptYn']:eq(0)").prop("checked", false);    // 현금영수증 초기화
            $("input[name='receiptYn']:eq(1)").prop("checked", true);    // 현금영수증 초기화

            $("#order2016Alert, #order2016Alert div[name^='crdcCd']").hide();

            $(".list_btn.order2016_button .large_btn.color2.type2").removeClass("layerpopup_btn");
            $(".list_btn.order2016_button .large_btn.color2.type2").attr("dg-data", "");
            receiptInit();

            // 현금영수증
            calculateCashRcptAmt();
        }



        /**
         * 신용카드 선택 2016
         */
        function selectCrdcCd(obj) {
            var crdCd = "";
            var crdType = "";
            var cardCode = "";
            var cmCrdcCd = "";
            var alliRefCd = $("input[name='alliRefCd']").val();

            $("#allotMonth").removeClass('Color4');
            $("input[name='paymentType'], input[name='cardPoint']").prop("checked", false);  // 결제방식 초기화, 포인트 사용 초기화
            $("#point2").prop("checked", false); // 결제방식 초기화, 포인트 사용 초기화

            $("input[name='paymentType']").filter("input[value='simp']").prop("checked", true);
            $("input[name='paymentType']").filter("input[value='safe']").prop("checked", true);
            $("#pay1 sub.marginT10,#pay1CrdAftDmndPrmo sub.marginT10").hide();
            $("#order2016Alert, #order2016Alert div[name^='crdcCd']").hide();

            //20개월 이상 포인트 사용 제한 초기화
            $("#point").attr("disabled",false);
            $("#point2").attr("disabled",false);
            $("#noCardPointmsg").hide();

            if($("#order2016Alert div[name='crdcCd_10']").length > 0){
                $("#order2016Alert, #order2016Alert div[name='crdcCd_10']").show();
            }

            if(!isEmpty($(obj).val())) {
                crdCd = $(obj).val().split('|')[0];
                crdType = $(obj).val().split('|')[1];
                cardCode = $(obj).val().split('|')[2];
                cmCrdcCd = $(obj).val().split('|')[3];

                stlmWayCd = crdCd;

                if (crdType == "I") {
                    if(crdCd == "01") {
                        $("#pay1 span.crd" + crdCd).show();
                        $("input[name='paymentType']").prop("checked", false);
                        if(cpayPathGbcd == "011"){
                            $("input[name='paymentType']").filter('input[value="speed"]').prop("checked", true);
                        }else{
                            $("input[name='paymentType']").filter('input[value="safe"]').prop("checked", true);
                        }
                    } else {
                        $("#pay1 span.crd" + crdCd).hide();
                        $("input[name='paymentType']").prop("checked", false);
                        $("input[name='paymentType']").filter('input[value="simp"]').prop("checked", true);
                    }

                    // 결제방식 화면 노출
                    if(crdType == "I" && crdCd != "01") {
                        $("#pay1 span.crd" + crdCd).hide();
                    } else if(crdCd == "01") {
                        $("#pay1 span.crd" + crdCd).show();
                    }


                } else {
                    $("#pay1 p.marginB10").hide();
                    $(".marginB10").hide();
                }

                //20140929>김주명>MPoint
                if (crdCd == "01" || crdCd == "02" || crdCd == "03" || crdCd == "06" || crdCd == "07" || crdCd == "20" || crdCd == "04" || crdCd == "10") {
                    // 카드 포인트
                    $(".crdPntArea ").show();

                    // 법인몰 복지카드가 테스트가 되지 않아서 기존처럼 변경
                    //if(crdCd == "04" && ($(".crdPntArea input[name='mPoint']").val() == "N" || alliRefCd == "700")) {
                    if((crdCd == "04" && ($(".crdPntArea input[name='mPoint']").val() == "N")) || cardCode == "B2B") {
                        $(".crdPntArea ").hide();
                    }
                } else {
                    $(".crdPntArea").hide();
                }

                if(crdCd == "04" || crdCd == "02" || crdCd == "08" || crdCd == "20" || crdCd == "40") {
                    $("#pay1 sub.crdcd" + crdCd).show();
                    $("#pay1CrdAftDmndPrmo sub.crdcd" + crdCd).show();
                }

                // 장애카드 체크
                if($("#order2016Alert div[name='crdcCd_*"+crdCd+"']").length > 0){
                    $("#order2016Alert, #order2016Alert div[name='crdcCd_*"+crdCd+"']").show();
                }

                //복지카드 선택 시 페이샷관련 문구 노출, 04|N|4|06 - 현대카드 , 04|N|B2B|06 - 복지카드
                $("#payshotDesc").hide();
                var b2bCardYn = $("#b2bCardYn").val();
                if($(obj).val() == "04|N|B2B|06" || b2bCardYn == "Y" ){
                    $("#payshotDesc").show();
                    $(".crdPntArea").hide();    //법인카드 사용 시 포인트사용 비노출
                }
                var smileCrdExceptYn = "";
                smileCrdExceptYn = $("input[name='smileCrdExceptYn']").val(); //스마일카드 적용안될때 처리
                
                 if(crdCd == "04" && smileCrdExceptYn !="Y"){ 
                    $(".smileCrdArea").show();
                    //$("form[name='orderDataForm'] input[name='smileCrdExceptYn']").val("N"); //제외여부체크
                }else{
                    $(".smileCrdArea").hide();
                    $("#smileCrdpoint1").prop("checked", false);
                    $("#smileCrdpoint2").prop("checked", false);
                    $("form[name='orderDataForm'] input[name='smileCrdPointYn']").val("N");
                    //$("form[name='orderDataForm'] input[name='smileCrdExceptYn']").val("Y"); //제외여부체크
                }  
            } else {
                $("#allotMonth").attr('disabled', 'disabled');
                $(".crdPntArea").hide();
                $("#payshotDesc").hide();
            }


            reloadCardAfterDmnd(crdCd, cmCrdcCd);
            reloadCardAllotMonth(crdCd, cmCrdcCd, crdType);

            //$("#allotMonth").removeClass('textCor1').find('option').removeClass('textCor3');
        }

        /**
         * 카드에 따른 할부개월 셋팅
         * @param crdCd
         */
        function reloadCardAllotMonth(crdCd, cmCrdcCd, crdType, stlmCrdAmt) {
            $("select[name='allotMonth']").children().remove();
            var spymDc = $("input[name='spymDc']:checked").val();
            stlmCrdAmt = isEmpty(stlmCrdAmt) ? Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val()) : stlmCrdAmt;
            var wintInsmMths = getWintInsmMths(stlmCrdAmt);
            $("input[name='wintInsmMths']").val(wintInsmMths);

            var hnmPromotionCodePossYn = "N";

            if ($("#hnmPromotionCodePossYn").val() =="Y"){
                hnmPromotionCodePossYn ="Y" ;
            }

            var gcItemYn = $("input[name='gcItemYn']").val();
            var longWintInsmMthsArr = getLongWintInsmMths(cmCrdcCd);
            var longWintPopArr = getLongWintPopArr(crdCd,stlmCrdAmt);

            if(!isEmpty(crdCd) && stlmCrdAmt >= 50000 && hnmPromotionCodePossYn== "N") {

                $("select[name='allotMonth']").append("<option value='0' class='Color1'>일시불</option>");

                if(isEmpty(spymDc) && gcItemYn == "N") {
                    var templongWintArray = new Array();
                    var tempWintArray = new Array();
                    for(var i=2; i<=18 ; i++) {
                        var longWintInsmMthsSetFlag = false;
                        var tempText = "";
                        if(i < 10){
                            tempText = "0"+i;
                        }else{
                            tempText = i;
                        }

                        if(wintInsmMths >= i) {
                            $("select[name='allotMonth']").append("<option value='" + i + "' class='color-ff5340'>무이자 " + tempText + "개월</option>");
                        } else {
                            if(longWintInsmMthsArr.length > 0){
                                for(var j=0; j<longWintInsmMthsArr.length ; j++) {
                                    if(longWintInsmMthsArr[j].insmPossMths == i){
                                        $("select[name='allotMonth']").append("<option value='" + longWintInsmMthsArr[j].insmPossMths + "' class='color-ff5340'>무이자 " + longWintInsmMthsArr[j].insmPossMths + "개월</option>");
                                        longWintInsmMthsSetFlag = true;
                                    }
                                    //18개월 초과 장기 무이자 데이터 쌓기
                                    if(longWintInsmMthsArr[j].insmPossMths > 18 && i == 18){
                                        templongWintArray.push(longWintInsmMthsArr[j].insmPossMths);
                                    }
                                }
                            }

                            if(!longWintInsmMthsSetFlag){
                                if(longWintPopArr.length > 0 && longWintPopArr.includes(String(i))){
                                    //무이자 팝업 부분 카드 표시 노출은 무이자지만 로직은 유이자로 간다
                                    $("select[name='allotMonth']").append("<option value='" + i + "' longWintPopYn='Y' class='color-ff5340'>무이자 " + tempText + "개월</option>");
                                }else{
                                    tempWintArray.push(i);
                                }
                            }
                        }
                    }

                    //18개월 이상 무이자 노출
                    if(templongWintArray.length > 0){
                        for(var x=0; x < templongWintArray.length ; x++) {
                            $("select[name='allotMonth']").append("<option value='" + templongWintArray[x] + "' class='color-ff5340'>무이자 " + templongWintArray[x] + "개월</option>");
                        }
                    }

                    //유이자 노출
                    if(tempWintArray.length > 0){
                        for(var x=0; x < tempWintArray.length ; x++) {
                            var tempText = "";
                            if(tempWintArray[x] < 10){
                                tempText = "0"+tempWintArray[x];
                            }else{
                                tempText = tempWintArray[x];
                            }
                            $("select[name='allotMonth']").append("<option value='" + tempWintArray[x] + "'>유이자 " + tempText + "개월</option>");
                        }
                    }
                }

                $("#allotMonth").removeAttr('disabled');
                $("select[name='allotMonth']").show();
            } else {
                $("#allotMonth").attr('disabled', 'disabled');
                if(isEmpty(crdCd)) {
                    $("select[name='allotMonth']").append("<option>할부기간 선택</option>");
                } else {
                    $("select[name='allotMonth']").append("<option value='0'>일시불</option>");
                }
            }
        }


        /**
         * 장기무이자 할부 프로모션 확인 2016
         * @param crdCd
         */
        function getLongWintInsmMths(crdCd) {

            var tempPrmoArr = new Array();
            var longWintPrmoArr = new Array();

            if(crdCd == "03"){
                crdCd = "12";
            }

            $("#slitmInfDiv span").each(function(index, element) {
                var prmoMap = $(this).data("longWintInsmPrmoMap");

                if(prmoMap == null || prmoMap.length == 0) return longWintPrmoArr;
                if(index > 0 && tempPrmoArr.length == 0) return longWintPrmoArr;

                if(index == 0){
                    for(var i=0;i<prmoMap.length;i++){

                        if(prmoMap[i].crdcCd != crdCd) continue;

                        if(tempPrmoArr.length==0){
                            tempPrmoArr.push(prmoMap[i]);
                            continue;
                        }

                        var matchFlag = false;
                        for(var j=0;j<tempPrmoArr.length;j++){
                            if(tempPrmoArr[j].insmPossMths == prmoMap[i].insmPossMths){
                                matchFlag = true;
                            }
                        }

                        if(!matchFlag){
                            tempPrmoArr.push(prmoMap[i]);
                        }

                    }
                }else{
                    for(var i=0;i<prmoMap.length;i++){

                        if(prmoMap[i].crdcCd != crdCd) continue;

                        for(var j=0;j<tempPrmoArr.length;j++){
                            if(tempPrmoArr[j].insmPossMths == prmoMap[i].insmPossMths
                                && tempPrmoArr[j].cnt == index){
                                tempPrmoArr[j].cnt = index+1;
                            }
                        }
                    }
                }

            });


            for(var j=0;j<tempPrmoArr.length;j++){
                if(tempPrmoArr[j].cnt == $("#slitmInfDiv span").length){
                    longWintPrmoArr.push(tempPrmoArr[j]);
                }
            }

            return longWintPrmoArr;
        }

        function getLongWintPopArr(crdCd,stlmCrdAmt){
            var longWintPopArr = new Array();

            for(var i=0 ; i<longWintPopList.length ; i++){
                var popCrdcCd = longWintPopList[i].crdcCd;
                var bsicSlitmAmt = longWintPopList[i].bsicSlitmAmt;
                var insmPossMths = longWintPopList[i].insmPossMths;

                if(crdCd == popCrdcCd){
                    if(stlmCrdAmt >= bsicSlitmAmt){
                        longWintPopArr.push(insmPossMths);
                    }
                }
            }

            return longWintPopArr;
        }

        /**
         * 현금영수증 초기화 2016
         */
        function receiptInit() {
            $("select[name='cashRcptHpNum1'] option:eq(0)").attr("selected", true);
            $("input[name='rgno1'], input[name='rgno2'], input[name='rgno3']").val("");
            $("input[name='cashRcptHpNum1']").val($("input[name=memberCashRcptHpTel1]").val());
            $("input[name='cashRcptHpNum2']").val($("input[name=memberCashRcptHpTel2]").val() + $("input[name=memberCashRcptHpTel3]").val());
            $("input[name='receiptYn']:eq(0)").prop("checked", false);
            $("input[name='receiptYn']:eq(1)").prop("checked", true);
            $(".receipt1").removeClass("selected");
            $(".receipt2").removeClass("selected");
            $("#receiptSelect div.receiptType").hide();
            $("#cashRcptAmtSpan").hide();
        }

        /////////////////////////////////////////////////////////
        //스크립트. 결제영역 처리 끝
        ////////////////////////////////////////////////////////



        /////////////////////////////////////////////////////////
        //스크립트. 포인트 제어 시작
        ////////////////////////////////////////////////////////

        // 각종 할인 내역 체크박스 설정 2016
        function decisionSubPayAreaIsEnable(type) {

            if (type == "useGc") { // 상품권

                if (    ($("input[name='discountType1']").size() == 1 || $("input[name='discountType1']:checked").val() == 0) // 제휴할인
                    && !$("#discount1").prop("checked") // 일시불사용여부
                ) {
                    $("#chk18").prop("disabled", false);
                }
            } else if (type == "useDeposit") {
                var kind = $("input[name='discountType1']:checked").attr("kind");
                if (kind != "1") {
                    $("#chkDeposit").prop("disabled", false);
                }
            } else if (type == "useHPoint") {
                var kind = $("input[name='discountType1']:checked").attr("kind");
                if (kind != "1" && isEmpty($("#sale:checked").val())) {
                    $("#chk20").prop("disabled", false);
                }
                //20170414 박승택 추가
            } else if (type == "useUPoint") {
                var kind = $("input[name='discountType1']:checked").attr("kind");
                if (kind != "1" && isEmpty($("#sale:checked").val())) {
                    $("#chk21").prop("disabled", false);
                }
            }
        }

        // 지류상품권 체크박스 2016
        function useGcAmt(obj) {
            if(obj.checked) {
                $("#ch08").attr("disabled", false);
                if($("select[name='selectGcKind']").val() == "1"){
                    $("input[name='useGcAmt']").attr("disabled", false);
                }
                goGaPage('주문/장바구니>주문서작성>할인포인트팝업','지류상품권안내');
            } else {
                $("#ch08").prop("disabled", true);
                $("input[name='useGcAmt']").prop("disabled", true);
                $("input[name='useGcAmt']").val("0원");

                clearPayTypeArea();
                calculateOrderAmt();
                restoreLastPayType();
            }
        }

        // 지류상품권 셀렉트박스 2016
        function selectGcKind(obj) {
            var gcChecked =  $id("chk18").checked;

            if($(obj).val() == '1' && gcChecked){
                $("input[name='useGcAmt']").attr("disabled", false);
            }else{
                $("input[name='useGcAmt']").attr("disabled", true);
            }

            $("input[name='useGcAmt']").val("0원");

            clearPayTypeArea();
            calculateOrderAmt();
            restoreLastPayType();
        }

        //예치금 사용 체크 2016
        function useDeposit(obj, isAllAmt) {

            if(obj.checked) {
                //카드즉시할인KJH 예치금 체크 시 결제영역 초기화 및 주문금액 재계산
                clearPayTypeArea();
                calculateOrderAmt();
                //$("input[name='useDeposit']").prop("disabled", false);

                var totStlmAmt = Number($("input[name='totStlmAmt']").val());
                var deposit = Number($("#assetDeposit").val());
                if (totStlmAmt >= 0) {
                    if(totStlmAmt < deposit) {
                        if(isAllAmt) $("input[name='useDeposit']").val(gfn_appendComma(totStlmAmt) + "원");
                        else $("input[name='useDeposit']").val("0원");
                    } else {
                        if(isAllAmt) $("input[name='useDeposit']").val(gfn_appendComma(deposit) + "원");
                        else $("input[name='useDeposit']").val("0원");
                    }
                }
            } else {
                //$("input[name='useDeposit']").prop("disabled", true);
                $("input[name='useDeposit']").val("0원");
            }

            clearPayTypeArea();
            calculateOrderAmt();
            restoreLastPayType();
        }


        //H.Point 사용 체크 2016  20170413 박승택 추가
        function useUPoint(obj, isAllAmt) {
            //HPoint마케팅개선 kjh 20190219 H.Point 우선결제 적용
            var hpntPrtyStlmYn = $('input[name="hpntPrtyStlmYn"]').val();
            if(obj.checked) {
                //카드즉시할인KJH H.Point 체크 시 결제영역 초기화 및 주문금액 재계산
                clearPayTypeArea();
                calculateOrderAmt();

                //$("input[name='useHPoint']").prop("disabled", false);
                var totStlmAmt = Number($("input[name='totStlmAmt']").val());
                var uPoint = Number($("#assetUpoint").val());
                // 2020.01 H포인트 최소결제금액 1000p->100p
                if(uPoint >= 100 && totStlmAmt >= 0) {
                    if(totStlmAmt < uPoint) {
                        if(isAllAmt) $("input[name='useUPoint']").val(gfn_appendComma(totStlmAmt) + "P");
                        else $("input[name='useUPoint']").val("0P");
                    } else {
                        if(isAllAmt) $("input[name='useUPoint']").val(gfn_appendComma(uPoint) + "P");
                        else $("input[name='useUPoint']").val("0P");
                    }
                }
                //HPoint마케팅개선 kjh 20190219 H.Point 우선결제 적용
                // 2020.01 H포인트 최소결제금액 1000p->100p
            }else if(!isEmpty(hpntPrtyStlmYn) && (hpntPrtyStlmYn == 'Y')){
                alert("H.Point 우선결제 상품입니다. 최소 H.Point 100P를 사용해야 합니다.");
                $("#chk21").prop("checked", true);
                $("input[name='useUPoint']").val(1000);
                directInsertUPoint($("input[name='useUPoint']"));
            }else{
                //$("input[name='useUPoint']").prop("disabled", true);
                $("input[name='useUPoint']").val("0P");
            }

            clearPayTypeArea();
            calculateOrderAmt();
            restoreLastPayType();
        }

        //적립금 사용 체크 2016
        function useHPoint(obj, isAllAmt) {
            var hpntPrtyStlmYn = $('input[name="hpntPrtyStlmYn"]').val();
            if(obj.checked) {
                //카드즉시할인KJH 적립금 체크 시 결제영역 초기화 및 주문금액 재계산
                clearPayTypeArea();
                calculateOrderAmt();
                //$("input[name='useHPoint']").prop("disabled", false);
                var totStlmAmt = Number($("input[name='totStlmAmt']").val());
                var hPoint = Number($("#assetHpoint").val());
                if(hPoint >= 1000 && totStlmAmt >= 0) {
                    if(totStlmAmt < hPoint) {
                        if(isAllAmt) $("input[name='useHPoint']").val(gfn_appendComma(totStlmAmt) + "원");
                        else $("input[name='useHPoint']").val("0원");
                    } else {
                        if(isAllAmt) $("input[name='useHPoint']").val(gfn_appendComma(hPoint) + "원");
                        else $("input[name='useHPoint']").val("0원");
                    }
                }
                //HPoint마케팅개선 kjh 20190219 H.Point 우선결제 적용으로 기존 적립금 우선결제 로직 삭제...
            }else{
                //$("input[name='useHPoint']").prop("disabled", true);
                $("input[name='useHPoint']").val("0원");
            }

            clearPayTypeArea();
            calculateOrderAmt();
            restoreLastPayType();
        }

        /**
         * 상품권 금액 입력 2016
         * @param obj
         * @returns
         */
        function directInsertGc(obj) {
            clearPayTypeArea();
            calculateOrderAmt();

            var totStlmAmt = Number($("input[name='totStlmAmt']").val());
            var gcAmt = ufnToNum($(obj).val());

            if(totStlmAmt < 0) {
                //$(obj).val(gfn_appendComma(totStlmAmt + gcAmt));
                $(obj).val((totStlmAmt + gcAmt));
                if ((totStlmAmt + gcAmt) < 0) {
                    $(obj).val(0);
                }
            } else {
                //$(obj).val(gfn_appendComma(gcAmt));
                $(obj).val(gcAmt);
            }

            calculateOrderAmt();
            restoreLastPayType();
        }


        /**
         * 예치금 입력 2016
         * @param obj
         * 이주형 : onkeyup 때 발생시키지 않고 onblur때 발생하도록 변경
         */
        function directInsertDeposit(obj) {
            clearPayTypeArea();

            var useDeposit = ufnToNum($(obj).val()); // 입력한 예치금
            var deposit = $("#assetDeposit").val();

            // 임시로 사용할 예치금을 0으로 놓고 최종결제금액을 구함
            $(obj).val(0);
            calculateOrderAmt();
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());

            $(obj).val(useDeposit);

            // 넘치게 입력하면 제한
            if (useDeposit > totStlmAmt) {
                $(obj).val(totStlmAmt);
            }
            if (useDeposit > deposit) {
                if (totStlmAmt > deposit) {
                    $(obj).val(deposit);
                }
                else {
                    $(obj).val(totStlmAmt);
                }
            }

            calculateOrderAmt();
            restoreLastPayType();
        }



        /**
         * H.Point 입력 20170414 박승택 추가
         * @param obj
         */
        function directInsertUPoint(obj) {
            clearPayTypeArea();

            var useUPoint = ufnToNum($(obj).val()); // 입력한 포인트
            var uPoint = $("#assetUpoint").val(); // 보유포인트

            // 임시로 사용할 포인트를 0으로 놓고 최종결제금액을 구함
            $(obj).val(0);
            calculateOrderAmt();
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());

            $(obj).val(useUPoint);

            // 넘치게 입력하면 제한
            if (useUPoint > totStlmAmt) {
                $(obj).val(totStlmAmt);
            }
            if (useUPoint > uPoint) {
                if (totStlmAmt > uPoint) {
                    $(obj).val(uPoint);
                }
                else {
                    $(obj).val(totStlmAmt);
                }
            }

            if(String($(obj).val()).indexOf("P") == -1) {
                $(obj).val(gfn_appendComma($(obj).val()) + "P");
            }

            calculateOrderAmt();
            restoreLastPayType();
        }

        /**
         * 적립금 입력 2016
         * @param obj
         */
        function directInsertHPoint(obj) {
            clearPayTypeArea();

            var useHPoint = ufnToNum($(obj).val()); // 입력한 포인트
            var hPoint = $("#assetHpoint").val(); // 보유포인트

            // 임시로 사용할 포인트를 0으로 놓고 최종결제금액을 구함
            $(obj).val(0);
            calculateOrderAmt();
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());

            $(obj).val(useHPoint);

            // 넘치게 입력하면 제한
            if (useHPoint > totStlmAmt) {
                $(obj).val(totStlmAmt);
            }
            if (useHPoint > hPoint) {
                if (totStlmAmt > hPoint) {
                    $(obj).val(hPoint);
                }
                else {
                    $(obj).val(totStlmAmt);
                }
            }

            if(String($(obj).val()).indexOf("원") == -1) {
                $(obj).val(gfn_appendComma($(obj).val()) + "원");
            }

            calculateOrderAmt();
            restoreLastPayType();
        }

        /**
         * 적립금 사용금액 입력 후 포커스 아웃 됐을때 1,000포인트 미만 입력 여부 체크 2016
         * @param obj
         */
        function focusOutHPoint(obj) {
            directInsertHPoint(obj); // 2016 모바일이주형 onkeyup에서 처리하면 계산이 안맞으므로 blur시에만 처리

            var usePoint = ufnToNum($(obj).val());
            var hpntPrtyStlmYn = $('input[name="hpntPrtyStlmYn"]').val();
            //isEmpty(hpntPrtyStlmYn) -> hpntPrtyStlmYn!='Y'
            //조건 변경 박승택 20170519
            if(usePoint > 0 && usePoint < 1000){
                alert("적립금은 1,000원이상 사용가능합니다.");
                $(obj).val(0);
                calculateOrderAmt();
                //HPoint마케팅개선 kjh 20190219 H.Point 우선결제 적용으로 기존 적립금 우선결제 로직 삭제...
            }
        }


        /**
         * H.Point 사용금액 입력 후 포커스 아웃 됐을때 1,000포인트 미만 입력 여부 체크
         20170414 박승택 추가
         * @param obj
         */
        function focusOutUPoint(obj) {
            directInsertUPoint(obj); // 2016 모바일이주형 onkeyup에서 처리하면 계산이 안맞으므로 blur시에만 처리
            //HPoint마케팅개선 kjh 20190219 H.Point 우선결제 적용
            var hpntPrtyStlmYn = $('input[name="hpntPrtyStlmYn"]').val();
            var usePoint = ufnToNum($(obj).val());
            if(usePoint > 0 && usePoint < 100 && hpntPrtyStlmYn!= 'Y'){
                alert("H.Point는 100P 이상 사용가능합니다.");
                $(obj).val(0);
                calculateOrderAmt();
            }else if (usePoint >=0 && usePoint < 100 && (!isEmpty(hpntPrtyStlmYn)) && (hpntPrtyStlmYn=='Y')){ //H.Point 우선 결제 상품인 경우 강제로 1,000입력
                $(obj).val(1000);
                alert("H.Point 우선결제 상품입니다. 최소 H.Point 100P 이상 사용하셔야 합니다.");
                calculateOrderAmt();
            }
        }

        /////////////////////////////////////////////////////////
        //스크립트. 포인트 제어 끝
        ////////////////////////////////////////////////////////



        /////////////////////////////////////////////////////////
        //스크립트. 유틸 처리 시작
        ////////////////////////////////////////////////////////


        //사은품 팝업열기
        function openGiftLayerPup() {

            $('#content').hide();
            $('#giftSelection').show();
            $(window).scrollTop(0);
            $('footer').hide();
        }

        //사은품 팝업닫기
        function closeGiftLayerPup() {

            $('#content').show();
            $('#giftSelection').hide();
            $('footer').show();
        }



        //전화번호 체크
        function chkPhone(ddd, tel1, tel2, required, phoneGubun) {

            // TODO
            return true;
            if ((ddd.length == 0) && (tel1.length == 0) && (tel2.length == 0) && (required == "0")) {
                return true;
            }

            if (calculateByte(ddd) < 2 || calculateByte(ddd) > 4) {
                return false;
            } else if(calculateByte(tel1) < 2 || calculateByte(tel1) > 4) {
                return false;
            } else if(calculateByte(tel2) != 4) {
                return false;
            } else if (!onlyNum(ddd)) {
                return false;
            } else if (onlyNum(ddd)) {
                var dddFlag = true;
                var arr1 = new Array("02", "031", "032", "033", "041", "042", "043", "051", "052", "053", "054", "055", "061", "062", "063", "064", "070");
                var arr2 = new Array("010", "011","016", "017", "018", "019", "0130");
                var arr = arr1.concat(arr2);

                for(var i=0; i<arr.length; i++) {
                    if(ddd != arr[i]) {
                        dddFlag = false;
                    } else {
                        dddFlag = true;
                        break;
                    }
                }

                if(!dddFlag) {
                    return false;
                } else {
                    return true;
                }
            } else if (!onlyNum(tel1)) {
                return false;
            } else if (!onlyNum(tel2)) {
                return false;
            } else {
                return true;
            }
        }



        /**
         * 입력한 문자열의 바이트를 계산한다.
         * @param obj
         * @param limitByte
         */
        function checkBytes(obj, limitByte, isMulti) {

            $obj = $(obj);
            var inputStr = $obj.val();

            var iByteLength = 0;
            for (var i = 0; i < inputStr.length; i++) {
                var sChar = escape(inputStr.charAt(i));
                iByteLength += calculateByte(sChar);

                if(iByteLength > limitByte){
                    alert('최대 '+limitByte+'Byte 까지 입력가능합니다.');
                    $obj.val(inputStr.substring(0, i));
                    iByteLength = iByteLength - calculateByte(escape(inputStr.charAt(i)));

                    break;
                }
            }
            if (obj.name == "mmsMsgTitl" || obj.name == "mmsMsgCntn" || obj.name == "mmsMsgCntnMulti" || obj.name == "mmsMsgCntnPwd" || obj.name == "prsnMsg" || obj.name == "dsrvCoMsg") {  //20180625_공동현관비밀번호추가조유진
                //$obj.next().find("span.text_count").text(iByteLength);
                $obj.siblings(".input-cnt").find(".text_count").text(iByteLength);
            }

            if(isEmpty(isMulti)) {
                $("select[name=mmsMsgCntnSelect] option:eq(0)").attr("selected", false);
            } else {
                $(obj).parents("li").find("select[name=mmsMsgCntn] option:eq(0)").attr("selected", false);
            }
            //$(obj).next().find("span.text_count").text(iByteLength);
        }


        function checkHopeDt(obj){
            var dlvHopeDt = $(obj).val();

            if(dlvHopeDt < getToday()){
                alertMsg("오늘 이후의 날짜를 선택하셔야 합니다.");
                $(obj).val("");
                return false;
            }

            if (!isEmpty($(obj).attr("hopeDtPlusDay"))) {
                if(dlvHopeDt < getToday(Number($(obj).attr("hopeDtPlusDay")))){
                    alertMsg(getToday(Number($(obj).attr("hopeDtPlusDay")))+ " 이후의 날짜를 선택하셔야 합니다.");
                    $(obj).val("");
                    return false;
                }
            }


            if(getDt3(getToday(),1) < dlvHopeDt.replace('-', '').replace('-', '')){
                alertMsg("금일부터 한달이후 사이의 날짜를 선택하셔야 합니다.");
                $(obj).val("");
                return false;
            }

            if (!isEmpty($(obj).attr("venCd"))) {
                if($(obj).attr("venCd") == "012959" || $(obj).attr("venCd") == "006115"){
                    var itemCd = $(obj).attr("venItemCd");
                    $.ajax({
                        type:"post",
                        dataType: "json",
                        data : {itemCd : itemCd},
                        url:"/m/pda/getLGElecHolidayList.do",
                        async:false,
                        dataType:"json",
                        success:function(data) {
                            var tempHopeDt = dlvHopeDt.replace(/-/g,"");
                            if(data[tempHopeDt] != null) {
                                alert("해당 일자는 배송이 불가한 날짜입니다. 다른 날짜를 선택해주세요.");
                                return false;
                            }
                        }
                        , error: function(data){

                        }
                    });

                }
            }

        }

        function getDt3(s,i){
            newDt = new Date(s);
            newDt.setMonth( newDt.getMonth() + i );
            return converDateString(newDt);
        }


        function converDateString(dt){
            return newDt.getFullYear() + addZero(eval(newDt.getMonth()+1)) + addZero(newDt.getDate());
        }


        function addZero(i){
            var rtn = i + 100;
            return rtn.toString().substring(1,3);
        }

        function fillZeros(n, digits) {
            var zero = '';
            n = n.toString();

            if (n.length < digits) {
                for (i = 0; i < digits - n.length; i++)
                    zero += '0';
            }
            return zero + n;
        }
        function getToday(addDay) {
            var d = new Date();

            if (!isEmpty(addDay)) {
                d.setDate(d.getDate() + addDay);
            }
            var s = fillZeros(d.getFullYear(), 4) + '-' +
                fillZeros(d.getMonth() + 1, 2) + '-' +
                fillZeros(d.getDate(), 2);

            return s;
        }

        /////////////////////////////////////////////////////////
        //스크립트. 유틸 처리 끝
        ////////////////////////////////////////////////////////

        /////////////////////////////////////////////////////////
        //스크립트. 배송 처리 시작
        ////////////////////////////////////////////////////////

        /*
* 여러명에게 배송선택시
*/
        function selectChangeMultiDlv(obj) {

            var dlvCostExstYn = $("input[name='dlvCostExstYn']").val();
            if(dlvCostExstYn == "Y") {
                alert("죄송합니다.\n1개당 판매가가 무료배송기준금액 미만인 상품이 있을 경우, 여러곳으로 배송이 불가능합니다.");
                return false;
            }

            // 기본배송지중 1번째것 제외하고 삭제
            $("#domestic h5:gt(0)").remove();
            $("#domestic ul.dlvTab:gt(0)").remove();
            $("#domestic div.tabCon:gt(0)").remove();

            var cnt = obj.value;
            for (var i=1; i < cnt; i++) {
                $("#domestic").append($('<h5 class="ds_none"><span>'+(i+1)+'</span>번째 배송지</h5>'));
                $("#domestic").append($("#domestic ul.dlvTab:eq(0)").clone(true, true));
                $("#domestic").append($("#domestic div.tabCon:eq(0)").clone(true, true));
            }

            $("#domestic ul.dlvTab").each(function (idx) {
                if (idx > 0) {
                    $(this).find("a:eq(2)").click();
                }
            });
            $("#domestic div.tabCon:gt(0)").find("input[type=number]").inputNumber();
        };

        // 여러배송지 선택에서 상품 개수 선택시 2016
        function mulitDlvItemChange(obj) {
            $obj = $(obj);
            var slitmCd = $obj.parent().find("input[name=slitmCd]").val();
            var uitmCd = $obj.parent().find("input[name=uitmCd]").val();
            var aspItemCd = $obj.parent().find("input[name=aspItemCd]").val();
            var targetItem = slitmCd + "|" + uitmCd + "|" + aspItemCd;

            var targetQty = 0;
            var totOrdQty = 0;

            $("#domestic li[name='domesticDstnLi']").find("li").each(function () {
                slitmCd = $(this).find("input[name=slitmCd]").val();
                uitmCd = $(this).find("input[name=uitmCd]").val();
                aspItemCd = $(this).find("input[name=aspItemCd]").val();
                itemQty = Number($(this).find("select[name=ordQty]").val());

                var curItem = slitmCd + "|" + uitmCd + "|" + aspItemCd;
                if (targetItem == curItem) {
                    targetQty += itemQty;
                }
            });

            // 상품단위로 loop
            $("#slitmInfDiv span").each(function() {
                var obj = $(this);
                var slitmCd = obj.data("slitmCd");
                var uitmCd = obj.data("uitmCd");
                var aspItemCd = obj.data("aspItemCd");
                var ordQty = Number(obj.data("ordQty"));

                var curItem = slitmCd + "|" + uitmCd + "|" + aspItemCd;
                if (targetItem == curItem) {
                    totOrdQty = ordQty;
                    return false;
                }
            });

            if (targetQty > totOrdQty) {
                alertMsg("주문수량보다 선택한 수량이 더 많습니다.");
                $obj.find("option:first").prop("selected", true);
                //$($obj).parents("li").find("input[name=depth3ErrorCode]").val(0);
            } else {
                $obj.parents("li").find("input[name=depth3ErrorCode]").val(0);
            }
        }


        //이전배송지 선택 클릭시 2016
        function preDlvChoice(obj, multiIndex) {

            var $li = $(obj);

            if($li.find("input[name=dstnPostNoPrv]").val().length > 5){
                if (confirm("선택하신 배송지는 변경된 우편번호(5자리)로 다시 입력하셔야 합니다. 주소 검색을 진행하시겠습니까?")) {
                    $li.find("#updateAddress").click();
                }
                return;
            }

            var dstnBaseAdr = $li.find("input[name=dstnBaseAdrPrv]").val();
            if(dstnBaseAdr.indexOf("오정구") > -1 || dstnBaseAdr.indexOf("원미구") > -1 || dstnBaseAdr.indexOf("소사구") > -1) {
                alert("부천시의 오정구, 원미구, 소사구는 폐지된 주소 입니다.\n새로 주소지를 검색하여 사용하여 주세요.");
                return;
            }

            if (multiIndex != undefined && multiIndex != 0) {
                var dlvNoMsg = checkNoDlvArea($li.find("input[name=apocGbcdPrv]").val());
                if(!isEmpty(dlvNoMsg)) {
                    alert(dlvNoMsg);
                    return;
                }
            }

            var dstncustNo = $li.find("input[name=dstncustNo]").val();
            var dstnSeq = $li.find("input[name=dstnSeq]").val();
            var baseYn = $li.find("input[name=dstnBaseYn]").val();
            var rcvCustNm = $li.find("input[name=rcvCustNmPrv]").val();
            var dstnPostNoPrv = $li.find("input[name=dstnPostNoPrv]").val();
            var dstnBaseAdrPrv = $li.find("input[name=dstnBaseAdrPrv]").val();
            var dstnPtcAdrPrv = $li.find("input[name=dstnPtcAdrPrv]").val();
            var dstnHpIdntNoPrv = $li.find("input[name=dstnHpIdntNoPrv]").val();
            var dstnHpIntmNoPrv = $li.find("input[name=dstnHpIntmNoPrv]").val();
            var dstnHpBckNoPrv = $li.find("input[name=dstnHpBckNoPrv]").val();
            var dstnTelaPrv = $li.find("input[name=dstnTelaPrv]").val();
            var dstnTelsPrv = $li.find("input[name=dstnTelsPrv]").val();
            var dstnTeliPrv = $li.find("input[name=dstnTeliPrv]").val();
            var adrKndGbcdPrv = $li.find("input[name=adrKndGbcdPrv]").val();
            var apocGbcd = $li.find("input[name=apocGbcdPrv]").val();
            var reUseYn = $li.find("input[name=reUseYn]").val();

            var adr = "("+dstnPostNoPrv+")" + dstnBaseAdrPrv + dstnPtcAdrPrv;
            var hp = dstnHpIdntNoPrv + "-" + dstnHpIntmNoPrv + "-" + dstnHpBckNoPrv;
            var tel;

            if(dstnTelaPrv.length > 0 && dstnTelsPrv.length > 0 && dstnTeliPrv.length > 0) {
                tel = dstnTelaPrv + "-" + dstnTelsPrv + "-" + dstnTeliPrv;
            }

            // 추가배송비 조회
            //var rst = getAddDlvcAmtByDlvcoArea(dstnPostNoPrv, multiIndex);
            //if (rst == "noMulti") {
            //    return;
            //}
            // 2020.08.11  추가배송비 선결제 기존 도서지역 추가배송비는 여러곳으로 배송 불가능 
            if (multiIndex != undefined && multiIndex != 0) {                
            }else {
                nowApocGbcd = $li.find("input[name=apocGbcdPrv]").val();
                $("#multi_false input[name=irgnAreaGbcd]").val("");
            }
            
            getIrgnAreaGbcd(dstnPostNoPrv, multiIndex);

            // 단일배송지 그리기
            //drawSingleAddressInfo(baseYn, rcvCustNm, adr, hp, tel, dstncustNo, dstnSeq, multiIndex, baseYn, dstnPostNoPrv, dstnBaseAdrPrv, dstnPtcAdrPrv, dstnHpIdntNoPrv, dstnHpIntmNoPrv, dstnHpBckNoPrv, dstnTelaPrv, dstnTelsPrv, dstnTeliPrv, adrKndGbcdPrv);
            drawSingleAddressInfo(baseYn, rcvCustNm, adr, hp, tel, dstncustNo, dstnSeq, multiIndex, baseYn, dstnPostNoPrv, dstnBaseAdrPrv, dstnPtcAdrPrv, dstnHpIdntNoPrv, dstnHpIntmNoPrv, dstnHpBckNoPrv, dstnTelaPrv, dstnTelsPrv, dstnTeliPrv, adrKndGbcdPrv, glIrgnAreaGbcd, apocGbcd);
            
            // 데이터 세팅
            if (multiIndex != undefined && multiIndex != 0) {

            }
            else {
                $("#multi_false input[name=dstnSeq]").val(dstnSeq);
                $("#multi_false input[name=baseYn]").val(baseYn);
                $("#multi_false input[name=rcvCustNm]").val(rcvCustNm);
                $("#multi_false input[name=dstnPostNo]").val(dstnPostNoPrv);
                $("#multi_false input[name=dstnBaseAdr]").val(dstnBaseAdrPrv);
                $("#multi_false input[name=dstnPtcAdr]").val(dstnPtcAdrPrv);
                $("#multi_false input[name=dstnHpIdntNo]").val(dstnHpIdntNoPrv);
                $("#multi_false input[name=dstnHpIntmNo]").val(dstnHpIntmNoPrv);
                $("#multi_false input[name=dstnHpBckNo]").val(dstnHpBckNoPrv);
                $("#multi_false input[name=dstnTela]").val(dstnTelaPrv);
                $("#multi_false input[name=dstnTels]").val(dstnTelsPrv);
                $("#multi_false input[name=dstnTeli]").val(dstnTeliPrv);
                $("#multi_false input[name=adrKndGbcd]").val(adrKndGbcdPrv);
                
                // 주문자수령인상이시알림.
                checkRcvp();
            }

            if($("#multi_false input[name=notAdrYn]").val() == "Y") {
                $("#multi_false input[name=notAdrYn]").val("");
                $("#multi_false").removeClass("cont3");
                $("#notAdrY").hide();
                $("#notAdrN").show();
            }

            if($("input[name='dlvAdrSaveYn']") != null){
                if(reUseYn == 'Y' || baseYn == 'Y' || $("#multi").prop("checked")){
                    $("input[name='dlvAdrSaveYn']").prop("checked", true);
                    $("input[name='dlvAdrSaveYn']").prop("disabled", true);
                    $("#dlvAdrSaveDiv").hide();
                }else{
                    $("input[name='dlvAdrSaveYn']").prop("checked", false);
                    $("input[name='dlvAdrSaveYn']").prop("disabled", false);
                    $("#dlvAdrSaveDiv").show();
                }
            }                       

            // 이전배송지목록에서 나감
            backStateLayerPopup();
			
        }

        // 단일배송지 html 그리기 2016
        // ex) drawSingleAddressInfo("Y", "홍길동", "서울시 강동구 길동...", "010-1234-1234", "02-123-1234");
        // 2020.08.11  추가배송비 선결제  수정 
        function drawSingleAddressInfo(baseYn, rcvCustNm, adr, hp, tel, dstncustNo, dstnSeq, multiIndex, baseYn, dstnPostNoPrv, dstnBaseAdrPrv, dstnPtcAdrPrv, dstnHpIdntNoPrv, dstnHpIntmNoPrv, dstnHpBckNoPrv, dstnTelaPrv, dstnTelsPrv, dstnTeliPrv, adrKndGbcdPrv, irgnAreaGbcd, apocGbcd) {
            if(multiIndex != undefined && multiIndex != 0) {
                if(multiIndex == 1) {
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstncustNo]").val(dstncustNo);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnSeq]").val(dstnSeq);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=baseYn]").val(baseYn);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=rcvCustNm]").val(rcvCustNm);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnPostNo]").val(dstnPostNoPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnBaseAdr]").val(dstnBaseAdrPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnPtcAdr]").val(dstnPtcAdrPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnHpIdntNo]").val(dstnHpIdntNoPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnHpIntmNo]").val(dstnHpIntmNoPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnHpBckNo]").val(dstnHpBckNoPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnTela]").val(dstnTelaPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnTels]").val(dstnTelsPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnTeli]").val(dstnTeliPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=adrKndGbcd]").val(adrKndGbcdPrv);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=irgnAreaGbcd]").val(irgnAreaGbcd);
                    $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=apocGbcd]").val(apocGbcd);

                    $("#domestic").find("input[name=depth3_address_chg_1]").val("Y");
                } else {
                    if(isEmpty($("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstncustNo]").attr("name"))) {
                        var inputhtml = "<input type='hidden' name='dstncustNo' value='"+ dstncustNo +"'/>"
                            + "<input type='hidden' name='dstnSeq' value='"+ dstnSeq +"'/>"
                            + "<input type='hidden' name='baseYn' value='"+ baseYn +"'/>"
                            + "<input type='hidden' name='rcvCustNm' value='"+ rcvCustNm +"'/>"
                            + "<input type='hidden' name='dstnPostNo' value='"+ dstnPostNoPrv +"'/>"
                            + "<input type='hidden' name='dstnBaseAdr' value='"+ dstnBaseAdrPrv +"'/>"
                            + "<input type='hidden' name='dstnPtcAdr' value='"+ dstnPtcAdrPrv +"'/>"
                            + "<input type='hidden' name='dstnHpIdntNo' value='"+ dstnHpIdntNoPrv +"'/>"
                            + "<input type='hidden' name='dstnHpIntmNo' value='"+ dstnHpIntmNoPrv +"'/>"
                            + "<input type='hidden' name='dstnHpBckNo' value='"+ dstnHpBckNoPrv +"'/>"
                            + "<input type='hidden' name='dstnTela' value='"+ dstnTelaPrv +"'/>"
                            + "<input type='hidden' name='dstnTels' value='"+ dstnTelsPrv +"'/>"
                            + "<input type='hidden' name='dstnTeli' value='"+ dstnTeliPrv +"'/>"
                            + "<input type='hidden' name='adrKndGbcd' value='"+ adrKndGbcdPrv +"'/>"
                            + "<input type='hidden' name='apocGbcd' value='"+ apocGbcd +"'/>"
                            + "<input type='hidden' name='irgnAreaGbcd' value=''/>"; // 2020.08.11 추가배송비 선결제 추가

                        $("#addressInfoBaseYn_" + multiIndex).parents("a").append(inputhtml);
                    } else {
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstncustNo]").val(dstncustNo);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnSeq]").val(dstnSeq);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=baseYn]").val(baseYn);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=rcvCustNm]").val(rcvCustNm);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnPostNo]").val(dstnPostNoPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnBaseAdr]").val(dstnBaseAdrPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnPtcAdr]").val(dstnPtcAdrPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnHpIdntNo]").val(dstnHpIdntNoPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnHpIntmNo]").val(dstnHpIntmNoPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnHpBckNo]").val(dstnHpBckNoPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnTela]").val(dstnTelaPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnTels]").val(dstnTelsPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=dstnTeli]").val(dstnTeliPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=adrKndGbcd]").val(adrKndGbcdPrv);
                        $("#addressInfoBaseYn_" + multiIndex).parents("a").find("input[name=apocGbcd]").val(apocGbcd);

                        $("#domestic").find("input[name=depth3_address_chg_"+ multiIndex +"]").val("Y");
                    }
                }

                if (baseYn == "Y") {
                	$("#addressInfoBaseYn_" + multiIndex).html("배송지 "+multiIndex+" 기본배송지");
                	$("#setBaseDstn").remove();
                } else {
                	$("#addressInfoBaseYn_" + multiIndex).html("배송지 "+multiIndex);
                	//$("a#multi_false" + multiIndex).after("<span id='baseDstnYn'><input type='checkbox' name='baseDstnYn' value='Y'/>기본배송지 설정</span>");
                    var halfDlvYn = 'N';
                    if(halfDlvYn != "Y"){
                    	$("#setBaseDstn").remove();
                        $("a#multi_false").after("<div class='row-wrap' id='setBaseDstn'><span class='row-title'><input type='checkbox' id='set-default' name='baseDstnYn' onclick='baseDstnYnClick(this);' value='Y'> <label for='set-default'> 기본배송지</label></span></div>");
                    }
                }
                if (rcvCustNm != undefined) $("#addressInfoCustNm_" + multiIndex).html(rcvCustNm);
                else $("#addressInfoCustNm_" + multiIndex).html("");
                if (adr != undefined) $("#addressInfoPtcAdr_" + multiIndex).html(adr);
                else $("#addressInfoPtcAdr_" + multiIndex).html("");
                if (hp != undefined) $("#addressInfoHpIdntNo_" + multiIndex).html(hp);
                else $("#addressInfoHpIdntNo_" + multiIndex).html("");
                if (tel != undefined) $("#addressInfoDstnTela_" + multiIndex).html(tel);
                else $("#addressInfoDstnTela_" + multiIndex).html("");
            }
            else {
                $("#addressInfoBaseYn").empty().hide();
                if (baseYn == "Y") { 
                	$("#addressInfoBaseYn").text("기본배송지").show();
                	$("#baseDstnSet").remove();
                	$("#setBaseDstn").remove();
                } else {
                	$("#baseDstnSet").remove();
                	//$("a#multi_false").after("<span id='baseDstnYn'><input type='checkbox' name='baseDstnYn' value='Y'/>기본배송지 설정</span>");
                	$("#setBaseDstn").remove();
                    $("a#multi_false").after("<div class='row-wrap' id='setBaseDstn'><span class='row-title'><input type='checkbox' id='set-default' name='baseDstnYn' onclick='baseDstnYnClick(this);' value='Y'> <label for='set-default'> 기본배송지</label></span></div>");
                }
                if (rcvCustNm != undefined) $("#addressInfoCustNm").html(rcvCustNm);
                else $("#addressInfoCustNm").html("");
                if (adr != undefined) $("#addressInfoPtcAdr").html(adr);
                else $("#addressInfoPtcAdr").html("");
                if (hp != undefined) $("#addressInfoHpIdntNo").html(hp);
                else $("#addressInfoHpIdntNo").html("");
                if (tel != undefined) $("#addressInfoDstnTela").html(tel);
                else $("#addressInfoDstnTela").html("");
            }
            
        }
        
        function reDrawSlick() {
            setTimeout(function() {
                $(".giftMultiDlvArea div[name=mobileDlv]").find(".gift-card-list").slick('setPosition');
            }, 100);
        }

      //복수 배송지 선택시 이벤트 2016
        function changeMultiAddress(obj, orderItemTotCount, maxMuliDlvCnt) {
            
    	    var cnt = 2;
    	    if(obj != null)	{
    	    	cnt = $(obj).find("option:selected").val();
    	    }
    	    	

                        
            if(cnt == 1)
            {
                 $(".shipping-step-1").find("input[name=multiCnt]").val(cnt);
            }
            else
            {
                                            
		        //에러코드 초기화
		        $("#domestic li[name='domesticDstnLi']").each(function () {
		                $(this).find("input[name=depth3ErrorCode]").val(0);
		                
		        });
		
		            // 선물하기 다중배송 추가  2020.07 김지영
		            var giftOrderYn = $("input[name='giftOrderYn']").val();
		            if( giftOrderYn=="Y"){
		 
		                $(".shipping-step-1").find("input[name=multiCnt]").val(cnt);
		                
		                // 원래 배송지 갯수
		                var orgCnt = $(".giftMultiDlvArea div[name=mobileDlv]").length;
		                var diffCnt = cnt - orgCnt;
		             
		                
		                // +면 추가로 그리고 -면 마지막꺼부터 삭제
		                if (diffCnt > 0) {
		                    for (var i = 0; i < diffCnt; i++) {
		                        $(".giftMultiDlvArea").append($(".giftMultiDlvAreaTmpl").clone(true, true));
		                        $(".giftMultiDlvArea div[name=mobileDlv]:last").show();
		                        $(".giftMultiDlvArea div[name=mobileDlv]:last").removeClass("giftMultiDlvAreaTmpl");
		                        
		                        var arrImgDesc = new Array();
		                        //메세지카드 메세지명 배열
		                        $(".giftMultiDlvArea div[name=mobileDlv]:last .gift-card-list li").each(function(){
		                            arrImgDesc.push($(this).attr("imgdesc"));   
		                        });
		                        
		                        /*
		                        $(".giftMultiDlvArea div[name=mobileDlv]:last .gift-card-list").slick({
		                            infinite: false,
		                            arrows: false,
		                            dots: true
		                        });
		                        */
		                        
		                        $(".giftMultiDlvArea div[name=mobileDlv]:last .gift-card-list").show();
		                        
		                        $(".giftMultiDlvArea div[name=mobileDlv]:last .gift-card-list").on('afterChange',function(event, slick, currentSlide){
		                            var dataId = $(this).find('.slick-current').attr('aria-describedby');
		                            var $current = $("[aria-describedby='"+dataId+"']");
		                            
		                            var activeImgNm = $current.attr("imgnm");
		                            var activeImgDesc = $current.attr("imgdesc");
		                            
		                            $current.parent().parent().parent().parent().find("input[name=prsnMsgCrdImgNm]").val(activeImgNm);
		                            var currentMmsMsg1 = $current.parent().parent().parent().parent().find("textarea[name=mmsMsgCntn]").val();
		                            var chk1 =false;
		                            $.each(arrImgDesc,function(key,value){
		                                if(currentMmsMsg1 == value){chk1 = true;}
		                            });
		                            if(chk1){
		                                $current.parent().parent().parent().parent().find("textarea[name=mmsMsgCntn]").val(activeImgDesc);
		                                $current.parent().parent().parent().parent().find("textarea[name=mmsMsgCntn]").text(activeImgDesc);
		                            }
		                       });
		                    }
		                    
		                      $(".giftMultiDlvArea div[name=mobileDlv]").find(".mobliePhoneAddList").each(function(idx){
		                           $(this).val(idx+1); 
		                    });
		                        
		                }
		     
		                else if (diffCnt < 0) {
		                    diffCnt = diffCnt * -1;
		    
		                    for (var i = 0; i < diffCnt; i++) {
		                                        
		                                            if($(".giftMultiDlvArea div[name=mobileDlv]").length > 1)
		                                            {
		                        $(".giftMultiDlvArea div[name=mobileDlv]:last").remove();
		                        $(".giftmobileDepth3 li[name=domesticDstnLi]:last").remove();
		                    }
		                }
		                                    }
		                
		                
		       
		                
		            }else{
		        
		                $(".shipping-step-1").find("input[name=multiCnt]").val(cnt);
		                $(".shipping-step-2 .addr-list li:gt(0)").remove();
		                $(".multiaddress_depth3 dl:gt(0)").remove();
		
		                for(var i=1; i < cnt; i++) {
		                    var idIndex = i+1;
		
		                    var innerHtml = "";
		                    innerHtml += "<li>";
		                    innerHtml += "   <a class='addr-area btn-input-multi-addr' id='multiaddress_depth2_a"+idIndex+"' onclick='goAddrList(this)'>";
		                    innerHtml += "       <input type='hidden' name='multiIndex' value='"+idIndex+"'>";
		                    innerHtml += "       <div class='name'>";
		                    innerHtml += "          <strong class='txt-orange' id='addressInfoBaseYn_"+idIndex+"'>배송지"+idIndex+"</strong>";
		                    innerHtml += "          <span id='addressInfoCustNm_"+idIndex+"'></span>";
		                    innerHtml += "       </div>";
		                    innerHtml += "       <div class='addr' id='addressInfoPtcAdr_"+idIndex+"'>"+idIndex+"번 배송지를 선택해주세요.</div>";
		                    innerHtml += "       <div class='phone-number' id='addressInfoHpIdntNo_"+idIndex+"'></div>";
		                    innerHtml += "       <div class='phone-number' id='addressInfoDstnTela_"+idIndex+"'></div>";
		                    innerHtml += "   </a>";
		                    innerHtml += "</li>";
		
		                    $(".shipping-step-2 .addr-list").append(innerHtml);
		                }
		            }
	        }
        }

        // 이전주소 가져오기 2016
        function getPreAddress(obj){
            isBack = true;
            history.pushState(null, null, location.href);
            var dstnSeq = $(obj).find("input[name='dstnSeq']").val();
            var multiIndex = $(obj).find("input[name='multiIndex']").val();

            if(isEmpty(multiIndex)) multiIndex = 0;

            $.ajax({
                type: "get"
                , url: "/m/selectDstnAdrList.do"
                ,data: {
                    'dstnSeq':dstnSeq,
                    'multiIndex':multiIndex
                }
                , dataType: "html"
                , success : function(data) {
                    $(".popup_sublayer.address.nobtn").html("");
                    $(".popup_sublayer.address.nobtn").append(data);
                }
                , error: function(data) {
                    alert(data);
                }
                , complete: function(jqXHR,textStatus ){
                }
            });
        }

        // 배송불가지역 체크 2016
        function checkNoDlvArea(apocGbcd) {
            var dlvNoMsg = "";
            $("#slitmInfDiv span").each(function(index, element) {
                var itemDlvNdmtDtlList = isEmpty($(this).data("itemDlvNdmtDtlList")) ? new Array() : $(this).data("itemDlvNdmtDtlList");
                for(var i = 0; i < itemDlvNdmtDtlList.length; i++) {
                    var dlvNdmtDtl = itemDlvNdmtDtlList[i];
                    if(dlvNdmtDtl.cd == apocGbcd) {
                        dlvNoMsg += (index + 1) + "번째 상품이 " + dlvNdmtDtl.cdNm + "지역으로  배송이 불가능한 상품입니다.\n해당 상품은 다른 배송지를 지정해주세요.";
                    }
                }
            });
            return dlvNoMsg;
        }

        // 배송메모 직접입력 선택시 2016
        // 2017.10.19 최연태 다중배송지 기획변경
        function changeDlvMemoSelect(obj) {
            if(obj.value == "직접입력(저장됩니다)") {
            	$(obj).next().find("textarea[name=mmsMsgCntn]").val("");
            	$(obj).next().find("textarea[name=mmsMsgCntn]").trigger("keyup");
                //checkBytes($(obj).next().find("textarea[name=mmsMsgCntn]"), 100);
                $(obj).parent().find("input[name=dsrvCoMsgInfCustInsrYn]").val("Y");
            } else {
                $(obj).next().find("textarea[name=mmsMsgCntn]").val(String(obj.value).replace("[MY]", ""));
                $(obj).next().find("textarea[name=mmsMsgCntn]").trigger("keyup");
                //checkBytes($(obj).next().find("textarea[name=mmsMsgCntn]"), 100);
                $(obj).parent().find("input[name=dsrvCoMsgInfCustInsrYn]").val("N");
            }
        }

        //배송메모 직접입력 선택시 2016 - 모바일이주형 멀티배송용 추가
        //2017.10.19 최연태 다중배송지 기획변경
        function changeDlvMemoSelectMulti(obj) {
            if (obj.value == "5") {
                $(obj).next().find("textarea[name=mmsMsgCntnMulti]").val("");
                $(obj).next().next().val("Y");
            } else {
                $(obj).next().find("textarea[name=mmsMsgCntnMulti]").val(String($(obj).find("option:selected").html()).replace("[MY]", ""));
                $(obj).next().next().val("N");
            }
        }

        //배송지 저장 2016
        function saveDstnAddr(updatAddrYn) {

            var idNm = "newaddress_wrap";
            if(updatAddrYn == "Y"){
                idNm = "updateAddress_wrap";
            }

            var dstnNknm =  $("#"+idNm).find("input[name=dstnNknm]").val();
            var rcvCustNm =  $("#"+idNm).find("input[name=rcvCustNm]").val();
            var dstnPostNo =  $("#"+idNm).find("input[name=dstnPostNo]").val();
            var dstnBaseAdr =  $("#"+idNm).find("input[name=dstnBaseAdr]").val();
            var dstnPtcAdr =  $("#"+idNm).find("input[name=dstnPtcAdr]").val();
            var dstnHpIdntNo =  $("#"+idNm).find("select[name=dstnHpIdntNo]").val();
            var dstnHpIntmNo =  $("#"+idNm).find("input[name=dstnHpIntmNo]").val();
            var dstnHpBckNo;
            var dstnTela =  $("#"+idNm).find("select[name=dstnTela]").val();
            var dstnTels =  $("#"+idNm).find("input[name=dstnTels]").val();
            var dstnTeli;
            var adrKndGbcd =  $("#"+idNm).find("input[name=adrKndGbcd]").val();
            var custNo =  $("#"+idNm).find("input[name=dstncustNo]").val();
            var dstnSeq =  $("#"+idNm).find("input[name=dstnSeq]").val();

            var baseYn = $("#"+idNm).find("input[name=baseYn]").prop("checked");
            if (baseYn) baseYn = "Y";
            else baseYn = "N";

            var updateYn = $("#"+idNm).find("input[name=updateYn]").val();

            if(isEmpty(rcvCustNm)){
                alert("받으실 분을 입력해 주세요.");
                return false;
            }
            if(isEmpty(dstnNknm)){
                if(rcvCustNm.length > 10){
                    dstnNknm = rcvCustNm.substring(0,9);    
                }else{           
                dstnNknm = rcvCustNm;
                }
            }
            if(isEmpty(dstnBaseAdr) || isEmpty(dstnPostNo)){
                alert("'우편번호 찾기' 버튼을 클릭하여 주소를 입력해 주세요.");
                return false;
            }

            if(isEmpty(dstnHpIdntNo)) {
                alert("휴대폰번호 앞자리를 선택해주세요.");
                return false;
            }

            /* 단일 폰번호 입력폼 처리 */
            if (dstnHpIntmNo.length != 8 && dstnHpIntmNo.length != 7) {
                alert("휴대폰번호를 정확하게 입력해주세요.");
                return false;
            }
            else {
                if (dstnHpIntmNo.length == 8) {
                    dstnHpBckNo = dstnHpIntmNo.substring(4, 8);
                    dstnHpIntmNo = dstnHpIntmNo.substring(0, 4);
                }
                else {
                    dstnHpBckNo = dstnHpIntmNo.substring(3, 7);
                    dstnHpIntmNo = dstnHpIntmNo.substring(0, 3);
                }
            }
            if (dstnTels.length != 8 && dstnTels.length != 7) {
                // 일반전화는 필수아님
                dstnTela = "";
                dstnTels = "";
                dstnTeli = "";
            }
            else {
                if (dstnTels.length == 8) {
                    dstnTeli = dstnTels.substring(4, 8);
                    dstnTels = dstnTels.substring(0, 4);
                }
                else {
                    dstnTeli = dstnTels.substring(3, 7);
                    dstnTels = dstnTels.substring(0, 3);
                }
            }
            /* 단일 폰번호 입력폼 처리 끝 */

            if(isEmpty(dstnPtcAdr)){
                alert("'배송지 상세주소'를 입력해주세요.");
                return false;
            }

            var isInsert = true;
            if(!isEmpty(dstnSeq)) {
                var isBaseChg = ufnAdrDup(custNo, dstnSeq, dstnNknm, rcvCustNm, dstnBaseAdr, dstnPtcAdr, dstnHpIdntNo, dstnHpIntmNo, dstnHpBckNo, dstnTela, dstnTels, dstnTeli, adrKndGbcd, dstnPostNo, baseYn);

                if(isBaseChg) {
                    isInsert = false;
                }
            }

            if(isInsert) {
                $.ajax({
                    type: "post"
                    , url: "/m/insertDstnAdrOrder.do"
                    ,data: {
                        'dstnNknm' : dstnNknm
                        ,'rcvCustNm' : rcvCustNm
                        ,'postNo1' : dstnPostNo
                        ,'dstnBaseAdr' : dstnBaseAdr
                        ,'dstnPtcAdr' : dstnPtcAdr
                        ,'dstnHpIdntNo' : dstnHpIdntNo
                        ,'dstnHpIntmNo' : dstnHpIntmNo
                        ,'dstnHpBckNo' : dstnHpBckNo
                        ,'dstnTela' : dstnTela
                        ,'dstnTels' : dstnTels
                        ,'dstnTeli' : dstnTeli
                        ,'adrKndGbcd' : adrKndGbcd
                        ,'dstnPostNo' : dstnPostNo
                        ,'baseYn' : baseYn
                        ,'dstnSeq' : dstnSeq
                        ,'updateYn' : updateYn
                        ,'custNo':custNo
                    }
                    , dataType: "html"
                    , success : function(data) {
                        var addrListCallId = $("#addrListCallId").val();
                        if ( addrListCallId == "" ) addrListCallId = "multi_false"; 
                        goAddrList($("#"+addrListCallId));

                        dlvAddInfoReset();
                        $(".btn-addr-list").click();

                        if(updatAddrYn == "Y"){
                            backStateLayerPopup();
                        }
                    }
                    , error: function(data) {
                        alert("일시적 오류로 배송지 저장을 실패했습니다.\n잠시후 다시 시도해 주시기 바랍니다.");
                    }
                });
            } else {
                $.ajax({
                    type: "post"
                    , url: "/m/updatedefAddress.do"
                    ,data: {
                        'custNo':custNo,
                        'dstnSeq':dstnSeq
                    }
                    , dataType: 'json'
                    , success : function(data) {
                        var addrListCallId = $("#addrListCallId").val();
                        goAddrList($("#"+addrListCallId));

                        dlvAddInfoReset();
                        $(".btn-addr-list").click();

                        if(updatAddrYn == "Y"){
                            backStateLayerPopup();
                        }
                    }
                    ,error: function(xhr, status, error) {
                        console.log(error);
                    }
                });
            }
        }


        /*
 * 모바일 상품권 여러명에게 배송선택시
 */
        function selectChangeMultiMobile(obj) {

            // 기본배송지중 1번째것 제외하고 삭제
            $("#mobileDlvArea div[name=mobileDlv]:gt(0)").remove();

            $("#mobileDlvArea div[name=mobileDlv] input[name=mmsMsgTitl]").val("");
            $("#mobileDlvArea div[name=mobileDlv] textarea[name=mmsMsgCntn]").val("");

            var cnt = obj.value;
            for (var i=1; i < cnt; i++) {
                $("#mobileDlvArea").append($("#mobileDlvArea div[name=mobileDlv]:eq(0)").clone(true, true));
            }
            if (cnt != 1) {
                $("#mobileDlvArea div[name=mobileDlv]").find("select[name=ordQty]").val("1");
                $("#mobileDlvArea div[name=mobileDlv]").find("input[name=rcvCustNm]").filter(":gt(0)").val("");
                $("#mobileDlvArea div[name=mobileDlv]").find("input[name=rcvCustHpTel2]").filter(":gt(0)").val("");
                $("#mobileDlvArea div[name=mobileDlv]").find("input[name=rcvCustHpTel3]").filter(":gt(0)").val("");


                $("#mobileDlvArea div[name=mobileDlv]").find("input[type=number]").inputNumber();
            }
        };


        // 편의점 전화걸기 2016
        function sendTel() {
            var sendTel = $('#cvst_brn_tel').val();
            if (sendTel.length == 0) {
                alert("연락가능한 번호가 없습니다.");
            }
            else {
                location.href = "tel:"+sendTel;
            }
        }

        // 모바일 상품권 이전발송번호
        function preMblCopnSendClick() {
            var $mblSendList = $("#layer1").find("input[type=checkbox]:checked");
            if ($mblSendList.length > Number($("#multiSelectMobile").val())) {
                alert("선택한 인원수가 쿠폰을 받을 인원수보다 많습니다.");
                return false;
            }

            $mblSendList.each(function (idx) {
                var $obj = $(this);
                var $mobile = $("#mobileDlvArea").find("div[name=mobileDlv]").eq(idx);
                $mobile.find("input[name=rcvCustNm]").val($obj.attr("data-rcvCustNm"));
                $mobile.find("select[name=rcvCustHpTel1]").val($obj.attr("data-rcvCustHpTel1"));
                $mobile.find("input[name=rcvCustHpTel2]").val($obj.attr("data-rcvCustHpTel2"));
                $mobile.find("input[name=rcvCustHpTel3]").val($obj.attr("data-rcvCustHpTel3"));
            });

            // 닫기
            $('#layer1 .close').click();

        }


        function chkMblGcOrdCnt(tel){

            var returnVal = 0;

            $.ajax({
                type: "post"
                , url: "/m/chkMblGcOrdCnt.do"
                , dataType: "json"
                , async:false
                , data : {tel : tel}
                ,success : function(data) {
                    returnVal = data.returnVal;
                }
            });

            return returnVal;
        }


        /*$(document).on('change','.selectsub_installment', function(){
            var sel_text=$("#allotMonth option:selected").text();
            if(sel_text.indexOf('무이자')>-1){
                $(this).addClass('color-ff5340');
            }else{
                $(this).removeClass('color-ff5340');
            }
        });*/

        // 복수배송지 설정시 배송지가 변경 되었는지 확인 2016
        function chkChangeMulti(cnt, dlCnt) {

            if(cnt != dlCnt) return true;

            for(var i = 1; i <= dlCnt; i++) {
                var chgYn = $("#domestic li[name='domesticDstnLi']").find("input[name=depth3_address_chg_"+ (i + 1) +"]").val();

                if(chgYn == "Y") {
                    return true;
                }
            }

            return  false;
        }

        // input 에 들어있는 원자 제거 2016
        function wonRemove(obj) {
            var result;

            if(isEmpty(obj)) {
                result = obj;
            } else {
                result = obj.replace("원", null);
            }

            return result
        }

        // input maxlength 가 동작 안되서 만듬 2016
        function maxLengthCheck(object){
            if (object.value.length > object.maxLength){
                object.value = object.value.slice(0, object.maxLength);
            }
        }

        // 2016 이주형 형변환 오류가 많아서 통합펑션으로 처리
        function ufnToChar(val) {
            if (isEmpty(val)) {
                val = "";
            }
            val += "";

            val = val.replace("원", "");
            val = removeComma(val)

            if (val.length < 1) {
                val = "";
            }

            return val;
        }

        function ufnToNum(val) {
            if (isEmpty(val)) {
                val = "";
            }
            val += "";

            val = val.replace("원", "");

            //통합포인트 추가 박승택 20170523
            val = val.replace("P", "");

            val = removeComma(val);

            if (val.length < 1) {
                val = 0;
            }

            try {
                val = Number(val);
                if (val == "NaN") {
                    console.log("넘버타입 변환 에러");
                }
            }
            catch(e) {
                console.log("넘버타입 변환 에러");
            }

            return val;
        }

        function ufnAdrDup(custNo, dstnSeq, dstnNknm, rcvCustNm, dstnBaseAdr, dstnPtcAdr, dstnHpIdntNo, dstnHpIntmNo, dstnHpBckNo, dstnTela, dstnTels, dstnTeli, adrKndGbcd, dstnPostNo, baseYn) {
            var result = false;

            $(".addr-list li").each(function() {
                var custNoDep = $(this).find("input[name=dstncustNo]").val()
                var dstnSeqDep = $(this).find("input[name=dstnSeq]").val()

                if(custNoDep == custNo && dstnSeqDep == dstnSeq) {

                    var rcvCustNmDep = $(this).find("input[name=rcvCustNmPrv]").val();
                    var dstnBaseAdrDep = $(this).find("input[name=dstnBaseAdrPrv]").val();
                    var dstnPtcAdrDep = $(this).find("input[name=dstnPtcAdrPrv]").val();
                    var dstnHpIdntNoDep = $(this).find("input[name=dstnHpIdntNoPrv]").val();
                    var dstnHpIntmNoDep = $(this).find("input[name=dstnHpIntmNoPrv]").val();
                    var dstnHpBckNoDep = $(this).find("input[name=dstnHpBckNoPrv]").val();
                    var dstnTelaDep = $(this).find("input[name=dstnTelaPrv]").val();
                    var dstnTelsDep = $(this).find("input[name=dstnTelsPrv]").val();
                    var dstnTeliDep = $(this).find("input[name=dstnTeliPrv]").val();
                    var adrKndGbcdDep = $(this).find("input[name=adrKndGbcdPrv]").val();
                    var dstnPostNoDep = $(this).find("input[name=dstnPostNoPrv]").val();
                    var baseYnDep = isEmpty($(this).find("input[name=baseYn]").val()) ? "N" : $(this).find("input[name=baseYn]").val();

                    if(rcvCustNmDep == rcvCustNm && dstnBaseAdrDep == dstnBaseAdr && dstnPtcAdrDep == dstnPtcAdr
                        && dstnHpIdntNoDep == dstnHpIdntNo && dstnHpIntmNoDep == dstnHpIntmNo
                        && dstnHpBckNoDep == dstnHpBckNo && dstnTelaDep == dstnTela
                        && dstnTelsDep == dstnTels && dstnTeliDep == dstnTeli
                        && adrKndGbcdDep == adrKndGbcd && dstnPostNoDep == dstnPostNo
                        && baseYnDep != baseYn
                    ) {
                        result = true;
                    }
                }
            });

            return result;
        }

        // 이전 발송번호 선택 2016
        function preDlvHpChoice(obj) {
            var rcvCustNm = $(obj).find("input[name=rcvCustNm]").val();
            var dstnHpIdntNo = $(obj).find("input[name=dstnHpIdntNo]").val();
            var dstnHpIntmNo = $(obj).find("input[name=dstnHpIntmNo]").val();

            $("#mobileDlvArea").find("input[name=rcvCustNm]").val(rcvCustNm);
            $("#mobileDlvArea").find("input[name=dstnHpIdntNo]").val(dstnHpIdntNo);
            $("#mobileDlvArea").find("input[name=dstnHpNo]").val(dstnHpIntmNo);

            $("#mobileDlvArea #uPhon2").val(dstnHpIdntNo);
            $("#mobileDlvArea #uPhon3").val(dstnHpIntmNo);

            backStateLayerPopup();
        }

        //행정구역명의 rmrk 를 제거 2016
        function getdistNm(distNm) {
            var result = "";
            var distNmtmp = distNm.split("(");

            if(!isEmpty(distNmtmp[1])) {
                result = distNmtmp[1].replace(")", "");
            }

            return result;
        }

        function dstnListDel(dstnSeq) {

            var custNo = "201809357435";

            var isMulti = $("#multi").prop("checked");
            var halfDlvYn = 'N';

            var isDel = true;
            if(isMulti || halfDlvYn =="Y") {
                $("a[id ^='multiaddress_depth2_a']").each(function() {
                    if($(this).find("input[name=dstnSeq]").val() == dstnSeq) {
                        isDel = false;
                    }
                });
            } else {
                var defSeq = $("#multi_false").find("input[name=dstnSeq]").val();
                if(dstnSeq == defSeq) {
                    isDel = false;
                }
            }

            if(!isDel) {
                alert("선택 되어있는 배송지는 삭제 할 수 없습니다.");
                return;
            }

            if(confirm("배송지를 삭제하시겠습니까?") ) {
                $.ajax({
                    type: "post"
                    , url: "/m/dstnListDel.do"
                    ,data: {
                        'custNo':custNo,
                        'dstnSeq':dstnSeq
                    }
                    , dataType: "json"
                    , success : function(data) {
                        var addrListCallId = $("#addrListCallId").val();
                        goAddrList($("#"+addrListCallId));

                        dlvAddInfoReset();
                    }
                    , error: function(data) {
                    }
                    , complete: function(jqXHR,textStatus ){
                    }
                });
            }
        }

        //추천 할인 적용
        function setAutoDc(isCheck, callback) {

            // ars할인여부
            var arsDcYn = $("#discount0").length > 0 ? "Y" : "N";
            // 일시불할인여부
            var spymDcYn = $("#discount1").length > 0 ? "Y" : "N";
            // 깜짝할인여부
            var prmoDcYn = $("#discount2").length > 0 ? "Y" : "N";
            // 적립금즉시할인여부
            var svmtDcYn = $("#sale").length > 0 ? "Y" : "N";
            
            var cardEventYn = 'N';
            if(isCheck) {
                try {
                    isAutoDcIng = true;

                    if(arsDcYn == "Y") {
                        $("#discount0").prop("checked", true);
                        chkTotArsDcAmt($("#discount0")[0]);
                    }
                    if(spymDcYn == "Y") {
                        $("#discount1").prop("checked", true);
                        chkTotSpymDcAmt($("#discount1")[0]);
                    }
                    if(prmoDcYn == "Y") {
                        $("#discount2").prop("checked", true);
                        chkTotPrmoDcAmt($("#discount2")[0]);
                    }
                    if(svmtDcYn == "Y") {
                        $("#sale").prop("checked", true);
                        imdtUseHpoint();
                    }

                    // 2020 리뉴얼... 추천할인 
                    var recommandDisc = new Array();
                    
                    var plusDisc = new Array();
                    
                    
                    // 일반쿠폰
                    /* 2016
                    $("#cuponSearch li.cuponli select.gnrlCopn").each(function() {
                        var flag = false;
                        $(this).find("option").each(function() {
                            for(var i = 0; i < recommandDisc.length; i++) {
                                if ( $(this).val() == recommandDisc[i] ) {
                                    $(this).prop("selected", true);
                                    flag = true;
                                    break;
                                }
                            }
                        });
                        if ( flag ) {
                            selectCopn(this);
                        }
                    });
                    */
                    // 2020
                    //
                    if ( recommandDisc.length > 0 ) {
                        for(var i = 0; i < recommandDisc.length; i++) {
                            $("input[value='"+recommandDisc[i]+"']").prop("checked", true);
                            selectCopn($("input[value='"+recommandDisc[i]+"']").parents("div[name='cuponSearch']"),"N");
                        }
                        calculateOrderAmt();
                        if(cardEventYn != "Y"){
                        	restoreLastPayType();
                        }                        
                        //setGnrlCupon();
                    }
                    
                    //
                    // 플러스쿠폰
                    /* 2016
                    $("#cuponSearch li.cuponli select.plusCopn").each(function() {
                        var flag = false;
                        $(this).find("option").each(function() {
                            for(var i = 0; i < plusDisc.length; i++) {
                                if ( $(this).val() == plusDisc[i] ) {
                                    $(this).prop("selected", true);
                                    flag = true;
                                    break;
                                }
                            }
                        });
                        if ( flag ) {
                            selectCopn(this);
                        }
                    });
                    */
                    // 2020
                    //
                    if ( plusDisc.length > 0 ) {
                        for(var i = 0; i < plusDisc.length; i++) {
                            $("input[value='"+plusDisc[i]+"']").prop("checked", true);
                            selectCopn($("input[value='"+plusDisc[i]+"']").parents("div[name='cuponSearch']"),"N");
                        }
                        calculateOrderAmt();
                        if(cardEventYn != "Y"){
                        	restoreLastPayType();
                        }                        
                        //setPlusCupon();
                    }
                    //
                    // 2020 리뉴얼... 추천할인 
                    
                    /*
                    if($("div[name='cuponSearch']").length > 0) {
                        setGnrlCupon();

                        var gnrlCupncnt = 0;
                        $("input[name^='gnrlCopn_']:checked").each(function() {
                            if(isEmpty($(this).val().split("|")[0])) {
                                gnrlCupncnt++;
                            }
                        });

                        if(gnrlCupncnt > 0) {
                            setGnrlCupon();
                        }

                        setPlusCupon();

                        var plusCupncnt = 0;
                        $("input[name^='plusCopn_']:checked").each(function() {
                            if(isEmpty($(this).val().split("|")[0])) {
                                plusCupncnt++;
                            }
                        });

                        if(plusCupncnt > 0) {
                            setPlusCupon();
                        }
                    }
                    */

                    if($("div.totAlliDcTxt-detail-select").length > 0) {
                        $("div.totAlliDcTxt-detail-select").find("input[name='discountType1']").each(function() {
                            if($(this).val() == "0000000704" || $(this).val() == "0000000429" || $(this).val() == "0000003583" || $(this).val() == "0000003586" || $(this).val() == "0000003621" || $(this).val() == "0000003622") {
                                $(this).prop("checked", true);
                                selectAlliCrd();
                            }
                        });
                    }
                    
                    if($("input[name='paymentCopnInf']").length > 0 && $("input[name='selPaymentCopn']").length > 0) {
                        var isDisabled = $("#stlmAmtDcDiv").css("display");
                        if(isDisabled != "none") {
                            var calDcAmtArr = new Array();
                            var maxDcAmt = 1000;

                            $("input[name='selPaymentCopn']").each(function(index) {
                                if($(this).css("display") != "none" && !$(this).prop("disabled") && !isEmpty($(this).val())) {
                                    $(this).prop("checked", true);
                                    selectPaymentCopn();
                                    var maxCopnData = $(this).val().split("|")[0];
                                    var tmpTotDcAmtCalc = Number($("input[name='orderAmt']:last").val()) - Number($("input[name=totDcAmtCalc]").val());

                                    if (tmpTotDcAmtCalc >= maxDcAmt) {
                                        calDcAmtArr.push($("input[name=totDcAmtCalc]").val() + "|" + index + "|" + maxCopnData);
                                    } else {
                                        $(this).remove();
                                    }
                                }
                            });

                            if(calDcAmtArr.length > 0){
                                $("input[name='selPaymentCopn']:eq(0)").prop("checked", true);
                                selectPaymentCopn();

                                var tmpTotDcAmtArray = new Array();
                                for(var i = 0; i < calDcAmtArr.length; i++) {
                                    var totDcAmtCalc = calDcAmtArr[i].split("|")[0];
                                    var arrayIndex = i < 10 ? "0" + i : String(i);

                                    tmpTotDcAmtArray.push(totDcAmtCalc + arrayIndex);
                                }

                                var maxIndexVal = String(Math.max.apply(null, tmpTotDcAmtArray));
                                var maxIndex = Number(maxIndexVal.substring(maxIndexVal.length -2, maxIndexVal.length));
                                var eqIndex = calDcAmtArr[maxIndex].split("|")[1];


                                $("input[name='selPaymentCopn']:eq("+eqIndex+")").prop("checked", true);

                                selectPaymentCopn();
                            }

                        } else {
                            //주문서 리뉴얼 추천할인 체크박스 확인
                            if(dcAreaCnt() == 0) {
                                $("#chk2").prop("checked", false);
                                $(".order2016_optionwrap").hide();
                            }
                        }
                    }
                    
                    // 2019.10.08 HMALL개선이주형 무료배송비쿠폰 추천할인적용
                    var aplyDlvCopnArr = new Array();
                    if($("div[class^='coupon-detail-select_freeDlvCopn']").length > 0) {
                        // 랭킹매기기
                        var aArr = new Array();
                        $("div[class^='coupon-detail-select_freeDlvCopn']").each(function() {
                            var dlvCost = $(this).find("input[name='dcPrice']").val();
                            var slitmCd = $(this).find("input[name='slitmCd']").val();
                            aArr.push(dlvCost + "|" + slitmCd);
                        });
                        var bArr = new Array();
                        var rnk = aArr.length;
                        for (var i = 0; i < aArr.length; i++) {
                            rnk = 1;
                            for (var j = 0; j < aArr.length; j++) {
                                if (parseFloat(aArr[i].split("|")[0]) < parseFloat(aArr[j].split("|")[0])) rnk++;
                            }
                            for (var j = 0; j < bArr.length; j++) {
                                if (bArr[j].split("|")[2] == rnk) rnk++;
                            }
                            bArr[i] = aArr[i] + "|" + rnk;
                        }

                        // 랭킹순서로 적용
                        for (var j = 0; j < bArr.length; j++) {
                            for (var i = 0; i < bArr.length; i++) {
                                if ((j+1) == bArr[i].split("|")[2]) {
                                    var slitmCd = bArr[i].split("|")[1];

                                    $("div[class^='coupon-detail-select_freeDlvCopn']").each(function() {
                                        var defSlitmCd = $(this).find("input[name='slitmCd']").val();
                                        if (slitmCd == defSlitmCd) {
                                            // 옵션 루프
                                            // 가능쿠폰만 옵션에 들어가 있으므로 하나씩 적용
                                            var isSelected = false;
                                            $(this).find("input[name^='freeDlvCopn']").each(function() {
                                                if (!isEmpty($(this).val().split("|")[0])) {
                                                    var curCopn = $(this).val().split("|")[4];
                                                    var isDup = false;
                                                    for (var i = 0; i < aplyDlvCopnArr.length; i++) {
                                                        var chkCopn = aplyDlvCopnArr[i];
                                                        if (curCopn == chkCopn) {
                                                            isDup = true;
                                                        }
                                                    }
                                                    if (!isDup) {
                                                        aplyDlvCopnArr.push(curCopn);
                                                        isSelected = true;
                                                        $(this).prop("checked", true);
                                                        return false;
                                                    }
                                                }
                                            });
                                            if (isSelected) selectDlvCopn($(this));
                                        }
                                    });
                                }
                            }
                        }
                    }
                    
                    var isAplyEmpDc = false;

                    var limitEmpDcAmt = Number($("input[name='limitEmpDcAmt']").val());
                    var orderAmt = Number($("input[name='orderAmt']").val());
                    var totDcAmtCalc = Number($("input[name='totDcAmtCalc']").val());

                    if(limitEmpDcAmt > (orderAmt - totDcAmtCalc)){
                        if(hasHsPrchMdaYn == "Y" || hasDtvItmYn == "Y") {

                            var isHsEmpDc = false;

                            if($("div.totAlliDcTxt-detail-select").length > 0) {
                                $("div.totAlliDcTxt-detail-select").find("input[name='discountType1']").each(function() {
                                    if($(this).val() == "0000002991") {
                                        isHsEmpDc = true;
                                    }
                                });
                            }

                            if(isHsEmpDc){

                                //var totPrmoDcAmt = $("#totPrmoDcAmtArea").next("input[name=totPrmoDcAmt]").val();
                                var totPrmoDcAmt = 0;
                                var totCopnDcAmt = 0;
                                var totEmpDcAmt = 0;
                                var payCopnDcAmt = 0;

                                $("#slitmInfDiv span").each(function() {

                                    var obj = $(this);

                                    var slitmCd = obj.data("slitmCd");
                                    var uitmCd = obj.data("uitmCd");
                                    var aspItemCd = obj.data("aspItemCd");
                                    var sellPrc = Number(obj.data("sellPrc"));
                                    var ordQty = Number(obj.data("ordQty"));

                                    // 상품의 수량별로 할인금액 보관
                                    var dcAmtArr = new Array();

                                    // 상품의 수량만큼 loop
                                    for (var i=0; i<ordQty; i++) {

                                        var dcAmt = 0;
                                        var prmoDcAmt = 0;
                                        var copnDcAmt = 0;
                                        var stlmCopnDcAmt = 0;


                                        // 깜짝할인
                                        var prmoDcRate = $(this).data("dcRate");
                                        if(prmoDcRate > 0) {
                                            prmoDcAmt = Math.floor(sellPrc * Number(prmoDcRate) / 1000) * 10;
                                        } else {
                                            prmoDcAmt = Number(obj.data("dcAmt"));
                                        }
                                        totPrmoDcAmt += prmoDcAmt;
                                        dcAmt += prmoDcAmt;



                                        // 일반 쿠폰
                                        var copnInfArrString = $("#gnrlCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).val();

                                        if (!isEmpty(copnInfArrString)) {
                                            // (0:copnNo|1:slitmCd|2:uitmCd|3:aspItemCd|4:famtFxrtGbcd|5:famtFxrtVal|6:copnGb|7:itemIdx|8:copnPblcNo|9:maxDcPossAmt|10:copnTypeGbcd)
                                            var copnInfArr = copnInfArrString.split("|");
                                            var copnNo = copnInfArr[0];
                                            var copnItemIdx = copnInfArr[7];
                                            var maxDcPossAmt = copnInfArr[9];
                                            var copnTypeGbcd = copnInfArr[10];
                                            var prchMdaGbcd = copnInfArr[11];
                                            var dtvItemYn = copnInfArr[12];

                                            if(prchMdaGbcd == "20" || dtvItemYn == "Y") {

                                                var copnDcAmt = 0;
                                                var isVenCopn = false;

                                                for(var j = 0; j < afcoDcVenCopnList.length; j++){
                                                    if(afcoDcVenCopnList[j] == copnNo){
                                                        isVenCopn = true;
                                                        break;
                                                    }
                                                }

                                                if(isVenCopn || copnTypeGbcd == "03" || copnTypeGbcd == "04" || copnTypeGbcd == "05"){
                                                    if(copnInfArr[4] == '1') {
                                                        copnDcAmt = Math.floor(Number(copnInfArr[5]) * Number(sellPrc - dcAmt) / 1000) * 10;

                                                        if(maxDcPossAmt > 0 && copnDcAmt > maxDcPossAmt) {
                                                            copnDcAmt = Number(maxDcPossAmt);
                                                        }
                                                    } else {
                                                        copnDcAmt = Number(copnInfArr[5]);

                                                        if(maxDcPossAmt > 0 && copnDcAmt > maxDcPossAmt) {
                                                            copnDcAmt = Number(maxDcPossAmt);
                                                        }
                                                    }
                                                    totCopnDcAmt += copnDcAmt;
                                                    dcAmt += copnDcAmt;
                                                }
                                            }

                                            // 플러스 쿠폰
                                            copnInfArrString = $("#plusCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).val();

                                            if (!isEmpty(copnInfArrString)) {

                                                // (0:copnNo|1:slitmCd|2:uitmCd|3:aspItemCd|4:famtFxrtGbcd|5:famtFxrtVal|6:copnGb|7:itemIdx|8:copnPblcNo|9:maxDcPossAmt|10:copnTypeGbcd)
                                                var copnInfArr = copnInfArrString.split("|");
                                                var copnNo = copnInfArr[0];
                                                var copnItemIdx = copnInfArr[7];
                                                var maxDcPossAmt = copnInfArr[9];
                                                var copnTypeGbcd = copnInfArr[10];
                                                var prchMdaGbcd = copnInfArr[11];
                                                var dtvItemYn = copnInfArr[12];

                                                if(prchMdaGbcd == "20" || dtvItemYn == "Y") {
                                                    var plusCopnDcAmt = 0;
                                                    var isVenCopn = false;

                                                    for(var j = 0; j < afcoDcVenCopnList.length; j++){
                                                        if(afcoDcVenCopnList[j] == copnNo){
                                                            isVenCopn = true;
                                                            break;
                                                        }
                                                    }

                                                    if(isVenCopn || copnTypeGbcd == "03" || copnTypeGbcd == "04" || copnTypeGbcd == "05"){
                                                        if(copnInfArr[4] == '1') {
                                                            plusCopnDcAmt = Math.floor(Number(copnInfArr[5]) * Number(sellPrc - dcAmt) / 1000) * 10;

                                                            if(maxDcPossAmt > 0 && plusCopnDcAmt > maxDcPossAmt) {
                                                                plusCopnDcAmt = Number(maxDcPossAmt);
                                                            }
                                                        } else {
                                                            plusCopnDcAmt = Number(copnInfArr[5]);

                                                            if(maxDcPossAmt > 0 && plusCopnDcAmt > maxDcPossAmt) {
                                                                plusCopnDcAmt = Number(maxDcPossAmt);
                                                            }
                                                        }

                                                        totCopnDcAmt += plusCopnDcAmt;
                                                        dcAmt += plusCopnDcAmt;
                                                    }
                                                }
                                            }

                                        }

                                        dcAmtArr[i] = dcAmt;
                                    }


                                    var baseDcRate = isEmpty($(this).data("tcBaseDcRate")) ? 0 : Number($(this).data("tcBaseDcRate"));
                                    // 2018.07.19 할인한도액
                                    var tcDcRate = (isEmpty($(this).data("tcDcRate")) || $(this).data("tcDcRate") == 0)? baseDcRate : Number($(this).data("tcDcRate"));

                                    for (var i=0; i < dcAmtArr.length; i++) {
                                        var alliDcAmt = gfn_getTcDcAmt("3", sellPrc, tcDcRate, 1, $(this));
                                        totEmpDcAmt += alliDcAmt;
                                    }

                                });


                                $("input[name='paymentCopnInf']").each(function() {
                                    var copnNo = $(this).val().split("|")[0];
                                    for(var i = 0; i < afcoDcVenCopnList.length; i++){
                                        if(afcoDcVenCopnList[i] == copnNo){
                                            payCopnDcAmt = Number($("form[name='orderDataForm'] input[name='payCopnDcAmt']").val());
                                            break;
                                        }
                                    }
                                });

                                if((totPrmoDcAmt + totCopnDcAmt + payCopnDcAmt) > 0){
                                    if(totEmpDcAmt > (totPrmoDcAmt + totCopnDcAmt + payCopnDcAmt)){
                                        //깜짝 할인 해제
                                        if(totPrmoDcAmt > 0){
                                            $("#discount2").prop("checked", false);
                                            chkTotPrmoDcAmt($("#discount2")[0]);
                                        }


                                        $("div[class^='coupon-detail-select_']").each(function() {

                                            //바로사용 쿠폰  해제
                                            if(totCopnDcAmt > 0){
                                                if($(this).hasClass("gnrlCopn") || $(this).hasClass("plusCopn")){

                                                    if($(this).hasClass("gnrlCopn")){
                                                        //일반쿠폰
                                                        var copnInfArr = $(this).find("input[name^='gnrlCopn_']:checked").val().split("|");
                                                    }else{
                                                        //플러스쿠폰
                                                        var copnInfArr = $(this).find("input[name^='plusCopn_']:checked").val().split("|");
                                                    }


                                                    var copnNo = copnInfArr[0];
                                                    var copnTypeGbcd = copnInfArr[4];
                                                    var prchMdaGbcd = copnInfArr[12];
                                                    var dtvItemYn = copnInfArr[13];

                                                    if(prchMdaGbcd == "20" || dtvItemYn == "Y") {

                                                        var isVenCopn = false;

                                                        for(var i = 0; i < afcoDcVenCopnList.length; i++){
                                                            if(afcoDcVenCopnList[i] == copnNo){
                                                                isVenCopn = true;
                                                                break;
                                                            }
                                                        }

                                                        if(isVenCopn || copnTypeGbcd == "03" || copnTypeGbcd == "04" || copnTypeGbcd == "05"){
                                                            if($(this).hasClass("gnrlCopn")){
                                                                //일반쿠폰
                                                                $(this).find("input[name^='gnrlCopn_']:eq(0)").prop("checked", true);
                                                            }else{
                                                                //플러스쿠폰
                                                                $(this).find("input[name^='plusCopn_']:eq(0)").prop("checked", true);
                                                            }
                                                            selectCopn(this);
                                                        }
                                                    }
                                                }
                                            }

                                        });

                                        //결제수단 쿠폰 해제
                                        if(payCopnDcAmt > 0){
                                            if($(".stlmAmtDcTxt-detail-select").length > 0) {
                                                var copnNo = $("input[name='selPaymentCopn']:checked").val().split("|")[0];
                                                for(var i = 0; i < afcoDcVenCopnList.length; i++){
                                                    if(afcoDcVenCopnList[i] == copnNo){
                                                        $("input[name='selPaymentCopn']:eq(0)").prop("checked", true);
                                                        selectPaymentCopn();
                                                        break;
                                                    }
                                                }
                                            }
                                        }

                                        isAplyEmpDc = true;
                                    }
                                }else{
                                    isAplyEmpDc = true;
                                }
                            }
                        }else{
                            isAplyEmpDc = true;
                        }
                    }
                    
                    if(isAplyEmpDc){ //임직원 할인 적용
                        if($("div.totAlliDcTxt-detail-select").length > 0) {
                            $("div.totAlliDcTxt-detail-select").find("input[name='discountType1']").each(function() {
                                if($(this).val() == "0000002991") {
                                    $(this).prop("checked", true);
                                    selectAlliCrd();
                                }
                            });
                        }
                    }
                    
                    isAutoDcIng = false;

                } catch (e) {
                    isAutoDcIng = false;
                    console.log("error : " + e);
                    alert("죄송합니다. 고객님 추천할인 적용에 실패 하였습니다.\n할인수단은 개별로 적용 할 수 있습니다.");
                    $("#chk2").prop("checked", false);
                    callback(true);
                }
            } else {
                isAutoDcIng = false;

                if(arsDcYn == "Y") {
                    $("#discount0").prop("checked", false);
                    chkTotArsDcAmt($("#discount0")[0]);
                }
                if(spymDcYn == "Y") {
                    $("#discount1").prop("checked", false);
                    chkTotSpymDcAmt($("#discount1")[0]);
                }
                if(prmoDcYn == "Y") {
                    $("#discount2").prop("checked", false);
                    chkTotPrmoDcAmt($("#discount2")[0]);
                }
                if(svmtDcYn == "Y") {
                    $("#sale").prop("checked", false);
                    imdtUseHpoint();
                }


                $("div[class^='coupon-detail-select_']").each(function() {

                    if($(this).hasClass("gnrlCopn")){
                        //일반쿠폰
                        $(this).find("input[name^='gnrlCopn_']:eq(0)").prop("checked", true);
                        $(this).find("input[name=setAutoDcDupYn]").val("");
                        selectCopn(this);
                    }else if($(this).hasClass("plusCopn")){
                        //플러스쿠폰
                        $(this).find("input[name^='plusCopn_']:eq(0)").prop("checked", true);
                        $(this).find("input[name=setAutoDcDupYn]").val("");
                        selectCopn(this);
                    }else if($(this).hasClass("freeDlvCopn")){
                        //배송비 쿠폰
                        $(this).find("input[name^='freeDlvCopn_']:eq(0)").prop("checked", true);
                        selectDlvCopn($(this));
                    }
                });

                if($("div.totAlliDcTxt-detail-select").length > 0) {
                    $("div.totAlliDcTxt-detail-select").find("input[name='discountType1']:eq(0)").prop("checked", true);
                    selectAlliCrd();
                }

                //결제수단 쿠폰 초기화
                if($(".stlmAmtDcTxt-detail-select").length > 0) {
                    $("input[name='selPaymentCopn']:eq(0)").prop("checked", true);
                    selectPaymentCopn();
                }

            }

            if(isCheck) {
                setTimeout(function() {
                    callback(true);
                }, 1000);
            }

            calculateOrderAmt();
            calculateCashRcptAmt();
        }

        function setGnrlCupon() {
            $("div[class^='coupon-detail-select_gnrlCopn_']").each(function() {

                cuponDupSet();

                var slitmSellPrcArr = new Array();
                $("div[class^='coupon-detail-select_gnrlCopn_']").each(function() {
                    if(!isEmpty($(this).find("input[name^='gnrlCopn']:checked").val() && isEmpty($(this).find("input[name^='gnrlCopn']:checked").val().split("|")[0]))) {
                        var sellPrc = $(this).find("input[name='slitmSellPrc']").val();
                        var setAutoDcDupYn = $(this).find("input[name='setAutoDcDupYn']").val();
                        if(!isEmpty(sellPrc) && setAutoDcDupYn != "Y") {
                            var index = String($(this).index()).length > 1 ? $(this).index() : "0" + $(this).index();
                            slitmSellPrcArr.push(sellPrc + index);
                        }
                    }
                });

                var maxindexVal = String(Math.max.apply(null, slitmSellPrcArr));
                var maxindex = Number(maxindexVal.substring(maxindexVal.length -2, maxindexVal.length));

                $("div[class^='coupon-detail-select_gnrlCopn_']").each(function() {
                    var gnrlCopnObj = $(this);
                    var cuponArray = new Array();
                    var isCuponSet = false;

                    $(this).find("input[type='radio']").each(function() {
                        cuponArray.push($(this).val());
                    });

                    var tmpMaxCopnData = getMaxCopnData(cuponArray.join(","), maxindexVal);
                    $(this).find("input[type='radio']").each(function() {

                        if(gnrlCopnObj.index() == maxindex) {
                            if($(this).val() ==  tmpMaxCopnData && !isCuponSet) {
                                $(this).prop("checked", true);
                                isCuponSet = true;
                                return false;
                            }
                        }
                    });

                    if(isCuponSet) {
                        selectCopn(this,'N');
                    }
                });
            });
            calculateOrderAmt();
            if('N' != 'Y'){
            	restoreLastPayType();
            }             
        }

        function setPlusCupon() {
            var totDcAmtArray = new Array();
            $("div[class^='coupon-detail-select_plusCopn_']").each(function(i) {

                var copnSlitmCd = $(this).find("input[name='copnSlitmCd']").val();
                var copnUitmCd = $(this).find("input[name='copnUitmCd']").val();
                var copnAspItemCd = $(this).find("input[name='copnAspItemCd']").val();
                var copnItemIdx = $(this).find("input[name='copnItemIdx']").val();

                var gnrlCupnSelect = $("input[name='gnrlCopn_"+copnSlitmCd+"_"+copnUitmCd+"_"+copnAspItemCd+"_"+copnItemIdx+"']:checked").val().split("|")[0];
                if(isEmpty(gnrlCupnSelect)) {
                    return true;
                }

                if(!isEmpty($(this).find("input[name^='plusCopn_']:checked").val().split("|")[0])) {
                    return true;
                }

                cuponDupSet();

                var slitmSellPrcArr = new Array();
                $("div[class^='coupon-detail-select_plusCopn_']").each(function() {

                    if(isEmpty($(this).find("input[name^='plusCopn_']:checked").val().split("|")[0])) {
                        var sellPrc = $(this).find("input[name='slitmSellPrc']").val();
                        var setAutoDcDupYn = $(this).find("input[name='setAutoDcDupYn']").val();
                        if(!isEmpty(sellPrc) && setAutoDcDupYn != "Y") {
                            var index = String($(this).index()).length > 1 ? $(this).index() : "0" + $(this).index();
                            slitmSellPrcArr.push(sellPrc + index);
                        }
                    }
                });

                if(isEmpty(slitmSellPrcArr)) return true;

                var maxindexVal = String(Math.max.apply(null, slitmSellPrcArr));

                var cuponArray = new Array();
                var isCuponSet = false;
                var index = String($(this).index()).length > 1 ? $(this).index() : "0" + $(this).index();

                $(this).find("input[name^='plusCopn_']").each(function() {
                    cuponArray.push($(this).val());
                });

                var tmpMaxCopnData = getMaxCopnData(cuponArray.join(","), maxindexVal);
                $(this).find("input[name^='plusCopn_']").each(function() {
                    if(!isEmpty($(this).val().split("|")[0])) {
                        if($(this).val() == tmpMaxCopnData && !isCuponSet) {
                            $(this).prop("checked", true);
                            isCuponSet = true;
                            return false;
                        }
                    }
                });

                if(isCuponSet) {
                    selectCopn(this,'N');
                    var maxCopnData = $(this).find("input[name^='plusCopn_']:checked").val().split("|")[0];
                    totDcAmtArray.push($("input[name=totDcAmtCalc]").val() + "|" + i + "|" + maxCopnData);
                    $(this).find("input[name^='plusCopn_'].noneCopn").prop("checked","true");
                    selectCopn(this,'N');
                }

                if(($("div[class^='coupon-detail-select_plusCopn_']").size() -1) == i && !isEmpty(totDcAmtArray)) {
                    var tmpTotDcAmtArray = new Array();
                    for(var i = 0; i < totDcAmtArray.length; i++) {
                        var totDcAmtCalc = totDcAmtArray[i].split("|")[0];
                        var arrayIndex = i < 10 ? "0" + i : String(i);

                        tmpTotDcAmtArray.push(totDcAmtCalc + arrayIndex);
                    }

                    var maxIndexVal = String(Math.max.apply(null, tmpTotDcAmtArray));
                    var maxIndex = Number(maxIndexVal.substring(maxIndexVal.length -2, maxIndexVal.length));

                    var eqIndex = totDcAmtArray[maxIndex].split("|")[1];
                    var calMaxCopnNo = totDcAmtArray[maxIndex].split("|")[2];

                    $("div[class^='coupon-detail-select_plusCopn_']:eq("+eqIndex+")").find("input[name^='plusCopn_']").each(function() {
                        if($(this).val().split("|")[0] == calMaxCopnNo) {
                            $(this).prop("checked", true);
                            selectCopn($("div[class^='coupon-detail-select_plusCopn_']:eq("+eqIndex+")"),'N');
                        }
                    });
                }
            });
            calculateOrderAmt();
            if('N' != 'Y'){
            	restoreLastPayType();
            } 
        }

        function getMaxCopnData(cuponData, maxindexVal) {
            var tmpCuponData = cuponData.split(",");
            var tmpArray = new Array();
            var tmpMaxDcValArr = new Array();
            var result = "";
            var maxSellPrc = Number(maxindexVal.substring(0 , maxindexVal.length -2));
            var maxSellIdx = Number(maxindexVal.substring(maxindexVal.length -2 , maxindexVal.length));
            var maxCopnNo = "";

            for(var i = 0; i < tmpCuponData.length; i++) {
                if(!isEmpty(tmpCuponData[i].split("|")[6]) && tmpCuponData[i].split("|")[12] != "Y") {
                    var priorityVal = 99999999;
                    if(!isEmpty(tmpCuponData[i].split("|")[11]) && tmpCuponData[i].split("|")[11].length == 8){
                        priorityVal -= Number(tmpCuponData[i].split("|")[11]);
                    }
                    tmpMaxDcValArr.push(sellPrcCal(tmpCuponData[i].split("|")[5], tmpCuponData[i].split("|")[9], tmpCuponData[i].split("|")[6], maxSellPrc) + String(priorityVal));
                }
            }

            var tmpMaxDcVal = Math.max.apply(null, tmpMaxDcValArr);

            for(var i = 0; i < tmpCuponData.length; i++) {
                var priorityVal = 99999999;
                if(!isEmpty(tmpCuponData[i].split("|")[11]) && tmpCuponData[i].split("|")[11].length == 8){
                    priorityVal -= Number(tmpCuponData[i].split("|")[11]);
                }
                if(tmpMaxDcVal == (sellPrcCal(tmpCuponData[i].split("|")[5], tmpCuponData[i].split("|")[9], tmpCuponData[i].split("|")[6], maxSellPrc) + String(priorityVal))
                    && tmpCuponData[i].split("|")[12] != "Y") {
                    maxCopnNo = tmpCuponData[i].split("|")[0];
                    break;
                }
            }

            if(!isEmpty(maxCopnNo)) {
                for(var i = 0; i < tmpCuponData.length; i++) {
                    var selectValues = tmpCuponData[i].split("|");

                    var copnNo = selectValues[0];
                    var slitmCd = selectValues[1];
                    var uitmCd = selectValues[2];
                    var copnTypeGbcd = selectValues[4];
                    var famtFxrtVal = selectValues[6];
                    var itemIdx = selectValues[7];
                    var copnPblcNo = selectValues[8];

                    if(maxCopnNo == copnNo) {
                        var dupYn = false;

                        if(copnTypeGbcd != "03" && copnTypeGbcd != "04" && copnTypeGbcd != "05") {
                            $("div[name='cuponSearch'] input[name='copnInf']").each(function() {
                                var copnSlitmCd = $(this).siblings("input[name='copnSlitmCd']").val();
                                var copnUitmCd = $(this).siblings("input[name='copnUitmCd']").val();
                                var copnInfIdx = $(this).siblings("input[name='copnItemIdx']").val();
                                if(!dupYn && !isEmpty($(this).val())) {
                                    var copnInfArr = $(this).val().split("|");
                                    if((slitmCd + uitmCd + itemIdx) != (copnSlitmCd + copnUitmCd + copnInfIdx)  && copnInfArr[0] == copnNo && copnInfArr[8] == copnPblcNo) {
                                        dupYn = true;
                                    }
                                }
                            });
                        }

                        if(dupYn) {
                            $("div[name='cuponSearch']").find("input[type='radio']").each(function() {
                                if(isEmpty($(this).parents().find("input[name=copnInf]").val())) {
                                    if(maxCopnNo == $(this).val().split("|")[0] && $(this).val().split("|")[12] != "Y") {
                                        var tmpVal = $(this).val() + "|Y";
                                        $(this).val(tmpVal);
                                    }
                                }
                            });
                        } else {
                            result = tmpCuponData[i];
                        }
                    }
                }
            }

            return result;
        }

        function sellPrcCal(famtFxrtGbcd, maxDcPossAmt, famtFxrtVal, maxSellPrc) {
            var result = 0;

            if(famtFxrtGbcd == "2") {
                result = isEmpty(famtFxrtVal) ? 0 : Number(famtFxrtVal);
            } else {
                result = Number(maxSellPrc) * (isEmpty(famtFxrtVal) ? 0 : Number(famtFxrtVal / 100));
            }

            if(maxDcPossAmt != 0 && !isEmpty(maxDcPossAmt)) {
                if(result > Number(maxDcPossAmt)) {
                    result = Number(maxDcPossAmt);
                }
            }

            return result;
        }

        function cuponDupSet() {
            $("div[name='cuponSearch']").each(function() {
                if($(this).find("input[name=setAutoDcDupYn]").val() != "Y") {
                    var dupCnt = 0;
                    var optionCnt = 0;
                    $(this).find("input[type='radio']").each(function() {
                        if(!isEmpty($(this).val().split("|")[0])) {
                            optionCnt++;
                            if($(this).val().split("|")[12] == "Y") {
                                dupCnt++;
                            }
                        }
                    });

                    if(optionCnt == dupCnt) {
                        $(this).find("input[name=setAutoDcDupYn]").val("Y");
                    }
                }
            });
        }

        function selectPaymentCopn() {
            var obj = $("input[name='selPaymentCopn']:checked");
            var stlmFixYnObj = "";

            $("input[name=paymentCopnInf]").val("");
            isPayCopnPayTypeSet = false;
            $("select[name='stlmCrdInf']").prop("disabled", false);

            clearSubPayTypeArea();
            clearPayTypeArea();
            calculateOrderAmt();

            if(!isEmpty(obj.val())) {
                var selectValues = obj.val().split("|");

                var copnNo = selectValues[0];
                var copnTypeGbcd = selectValues[1];
                var famtFxrtGbcd = selectValues[2];
                var famtFxrtVal = selectValues[3];
                var maxDcPossAmt = selectValues[4];
                var bsicAmt = selectValues[5];
                var copnBsicAmtGbcd = selectValues[6];
                var copnPblcNo = selectValues[7];
                var stlmFixYn = selectValues[8];
                var stlmFixGbcd = selectValues[9];
                var totStlmAmt = $("input[name=totStlmAmt]").val();
                stlmFixYnObj = stlmFixYn;

                var tcDcType = isEmpty($("input[name='discountType1']:checked").attr("tcDcType")) ? "03" : $("input[name='discountType1']:checked").attr("tcDcType");
                if(tcDcType == "04"){
                    if(hasHsPrchMdaYn == "Y" || hasDtvItmYn == "Y") {  // 바로사용 쿠폰사용시 임직원 할인 사용 불가
                        for(var i = 0; i < afcoDcVenCopnList.length; i++){
                            if(afcoDcVenCopnList[i] == copnNo){
                            	alertMsg("방송상품은 홈쇼핑 임직원할인시 일반 결제할인쿠폰에 한하여 중복 적용이 가능합니다.(VIP쿠폰 불가)");
                                $("input[name='discountType1']").eq(0).prop("checked",true);
                                //return;
                            }
                        }
                    }
                }


                if(copnBsicAmtGbcd == "1" && totStlmAmt < Number(bsicAmt)) {
                    alert("최종 결제 금액이 " + bsicAmt + "원 이상일 때에만 사용 할 수 있습니다");
                    return;
                }else if(copnBsicAmtGbcd == "2" && totStlmAmt > Number(bsicAmt)) {
                    alert("최종 결제 금액이 " + bsicAmt + "원 이하일 때에만 사용 할 수 있습니다");
                    return;
                } else {
                    var kind = $("input[name='discountType1']:checked").attr("kind");
                    var alliCrdCd = $("input[name='discountType1']:checked").attr("crdCd");
                    var tcCd = $("input[name='discountType1']:checked").val();

                    if((kind == "2" || (kind == "1" && alliCrdCd == "04")) && !isEmpty(tcCd)) {   // 직원할인(+현대패밀리)은 쿠폰과 중복사용 불가능
                        alertMsg("쿠폰할인과 직원할인은\n동시에 이용하실 수 없습니다.");
                        $("input[name='selPaymentCopn'].noneCopn").prop("checked",true);
                    }else{
                        $("input[name=paymentCopnInf]").val(copnNo + "|" + copnTypeGbcd + "|" + famtFxrtGbcd + "|" + famtFxrtVal + "|" + maxDcPossAmt + "|" + bsicAmt + "|" + copnBsicAmtGbcd + "|" + copnPblcNo + "|" + stlmFixYn + "|" + stlmFixGbcd);
                    }
                }
            }

            calculateOrderAmt();

            // 결제고정여부 확인
            if(stlmFixYnObj == "Y") {
                setPayCopnPayType(stlmFixGbcd);
            } else {
                restoreLastPayType();
            }
        }

        function setPaymentCopnHide(realStlmAmt) {
            var optCnt = 0;
            var hideCnt = 0;
            var result = false;

            $("div[name='cuponSearch']").find("input[name='selPaymentCopn']").each(function() {
                if(!isEmpty($(this).val()) && !$(this).hasClass("noneCopn")) {
                    var bsicAmt = $(this).val().split("|")[5];
                    var copnBsicAmtGbcd = $(this).val().split("|")[6];
                    var radioId = $(this).attr("id");

                    // 이하
                    if(copnBsicAmtGbcd == "2" || ((isEmpty(bsicAmt) || bsicAmt <= 0) && isEmpty(copnBsicAmtGbcd))) {
                        if(realStlmAmt < Number(bsicAmt)) {
                            $(this).show();
                            $("label[for='"+radioId+"']").show();
                        } else {
                            $(this).hide();
                            $("label[for='"+radioId+"']").hide();
                        }
                    } else {
                        if(realStlmAmt >= Number(bsicAmt)) {
                            $(this).show();
                            $("label[for='"+radioId+"']").show();
                        } else {
                            $(this).hide();
                            $("label[for='"+radioId+"']").hide();
                        }
                    }
                }
            });

            $("div[name='cuponSearch']").find("input[name='selPaymentCopn']").each(function() {
                optCnt++;
                if($(this).css("display") == "none") {
                    hideCnt++;
                }
            });

            if((optCnt -1) == hideCnt) {
                var copnDcCnt = $("div[name='copnDcDiv']").length;
                if(copnDcCnt == 1){
                    $("#copnSaleDiv").hide();
                }else{
                    $("#copnDcCnt").text(copnDcCnt-1);
                }

                $("#stlmAmtDcDiv").hide();
                $("#paymentCopnBtn").prop("disabled", true);
                result = false;

            } else {
                var copnDcCnt = $("div[name='copnDcDiv']").length;
                if(copnDcCnt == 1){
                    $("#copnSaleDiv").show();
                }else{
                    if($("#stlmAmtDcDiv").css("display") == "none"){
                        $("#copnDcCnt").text(copnDcCnt+1);
                    }
                }

                $("#stlmAmtDcDiv").show();
                $("#paymentCopnBtn").prop("disabled", false);
                result = true;
            }

            return result;
        }

        function dcAreaCnt() {
            var result = 0;

            var arsDcAreaYn = $("#discount0").length > 0 ? "Y" : "N";
            var spymDcAreaYn = $("#discount1").length > 0 ? "Y" : "N";
            var prmoDcAreaYn = $("#discount2").length > 0 ? "Y" : "N";
            var svmtDcAreaYn = $("#sale").length > 0 ? "Y" : "N";
            var gnrlCopnAreaYn = $("div[name='cuponSearch'].gnrlCopn ").length > 0 ? "Y" : "N";
            var cuponliMoreAreaYn = $("input[name='discountType1']").length > 0 ? "Y" : "N";

            if(arsDcAreaYn == "Y") result++;
            if(spymDcAreaYn == "Y") result++;
            if(prmoDcAreaYn == "Y") result++;
            if(svmtDcAreaYn == "Y") result++;
            if(gnrlCopnAreaYn == "Y") result++;
            if(cuponliMoreAreaYn == "Y") result++;

            return result;
        }

        /**
         * W포인트 체크
         */
        function useWPoint(obj, isAllAmt) {
            if(obj.checked) {
                //카드즉시할인KJH WPoint 체크 시 결제영역 초기화 및 주문금액 재계산
                clearPayTypeArea();
                calculateOrderAmt();

                var totStlmAmt = Number($("input[name='totStlmAmt']").val());
                var wPoint = Number($("#assetWpoint").val());
                if(wPoint > 0 && totStlmAmt >= 0) {
                    if(totStlmAmt < wPoint) {
                        if(isAllAmt) $("input[name='useWPoint']").val(gfn_appendComma(totStlmAmt) + "원");
                        else $("input[name='useWPoint']").val("0원");
                    } else {
                        if(isAllAmt) $("input[name='useWPoint']").val(gfn_appendComma(wPoint) + "원");
                        else $("input[name='useWPoint']").val("0원");
                    }
                }
            } else {
                $("input[name='useWPoint']").val("0원");
            }

            clearPayTypeArea();
            calculateOrderAmt();
            restoreLastPayType();
        }

        /**
         * W포인트 입력
         */
        function directInsertWPoint() {
            clearPayTypeArea();

            var obj = $("#useWPoint");
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());
            var wPoint = Number($("#assetWpoint").val());
            var useWPoint = isEmpty(obj.val()) ? 0 : ufnToNum(obj.val());

            if(useWPoint > wPoint) {
                alert("사용하실 W포인트가 보유한 포인트보다 큽니다.");
                if(totStlmAmt < wPoint) {
                    obj.val(gfn_appendComma(totStlmAmt + useWPoint));
                } else {
                    obj.val(gfn_appendComma(wPoint));
                }
            } else {
                if(totStlmAmt < 0) {
                    obj.val(gfn_appendComma(totStlmAmt + useWPoint));
                } else {
                    obj.val(gfn_appendComma(useWPoint));
                }
            }

            calculateOrderAmt();
            restoreLastPayType();
        }

        function focusOutWPoint(obj) {
            directInsertWPoint();
        }

        // 결제금액할인 쿠폰의 결제구분코드를 받아서 결제수단을 설정한다
        function setPayCopnPayType(stlmFixGbcd) {
            isPayCopnPayTypeSet = true;
            if(appOpsyVerNm.startsWith("4.") == true){
                $('select[name="stlmCrdInf"]').attr('disabled', 'disabled');
            }
            var payTypeGbcd = getPayCopnFixGbcd(stlmFixGbcd);

            $(".payment-wrap").show();
            if(payTypeGbcd == '10') { //카드
                if($(".payment-wrap a.type-card").length > 0) {
                    $(".payment-wrap a.type-card").addClass("on");
                    $(".payment-option-area").show();
                    $("#pay1").show();
                    $("div[name='pay1CardPrmo'],#pay1CrdAftDmndPrmo").show();

                    $("select[name='stlmCrdInf'] option").each(function() {
                        var stlmCrdInf = $(this).val();
                        if(isPayCopnPayTypeSet){
                            if(!isEmpty(stlmCrdInf) && stlmCrdInf.split("|")[0] == stlmFixGbcd) {
                                $('#stlmCrdInf').val(stlmCrdInf);
                            }
                        }else{
                            if(!isEmpty(stlmCrdInf) && stlmCrdInf.split("|")[0] == stlmWayCd) {
                                $('#stlmCrdInf').val(stlmCrdInf);
                            }
                        }
                    });
                    //카드 정보 세팅
                    cardPromInf();
                    selectCrdcCd($('#stlmCrdInf'));
                }
            }else if(payTypeGbcd == '20') {   //무통장입급
                if($(".payment-wrap a.type-bankacc").length > 0) {
                    $(".payment-wrap a.type-bankacc").addClass("on");
                    //$(".paymentArea li.select_bank").addClass("selected");
                    $("#selectBank").show();
                    $(".payment-option-area").show();
                    $("select[name='wibkBankCd'] option").each(function() {
                        var wibkBankCd = $(this).val();
                        if(!isEmpty(wibkBankCd) && wibkBankCd == stlmWayCd) {
                            $('#wibkBankCd').val(wibkBankCd);
                            /* console.log("wibkBankCd = " + wibkBankCd); */
                        }
                    });

                    if($("#order2016Alert div[name='crdcCd_20']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_20']").show();
                    }
                }
            }else if(payTypeGbcd == '40') {   //휴대폰결제
                if($(".payment_select.boxtype li.select_mobile").length > 0) {
                    $(".payment_select.boxtype li.select_mobile").addClass("selected");
                    $(".payment-option-area").show();
                    $(".sub-area.hpDesc").show();

                    // 휴대폰결제 장애체크
                    if($("#order2016Alert div[name='crdcCd_40']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_40']").show();
                    }
                }
            }else if(payTypeGbcd == '90') {   //페이나우
                if($(".payment_select.boxtype li.select_paynow").length > 0) {
                    cardPromInf();
                    $(".payment_select.boxtype li.select_paynow").addClass("selected");
                    $(".paymentArea li.select_simple").addClass("selected");
                    $(".paymentArea ul.simple_pay li:eq(0)").addClass("selected");
                    $(".sub-area.pay4").show();
                    $(".paymentArea .select_simple .paynowSub").show();
                    $(".payment-option-area").show();
                }
            }else if(payTypeGbcd == '91') {   //Payco
                if($(".payment_select.boxtype li.select_payco").length > 0) {
                    $(".payment_select.boxtype li.select_payco").addClass("selected");
                    $(".paymentArea li.select_simple").addClass("selected");
                    $(".paymentArea ul.simple_pay li:eq(1)").addClass("selected");
                    $(".sub-area.pay5").show();
                    $(".paymentArea .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                }
            }else if(payTypeGbcd == '92') {   //SyrupPay
                if($(".payment_select.boxtype li.select_syruppay").length > 0) {
                    $(".payment_select.boxtype li.select_syruppay").addClass("selected");
                    $(".paymentArea li.select_simple").addClass("selected");
                    $(".paymentArea ul.simple_pay li:eq(2)").addClass("selected");
                    $(".sub-area.pay6").show();
                    $(".paymentArea .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                }
            }else if(payTypeGbcd == '93') {   //삼성페이
                if($(".payment_select.boxtype li.select_samsungpay").length > 0) {
                    cardPromInf();
                    $(".payment_select.boxtype li.select_samsungpay").addClass("selected");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".payment_selectsub ul.simple_pay li:eq(3)").addClass("selected");
                    $(".sub-area.pay7").show();
                    $(".payment_selectsub .select_simple .paynowSub").show();
                    $(".payment_selectsub").show();
                }
            }else if(payTypeGbcd == '94') {   //카카오페이 : 20170210 goodsin 카카오페이 추가
                if($(".payment_select.boxtype li.select_kakaopay").length > 0) {
                    $(".payment_select.boxtype li.select_kakaopay").addClass("selected");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".payment_selectsub ul.simple_pay li.simple_pay_kakaopay").addClass("selected");
                    $(".sub-area.pay8").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment_selectsub").show();
                }
            }else if(payTypeGbcd == '95') {   //네이버페이
                if($(".payment_select.boxtype li.select_naverpay").length > 0) {
                    $(".payment_select.boxtype li.select_naverpay").addClass("selected");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".payment_selectsub ul.simple_pay li.simple_pay_naverpay").addClass("selected");
                    $(".sub-area.pay9").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment_selectsub").show();
                }
            }else if(payTypeGbcd == '96') {   //스마일페이
                if($(".payment_select.boxtype li.select_smilepay").length > 0) {
                    $(".payment_select.boxtype li.select_smilepay").addClass("selected");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".payment_selectsub ul.simple_pay li.simple_pay_smilepay").addClass("selected");
                    $(".sub-area.pay10").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment_selectsub").show();
                }
            }else if(payTypeGbcd == '97') {   //신카카오 페이
                if($(".payment_select.boxtype li.select_newkakaopay").length > 0) {
                    $(".payment_select.boxtype li.select_newkakaopay").addClass("selected");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".payment_selectsub ul.simple_pay li.simple_pay_newkakaopay").addClass("selected");
                    $(".sub-area.pay11").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment_selectsub").show();
                }
            }else if(payTypeGbcd == '99') {   //HPAY
                if($(".payment_select.boxtype li.select_simplepay.hmall-pay").length > 0) {
                    $(".payment_select.boxtype li.select_simplepay.hmall-pay").addClass("selected");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".sub-area.pay13").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment_selectsub").show();
                }
            }else if(payTypeGbcd == '81') {   //toss
                if($(".payment_select.boxtype li.select_simplepay.toss").length > 0) {
                    $(".payment_select.boxtype li.select_simplepay.toss").addClass("selected");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".sub-area.pay14").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment_selectsub").show();
                }
            }else if(payTypeGbcd == '82') {   // nfc 결제
                if($(".payment_select.boxtype li.select_simplepay.nfc").length > 0) {
                    $(".payment_select.boxtype li.select_simplepay.nfc").addClass("selected");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".sub-area.pay15").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment_selectsub").show();
                }
            }
            // 현금영수증
            calculateCashRcptAmt();
        }

        //결제금액할인 쿠폰에서 해당하는 결제수단이 없으면 그 쿠폰은 숨긴다
        function setHidePayCopn() {
            if($("input[name='paymentCopnInf']").length > 0) {
                $("div[name='cuponSearch'] input[name='selPaymentCopn']").each(function() {

                    if(!isEmpty($(this).val())) {
                        var selectValues = $(this).val().split("|");

                        var stlmFixYn = selectValues[8];
                        var stlmFixGbcd = selectValues[9];
                        var payTypeGbcd = getPayCopnFixGbcd(stlmFixGbcd);
                        var isShow = false;

                        if(stlmFixYn == "Y") {
                            // 신용카드
                            if(payTypeGbcd == "10") {
                                if($(".payment-wrap a.type-card").length > 0 && $(".payment-wrap a.type-card").css("display") != "none") {
                                    $("select[name='stlmCrdInf'] option").each(function() {
                                        var stlmCrdInf = $(this).val();
                                        if(!isEmpty(stlmCrdInf) && stlmCrdInf.split("|")[0] == stlmFixGbcd) {
                                            isShow = true;
                                            return false;
                                        }
                                    });
                                }
                            }
                            // 무통장
                            else if(payTypeGbcd == "20") {
                                if($(".payment-wrap a.type-bankacc").length > 0 && $(".payment-wrap a.type-bankacc").css("display") != "none") {
                                    isShow = true;
                                }
                            }
                            // PAYCO
                            else if(payTypeGbcd == "91") {
                                if($(".payment-wrap a.type-payco").length > 0 && $(".payment-wrap a.type-payco").css("display") != "none") {
                                    isShow = true;
                                }
                            }
                            // 삼성페이
                            else if(payTypeGbcd == "93") {
                                if($(".payment-wrap a.type-samsungpay").length > 0 && $(".payment-wrap a.type-samsungpay").css("display") != "none") {
                                    isShow = true;
                                }
                            }
                            // 네이버페이
                            else if(payTypeGbcd == "95") {
                                if($(".payment-wrap a.type-naverpay").length > 0 && $(".payment-wrap a.type-naverpay").css("display") != "none") {
                                    isShow = true;
                                }
                            }
                            // 스마일페이
                            else if(payTypeGbcd == "96") {
                                if($(".payment-wrap a.type-smilepay").length > 0 && $(".payment-wrap a.type-smilepay").css("display") != "none") {
                                    isShow = true;
                                }
                            }
                            // 신카카오페이
                            else if(payTypeGbcd == "97") {
                                if($(".payment-wrap a.type-kakaopay").length > 0 && $(".payment-wrap a.type-kakaopay").css("display") != "none") {
                                    isShow = true;
                                }
                            }
                            // hmallPay
                            else if(payTypeGbcd == "99") {
                                if($(".payment-wrap a.type-hmallpay").length > 0 && $(".payment-wrap a.type-hmallpay").css("display") != "none") {
                                    isShow = true;
                                }
                            }
                            // toss
                            else if(payTypeGbcd == "81") {
                                if($(".payment-wrap a.type-toss").length > 0 && $(".payment-wrap a.type-toss").css("display") != "none") {
                                    isShow = true;
                                }
                            }
                            // nfc 결제
                            else if(payTypeGbcd == "82") {
                            	if($(".payment-wrap a.type-nfc").length > 0 && $(".payment-wrap a.type-nfc").css("display") != "none") {
                                    isShow = true;
                                }
                        	}
                        }
                        // 고정구분코드 N 일 때에는 무조건 표시
                        else {
                            isShow = true;
                        }

                        if(isShow && $(this).css("display") != "none") {
                            $(this).show();
                            $("label[for='"+$(this).attr("id")+"']").show();
                        } else {
                            $(this).hide();
                            $("label[for='"+$(this).attr("id")+"']").hide();
                        }
                    }
                });

                var optCnt = 0;
                var hideCnt = 0;
                $("div[name='cuponSearch'] input[name='selPaymentCopn']").each(function() {
                    optCnt++;
                    if($(this).css("display") == "none") {
                        hideCnt++;
                    }
                });

                if((optCnt -1) == hideCnt) {
                    var copnDcCnt = $("div[name='copnDcDiv']").length;
                    if(copnDcCnt == 1){
                        $("#copnSaleDiv").hide();
                    }else{
                        $("#copnDcCnt").text(copnDcCnt-1);
                    }

                    $("#stlmAmtDcDiv").hide();
                    $("#paymentCopnBtn").prop("disabled", true);
                } else {
                    var copnDcCnt = $("div[name='copnDcDiv']").length;
                    if(copnDcCnt == 1){
                        $("#copnSaleDiv").show();
                    }else{
                        if($("#stlmAmtDcDiv").css("display") == "none"){
                            $("#copnDcCnt").text(copnDcCnt+1);
                        }
                    }

                    $("#stlmAmtDcDiv").show();
                    $("#paymentCopnBtn").prop("disabled", false);
                }
            }
        }

        // ft014 20190814 hmallpay간편결제 예상 H.point 계산
        // fnGetPrmoSmplPoint(상품코드, 코드그룹가격합, 할인가격)
        function fnGetPrmoSmplPoint(vSlitmCd, vSellPrc, vDcAmt, vPrmoNo) {
            var tSellPrc        = vSellPrc - Number(vDcAmt == null || vDcAmt == ""?0:vDcAmt);
            var tHPoint         = 0;
            var sSlitmCd        = "";
            var sPrmoNo         = "";
            var smplPrmoSaveYn  = "";
            //alert("vSlitmCd = "+vSlitmCd+", vSellPrc = "+vSellPrc+", vDcAmt = "+", vPrmoNo = "+vPrmoNo+", vTotUseAmt ="+vTotUseAmt+", tSellPrc = "+tSellPrc);

            
            // 프로모션 구분 + 적립 + 모바일 + 해당자여부
            

            sPrmoNo     = 'P202105281079';                  //코드
            if(sPrmoNo == vPrmoNo){
                var sStrtVal            = 50000;           //기준금액 이상
                var sEndVal             = 999999999999;            //기준금액 이하
                var sBndsAmt            = '10000';         //한도금액
                var sFamtFxrtVal        = 1;       //적용 정액/정율 값
                var sFamtFxrtGbcd       = '1';    //적용 정액/정율 구분

                sBndsAmt = isEmpty(sBndsAmt) ? 999999999 : Number(sBndsAmt);

                //금액 체크
                if(sStrtVal <= tSellPrc && sEndVal >= tSellPrc ){
                    //정율
                    if (sFamtFxrtGbcd == '1'){
                        var wPrmoHPoint = Math.floor(tSellPrc * Number(sFamtFxrtVal) / 1000) * 10;          //임시 예상Hpoint

                        tHPoint = sBndsAmt < wPrmoHPoint ? sBndsAmt : wPrmoHPoint;  //한도금액
                    }
                    //정액
                    if (sFamtFxrtGbcd == '2'){
                        var wPrmoHPoint = Number(sFamtFxrtVal);         //임시 예상Hpoint

                        tHPoint = sBndsAmt < wPrmoHPoint ? sBndsAmt : wPrmoHPoint;
                    }
                    if(tHPoint > 0)
                        return tHPoint;
                }
            }
            
            

            return tHPoint;
        }

        //ft014 20190814 hmallpay간편결제 예상 H.point 대상상품 여부
        function fnGetPrmoSmplPointYn(vSlitmCd) {
            var sSlitmCd = "";
            // (taxItemExstYn eq 'N' or ntaxItemExstYn eq 'N') && !empty memberBaseInf && stlmWayCardOnlyYn eq 'N' and simpleStlmExcepYn eq 'N'
            // (과세상품 존재여부 or 면세상품 존재여부) and 멤버 and 결제수단 개인카드만 사용 and 간편결제수단 예외 처리
            //<!-- Y, N, N, N -->
            
            
            // 프로모션 구분 + 적립 + 모바일 + 해당자여부
            

            sSlitmCd        = '2101185938';                 //코드
            if(sSlitmCd == vSlitmCd){
                return 'P202105281079';
            }

            
            
            
            return "N";
        }


        // 결제금액쿠폰의 고정구분코드를 받아서 stlmWayType 으로 변환한다
        function getPayCopnFixGbcd(stlmFixGbcd) {
            var result = "";

            if(isEmpty(stlmFixGbcd)) return result;

            // 페이나우
            if(stlmFixGbcd == "A1") {
                result = "90";
            }
            // PAYCO
            else if(stlmFixGbcd == "A2") {
                result = "91";
            }
            // 시럽페이
            else if(stlmFixGbcd == "A3") {
                result = "92";
            }
            // 삼성페이
            else if(stlmFixGbcd == "A4") {
                result = "93";
            }
            // 카카오페이
            else if(stlmFixGbcd == "A5") {
                result = "94";
            }
            // HmallPay
            else if(stlmFixGbcd == "A6") {
                result = "99";
            }
            // 신카카오페이
            else if(stlmFixGbcd == "A8") {
                result = "97";
            }
            // TOSS
            else if(stlmFixGbcd == "A9") {
                result = "81";
            }
            // 무통장입금
            else if(stlmFixGbcd == "B1") {
                result = "20";
            }
        	// 스마일 페이
            else if(stlmFixGbcd == "B2") {
                result = "96";
            } 
         	// nfc 결제
            else if(stlmFixGbcd == "B3") {
                result = "82";
            } 
            // 신용카드
            else {
                result = "10";
            }

            return result;
        }


        function allAgree(){

            var isChecked = $("#allAgree").is(":checked");


            if(!$("#agreeChk").is(":disabled")){
                $("#agreeChk").prop("checked", isChecked);
            }
            if(!$("#dlvAdrSaveYn").is(":disabled")){
                $("#dlvAdrSaveYn").prop("checked", isChecked);
            }
            if(!$("#frdlvAgreeChk").is(":disabled")){
                $("#frdlvAgreeChk").prop("checked", isChecked);
            }
            /* if(!$("#stlmWaySaveYn").is(":disabled")){
        $("#stlmWaySaveYn").prop("checked", isChecked);
    } */
            if(!$("#psnCucrVenArgCheck").is(":disabled")){
                $("#psnCucrVenArgCheck").prop("checked", isChecked);
            }
            if(!$("#psnCucrReUseYnCheck").is(":disabled")){
                $("#psnCucrReUseYnCheck").prop("checked", isChecked);
            }
            if(!$("#nonMemberAgreeChk").is(":disabled")){
                $("#nonMemberAgreeChk").prop("checked", isChecked);
            }

        }

        var isHanaHoneyProgress = false;

        function useHanaMoneyPop(obj) {
        	if($("#hanaCheck").is(":checked") == true){
				openSubLayerPopup($(obj).data("etc-point"));
			}else{
	            $("input[name='stlmHanaMoneyAmt']").val(0);
	            $("span[name='useHanamoneyAmt']").text("0P");
	
	            $("input[name='selectHnmoAmt']").val('');
	            $("input[name='useHnmoAmt']").attr("disabled", true);
	            $("input[name='useHnmoAmt']").val("0P");
	            $("input[name='hnmoOtp']").val("");

	            etcPointTotal();
	            calculateOrderAmt();
			}
        }


        function checkHanaMoney(otpSendYn) {
            // 회원정보 제공 동의 확인
            if($("input[name='hnmoAgree']").is(":checked") != true) {
                alert("포인트 조회를 위해 개인정보 수집·이용에 동의해주시기 바랍니다.");
                return;
            }

            var hnmoNm = $("input[name='hnmoNm']").val();
            var hnmoHp = $("input[name='hnmoHp']").val();

            if(isEmpty(hnmoNm)){
                alert('성함을 입력해주세요.');
                return;
            }

            if(hnmoHp.length < 10 || hnmoHp.length > 11){
                alert('올바른 휴대폰번호를 입력해주세요.');
                return;
            }

            if(!isHanaHoneyProgress){
                isHanaHoneyProgress = true;
                $.ajax({
                    type: "post"
                    , url: "/m/oda/checkHanaMoney.do"
                    , dataType: "json"
                    , data : {hnmoNm : hnmoNm, hnmoHp : hnmoHp, otpSendYn : 'Y'}
                    ,success : function(data) {
                        isHanaHoneyProgress = false;
                        if(!isEmpty(data.rtnMsg)) {
                            alert(data.rtnMsg);
                        } else {
                        	$("input[name='selectHnmoAmt']").attr("type", "text");
                            $("input[name='selectHnmoAmt']").val(gfn_appendComma(Number(data.rtnAmt)));
                            $("input[name='useHnmoAmt']").attr("disabled", false);
                            $("input[name='useHnmoAmt']").val(0);
                        }
                    }
                    , error: function(data) {
                        isHanaHoneyProgress = false;
                        alert("하나머니 조회에 실패하였습니다.");
                    }
                });
            }else{
                alert("하나머니를 조회중입니다. 기다려주세요.");
            }

        }

        function useHanaMoneyAll() {
            var selectHnmoAmt = ufnToNum($("input[name='selectHnmoAmt']").val());
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());
            
			if(selectHnmoAmt == 0){
				return;
			}
			
			$("input[name='useHnmoAmt']").attr("type", "text");
			
            if(totStlmAmt > selectHnmoAmt){
                $("input[name='useHnmoAmt']").val(gfn_appendComma(selectHnmoAmt));
            }else{
                $("input[name='useHnmoAmt']").val(gfn_appendComma(totStlmAmt));
            }
        }


        function useHanaMoney() {

            var useHnmoAmt = ufnToNum($("input[name='useHnmoAmt']").val());
            var selectHnmoAmt = ufnToNum($("input[name='selectHnmoAmt']").val());
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());

            var hnmoOtp = $("input[name='hnmoOtp']").val();

            if(isEmpty(useHnmoAmt) || useHnmoAmt <= 0){
                alert("하나머니 사용금액이 없습니다.");
                return;
            }


            if(selectHnmoAmt < useHnmoAmt){
                alert("하나머니를 보유포인트 이상 사용할수 없습니다.");
                return;
            }


            if(isEmpty(hnmoOtp)){
                alert("하나머니 사용을 위해 인증번호를 입력해주세요.");
                return;
            }

            if(!isHanaHoneyProgress){
                isHanaHoneyProgress = true;
                $.ajax({
                    type: "post"
                    , url: "/m/oda/authHanaMoney.do"
                    , dataType: "json"
                    , data : {hnmoOtp : hnmoOtp}
                    ,success : function(data) {
                        isHanaHoneyProgress = false;
                        if(!isEmpty(data.rtnMsg)) {
                            alert(data.rtnMsg);
                        } else {

                            if(totStlmAmt < useHnmoAmt){
                                useHnmoAmt = totStlmAmt;
                            }

                            $("input[name='stlmHanaMoneyAmt']").val(useHnmoAmt);
                            $("span[name='useHanamoneyAmt']").text(gfn_appendComma(useHnmoAmt)+"P");
                            calculateOrderAmt();
                            $("#hanaCheck").prop("checked", true);

                            etcPointTotal();
                            backStateLayerPopup();
                        }
                    }
                    , error: function(data) {
                        isHanaHoneyProgress = false;
                        alert("하나머니 조회에 실패하였습니다.");
                    }
                });
            }else{
                alert("하나머니를 조회중입니다. 기다려주세요.");
            }

        }
        var isCultureCashProgress = false;
        function useCultureCashPop(obj) {
        	if($("#chk29").is(":checked") == true){
				openSubLayerPopup($(obj).data("etc-point"));
			}else{
	            $("input[name='stlmCultureCashAmt']").val(0);
	            $("span[name='useCultureCashAmt']").text("0P");
	
	            $("input[name='selectCultureAmt']").val('');
	            $("input[name='useCultureAmt']").attr("disabled", true);
	            $("input[name='useCultureAmt']").val("0P");
	
	            etcPointTotal();
	            calculateOrderAmt();
			}
        }

        function checkCultureCash() {

            //조회 버튼을 눌렀을 때 초기화 해준다
            $("input[name='stlmCultureCashAmt']").val(0);
            $("span[name='useCultureCashAmt']").text("0P");

            $("input[name='selectCultureAmt']").val('');
            $("input[name='useCultureAmt']").attr("disabled", true);
            $("input[name='useCultureAmt']").val("0P");

            var culturelandId = $("input[name='culturelandId']").val();
            var culturelandPwd = $("input[name='culturelandPwd']").val();

            if(isEmpty(culturelandId)){
                alert("아이디를 입력해주세요.");
                return;
            }

            if(isEmpty(culturelandPwd)){
                alert("비밀번호를 입력해주세요.");
                return;
            }


            if(!isCultureCashProgress){
                isCultureCashProgress = true;
                $.ajax({
                    type: "post"
                    , url: "/m/oda/checkCultureCash.do"
                    , dataType: "json"
                    , data : {culturelandId : culturelandId, culturelandPwd : culturelandPwd}
                    ,success : function(data) {
                        isCultureCashProgress = false;
                        if(!isEmpty(data.result.errMsg)) {
                            alert(data.result.errMsg);
                        } else {
                        	$("input[name='selectCultureAmt']").attr("type", "text");
                        	$("input[name='selectCultureAmt']").val(gfn_appendComma(Number(data.result.mcashAmount)));
                            $("input[name='useCultureAmt']").attr("disabled", false);
                            $("input[name='useCultureAmt']").val(0);

                            $("input[name='onlnGcId']").val(culturelandId);
                            $("input[name='culturelandCustId']").val(data.result.custId);
                            $("input[name='culturelandHashNo']").val(data.result.hashNo);
                        }
                    }
                    , error: function(data) {
                        isCultureCashProgress = false;
                        alert("컬쳐캐쉬 조회에 실패하였습니다. 컬쳐랜드 아이디와 비밀번호를 다시 확인해주세요");
                    }
                });
            }else{
                alert("컬쳐캐쉬를 조회중입니다. 기다려주세요.");
            }

        }

        function useCultureCashAll() {
            var selectCultureAmt = ufnToNum($("input[name='selectCultureAmt']").val());
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());

			if(selectCultureAmt == 0){
				return;
			}
			
			$("input[name='useCultureAmt']").attr("type", "text");
			
            if(totStlmAmt > selectCultureAmt){
                $("input[name='useCultureAmt']").val(gfn_appendComma(selectCultureAmt));
            }else{
                $("input[name='useCultureAmt']").val(gfn_appendComma(totStlmAmt));
            }
        }

        function useCultureCash() {

            var useCultureAmt = ufnToNum($("input[name='useCultureAmt']").val());
            var selectCultureAmt = ufnToNum($("input[name='selectCultureAmt']").val());
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());

            if(isEmpty(useCultureAmt)){
                alert("사용하실 컬쳐캐쉬 금액을 입력해주세요.");
                return;
            }

            if(useCultureAmt < 10){
                alert("컬쳐캐쉬 최소 10원 이상부터 사용가능합니다");
                return;
            }

            if(selectCultureAmt < useCultureAmt){
                alert("컬처캐쉬 잔액이 부족하거나 한도를 초과하였습니다. 확인 후 재입력 바랍니다.");
                return;
            }


            if(totStlmAmt < useCultureAmt){
                useCultureAmt = totStlmAmt;
            }

            //$("input[name='stlmCultureCashAmt']").val(useCultureAmt);
            $("span[name='useCultureCashAmt']").text(gfn_appendComma(useCultureAmt)+"P");
            $("input[name='onlnGcGbcd']").val("03");
            calculateOrderAmt();
            calculateCashRcptAmt();

            $("#chk29").prop("checked",true);

            etcPointTotal();
            backStateLayerPopup();

        }
        
		var isBluePointProgress = false;
        
        function useBluePointPop(obj) {
        	if($("#bluePointCheck").is(":checked") == true) {
                openSubLayerPopup(obj);
        	}else{
                $("input[name='stlmBlpntAmt']").val(0);
                $("span[name='useBluePointAmt']").text("0P");

                $("input[name='selectBluePointAmt']").val('');
                $("input[name='useBluePointAmt']").attr("disabled", true);
                $("input[name='useBluePointAmt']").val("0P");

                etcPointTotal();
                calculateOrderAmt();
        	}
        }
        
        function useBluePointAll() {
            var selectBluePointAmt = ufnToNum($("input[name='selectBluePointAmt']").val());
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());
          
			if(selectBluePointAmt == 0){
				return;
			}
			
            $("input[name='useBluePointAmt']").attr("type", "text");
            
            if(totStlmAmt > selectBluePointAmt){
                $("input[name='useBluePointAmt']").val(gfn_appendComma(selectBluePointAmt));
            }else{
                $("input[name='useBluePointAmt']").val(gfn_appendComma(totStlmAmt));
            }
        }
        
        function checkBluePoint(){
        	//조회 버튼을 눌렀을 때 초기화 해준다
            $("input[name='stlmBlpntAmt']").val(0);
            $("span[name='useBluePointAmt']").text("0P");

            $("input[name='selectBluePointAmt']").val('');
            $("input[name='useBluePointAmt']").attr("disabled", true);
            $("input[name='useBluePointAmt']").val("0P");

            var bluePointCardNo = $("input[name='bluePointCardNo']").val();
            var bluePointCardPwd = $("input[name='bluePointCardPwd']").val();

            // 회원정보 제공 동의 확인
            if($("input[name='bluePointAgree']").is(":checked") != true) {
                alert("포인트 조회를 위해 개인정보 수집·이용에 동의해주시기 바랍니다.");
                return;
            }
            
            if(isEmpty(bluePointCardNo)){
                alert("카드번호를 입력해주세요.");
                return;
            }

            if(isEmpty(bluePointCardPwd)){
                alert("비밀번호를 입력해주세요.");
                return;
            }

            if(!isBluePointProgress){
            	isBluePointProgress = true;
                $.ajax({
                    type: "post"
                    , url: "/m/oda/checkBluePoint.do"
                    , dataType: "json"
                    , data : {bluePointCardNo : bluePointCardNo, bluePointCardPwd : bluePointCardPwd}
                    ,success : function(data) {
                    	isBluePointProgress = false;
                        if(!isEmpty(data.rtnMsg)) {
                            alert(data.rtnMsg);
                        } else {
							$("input[name='selectBluePointAmt']").attr("type", "text");
                            $("input[name='selectBluePointAmt']").val(gfn_appendComma(Number(data.rtnAmt)));
                            $("input[name='useBluePointAmt']").attr("disabled", false);
                            $("input[name='useBluePointAmt']").val(0);
                            $("input[name='stlmBlpntCrdNo']").val(bluePointCardNo);
                            $("input[name='stlmBlpntCrdPwd']").val(bluePointCardPwd);
                            $("input[name='stlmBlpntCustNo']").val(data.rtnBlpntCustNo);
                        }
                    }
                    , error: function(data) {
                    	isBluePointProgress = false;
                        alert("블루포인트 조회에 실패하였습니다. 블루포인트 카드번호와 비밀번호를 다시 확인해주세요.");
                    }
                });
            }else{
                alert("블루포인트를 조회 중입니다. 기다려주세요.");
            }
        }

        function useBluePoint() {
            var useBluePointAmt = ufnToNum($("input[name='useBluePointAmt']").val());
            var selectBluePointAmt = ufnToNum($("input[name='selectBluePointAmt']").val());
            var totStlmAmt = Number($("input[name='totStlmAmt']").val());
            var stlmBlpntCrdNo = $("input[name='stlmBlpntCrdNo']").val();
            var stlmBlpntCustNo = $("input[name='stlmBlpntCustNo']").val();

            if(isEmpty(useBluePointAmt) || useBluePointAmt <= 0){
                alert("블루포인트 사용금액이 없습니다.");
                return;
            }

            if(selectBluePointAmt < useBluePointAmt){
                alert("블루포인트를 보유포인트 이상 사용할 수 없습니다.");
                return;
            }
            
            if(!isBluePointProgress){
            	isBluePointProgress = true;
                $.ajax({
                    type: "post"
                    , url: "/m/oda/checkLimitBluePoint.do"
                    , dataType: "json"
                    , data : {stlmBlpntCrdNo : stlmBlpntCrdNo, stlmBlpntCustNo : stlmBlpntCustNo, useBluePointAmt : useBluePointAmt}
                    ,success : function(data) {
                    	isBluePointProgress = false;
                        if(!isEmpty(data.rtnMsg)) {
                            alert(data.rtnMsg);
                        } else {
                            if(totStlmAmt < useBluePointAmt){
                            	useBluePointAmt = totStlmAmt;
                            }
                            $("input[name='stlmBlpntAmt']").val(useBluePointAmt);
                            $("span[name='useBluePointAmt']").text(gfn_appendComma(useBluePointAmt)+"P");
                            calculateOrderAmt();
                            $("#bluePointCheck").prop("checked", true);
                            etcPointTotal();
                            backStateLayerPopup();
                        }
                    }
                    , error: function(data) {
                    	isBluePointProgress = false;
                        alert("블루포인트 사용 요청에 실패하였습니다. 다시 시도 부탁드립니다.");
                    }
                });
            }else{
                alert("블루포인트 한도를 확인 중입니다. 기다려주세요.");
            }
        }

        //배송타입 변경시 2018조유진
        function deleveryTypeSelect(str) {
            $("#multi").prop("checked", false);
            $("#multi_false").hide();

            //배송지타입(10:일반) 세팅
            $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val("");
            $("form[name='orderDataForm'] input[name='frdlvYn']").val("N");

            $("input[name='dstnBaseAdr']").val("");
            $("input[name='dstnPtcAdr']").val("");
            $("input[name='dstnPostNo']").val("");

            $("select[name='mmsMsgCntnSelect']").show();
            $("#address_delivery_msg").show();

            if (str == "delivery1") {
                $("input[name='dstnBaseAdr']").val(orgDstnBaseAdr);
                $("input[name='dstnPtcAdr']").val(orgDstnPtcAdr);
                $("input[name='dstnPostNo']").val(orgPostNo);

                $("#multi").prop("checked", false);
                $("#multi_false").show();

                if($("input[name='orderItemTotCount']").val() > 1 && $("input[name='dlvCostExstYn']").val() == 'N' && $("input[name='hasAddItem']").val() == 'N'){
                    $("#multiDlv").show();
                }
            }
            else if (str == "dawn") {
                $("#delivery_type_special").show();
                $("select[name='mmsMsgCntnSelect']").hide();
                $("#address_delivery_msg").hide();

                $("#lastStlmAmtDd em").html(gfn_appendComma(Number($("form[name='orderDataForm'] input[name='dawnTotStlmAmt']").val()))+"원");  // 최종결제금액
                $("form[name='orderDataForm'] input[name='orderAmt']").val($("form[name='orderDataForm'] input[name='dawnOrderAmt']").val());
                $("form[name='orderDataForm'] input[name='totStlmAmt']").val($("form[name='orderDataForm'] input[name='dawnTotStlmAmt']").val());
                $("form[name='orderDataForm'] input[name='realStlmAmt']").val($("form[name='orderDataForm'] input[name='dawnRealStlmAmt']").val());
                $("form[name='orderDataForm'] input[name='totDlvCost']").val($("form[name='orderDataForm'] input[name='dawnDlvCost']").val());      //배송비
                $("input[name='orderAmt']:last").val($("form[name='orderDataForm'] input[name='dawnOrderAmt']").val());
                $(".payment-select-area .type-bankacc").css("display","none");          //바로결제만 가능하도록 무통장입금 none
                $(".payment-select-area .type-ars").css("display","none");

                //배송지타입(60:새벽배송) 세팅
                $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val("60");
            }
            else if (str == "convenience" || str == "subway" || str == "safe" || str == "prem") {
                $("#delivery_type_special").show();

                if (str == "convenience") {
                    $("#multiDlv").hide();
                    $("#multiInfoTxt2").hide();
                    $("#multiInfoTxt1").removeClass("_active");
                    $("#multi").prop("checked", false);

                    $("#delivery_type_convenience1").show();
                    $("#delivery_type_convenience2").show();

                    // 도서지역추가배송비 셋팅
                    var specialDlvType = $("input[name='shipping-type-select']:checked").val();
                    var obj = $(".input-shipping-info."+specialDlvType);        
                    var specialDstnPostNo = $(obj).find("input[name='specialDstnPostNo']").val();
                    getIrgnAreaGbcd(specialDstnPostNo, 0);
                    //배송지타입(20:편의점) 세팅
                    $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val("20");
                }
                else if (str == "subway") {
                    //배송지타입(30:지하철) 세팅
                    $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val("30");
                }
                else if (str == "safe") {
                	// 도서지역추가배송비 셋팅
                    var specialDlvType = $("input[name='shipping-type-select']:checked").val();
                    var obj = $(".input-shipping-info."+specialDlvType);
                    var specialDstnPostNo = $(obj).find("input[name='specialDstnPostNo']").val();
                    getIrgnAreaGbcd(specialDstnPostNo, 0);
                	//배송지타입(40:안심배송) 세팅
                    $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val("40");

                }
                else if (str == "prem") {

                    $("#delivery_type_prem").show();

                    $("#lastStlmAmtDd em").html(gfn_appendComma(Number($("form[name='orderDataForm'] input[name='premTotStlmAmt']").val()))+"원");  // 최종결제금액
                    $("form[name='orderDataForm'] input[name='orderAmt']").val($("form[name='orderDataForm'] input[name='premOrderAmt']").val());
                    $("form[name='orderDataForm'] input[name='totStlmAmt']").val($("form[name='orderDataForm'] input[name='premTotStlmAmt']").val());
                    $("form[name='orderDataForm'] input[name='realStlmAmt']").val($("form[name='orderDataForm'] input[name='premRealStlmAmt']").val());
                    $("form[name='orderDataForm'] input[name='totDlvCost']").val($("form[name='orderDataForm'] input[name='premDlvCost']").val());
                    $("input[name='orderAmt']:last").val($("form[name='orderDataForm'] input[name='premOrderAmt']").val());
                    $(".payment-select-area .type-bankacc").css("display","none");
                    $(".payment-select-area .type-ars").css("display","none");

                    //배송지타입(50:프리미엄배송(당일배송)) 세팅
                    $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val("50");
                }
            }

            // 프리미엄배송 소스 추가_새벽배송추가_특화배송조유진
            if(str == "prem" || str == "dawn") {
                dlvYn("Y",str);
            }else {

                dlvYn("N",str);
            }

            // 2019.10.30 HMALL개선이주형 일반배송일때만 무료배송비쿠폰 사용가능처리
            if (str == "delivery1") {
                if($("div[name='cuponSearch'] input[name^='freeDlvCopn_']").length > 0) {
                    $("div[name='cuponSearch'] input[name^='freeDlvCopn_']").prop("disabled", false);
                    $("#freeDlvCpnBtn").prop("disabled", false);
                }
            }
            else {
                if($("div[name='cuponSearch'] input[name^='freeDlvCopn_']").length > 0) {
                    $("div[name='cuponSearch'] input[name^='freeDlvCopn_']").each(function () {
                        if ($(this).hasClass("noneCopn")) {
                            $(this).prop("checked", true);
                            selectDlvCopn($(this).parents("div[name='cuponSearch']"));
                        }
                        $(this).prop("disabled", true);
                    });
                    $("#freeDlvCpnBtn").prop("disabled", true);
                }
            }

            clearPayTypeArea();    //프리미엄 배송 주문금액 계산
            calculateOrderAmt();
            restoreLastPayType();
        }

        /*프리미엄/새벽배송 세팅_특화배송조유진*/
        function dlvYn(yn,dlv) {
            if(yn == "Y") {

                if(dlv == "prem"){
                    $("form[name='orderDataForm'] input[name='premDlvYn']").val("Y");
                    premDlvZipCode = "Y";
                }else if(dlv == "dawn"){
                    $("form[name='orderDataForm'] input[name='dawnDlvYn']").val("Y");
                    dawnDlvZipCode = "Y";
                }

                CurStlmWayType = '10';
                restoreLastPayType();

            }else {

                $("#lastStlmAmtDd em").html(gfn_appendComma(Number($("form[name='orderDataForm'] input[name='tmpTotStlmAmt']").val()))+"원");  // 최종결제금액
                $("form[name='orderDataForm'] input[name='orderAmt']").val($("form[name='orderDataForm'] input[name='tmpOrderAmt']").val());
                $("form[name='orderDataForm'] input[name='totStlmAmt']").val($("form[name='orderDataForm'] input[name='tmpTotStlmAmt']").val());
                $("form[name='orderDataForm'] input[name='realStlmAmt']").val($("form[name='orderDataForm'] input[name='tmpRealStlmAmt']").val());
                $("form[name='orderDataForm'] input[name='totDlvCost']").val($("form[name='orderDataForm'] input[name='tmpTotDlvCost']").val());
                $("input[name='orderAmt']:last").val($("form[name='orderDataForm'] input[name='tmpOrderAmt']").val());
                $("form[name='orderDataForm'] input[name='premDlvYn']").val("N");
                $(".payment-select-area .type-bankacc").css("display","inline-flex");
                $(".payment-select-area .type-ars").css("display","inline-flex");
                $(".order2016 .order2016_payment > ul.payment_select").css("width","100%");
                premDlvZipCode = "N";
                $("form[name='orderDataForm'] input[name='dawnDlvYn']").val("N");
                dawnDlvZipCode = "N";

            }
            $("#totDlvCostTxt").html(gfn_appendComma(Number($("form[name='orderDataForm'] input[name='totDlvCost']").val()))+"원");
        }

        //할인한도금액 초과시 할인한도 금액으로 할인 처리
        function gfn_getTcDcAmt(pAplyAlliKind, pSellPrc, pDcRate, pOrdQty, pSlitmInf){
            var tempTcDcAmt = 0;

            // 2018.07.19 제휴할인일경우 할인금액체크
            if(pAplyAlliKind == "3") {
                // 할인제한액
                var pDcBndsAmt = isEmpty(pSlitmInf.data("tcDcBndsAmt")) ? 0 : Number(pSlitmInf.data("tcDcBndsAmt"));
                // 할인구분 기본, 일반, 최저가
                var pTcDcType  = isEmpty(pSlitmInf.data("tcDcType")) ? "03" : Number(pSlitmInf.data("tcDcType"));
                // 할인한도 적용여부
                var dcBndsYn = isEmpty(pSlitmInf.data("dcBndsYn")) ? "N" : pSlitmInf.data("dcBndsYn");

                // tcDcType 01일 경우 최저가 할인
                if(pTcDcType == "01"){
                    tempTcDcAmt = pDcRate; //최저가할인액;
                }else{
                    tempTcDcAmt = Math.floor(pSellPrc * Number(pDcRate) / 1000) * 10;

                    if(dcBndsYn == "Y"){
                        tempTcDcAmt = pDcBndsAmt ;
                    }
                }
                tempTcDcAmt = tempTcDcAmt * pOrdQty;
            }else{
                tempTcDcAmt =  Math.floor(pSellPrc * Number(pDcRate) / 1000) * 10 * pOrdQty;
            }
            return tempTcDcAmt;
        }



        var crdInsmMthsInfList = new Array();
        var crdcCdList = new Array();

        //이전결제수단정보
        var stlmWayType = "10";
        var stlmWayCd = "03";
        var cpayPathGbcd = "021";
        var CurStlmWayType = "10";

        //원데이터 변수값 세팅
        var orgDstnBaseAdr = '서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)';
        var orgDstnPtcAdr = '101동 404호';
        var orgAdrKndGbcd = '2';
        var orgPostNo = '05408';



        var mltDlvLmtVenYn = "N";
        //배송불가지역 확인을 위한 변수값
        var nowApocGbcd = '10';

        //프리미엄 배송 가능 지역
        var premSi = new Array();
        var premGu = new Array();
        var premDlvZipCode = "N";

        

        //20180621조유진
        var dawnDlvYn = "N";
        var premDlvYn = "N";
        var cvstDlvYn = "N";
        var safeDlvYn = "N";
        //var subwDlvYn = "";
        var dawnSi = new Array();
        var dawnDlvZipCode = "N";
        
        var mobileAppYn="N";
        var psnCucrInntCodeChangeCnt = 0;
        // 시작 스크립트 및 이벤트
        // 이벤트는 od2016.js에 펑션은 smOrder2016.js에 구현
        $(function () {
            itemInfListInit();

            clearPayTypeArea();

            calculateOrderAmt();

            // 초기 접속 시 멀티배송 체크
            $("#multiInfoTxt1").find("input").val("Y");
            $("#multiInfoTxt2").find("input").val("N");

            // 신용카드 ISP에 기본으로 체크
            $("#rdo1").prop("checked", true);

            // 간편결제 설명 숨김 처리
            // 카카오페이 추가 : 20170210 goodsin 카카오페이 추가
            $("#pay4, #pay5, #pay6, #pay7, #pay8, #pay9, #pay10, #pay11, #pay12, #pay13, #pay14, #pay15, #hpDesc").hide();

            // 배송불가 처리
            var noDlvMsg = checkNoDlvArea($("input[name=stnAdrInf].apocGbcd").val());
            if(!isEmpty(noDlvMsg)) {
                alert(noDlvMsg);
                return;
            }

            
            crdInsmMthsInfList[0] = {aplyStrtAmt:50000, aplyEndAmt:199999, crdMths:0};
            
            crdInsmMthsInfList[1] = {aplyStrtAmt:200000, aplyEndAmt:699999, crdMths:0};
            
            crdInsmMthsInfList[2] = {aplyStrtAmt:700000, aplyEndAmt:9999999999, crdMths:0};
            

            // 추가배송비 있는 기본 주소의 경우 추가배송비를 조회한다.
            var irgnAreaAddDlvCostUseYn = $("input[name='irgnAreaAddDlvCostUseYn']").val();
            var dstnPostNo1 = $("input[name='stnAdrInf'].dstnPostNo1").val();
            var dstnPostNo2 = "";

            var giftOrderYn = $("input[name='giftOrderYn']").val();
            if(irgnAreaAddDlvCostUseYn == "Y" && !isEmpty(dstnPostNo1) && giftOrderYn != "Y") {
                var postNo = dstnPostNo1;
                //getAddDlvcAmtByDlvcoArea(postNo);
                // 지역구분코드 조회 추가배송비 선결제 2020.08.11
                getIrgnAreaGbcd(postNo, 0);
            }

        });
        
        // iphone app에서 뒤로가기시 호출
        function setPageGnb() {
            window.webkit.messageHandlers.renewHandler.postMessage("jscall:changeGnb:4");
            window.webkit.messageHandlers.renewHandler.postMessage("jscall:setTitle:주문서 작성");
        }

        // 이전 결제수단 설정
        $(document).ready(function() {	
        
            //chrome 80 브라우저인 경우, alert 문구 노출
            /* if(appYn == "N" && navigator.userAgent.substring((navigator.userAgent.lastIndexOf('Chrome')+7),(navigator.userAgent.lastIndexOf('Chrome')+9)) == '80'){
        alert("현재 고객님께서 사용하시는 크롬웹브라우저(v80)에서 일부 결제수단 사용이 일시적으로 불가능하실 수 있으니, 모바일App 또는 다른 브라우저의 사용을 권장드립니다.");
    } */
            
            

            var itemType = "GENERAL";

            if(itemType == "GENERAL") {
                $("#totPriceDiv").show();
            } else {
                $("#totPriceDiv").hide();
            }

            var isDisabled = $("#paymentCopnBtn").prop("disabled");
            if(!isDisabled) {
                setHidePayCopn();
            }
            
            restoreLastPayType();

            if($("div[name='immtDcDiv']").length > 0){
                $("#immtDcCnt").text($("div[name='immtDcDiv']").length);
            }

            if($("div[name='copnDcDiv']").length > 0){
                $("#copnDcCnt").text($("div[name='copnDcDiv']").length);
            }
            
            try {
                
                    if(itemType == "GENERAL") {
                        autoDcLoading();
                    	
                        setAutoDc(true, function(result) {
                            if(result) {
                                if(Number($("#discountTotalPrice strong").text().replace(/,|-|원/g,"")) > 0){
                                    $("#immtSaleAutoDcBtn").prop("checked",true);
                                }

                                if(Number($("#copnTotalPrice strong").text().replace(/,|-|원/g,"")) > 0){
                                    $("#copnSaleAutoDcBtn").prop("checked",true);
                                }

                                hideLoading();
                            }
                        });
                    }
                
            } catch (e) {
                console.log("ready error : " + e);
                console.log("ready error : " + e.message);
                hideLoading()
            }
            
            //씨제일제일제당 새벽배송 시 화면 처리
            var cjDawndlvYn = 'N';
            if(cjDawndlvYn == "Y"){
                deleveryTypeSelect('dawn');
            }

            //반반배송 상품일때
            var halfDlvYn = 'N';
            var halfDlv = false;
            if(halfDlvYn == "Y"){
                halfDlv = true;
            }
            
            //카드 이벤트 상품 결제수단 고정 요청
            var cardEventYn = 'N';
            var cardEventCrdCd = '';

            if(cardEventYn == "Y"){
                $(".payment-wrap a.type-card").addClass("on");
                $("#pay1").show();
                $("div[name='pay1CardPrmo'],#pay1CrdAftDmndPrmo").show();
                $(".payment-option-area").show();

                $("select[name='stlmCrdInf'] option").each(function() {
                    var stlmCrdInf = $(this).val();
                    if(!isEmpty(stlmCrdInf) && stlmCrdInf.split("|")[0] == cardEventCrdCd) {
                        $(this).prop("selected", true);
                    }
                });
                $("select[name='stlmCrdInf']").prop("disabled", true);
                selectCrdcCd($("select[name='stlmCrdInf']"));
                $("#allotMonth").prop("disabled", true);

                var alliRefCd = $("input[name='alliRefCd']").val();
                if(alliRefCd == '700'){
                    //법인몰 통해 인입시 카드포인트 사용 비노출
                    $(".crdPntArea ").hide();
                }else{
                    $(".crdPntArea ").show();
                    $("#point").prop("checked", true);
                    $("#point").prop("disabled", true);
                    $("#point2").prop("checked", true);
                    $("#point2").prop("disabled", true);
                }
            }

            //적립금 우선결제 상품여부
            var hpntPrtyStlmYn = 'N';
            if(hpntPrtyStlmYn == 'Y'){
                // HPoint마케팅개선 kjh 20190219 H.Point 우선결제 적용
                $("input[id='chk21']").click();
                $("input[name='useUPoint']").val(1000);
                directInsertUPoint($("input[name='useUPoint']"));
            }
            
            $("form[name='orderDataForm'] input[name='stlmWaySaveYn']").val("Y");

            //Android version Check (NFC 미노출 시 appVerNm 수정 필요)
            $(".payment-wrap a.type-nfc").hide();

            // 주문자 수령인 알람.
            checkRcvp();
            
            //GA 값 셋팅
            var stpicOrderYn = 'N';
            if(stpicOrderYn == "Y"){
                goGaPage('주문/장바구니>주문서작성>특화배송','스토어픽');
            }            
        });
        
        function baseDstnYnClick(obj) {
            if ( $(obj).prop("checked") && $(obj).data("prev") == "checked" ) { 
                $(obj).prop("checked", false);
                $(obj).data("prev", "");
            } else {
                $(obj).data("prev", "checked");
            }
            
            $("input[name="+$(obj).attr("name")+"]").each(function(){
            	if ( !$(this).prop("checked") ) {
            		$(this).data("prev", "");
            	}
            });
        }

        $(window).bind("popstate", function(e) {
            if(!$(".layer-popup.order").hasClass("_active")){
                history.back();
            }else{
            	//뒤로가기했을시 선물하기 이미지 가지고오기 
                reDrawSlick();
            	backStateLayerPopup();
            }

        });

        $(document).on('click', '#chk18, .layerpopup_btn', function() {
            isBack = true;
            history.pushState(null, null, location.href);
        });

        //결제금액할인이 적용되었을때 카드 선택 금지
        $(document).on('click', '#stlmCrdInf', function() {
            if(isPayCopnPayTypeSet) {
                $("select[name='stlmCrdInf']").prop("disabled", true);
                alert("결제금액할인 쿠폰으로 적용된 결제수단은 해제 할 수 없습니다.\n쿠폰 적용을 해제 후 결제수단을 선택해주세요.")
                return;
            }
        });

        // 결제수단 클릭시 이벤트
        $(document).on('click', '.payment-wrap', function() {

            var cardEventYn = "N";
            if(cardEventYn == "Y"){
                return;
            }

            var payType = $(".payment-wrap a.on").find("input[name=pay]").val();

            if(isPayCopnPayTypeSet) {
                if(payType == $("#clickStlmVal").val()){
                    alert("이미 선택한 결제수단입니다.");
                }else{
                    alert("결제금액할인 쿠폰으로 적용된 결제수단은 해제 할 수 없습니다.\n쿠폰 적용을 해제 후 결제수단을 선택해주세요.");
                }
                return;
            }

            var orgPayType = "";
            var orderItemTotCount = $("input[name='orderItemTotCount']").val();
            var totStlmAmt = Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());
            var stlmCdpstAmt = Number($("form[name='orderDataForm'] input[name='stlmCdpstAmt']").val());

            // 카드결제 팝업
            if (payType == "1") { // 신용카드
                orgPayType = "1";
            }
            else if (payType == "4") { // 무통장
                orgPayType = "2";
            }
            else if (payType == "3") { // 휴대폰 결제
                orgPayType = "3";
            }
            else if (payType == "paynow") { // 페이나우
                orgPayType = "4";
            }
            else if (payType == "payco") { // 페이코
                orgPayType = "5";
            }
            else if (payType == "syruppay") { // 시럽페이
                orgPayType = "6";
            }
            else if (payType == "samsungpay") { // 삼성페이
                orgPayType = "7";
            }
            else if (payType == "kakaopay") { // 카카오페이 : 20170210 goodsin 카카오페이 추가
                orgPayType = "8";
            }
            else if (payType == "naverpay") { // 네이버페이
                orgPayType = "9";
            }
            else if (payType == "smilepay") { // 스마일페이
                orgPayType = "10";
            }
            else if (payType == "newkakaopay") { // 신카카오페이
                orgPayType = "11";
            }
            else if (payType == "callpay") { // 상담원결제
                orgPayType = "12";
            }
            else if (payType == "hpay") { // hmallpay
                orgPayType = "13";
            }
            else if (payType == "toss") { // toss
                orgPayType = "14";
            }
            else if (payType == "nfc") { // nfc
                orgPayType = "15";
            }
            
            payType = orgPayType;

            calculateOrderAmt();
            clearPayTypeArea(true);
            reloadStlmWayPrmo(payType, totStlmAmt);

            cardPromInf();

            // 50만원 이하만 결제 가능 처리
            if(payType == "3" && totStlmAmt > 500000) {
                alert("휴대폰결제는 50만원이하 결제시에만 이용가능합니다.");

                $(".type-phone").removeClass("on");
                $(".payment-option-area").hide();
                return;
            }

            calculateCashRcptAmt();

            //현재 선택되어진 결제수단을 저장한다.
            var kind = $("input[name='discountType1']:checked").attr("kind");
            var alliCrdCd = $("input[name='discountType1']:checked").attr("crdCd");
            if((typeof kind == "undefined") || kind != "1" && kind != "2"){
                if(payType == 1){
                    CurStlmWayType = '10';
                }else if(payType == 2){
                    CurStlmWayType = '20';
                }else if(payType == 3){
                    CurStlmWayType = '40';
                }else if(payType == 4){
                    CurStlmWayType = '90';
                }else if(payType == 5){
                    CurStlmWayType = '91';
                }else if(payType == 6){
                    CurStlmWayType = '92';
                }else if(payType == 7){
                    CurStlmWayType = '93';
                }else if(payType == 8){ // 카카오페이추가 : 20170210 goodsin 카카오페이 추가
                    CurStlmWayType = '94';
                }else if(payType == 9){ // 네이버페이
                    CurStlmWayType = '95';
                }else if(payType == 10){
                    CurStlmWayType = '96';
                }else if(payType == 11){
                    CurStlmWayType = '97';
                }else if(payType == 12){
                    CurStlmWayType = '98';
                }else if(payType == 13){
                    CurStlmWayType = '99';
                }else if(payType == 14){
                    CurStlmWayType = '81';
                }else if(payType == 15){
                    CurStlmWayType = '82';
                }

                restoreLastPayType();
            } else {
                $(".payment-wrap").find("a.on").removeClass("on");
                var alliCrdCd = $("input[name='discountType1']:checked").attr("crdCd");
                if(alliCrdCd == "99") { // 무통장
                    $(".payment-wrap a.type-bankacc").addClass("on");
                    //$(".paymentArea li.select_bank").addClass("selected");
                    $("#selectBank").show();
                    $(".payment-option-area").show();

                    // 무통장입금 장애체크
                    if($("#order2016Alert div[name='crdcCd_20']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_20']").show();
                    }

                } else {    // 특정 카드만 가능
                    $(".payment-wrap a.type-card").addClass("on");
                    $("#pay1").show();
                    $("div[name='pay1CardPrmo'],#pay1CrdAftDmndPrmo").show();
                    $(".payment-option-area").show();

                    $("select[name='stlmCrdInf'] option").each(function() {
                        var stlmCrdInf = $(this).val();
                        if(!isEmpty(stlmCrdInf) && stlmCrdInf.split("|")[0] == alliCrdCd) {
                            $(this).prop("selected", true);
                        }
                    });
                    $("select[name='stlmCrdInf']").prop("disabled", true);
                    selectCrdcCd($("select[name='stlmCrdInf']"));
                }

                // 현금영수증
                calculateCashRcptAmt();
            }
        });

        function restoreLastPayType(){
            if(isPayCopnPayTypeSet) {
                calculateCashRcptAmt();
                return;
            }

            //셀렉트박스 초기화
            $(".payment-wrap a.on").removeClass("on");
            $(".paymentArea li.selected").removeClass("selected");
            $(".payment-option-area").hide();

            var totStlmAmt = $("form[name='orderDataForm'] input[name='totStlmAmt']").val();
            if(totStlmAmt == 0){
                return;
            }

            var payTypeNm = "";

            if(CurStlmWayType == '10') { //카드
                if($(".payment-wrap a.type-card").length > 0) {
                    $(".payment-wrap a.type-card").addClass("on");
                    $("#pay1").show();
                    $("div[name='pay1CardPrmo'],#pay1CrdAftDmndPrmo").show();
                    $(".payment-option-area").show();
                    $("select[name='stlmCrdInf'] option").each(function() {
                        var stlmCrdInf = $(this).val();
                        if(!isEmpty(stlmCrdInf) && stlmCrdInf.split("|")[0] == stlmWayCd) {
                            $('#stlmCrdInf').val(stlmCrdInf);
                        }
                    });
                    //카드 정보 세팅
                    cardPromInf();
                    selectCrdcCd($('#stlmCrdInf'));

                    var stlmCrdInf = $("select[name='stlmCrdInf'] option:selected").val();
                    var stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val());

                    payTypeNm = $("#stlmCrdInf option:checked").text() + "(" +$("#allotMonth option:checked").text() + ")";

                    // 신용카드 장애체크
                    if($("#order2016Alert div[name='crdcCd_10']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_10']").show();
                    }
                }
            }else if(CurStlmWayType == '20') {   //무통장입급
                if($(".payment-wrap a.type-bankacc").length > 0) {
                    $(".payment-wrap a.type-bankacc").addClass("on");
                    //$(".paymentArea li.select_bank").addClass("selected");
                    $("#selectBank").show();
                    $(".payment-option-area").show();
                    $("select[name='wibkBankCd'] option").each(function() {
                        var wibkBankCd = $(this).val();
                        if(!isEmpty(wibkBankCd) && wibkBankCd == stlmWayCd) {
                            $('#wibkBankCd').val(wibkBankCd);
                            /* console.log("wibkBankCd = " + wibkBankCd); */
                        }
                    });

                    payTypeNm = "무통장 입금";

                    // 무통장입금 장애체크
                    if($("#order2016Alert div[name='crdcCd_20']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_20']").show();
                    }
                }
            }else if(CurStlmWayType == '40') {   //휴대폰결제
                if($(".payment-wrap a.type-phone").length > 0) {
                    $(".payment-wrap a.type-phone").addClass("on");
                    $(".sub-area.hpDesc").show();
                    $(".payment-option-area").show();
                    payTypeNm = "휴대폰 결제";

                    // 휴대폰결제 장애체크
                    if($("#order2016Alert div[name='crdcCd_40']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_40']").show();
                    }
                }
            }else if(CurStlmWayType == '91') {   //Payco
                if($(".payment-wrap a.type-payco").length > 0) {
                    $(".payment-wrap a.type-payco").addClass("on");
                    $(".paymentArea li.select_simple").addClass("selected");
                    $(".paymentArea ul.simple_pay li:eq(1)").addClass("selected");
                    $(".sub-area.pay5").show();
                    $(".paymentArea .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                    payTypeNm = "페이코";

                    // 페이코 장애체크
                    if($("#order2016Alert div[name='crdcCd_91']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_91']").show();
                    }
                }
            }else if(CurStlmWayType == '93') {   //삼성페이
                if($(".payment-wrap a.type-samsungpay").length > 0) {
                    cardPromInf();
                    $(".payment-wrap a.type-samsungpay").addClass("on");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".payment_selectsub ul.simple_pay li:eq(3)").addClass("selected");
                    $(".sub-area.pay7").show();
                    $(".payment_selectsub .select_simple .paynowSub").show();
                    $(".payment-option-area").show();
                    payTypeNm = "삼성페이";

                    // 삼성페이 장애체크
                    if($("#order2016Alert div[name='crdcCd_93']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_93']").show();
                    }
                }
            }else if(CurStlmWayType == '95') {   //네이버페이
                if($(".payment-wrap a.type-naverpay").length > 0) {
                    $(".payment-wrap a.type-naverpay").addClass("on");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".payment_selectsub ul.simple_pay li.simple_pay_naverpay").addClass("selected");
                    $(".sub-area.pay9").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                    payTypeNm = "네이버페이";

                    // 네이버페이 장애체크
                    if($("#order2016Alert div[name='crdcCd_95']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_95']").show();
                    }
                }
            }else if(CurStlmWayType == '96') {   //스마일페이
                if($(".payment-wrap a.type-smilepay").length > 0) {
                    $(".payment-wrap a.type-smilepay").addClass("on");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".payment_selectsub ul.simple_pay li.simple_pay_smilepay").addClass("selected");
                    $(".sub-area.pay10").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                    payTypeNm = "스마일페이";

                    // 스마일 페이 장애체크
                    if($("#order2016Alert div[name='crdcCd_96']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_96']").show();
                    }
                }
            }else if(CurStlmWayType == '97') {   //신카카오 페이
                if($(".payment-wrap a.type-kakaopay").length > 0) {
                    $(".payment-wrap a.type-kakaopay").addClass("on");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".payment_selectsub ul.simple_pay li.simple_pay_newkakaopay").addClass("selected");
                    $(".sub-area.pay11").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                    payTypeNm = "카카오페이";

                    // 신카카오 페이 장애체크
                    if($("#order2016Alert div[name='crdcCd_97']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_97']").show();
                    }
                }
            }else if(CurStlmWayType == '98') {   //상담원결제
                if($(".payment-wrap a.type-ars").length > 0) {
                    $(".payment-wrap a.type-ars").addClass("on");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".sub-area.pay12").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                    payTypeNm = "상담원 결제";
                }
            }else if(CurStlmWayType == '99') {   //HPAY
                if($(".payment-wrap a.type-hmallpay").length > 0) {
                    $(".payment-wrap a.type-hmallpay").addClass("on");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".sub-area.pay13").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                    payTypeNm = "Hmall Pay";

                    // HPAY 장애체크
                    if($("#order2016Alert div[name='crdcCd_99']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_99']").show();
                    }
                }
            }else if(CurStlmWayType == '81') {   //toss
                if($(".payment-wrap a.type-toss").length > 0) {
                    $(".payment-wrap a.type-toss").addClass("on");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".sub-area.pay14").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                    payTypeNm = "토스";

                    // toss 장애체크
                    if($("#order2016Alert div[name='crdcCd_81']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_81']").show();
                    }
                }
			}else if(CurStlmWayType == '82') {   // nfc 결제
				if($(".payment-wrap a.type-nfc").length > 0) {
					$(".payment-wrap a.type-nfc").addClass("on");
                    $(".payment_selectsub li.select_simple").addClass("selected");
                    $(".sub-area.pay15").show();
                    $(".payment_selectsub .select_simple .paynowSub").hide();
                    $(".payment-option-area").show();
                    payTypeNm = "NFC 결제";
                    
                    // nfc 장애체크
                    if($("#order2016Alert div[name='crdcCd_82']").length > 0){
                        $("#order2016Alert, #order2016Alert div[name='crdcCd_82']").show();
                    }
                }
            }

            if(payTypeNm != null && payTypeNm != ""){
                $("#payTypeNm").text(payTypeNm);
                $("#payTypeNmAtag").addClass("mod");
            }

            var kind = $("input[name='discountType1']:checked").attr("kind");
            var alliCrdCd = $("input[name='discountType1']:checked").attr("crdCd");
            if(!(typeof kind == "undefined")){
                if( (kind == "2" && alliCrdCd == "01") || (kind == "2" && alliCrdCd == "03") || (kind == "2" && alliCrdCd == "04") ){
                    $(".payment-wrap a.on").removeClass("on");
                    $(".paymentArea li.selected").removeClass("selected");
                    $(".payment-option-area").hide();

                    $(".payment-wrap a.type-card").addClass("on");
                    $("#pay1").show();
                    $("div[name='pay1CardPrmo'],#pay1CrdAftDmndPrmo").show();
                    $(".payment-option-area").show();

                    $("select[name='stlmCrdInf'] option").each(function() {
                        var stlmCrdInf = $(this).val();
                        if(!isEmpty(stlmCrdInf) && stlmCrdInf.split("|")[0] == alliCrdCd) {
                            $(this).prop("selected", true);
                        }
                    });
                    $("select[name='stlmCrdInf']").prop("disabled", true);
                    cardPromInf();
                    selectCrdcCd($("select[name='stlmCrdInf']"));
                }else if( (kind == "2" && alliCrdCd == "99") ){
                    $(".payment-wrap a.on").removeClass("on");
                    $(".paymentArea li.selected").removeClass("selected");
                    $(".payment-option-area").hide();

                    $(".payment-wrap a.type-bankacc").addClass("on");
                    //$(".paymentArea li.select_bank").addClass("selected");
                    $("#selectBank").show();
                    $(".payment-option-area").show();
                }
            }
            // 현금영수증
            calculateCashRcptAmt();
        }


        var endTime = "";
        var stopTimer;
        var gap = 300;
        var certSeq = 0;
        var gv_tela = "";
        var gv_tels = "";
        var gv_teli = "";
        
        
        
        var nonMemberCertYn = "";
        
        

        function nonMemberSmsSend(){

            var tela = "";
            var tels = "";
            var teli = "";

            var nonMemberHpNo = $("#nonMemberHpNo").val();

            if(nonMemberHpNo.length > 11 || nonMemberHpNo.length < 10){
                alert("핸드폰 번호를 확인해주세요.");
                return;
            }else if(nonMemberHpNo.length == 10){
                tela =  nonMemberHpNo.substring(0,3);
                tels =  nonMemberHpNo.substring(3,6);
                teli =  nonMemberHpNo.substring(6,10);
            }else if(nonMemberHpNo.length == 11){
                tela =  nonMemberHpNo.substring(0,3);
                tels =  nonMemberHpNo.substring(3,7);
                teli =  nonMemberHpNo.substring(7,11);
            }

            var pattern = /\D/g;

            if(pattern.test(nonMemberHpNo)){
                alert("휴대폰번호는 숫자만 가능합니다.");
                return;
            }


            if(!isEmpty(endTime)){
                var now = new Date();
                var gapTime = (endTime - now.getTime())/1000;
                if(gapTime < 300 && gapTime > 180){
                    alert("인증 SMS 발송 진행 중입니다. \n잠시만 기다려주세요 \n(최대 2분 소요)");
                    return;
                }
            }

            $.ajax({
                type: "get"
                ,url: "/m/setCertSmsSend.do"
                ,data: {tela:tela, tels:tels, teli:teli }
                ,dataType: "json"
                ,async: true
                ,success : function(data) {

                    if(data.actorError == 'true'){
                        var errorMsgTemp = data.errorMessage;
                        errorMsgTemp = errorMsgTemp.replace(/<*>/g,"");
                        errorMsgTemp = errorMsgTemp.replace(/nbsp;/g," ");
                        alert(errorMsgTemp);
                    }else{
                        certSeq = data.certSeq;

                        // 유효시간 종료 시간 세팅
                        endTime = new Date().getTime() + 300*1000 ; //300초 이후에 정지
                        showLeftTime(); //유효시간 표시
                        alert("인증 SMS가 발송되었습니다. \n 휴대폰으로 수신하신 인증번호를 \n 하단에 입력해주세요.");

                        gv_tela = data.tela;
                        gv_tels = data.tels;
                        gv_teli = data.teli;

                        $("#nonMemberSmsConfirmBtn").prop("disabled",false);
                    }

                }
                ,
                error : function(){
                    console.log("json error");
                }
            });
        }


        function nonMemberSmsConfirm(){

            var smsSelfCertNo = $("#smsSelfCertNo").val();
            if( smsSelfCertNo == "" || smsSelfCertNo == null){
                alert("인증번호를 입력해 주세요.");
                return;
            }

            if(!isEmpty(endTime)){
                var now = new Date();
                var gapTime = (endTime - now.getTime())/1000;
                if(gapTime <= 0){
                    alert("인증 유효시간을 초과하였습니다. \n '인증번호 받기' 버튼을 \n 다시 눌러주세요.");
                    return;
                }
            }

            if(gap == 300){
                alert("'인증 SMS 발송' 버튼을 \n 눌러주세요.");
                return;
            }

            $.ajax({
                type: "get"
                ,url: "/m/setSmsCertIdnfYn.do"
                ,data: {smsSelfCertNo:smsSelfCertNo, certSeq:certSeq, tela:gv_tela, tels:gv_tels, teli:gv_teli, nonMemberYn:'Y'}
                ,dataType: "json"
                ,async: false
                ,success : function(data) {

                    if(data.actorError == 'true'){
                        var errorMsgTemp = data.errorMessage;
                        errorMsgTemp = errorMsgTemp.replace(/<*>/g,"");
                        errorMsgTemp = errorMsgTemp.replace(/nbsp;/g," ");
                        alert(errorMsgTemp);
                    }else{
                        //비회원 인증정보 셋팅
                        $("form[name='orderDataForm'] input[name='senderMobileDdd']").val(gv_tela);
                        $("form[name='orderDataForm'] input[name='senderMobilePhone1']").val(gv_tels);
                        $("form[name='orderDataForm'] input[name='senderMobilePhone2']").val(gv_teli);

                        var rentalYn = $("#rentalYn").val();
                        if(rentalYn == 'Y'){
                            $("#insurance input[name='dstnHpIdntNo']").val(gv_tela);
                            $("#insurance input[name='dstnHpNo']").val(''+gv_tels+gv_teli);
                        }

                        nonMemberCertYn = "Y";
                        $("#nonMemberDiv").hide();

                        alert("비회원 인증이 완료 되었습니다.")
                        backStateLayerPopup();

                    }
                }
                ,
                error : function(){
                    console.log("json error");
                }
            });
        }


        function showLeftTime(){
            var leftTime = "";

            var now = new Date();
            gap = (endTime - now.getTime())/1000;

            if(gap <= 0){
                clearCertSmsSend();
                return;
            }

            var min = parseInt(gap/60);
            var sec = parseInt(gap%60);

            leftTime += ((min < 10) ? "0" : "") + min;
            leftTime += ((sec < 10) ? ":0" : ":") + sec;

            $("#smsCertReftTime").html(leftTime);

            stopTimer = setTimeout("showLeftTime()", 1000);
        }

        /* 인증 초기화 */
        function clearCertSmsSend(){

            clearTimeout(stopTimer);
            leftTime = "00:00";
            $("#smsCertReftTime").html(leftTime);
            gap=300;
        }

        
        
        
        
        


        
        function itemInfListInit() {
            
            
            var copnDcInfArr = new Array(1);
            $("#slitmInfDiv").append($("<span id='2101185938000010'/>"));
            $("#slitmInfDiv span:last").data({slitmCd : '2101185938', uitmCd : '00001', aspItemCd : '0'
                    , sellPrc : '1490000', dcAmt : '0', dcRate : '0.0'
                    , arsDcAmt : '0', arsDcRate : '0', alliCrdDcYn : '0'
                    , spymDcAmt : '0', spymDcRate : '0'
                    , svmt : '0', svmtRate : '0.0', dcSvmt : '0', empDcYn : '0'
                    , mdSetWintInsmMthsYn : 'N', wintInsmMths : '0', hdptYn : ''
                    , itemType : 'GENERAL', b2BDcRate : '0'
                    
                    
                    
                    , itemDlvNdmtDtlList : [{cd:'22', cdNm:'도서/산간지역 불가'}]
                    
                    
                    , crdImdtDcPrmoMap : [{prmoNo:'P202105279902', crdcCd:'06', crdcNm:'현대카드', crdStlmWayGbcd:'0', totItemTrgtYn : 'N', bndsAmt : 280000, condList:[{strtVal:60000, endVal:999999999999, famtFxrtGbcd:'1', famtFxrtVal:7, condGrpSeq:'1'}]}]
                    
                    
                
                , stlmWayPrmoMap : {"crdcCd99":{prmoNo:'P202105281079', crdcNm:'HmallPay',  prmoAncmDtl: '모바일에서 현금간편결제 Hmall Pay 5만원 이상 결제 시 H.Point 1% 적립(최대적립액 1만원,21.6.1~6.30)&lt;br/&gt;&lt;br/&gt;※ 상품 출고일 + 7일 후 자동 적립(유효기간 60일)&lt;br/&gt;※ 일부 상품 제외&lt;br/&gt;※ 결제시점 및 부여시점에 H.Point 회원을 유지하셔야 자동 적립이 됩니다.&lt;br/&gt;(결제 완료 후 H.Point 회원을 가입하시면 적립이 되지 않습니다.)&lt;br/&gt;', totItemTrgtYn : 'Y', bndsAmt : 10000, condList:[{strtVal:50000, endVal:999999999999, famtFxrtGbcd:'1', famtFxrtVal:'1'}]}}
            
            
                
                
                , oPntUseYn : "Y", oPntMaxUseRt : '5.0', oPntAcmRt : '0.3'
                
                
                , crdcCdList : [{cd:'06'}, {cd:'04'}, {cd:'02'}, {cd:'08'}, {cd:'01'}, {cd:'07'}, {cd:'09'}, {cd:'12'}, {cd:'03'}, {cd:'10'}, {cd:''}, {cd:''}, {cd:''}, {cd:''}, {cd:''}, {cd:''}, {cd:''}, {cd:'01'}, {cd:'21'}]
                
                
                , upntAcmRateUseYn: 'Y',upntAcmRate: '0.1'
                
                , hmallPntAcmAmt : '0'
                , bndsAmt : '', famtFxrtGbcd  : '', famtFxrtVal : ''
                , hmallPntAcmRate : '0.0', ordQty : '1'});
            bindArray($("#slitmInfDiv span:last"), "copnDcInf", copnDcInfArr);

            
            
            
            
            
            

            
            
        }

        var hasHsPrchMdaYn = 'N';
        var hasDtvItmYn = 'N';

        // 앱GNB 뒤로가기에서 웹 뒤로가기 호출
        function goBackForApp() {
            $(".btn_back").click();
        }

        /* 한글입력 방지 */
        function fn_press_han(obj)
        {
            //좌우 방향키, 백스페이스, 딜리트, 탭키에 대한 예외
            if(event.keyCode == 8 || event.keyCode == 9 || event.keyCode == 37 || event.keyCode == 39
                || event.keyCode == 46 ) return;
            //obj.value = obj.value.replace(/[\a-zㄱ-ㅎㅏ-ㅣ가-힣]/g, '');
            obj.value = obj.value.replace(/[\ㄱ-ㅎㅏ-ㅣ가-힣]/g, '');
        }
        
        function setInsuranceAdr(obj){
            $("#insurance input[name='dstnPostNo1']").val($("#insurance input[name='dstnPostNo']").val());
            $("#insurance input[name='dstnBaseAdr']").val($("#insurance input[name='newDstnBaseAdr']").val());
            
        }

        function setNonMemberInfo(obj) {
            var infoStr = $(obj).attr("class");

            if(infoStr.indexOf("nonMemberHp") > -1) {
                if($(obj).val().length == 8) {
                    var dstnHpIntmNo = $(obj).val().substring(0, 4);
                    var dstnHpBckNo = $(obj).val().substring(4, $(obj).val().length);

                    $("#multi_false input[name=dstnHpIdntNo]").val($("select[name=nonMemberHpIdntNo]").val());
                    $("#multi_false input[name=dstnHpIntmNo]").val(dstnHpIntmNo);
                    $("#multi_false input[name=dstnHpBckNo]").val(dstnHpBckNo);
                } else {
                    $("#multi_false input[name=dstnHpIntmNo]").val("");
                    $("#multi_false input[name=dstnHpBckNo]").val("");
                }
            } else if(infoStr.indexOf("nonMemberPtcAdr") > -1) {
                $("#multi_false input[name=dstnPtcAdr]").val($(obj).val());
            } else if(infoStr.indexOf("nonMemberTel") > -1) {
                if($(obj).val().length > 6) {
                    var dstnTels = "";
                    var dstnTeli = "";

                    if($(obj).val().length == 7) {
                        dstnTels = $(obj).val().substring(0, 3);
                        dstnTeli = $(obj).val().substring(3, $(obj).val().length);
                    } else {
                        dstnTels = $(obj).val().substring(0, 4);
                        dstnTeli = $(obj).val().substring(4, $(obj).val().length);
                    }

                    $("#multi_false input[name=dstnTela]").val($("select[name=nonMemberTelIdntNo]").val());
                    $("#multi_false input[name=dstnTels]").val(dstnTels);
                    $("#multi_false input[name=dstnTeli]").val(dstnTeli);
                } else {
                    $("#multi_false input[name=dstnTels]").val("");
                    $("#multi_false input[name=dstnTeli]").val("");
                }
            } else if(infoStr.indexOf("nonMemberRcvCustNm") > -1) {
                $("#multi_false input[name=rcvCustNm]").val($(obj).val());
            }

        }

        //핸드폰의 주소록 불러오기 - 추가 선물하기 주소록 추가 2020.09.08 김지영
        $(document).on('click', '#mobliePhoneAddList, .mobliePhoneAddList', function() {
            if(appOpsyNm == "ios"){
                window.location="jscall:openDiviceContacts";
            } else if(appOpsyNm == "android"){
                window.AndroidJS.openDiviceContacts();
            }
        });

        function openDiviceContactsCallback(name, number) {
            var returnNum = number.replace(/-/gi, "");
            var hp1stNum = "01";
            var alertText = "휴대폰 전화번호를 선택해주세요.";

            if(appOpsyNm == "ios") {
                if(returnNum.substring(0, 2) == "82") {
                    returnNum = "0" + returnNum.substring(2, returnNum.length);
                }
            }

            if(returnNum.length < 11 && returnNum.substring(0, 2) != hp1stNum) {
                alert(alertText);
                return;
            }

            if(returnNum.length >= 11 && returnNum.substring(0, 2) != hp1stNum) {
                alert(alertText);
                return;
            }

            var dstnHpIdntNo = returnNum.substring(0, 3);
            var dstnHpIntmNo = returnNum.substring(3, returnNum.length);

            //여러곳 배송일 경우 
            var giftOrderYn = $("input[name='giftOrderYn']").val();
            var cnt = isEmpty($(".shipping-step-1").find("input[name=multiCnt]").val() ) ? "0" : $(".shipping-step-1").find("input[name=multiCnt]").val() ;
            var giftSeq = "0";
            
            if($("#addPhoneSeq").val() != "")
            {
                giftSeq = $("#addPhoneSeq").val()-1;
            }

            if(giftOrderYn=="Y" && cnt > 1){
                $("#mobileDlvArea div[name=mobileDlv]:eq("+giftSeq+")").each(function(){
                    $(this).find("input[name=rcvCustNm]").val(name);
                    $(this).find("input[name=dstnHpIdntNo]").val(dstnHpIdntNo);
                    $(this).find("input[name=dstnHpNo]").val(dstnHpIntmNo);
                    
                    $(this).find("#uPhon2").val(dstnHpIdntNo);
                    $(this).find("input[name=rcvCustHpTel2]").val(dstnHpIntmNo);
                });
            }else{ 
                $("#mobileDlvArea").find("input[name=rcvCustNm]").val(name);
                $("#mobileDlvArea").find("input[name=dstnHpIdntNo]").val(dstnHpIdntNo);
                $("#mobileDlvArea").find("input[name=dstnHpNo]").val(dstnHpIntmNo);
                
                $("#mobileDlvArea #uPhon2").val(dstnHpIdntNo);
                $("#mobileDlvArea").find("input[name=rcvCustHpTel2]").val(dstnHpIntmNo);
            }
        }

        if(appYn == "N"){
            _TRK_PI="ODF";
        }

        //프리미엄 배송지 확인(새벽배송 배송지 확인추가 20180627조유진)
        function premAddrCheck() {

            //새벽배송 과 프리미업 배송 선택 후 뒤로가기 눌렀을때 예외 처리
            if($("form[name='orderDataForm'] input[name='dawnDlvYn']").val() =="Y"){
                var cjDawndlvYn = 'N';
                if($("#specialDlvType").val() != "type6" && cjDawndlvYn != "Y"){
                    dawnDlvZipCode = "N";
                    $("form[name='orderDataForm'] input[name='dawnDlvYn']").val("");
                }
            }
            if($("form[name='orderDataForm'] input[name='premDlvYn']").val() =="Y"){
                if($("#specialDlvType").val() != "type7"){
                    premDlvZipCode = "N";
                    $("form[name='orderDataForm'] input[name='premDlvYn']").val("");
                }
            }


            if(premDlvZipCode == "Y") {

                $("#multi_false input[name='dstnPtcAdr']").val($("input[name='premDstnPtcAdr']").val());

                var dstnPostNo = $("#multi_false input[name='dstnPostNo']").val();
                var dstnPtcAdr = $("#multi_false input[name='dstnPtcAdr']").val();

                if(isEmpty(dstnPostNo)) {
                    alert("'주소검색' 버튼을 눌러서 주소를 입력해 주세요.");
                    return;
                }
                if(isEmpty(dstnPtcAdr)) {
                    alert("배송지 상세주소를 입력해 주세요.");
                    $("#multi_false input[name='dstnPtcAdr']").focus();
                    return;
                }

                var premdlvCheck = 0;

                for(var i=0; i < premSi.length ; i++) {
                    // 프리미엄 배송지 시/도 확인
                    if($("#multi_false input[name='dstnBaseAdr']").val().indexOf(premSi[i]) > -1) {
                        premdlvCheck++;
                    }
                }

                if (premdlvCheck == 0) {
                    alert("죄송합니다. 프리미엄배송 대상 지역이 아닙니다.\n일반택배를 선택하셔서 배송주소를 입력해주세요.");
                    return;
                }

                premdlvCheck = 0;

                for(var i=0; i < premGu.length ; i++) {
                    // 프리미엄 배송지 시/군/구 확인
                    if($("#multi_false input[name='dstnBaseAdr']").val().indexOf(premGu[i]) > -1) {
                        premdlvCheck++;
                    }
                }

                if (premdlvCheck == 0) {
                    alert("죄송합니다. 프리미엄배송 대상 지역이 아닙니다.\n일반택배를 선택하셔서 배송주소를 입력해주세요.");
                    return;
                }

                order();
            }else if(dawnDlvZipCode == "Y"){        //새벽배송
                $("#multi_false input[name='dstnPtcAdr']").val($("input[name='dawnDstnPtcAdr']").val());
                var slitmCdStr = "";

                var dstnPostNo = $("#multi_false input[name='dstnPostNo']").val();
                var dstnPtcAdr = $("#multi_false input[name='dstnPtcAdr']").val();

                if(isEmpty(dstnPostNo)) {
                    alert("'주소검색' 버튼을 눌러서 주소를 입력해 주세요.");
                    return;
                }
                if(isEmpty(dstnPtcAdr)) {
                    alert("배송지 상세주소를 입력해 주세요.");
                    $("#multi_false input[name='dstnPtcAdr']").focus();
                    return;
                }

                $("#depth3_content_1 li").each(function () {
                    slitmCdStr += $(this).find("input[name=slitmCd]").val()+"^";
                });

                //공동현관 비밀번호 체크박스
                var passCodeStr =  $("input[name='mmsMsgCntnPwd']").val();
                if(passCodeStr.length > 0){
                    var passCodeChk = $("input[name='passCodeChk']").is(":checked");
                    if(!passCodeChk) {
                        alert("공동현관 비밀번호 수집 및 이용 동의 체크해주세요.");
                        return;
                    }
                }

                //새벽배송 주소 체크
                $.ajax({
                    type: "get"
                    , url: "/m/selectDawnDlvAddrChk.do"
                    ,data: {'postNo':dstnPostNo,'slitmCdStr':slitmCdStr}
                    , dataType: "json"
                    , success : function(data) {
                        var dawnDlvAddrChkYn = data.dawnDlvAddrChkYn;
                        if(dawnDlvAddrChkYn == "Y"){
                            order();
                        }else{
                            alert("새벽배송이 불가능한 주소입니다.\n새로운 배송지 주소를 입력해주세요.");
                        }
                    }
                    , error: function(data) {
                    }
                });

            }else {
                order();
            }
        }

        //개인통관고유번호 재사용에 동의한 고객이 번호 처음 번호 변경 시 체크박스 해제
        function psnCucrInntCodeChange(){
            var psnCucrInntCode = "";
            if(psnCucrInntCode != "" && psnCucrInntCode != null && psnCucrInntCodeChangeCnt == 0){
                $("#psnCucrReUseYnCheck").prop("checked",false);
                psnCucrInntCodeChangeCnt ++;
            }
        }


        function fn_setPrsInfo(){
            var rcvnCustNm      = $("#stpicGiftDiv input[name='rcvnCustNm']").val();
            var rcvnCustHpTel   = $("#stpicGiftDiv input[name='rcvnCustHpTel']").val();
            var prsnMsg         = $("#stpicGiftDiv textarea[name='prsnMsg']").val();
            var index           = $("#saveGiftIndex").val();

            var obj = $("div[name='pickupInfoArea']").eq(index);

            if(isEmpty(rcvnCustNm)) {
                alert("받으시는 분을 입력해 주세요.");
                return;
            }

            if(isEmpty(rcvnCustHpTel)) {
                alert("휴대폰번호를 입력해주세요");
                return;
            }

            if(!onlyNum(rcvnCustHpTel)){
                alert("휴대폰번호는 숫자만 가능합니다.");
                obj.find("input[name='prsn_yn']").val("N");
                return;
            }

            var hpRegExp = /(^02.{0}|^01.{1}|[0-9]{3})([0-9]{3,4})([0-9]{4})/g;
            if(!hpRegExp.test(rcvnCustHpTel)) {
                alert("잘못된 휴대폰 번호입니다.");
                return ;
            }

            var tela = "";
            var tels = "";
            var teli = "";


            if(rcvnCustHpTel.length > 11 || rcvnCustHpTel.length < 10){
                alert("핸드폰 번호를 확인해주세요.");
                obj.find("input[name='prsn_yn']").val("N");
                return;
            }else if(rcvnCustHpTel.length == 10){
                tela =  rcvnCustHpTel.substring(0,3);
                tels =  rcvnCustHpTel.substring(3,6);
                teli =  rcvnCustHpTel.substring(6,10);
            }else if(rcvnCustHpTel.length == 11){
                tela =  rcvnCustHpTel.substring(0,3);
                tels =  rcvnCustHpTel.substring(3,7);
                teli =  rcvnCustHpTel.substring(7,11);
            }

            var prsInfo         = "<p>받으시는 분 : "+rcvnCustNm+"</p><p>휴대폰번호 : "+tela+"-"+tels+"-"+teli+"</p><p>선물메세지 : "+prsnMsg+"</p>";
            prsInfo += "<input type='hidden' name='rcvnCustNm' value='"+rcvnCustNm+"'>";
            prsInfo += "<input type='hidden' name='rcvnCustHpTel' value='"+rcvnCustHpTel+"'>";
            prsInfo += "<input type='hidden' name='prsnMsg' value='"+prsnMsg+"'>";

            obj.find("span[name='prsInfo']").html(prsInfo);
            obj.find("input[name='prsn_yn']").val("Y");
            obj.find("div[name='prsInfoArea']").show();

            $("#stpicGiftDiv input[name='rcvnCustNm']").val('');
            $("#stpicGiftDiv input[name='rcvnCustHpTel']").val('');
            $("#stpicGiftDiv textarea[name='prsnMsg']").val('');

            backStateLayerPopup();

        }

        //무이자 20개월 이상 선택 시
        function chgAllotMonth(obj){

            $("#noCardPointmsg").hide();
            $("#point").attr("disabled",false);
            $("#point2").attr("disabled",false);

            var sel_text=$("#allotMonth option:selected").text();
            if(sel_text.indexOf('무이자')>-1){
                $(obj).addClass('color-ff5340');
            }else{
                $(obj).removeClass('color-ff5340');
            }

            if(Number(obj.value) >= 20 && $(obj).hasClass("color-ff5340")){
                $("#point").prop("checked", false);
                $("#point").prop("disabled", true);
                $("#point2").prop("checked", false);
                $("#point2").prop("disabled", true);

                $("#noCardPointmsg").show();
            }
        }

        /**
         * 입력한 문자열의 바이트를 계산한다.
         * @param obj
         * @param limitByte
         */
        function checkCntn(obj, limitByte) {

            $obj = $(obj);
            var inputStr = $obj.val();

            var iByteLength = 0;
            for (var i = 0; i < inputStr.length; i++) {
                var sChar = escape(inputStr.charAt(i));
                iByteLength += calculateByte(sChar);

                if(iByteLength > limitByte){
                    alert('최대 '+limitByte+'Byte 까지 입력가능합니다.');
                    $obj.val(inputStr.substring(0, i));
                    iByteLength = iByteLength - calculateByte(escape(inputStr.charAt(i)));

                    break;
                }
            }
            $obj.next().find("span.text_count").text(iByteLength);
        }


        //선물하기 이전 번호 조회
        $(document).on('click', '#preMoblieHpList, #moblieHpListMore', function() {
            var clickId = $(this).attr("id");
            var listType = $(this).attr("listType");
            var isListMore = false;

            var listUrl = "/m/selectDstnHpList.do";

            if(listType == "02"){
                listUrl = "/m/selectGiftDstnHpList.do";
            }

            if(clickId == "preMoblieHpList") {
                isBack = true;
                history.pushState(null, null, location.href);
            }

            var nextStrListNum = 1;
            var nextEndListNum = 30;
            var totCnt = $("#phoneNumberList").find("input[name=totCnt]").val();
            var custNo = $("#mobileDlvArea").find("input[name='dstnCustNo']").val();
            var strtNum = isEmpty($("#phoneNumberList").find("input[name=listSize]").val()) ? nextStrListNum : Number($(".moblieHpList").find("input[name=listSize]").val()) + nextStrListNum;
            var endNum = isEmpty($("#phoneNumberList").find("input[name=listSize]").val()) ? nextEndListNum : Number($(".moblieHpList").find("input[name=listSize]").val()) + nextEndListNum;

            if(clickId == "preMoblieHpList") {
                strtNum = nextStrListNum;
                endNum = nextEndListNum;
            } else {
                if(totCnt < strtNum) {
                    return;
                }
            }

            if(clickId == "moblieHpListMore") isListMore = true;

            $.ajax({
                type: "post"
                , url: listUrl
                ,data: {
                    'custNo':custNo,
                    'strtNum':strtNum,
                    'endNum':endNum,
                    'isListMoreYn':isListMore ? "Y" : "N"
                }
                , dataType: "html"
                , success : function(data) {
                    if(isListMore) {
                        $(".moblieHpListMoreSub").append(data);
                        if($(".moblieHpListMoreSub li").size() < totCnt) {
                            $("#moblieHpListMore").html("더보기 (" + $(".moblieHpListMoreSub li").size() + "/" + totCnt + ")");
                        } else {
                            $("#moblieHpListMore").parents("div.layer_btn").remove();
                        }
                        $(".preMoblieHpList").find("input[name=listSize]").val($(".moblieHpListMoreSub li").size());
                        $(".preMoblieHpList ._loadingscreen").remove();
                    } else {
                        $("#phoneNumberList").html("");
                        $("#phoneNumberList").append(data);
                    }
                    $("#phoneNumberListDiv").scrollTop(0);
                }
                , error: function(data) {

                }
                , complete: function(jqXHR,textStatus ){
                }
            });
        });

        function setPromotionCode(hnmPromotionCodePossYn) {

            // 결제수단 선택 영역 초기화
            clearSubPayTypeArea();
            clearPayTypeArea();

            var custUseCopnNm = $('#promotion-code').val();
            custUseCopnNm = custUseCopnNm.toUpperCase();
            $('#promotion-code').val(custUseCopnNm);
            
            var copnAplyGbcd = hnmPromotionCodePossYn == 'Y' ? '01' : '00'

            $("#codeList").show();
            $("#errAlert").remove();
            $.ajax({
                type: "POST"
                , async:false
                , url: "/m/setPromotionCode.do"
                , dataType: "json"
                , data : {"custUseCopnNm" : $.trim(custUseCopnNm),"copnAplyGbcd":copnAplyGbcd}
                , success : function(data) {
                    console.log(data.errorMessages);
                    switch(data.errorMessages) {
                        case "MIN_PRICE_5000":
                        case "GREATER_THAN_DC_PRICE":
                        case "NOT_AVAILABLE":
                        case "EXPIRATION_DATE":
                        case "USED_PROMOTION_CODE":
                        case "OVER_PROMOTION_CODE":
                            $("#codeList").append("<span class='txt-orange' id='errAlert'>쿠폰 상태가 유효하지 않습니다.</span>");
                            $('#promotion-code').val('');
                            return; break;
                        case "CUST_USE_COPN_NM_EMPTY":
                            $("#codeList").append("<span class='txt-orange' id='errAlert'>프로모션 코드를 입력해 주세요.</span>");
                            return; break;
                        case "NON_MEMBER":
                            $("#codeList").append("<span class='txt-orange' id='errAlert'>로그인 후 이용해주세요.</span>");
                            alert("로그인 후 이용해주세요.");
                            $('#promotion-code').val('');
                            return; break;
                        case "NOT_STLM_AMT_DC_COPN":
                            $("#codeList").append("<span class='txt-orange' id='errAlert'>입력하신 코드는 동일한 브랜드 상품 주문 시에만 사용 가능합니다. 장바구니에서 재 선택 후 다시 시도해 주세요.</span>");
                            $('#promotion-code').val('');
                            return;
                        case "NOT_COPN_APLY_BSIC":
                        case "NOT_COPN_APLY_TRGT":
                            $("#codeList").append("<span class='txt-orange' id='errAlert'>프로모션 코드 적용 비대상 상품이 포함되어 있습니다.</span>");
                            $('#promotion-code').val('');
                            return;
                        case "NOT_BSICAMT":
                            $("#codeList").append("<span class='txt-orange' id='errAlert'>쿠폰 기준금액에 맞지 않습니다.</span>");
                            $('#promotion-code').val('');
                            return;
                        case "":
                            break;
                        default:
                            $("#codeList").append("<span class='txt-orange' id='errAlert'>"+data.errorMessages+"</span>");
                            return;
                    }
                    if ($.trim(data.errorMessages) != "") {
                        $("#codeList").append("<span class='txt-orange' id='errAlert'>"+data.errorMessages+"</span>");
                        return;
                    }

                    /*
           * 프로모션 코드 적용 불가 케이스
           * 1. 동일 브랜드의 프로모션 코드가 이미 적용되어 있을때
           */
                    var existEmpPromotionCodeYn = $('#promotion-code').parents().find("input[name=existEmpPromotionCodeYn]").val();

                    if($("#" + data.copnVen2Cd).val() != null || existEmpPromotionCodeYn == 'Y' || (data.isEmpPromotionCode == 'Y' && ($("#751347").length > 0 || $("#751348").length > 0))) {
                        $("#codeList").append("<span class='txt-orange' id='errAlert'>동일 브랜드에 프로모션 코드 2개 이상 적용이 불가합니다.</span>");
                        $('#promotion-code').val('');
                    } else {
                        applyPromotionCode(data);
                        $("#errAlert").remove();
                        alert("프로모션 코드가 적용되었습니다.");
                    }

                } , error: function(data) {
                    alert("일시적으로 서버 접속이 끊겼습니다.\n다시 접속 부탁드립니다. ");
                    history.back();
                }
            });

            //결제수단 없애지않기 2019.11.21
            restoreLastPayType();
        }

        function applyPromotionCode(data) {

            var exstCopnItemList = data.exstCopnItemList;

            var exstVen2Cd = (data.copnVen2Cd == "751347")? "751348" : "751347";
            var input = "", copnNm = "", copnPblcNo = "";
            var index = new Array();
            var addingIdx = 0;
            var isDupIdx = false;

            $.each(exstCopnItemList, function (idx, item) {
                var copValues = [], payValues = [], copn = {};
                if (item.copnList != null) {
                    copn = item.copnList[0];

                    copnNm = $.trim(copnNm) == "" ? copn.copnNm : copnNm;

                    //더현대 기존 쿠폰 idx와 중복 방지를 위해 최적할인 적용된 최초 쿠폰 copnInf를 더함
//          var curIdx = OptimumDiscountCopnInfArrLength + idx;
                    var curIdx = idx;

                    if($("#" + exstVen2Cd).length > 0) {
                        var exstCopnIdx = $("#" + exstVen2Cd).attr("data-value");
                        var exstCopnIdxArray = exstCopnIdx.split("|");

                        //기존에 등록된 다른 브랜드의 프로모션 코드 idx와 중복되지않게 처리 idx++ addingIdx++
                        for(var i=0; i<exstCopnIdxArray.length; i++) {
                            if(curIdx == exstCopnIdxArray[i]) {
                                isDupIdx = true;
                                curIdx++
                            }
                        }
                    }
                    //최종 idx
                    idx = curIdx + addingIdx;

                    if(isDupIdx){
                        addingIdx++;
                    }

                    index.push(idx);

                    copValues.push(copn.copnNo);
                    copValues.push(item.slitmCd);
                    copValues.push(item.uitmCd);
                    copValues.push(item.aspItemCd);
                    copValues.push(copn.famtFxrtGbcd);
                    copValues.push(copn.famtFxrtVal);
                    copValues.push("1");
                    copValues.push(idx);
                    copValues.push(copn.copnPblcNo);
                    copValues.push(copn.maxDcPossAmt);
                    copValues.push(copn.copnTypeGbcd);
                    copValues.push(copn.ulmtUseYn);        //쿠폰무제한사용여부(쿼리에서 'Y'고정)
                    copValues.push(copn.dcPrice);          //결제금액할인금액

                    if(copn.copnTypeGbcd == '10'){ //H*M결제금액할인일떄
                        payValues.push(copn.copnNo);
                        payValues.push(copn.copnTypeGbcd);
                        payValues.push(copn.famtFxrtGbcd);
                        payValues.push(copn.famtFxrtVal);
                        payValues.push(copn.maxDcPossAmt);
                        payValues.push(copn.bsicAmt);
                        payValues.push(copn.copnBsicAmtGbcd);
                        payValues.push(copn.copnPblcNo);
                        payValues.push(copn.stlmFixYn);
                        payValues.push(copn.stlmFixGbcd);
                    }

                    if (item.aplyGnrlCopnInf != null) {
                        input += '<input type="hidden" id="gnrlCopn_'+item.slitmCd+'_'+item.uitmCd+'_'+item.aspItemCd+'_'+idx+'" name="copnInf" itemIdx="'+idx+'" value="'+item.aplyGnrlCopnInf+'" class="gnrlCopn"/>';
                        if(copn.copnTypeGbcd == '10'){ //H*M결제금액할인일떄
                            input += '<input type="hidden" id="hnmPaymentCopnInf" name="hnmPaymentCopnInf" itemIdx="'+idx+'" value="'+item.aplyGnrlCopnInf+'" class="hnmPaymentCopnInf"/>';
                        }
                    } else {
                        input += '<input type="hidden" id="gnrlCopn_'+item.slitmCd+'_'+item.uitmCd+'_'+item.aspItemCd+'_'+idx+'" name="copnInf" itemIdx="'+idx+'" value="'+copValues.join('|')+'"/>';
                        if(copn.copnTypeGbcd == '10'){ //H*M결제금액할인일떄
                            input += '<input type="hidden" id="hnmPaymentCopnInf" name="hnmPaymentCopnInf" itemIdx="'+idx+'" value="'+payValues.join('|')+'"/>';
                        }
                    }
                }
                isDupIdx = false;
            });

            $(".promotion-code-inBox").append(input);

            // input promotionCodeYn가 없는 경우만 추가
            if($('#promotionCodeYn').length == 0){
                $("form[name='orderDataForm']").append('<input type="hidden" id="promotionCodeYn" name="promotionCodeYn">');
            }
            // 프로모션 코드여부로 Y값
            $('#promotionCodeYn').val('Y');

            var price = "";
            //프로모션 할인금액 세팅
            price = calculatePromotionCodePrice(data);
            //주문금액 재계산
            calculateOrderAmt("hnmCopn");

            // 프로모션코드 엘리먼트 추가
            var codeItem = "";
            codeItem += "<div class='row-wrap' id='" + data.copnVen2Cd + "' data-value='" + index.join('|') + "'>";
            codeItem += "   <span class='row-title'>"+ data.promotionCode+"</span>";
            codeItem += "   <span class='row-value'>";
            codeItem +=         price+"원";
            codeItem += "       <button class='btn-close-round' onclick='javascript:cancelPromotionCode(this);'>삭제</button>";
            codeItem += "   </span>";
            codeItem += "</div>";

            $("#codeList").append(codeItem);

            // 임직원 프로모션 코드 여부
            $('.promotion-code-inBox .code-input-box').find("input[name=existEmpPromotionCodeYn]").val(data.isEmpPromotionCode);

            $(".promotion-code-inBox .code-input-box input").val('');
        }

        function cancelPromotionCode(el) {

            // 결제수단 선택 영역 초기화
            clearSubPayTypeArea();
            clearPayTypeArea();

            var $el = $(el);
            var $codeItem = $el.closest('div');
            var index = $el.closest('div')[0].getAttribute("data-value")
            var indexArray = index.split("|");

            //프로모션 코드 li 제거
            $codeItem.remove();

            //임직원 프로모션 코드 여부 초기화
            $('#promotion-code').parents().find("input[name=existEmpPromotionCodeYn]").val('');


            //copnInf 정보 제거
            console.log("itemidx to be deleted: " + index);
            for(var i=0; i<indexArray.length; i++) {
                $("div.hnm-promotion-code input[itemidx='" + indexArray[i] + "']").remove();
            }

            var aplyPrmoCnt = $('div.hnm-promotion-code input[name="copnInf"]').length;  // 적용 프로모션 코드 수
            if(aplyPrmoCnt == 0){       // 프로모션코드가 없는 경우 N으로 변경
                $('#promotionCodeYn').val('N');
                $("#codeList").hide();
            }

            calculateOrderAmt();

            // 결제수단 없애지않기 2019.11.21
            restoreLastPayType();
        }

        /**
         * 프로모션 코드 할인금액 계산(H&M 상품 전용) PC
         */
        function calculatePromotionCodePrice(data) {
            $("#slitmInfDiv span").each(function() {
                $(this).data({prmoDcAmt : 0, copnDcAmt : 0});
            });

            // 쿠폰 할인 계산 정보 초기화
            $("#slitmInfDiv span").each(function() {
                var copnDcInfArr = pickArray($(this), "copnDcInf");
                for(var i=0;i<copnDcInfArr.length;i++) {
                    copnDcInfArr[i] = 0;
                }
                bindArray($(this), "copnDcInf", copnDcInfArr);
            });

            var copnDcAmt = 0;
            var beforeCopnItemIdx = -1;
            var beforeCopnDcAmt = 0;

            // 20190114 상품필드에 있는 쿠폰가격, 금액을 초기화 하는 부분
            var curSlitmCd = '';
            var preSlitmCd = '';
            var curUitmCd = '';
            var preUitmCd = '';
            var eachSlitmPrc = 0;

            //프로모션 코드 적용 대상 상품일 때에만 계산
            //promotionTargetItem ex : slitmCd-uitmCd
            var exstCopnItemList = data.exstCopnItemList;
            var promotionTargetItem = [];

            $.each(exstCopnItemList, function (idx, item) {
                if (item.copnList != null) {
                    //프로모션 코드 적용 대상 상품
                    promotionTargetItem.push(item.slitmCd + '-' + item.uitmCd);
                }
            });

            // H&M 일반쿠폰
            if($("div.hnm-promotion-code input[name='hnmPaymentCopnInf']").length == 0){
                $("div.hnm-promotion-code input[name='copnInf']").each(function() {
                    var copnInfArr = $(this).val().split("|");  // (copnNo|slitmCd|uitmCd|aspItemCd|famtFxrtGbcd|famtFxrtVal|copnGb|itemIdx|copnPblcNo|maxDcPossAmt|copnTypeGbcd)

                    //프로모션 코드 적용 대상 상품을 포함하고 있을 때
                    if(promotionTargetItem.indexOf(copnInfArr[1] + '-' + copnInfArr[2]) > -1){

                        var copnItemIdx = copnInfArr[7];
                        var maxDcPossAmt = copnInfArr[9];

                        var sellPrc = isEmpty($("span#" + copnInfArr[1] + copnInfArr[2] + copnInfArr[3]).data("sellPrc")) ? 0 : Number($("span#" + copnInfArr[1] + copnInfArr[2] + copnInfArr[3]).data("sellPrc"));

                        if(beforeCopnItemIdx == copnItemIdx) {  // 같은 상품에 적용된 다른 쿠폰이 존재하는 경우
                            sellPrc -= beforeCopnDcAmt;
                        }
                        var copnAmt = 0;

                        if(copnInfArr[4] == '1') {
                            copnAmt = Math.floor(Number(copnInfArr[5]) * Number(sellPrc) / 1000) * 10;
                        } else {
                            copnAmt = Number(copnInfArr[5]);
                        }

                        if(maxDcPossAmt > 0 && copnAmt > maxDcPossAmt) {
                            copnAmt = Number(maxDcPossAmt);
                        }

                        copnDcAmt += copnAmt;

                        var copnDcInfArr = pickArray($("span#" + copnInfArr[1] + copnInfArr[2] + copnInfArr[3]), "copnDcInf");

                        for(var i=0; i<copnDcInfArr.length; i++) {
                            if(copnDcInfArr[i] == 0) {
                                copnDcInfArr[i] = copnItemIdx + "|" + copnAmt;
                                break;
                            } else {
                                if(copnDcInfArr[i].indexOf("|") > -1) {
                                    if(copnDcInfArr[i].split("|")[0] == copnItemIdx) {
                                        copnDcInfArr[i] = copnDcInfArr[i] + "|" + copnAmt;
                                        break;
                                    }
                                }
                            }
                        }

                        // 20190114 상품필드에 있는 쿠폰가격, 금액을 설정하는 부분
                        curSlitmCd = copnInfArr[1];
                        curUitmCd = copnInfArr[2];

                        if (curSlitmCd == preSlitmCd && curUitmCd == preUitmCd) {
                            eachSlitmPrc += copnAmt;
                        } else {
                            if (isEmpty(preSlitmCd)) {
                                preSlitmCd = curSlitmCd;
                                preUitmCd = curUitmCd;
                                eachSlitmPrc = copnAmt;
                            }
                            //console.log('#sale-price-' + preSlitmCd + '-' + preUitmCd);
                            $('#sale-price-' + preSlitmCd + '-' + preUitmCd).text('-' + gfn_appendComma(eachSlitmPrc) + '원');
                            var eachTotPrc = $('#tot-price-' + preSlitmCd + '-' + preUitmCd).data('tot-prc');
                            $('#tot-price-txt-' + preSlitmCd + '-' + preUitmCd).text(gfn_appendComma((eachTotPrc - eachSlitmPrc)) + '원');
                            eachSlitmPrc = 0;
                            eachSlitmPrc += copnAmt;
                        }

                        preSlitmCd = curSlitmCd;
                        preUitmCd = curUitmCd;
                        // END

                        bindArray($("span#" + copnInfArr[1] + copnInfArr[2] + copnInfArr[3]), "copnDcInf", copnDcInfArr);

                        beforeCopnItemIdx = copnItemIdx;
                        beforeCopnDcAmt = copnAmt;
                    }
                });
            }

            // H&M 결제금액할인
            if($("div.hnm-promotion-code input[name='hnmPaymentCopnInf']").length > 0){
                $("div.hnm-promotion-code input[name='copnInf']").each(function() {
                    var copnInfArr = $(this).val().split("|"); // (copnNo|slitmCd|uitmCd|aspItemCd|famtFxrtGbcd|famtFxrtVal|copnGb|itemIdx|copnPblcNo|maxDcPossAmt|copnTypeGbcd|ulmtUseYn|dcPrice)

                    var copnAmt = 0;

                    if(copnInfArr[10] == '10'){      // 결제금액할인코드
                        copnAmt = Number(copnInfArr[12]);
                    }

                    copnDcAmt += copnAmt;
                });
            }
            return gfn_appendComma(copnDcAmt);
        }

        function goAddrList(obj){

            //어디에서 호출했는지 저장하기 위한 변수
            $("#addrListCallId").val($(obj).attr("id"));

            var dstnSeq = $(obj).find("input[name=dstnSeq]").val();
            var multiIndex =$(obj).find("input[name=multiIndex]").val();
            // dawnDlvYn, premDlvYn 처리
            var specialDlvType = $("input[name='shipping-type-select']:checked").val();
            var dawnDlvYn = "N";
            var premDlvYn = "N";
            if ( specialDlvType == "type6" ) {
            	dawnDlvYn = "Y";
            } else if ( specialDlvType == "type7" ) {
            	premDlvYn = "Y";
            }

            if(isEmpty(multiIndex)) multiIndex = 0;

            $.ajax({
                type: "get"
                , url: "/m/selectDstnAdrList.do"
                ,data: {
                    'dstnSeq':dstnSeq,
                    'multiIndex':multiIndex,
                    'dawnDlvYn':dawnDlvYn,
                    'premDlvYn':premDlvYn
                }
                , dataType: "html"
                , success : function(data) {
                	if ( specialDlvType == "type6" ) {
                		$("#shipping-type6-list").empty();
                        $("#shipping-type6-list").append(data);
                        // 6,7일때는 버튼이 추가됨.
                        var btnHtml = '<div class="popup-footer">';
                        btnHtml += '<button class="btn-cancel" onclick="closeLayerPopup();">취소</button>';
                        btnHtml += '<button class="btn-confirm"  onclick="specialDlvBtn();">선택완료</button>';
                        btnHtml += '</div>';
                        $("#shipping-type6-list").append(btnHtml);
                	} else if ( specialDlvType == "type7" ) {
                		$("#shipping-type7-list").empty();
                        $("#shipping-type7-list").append(data);
                        // 6,7일때는 버튼이 추가됨.
                        var btnHtml = '<div class="popup-footer">';
                        btnHtml += '<button class="btn-cancel" onclick="closeLayerPopup();">취소</button>';
                        btnHtml += '<button class="btn-confirm"  onclick="specialDlvBtn();">선택완료</button>';
                        btnHtml += '</div>';
                        $("#shipping-type7-list").append(btnHtml);
                	} else {
	                    $("#addrListArea").empty();
	                    $("#addrListArea").append(data);
	                    $("input[name='selectAddr'][value='"+dstnSeq+"']").prop("checked",true);
                        
                        if ( $("#addrListArea").find("ul.addr-list").length == 0 ) {
                            $("#addrSelect ul.tab>li").eq(1).find("a").click();
                        }
                	}
                    // TODO : dawnDlvYn, premDlvYn 기본선택
                }
                , error: function(data) {
                    alert("고객님 죄송합니다.\n30분이상 아무 동작을 안하셨거나 네트워크가 불안정하여 서버와의 연결이 끊겼습니다.\n주문을 다시 진행하여 주시기 바랍니다.같은 오류가 지속적으로 발생 시 고객센터 1600-000으로 문의 주시거나 고객센터 1:1문의를 통하여 문의 주시기 바랍니다.");
                    $(".popup_sublayer.address.nobtn").html("");
                }
                , complete: function(jqXHR,textStatus ){
                }
            });
        }

        function dlvAddInfoReset(){
            $("#newaddress_wrap").find("input[name=newDstnBaseAdr]").val("");
            $("#newaddress_wrap").find("input[name=dstnNknm]").val("");
            $("#newaddress_wrap").find("input[name=rcvCustNm]").val("");
            $("#newaddress_wrap").find("input[name=dstnPostNo]").val("");
            $("#newaddress_wrap").find("input[name=dstnBaseAdr]").val("");
            $("#newaddress_wrap").find("input[name=dstnPtcAdr]").val("");
            $("#newaddress_wrap").find("select[name=dstnHpIdntNo]").val("");
            $("#newaddress_wrap").find("input[name=dstnHpIntmNo]").val("");
            $("#newaddress_wrap").find("select[name=dstnTela]").val("");
            $("#newaddress_wrap").find("input[name=dstnTels]").val("");
            $("#newaddress_wrap").find("input[name=adrKndGbcd]").val("2");
            $("#newaddress_wrap").find("input[name=dstnSeq]").val("");
            $("#newaddress_wrap").find("input[name=baseYn]").prop("checked");
            $("#newaddress_wrap").find("input[name=updateYn]").val("N");
            $("#newaddress_wrap select[name='dstnHpIdntNo']").val("010");
        }

        function dstnBtnConfirm(){
            if($(".btn-addr-list").parent().attr("class") == "on"){
                if($("input[name='selectAddr']:checked").length == 0){
                    alert("배송지를 선택해 주세요");
                    return;
                }else{
                    var id = "liAddr"+$("input[name='selectAddr']:checked").val();
                    var obj = $("#"+id);
                    var multiIndex = obj.find("input[name='multiIndex']").val();

                    preDlvChoice(obj,multiIndex);
                    $("#selectDstnDesc").hide();
                    $("#firstDstnInfo").show();
                }
            }else if($(".btn-add-addr").parent().attr("class") == "on"){
                saveDstnAddr();
            }               

        }

        function dept2Validation(){
        	var cnt = $(".shipping-step-1").find("input[name=multiCnt]").val();
            var size = $("#domestic li[name='domesticDstnLi']").length;
            var chgAddressFirst = $("#domestic li[name='domesticDstnLi']").find("input[name=depth3_address_chg_1]").val();
            var ischg = false;
            var result = true;
            var baseYnCnt = 0;
            
            // init #domestic li[name='domesticDstnLi'] 0번 말고 다 지움.
            //var size = $("#domestic li[name='domesticDstnLi']:gt(0)").remove();
            //$("#domestic li[name='domesticDstnLi']:gt(0)").remove();
            
            var custInfo = "010-2360-6586"; // 고객전화번호

            $(".shipping-step-2 .addr-list li").each(function() {
                var baseYn = $(this).find("input[name=baseYn]").val();
                var dstnSeq = $(this).find("input[name=dstnSeq]").val();
                
                if(isEmpty($(this).find("input[name=dstncustNo]").val())) {
                    result = false;
                }

                if(baseYn == "Y") {
                    $(".shipping-step-2 .addr-list li").each(function() {
                        var deffbaseYn = $(this).find("input[name=baseYn]").val();
                        var deffdstnSeq = $(this).find("input[name=dstnSeq]").val();
                        if(deffbaseYn == "Y" && dstnSeq != deffdstnSeq) {
                            baseYnCnt++;
                        }
                    });
                }
            });

            if(!result) {
                alert("배송지가 입력되지 않았습니다.");
                //$(this).removeAttr("dg-subdata", "");
                return false;
            }

            if(baseYnCnt > 1) {
                alert("기본으로 설정 된 배송지가 1개 이상입니다.\n다시 선택해주세요.");
                //$(this).removeAttr("dg-subdata", "");
                return false;
            }
            
            if(chgAddressFirst == "Y") {
                //추후 작업
                var baseYn = $("#addressInfoBaseYn_1").html();
                var custNm = $("#addressInfoCustNm_1").html();
                var addressInfoPtcAdr = $("#addressInfoPtcAdr_1").html();
                var addressInfoHpIdntNo = $("#addressInfoHpIdntNo_1").html();
                var addressInfoDstnTela = $("#addressInfoDstnTela_1").html();

                $("#depth3Nm_1").html(custNm);
                $("#depth3Nm_1").siblings("span.txt-grey").remove();
                $("#depth3Nm_1").parents("div.addr-area").find("div.row-wrap").remove();
                
                if ( baseYn.indexOf("기본배송지") < 0 ) {
                	$("#depth3Nm_1").parents("div.addr-area").append("<div class='row-wrap'><span class='row-title'><input type='radio' name='baseDstnYn' onclick='baseDstnYnClick(this);' value='Y'/> 기본배송지</span></div>");
                    //$("<div class='row-wrap'><span class='row-title'><input type='radio' name='baseDstnYn' value='Y'/>기본배송지</span></div>").insertAfter($("#depth3Nm_1").parent().parent().find("div.phone-number"));
                    //$("a#multi_false").parent().find("a").last().after("<div class='row-wrap' id='rcvCustSms'><span class='row-title'><input type='checkbox' id='taker-alarm' name='rcvCustSms' value='Y'><label for='taker-alarm'>받으실 분에게도 배송 알림 <button class='btn-linegray xs info btn-slpopup' data-sub-lpopup='popup-recipient-delivery-noti'><span>안내</span></button></label></span></div>");
                    //$("#depth3Nm_1").parents("div.addr-area").append("<div class='row-wrap'><span class='row-title'><input type='radio' name='baseDstnYn' value='Y'/>기본배송지</span></div>");
                } else {
                	$("#depth3Nm_1").after('<span class="txt-grey">(기본)</span>');
                	$("#depth3Nm_1").parent().parent().find("div.row-wrap").each(function(){
                		if ( $(this).find("span").html().indexOf("(기본)") > 0 ) {
                			$(this).remove();
                		}
                	});
                }
                
                if ( custInfo != addressInfoHpIdntNo ) {
                	$("#depth3Nm_1").parents("div.addr-area").append("<div class='row-wrap' id='rcvCustSms'><span class='row-title'><input type='checkbox' id='taker-alarm' name='rcvCustSms' value='Y'><label for='taker-alarm'>받으실 분에게도 배송 알림 <button class='btn-linegray xs info btn-slpopup' data-sub-lpopup='popup-recipient-delivery-noti'><span>안내</span></button></label></span></div>");
                }
                
                $("#depth3Add_1").html(addressInfoPtcAdr);
                $("#depth3Hp_1").html(addressInfoHpIdntNo);
                $("#depth3Tel_1").html(addressInfoDstnTela);

                $("#depth3_content_1").find("select[name=ordQty]").each(function () {
                    $(this).val("0");
                });
            }
            if(chkChangeMulti(cnt, size)) {
                ischg = true;
                $("#domestic li[name='domesticDstnLi']:gt(0)").remove();
            }

            for(var i=1; i < cnt; i++) {
                //추후 작업
                var idIndex = i+1;
                var baseYn = $("#addressInfoBaseYn_" + idIndex).html();
                var custNm = $("#addressInfoCustNm_" + idIndex).html();
                var addressInfoPtcAdr = $("#addressInfoPtcAdr_" + idIndex).html();
                var addressInfoHpIdntNo = $("#addressInfoHpIdntNo_" + idIndex).html();
                var addressInfoDstnTela = $("#addressInfoDstnTela_" + idIndex).html();

                if(ischg) {
                    var innerHtml = "";
                    innerHtml += "<li name='domesticDstnLi'>";
                    innerHtml += "  <input type='hidden' name='depth3_address_chg_" + idIndex + "' value='N'/>";
                    innerHtml += "  <input type='hidden' name='depth3_address_chg_" + idIndex + "' value='N'/>";
                    innerHtml += "  <input type='hidden' name='depth3ErrorCode' value='0'/>";
                    innerHtml += "  <div class='addr-area'>";
                    innerHtml += "      <div class='name'>배송지" + idIndex + "</div>";
                    innerHtml += "      <div class='addr'>";
                    innerHtml += "          <span id='depth3Nm_" + idIndex + "'>"+custNm+"</span>";
                    if ( baseYn.indexOf("기본배송지") > -1 ) {
                        innerHtml += "          <span class='txt-grey'>(기본)</span>";
                    }
                    innerHtml += "          <span id='depth3Add_" + idIndex + "'>" + addressInfoPtcAdr + "</span>";
                    innerHtml += "      </div>";
                    innerHtml += "      <div class='phone-number' id='depth3Hp_" + idIndex + "'>" + addressInfoHpIdntNo + " </div>";
                    innerHtml += "      <div class='phone-number' id='depth3Tel_" + idIndex + "'>" + addressInfoDstnTela + " </div>";
                    // baseDstnYn
                    if ( baseYn != "Y" ) {
                        innerHtml += "<div class='row-wrap'><span class='row-title'><input type='radio' name='baseDstnYn' onclick='baseDstnYnClick(this);' value='Y'/> 기본배송지</span></div>";
                    }
                    // checkRcvp
                    if ( custInfo != addressInfoHpIdntNo && custInfo != addressInfoDstnTela ) {
                        innerHtml += "<div class='row-wrap'><span class='row-title'><input type='checkbox' id='taker-alarm' name='rcvCustSms' value='Y'><label for='taker-alarm'>받으실 분에게도 배송 알림 <button class='btn-linegray xs info btn-slpopup' data-sub-lpopup='popup-recipient-delivery-noti'><span>안내</span></button></label></span></div>";
                    }
                    
                    innerHtml += "  </div>";
                    innerHtml += "  <ul class='shipping-item-area' id='depth3_content_" + idIndex + "'>";
                    innerHtml += "  </ul>";
                    innerHtml += "  <select class='select-shipping-memo' name='mmsMsgCntn' id='multiaddress_depth4_dlvMemo_" + idIndex + "' onchange='changeDlvMemoSelectMulti(this);'>";

                    innerHtml += "  </select>";
                    innerHtml += "  <span class='input-cnt-wrap shipping-memo' data-maxcnt='100'>";
                    innerHtml += "      <span class='input-cnt'><span class='curr-cnt text_count'>0</span>/<span class='total-cnt'>100</span></span>";
                    innerHtml += "      <textarea placeholder='배송메모를 입력하세요.' name='mmsMsgCntnMulti'  onkeyup='checkBytes(this, 100)'></textarea>";
                    innerHtml += "  </span>";
                    innerHtml += "  <input type='hidden' name='dsrvCoMsgInfCustInsrYn'>";
                    innerHtml += "</li>";
                    $("#domestic").append(innerHtml);
                    $("#multiaddress_depth4_dlvMemo_"+idIndex).append($("#multiaddress_depth4_dlvMemo_1").html());

                    $("#depth3_content_" + idIndex).append($("#depth3_content_1 li").clone());
                }
            }
            return true;
        }
        
          //선물하기 2020.09.01 김지영
            function dept2GiftValidation(){
                var cnt = $(".shipping-step-1").find("input[name=multiCnt]").val();
                var result = false;
                var ischg = false;
                var size = $("#domestic li[name='domesticDstnLi']").size();
                
                if(chkChangeMulti(cnt, size)) {
                    ischg = true;
                    $(".multiaddress_depth3 dl:gt(0)").remove();
                }
                
                $(".giftMultiDlvArea div[name=mobileDlv]").each(function() {
                
                    //var dstnSeq = $(this).find("input[name=dstnSeq]").val();
                    if(isEmpty($(this).find("input[name=senderName]").val())) {
                        result = 1;
                    }
                    else if(isEmpty($(this).find("input[name=rcvCustNm]").val())) {
                        result = 2;
                    }
                    else if(isEmpty($(this).find("input[name=rcvCustHpTel2]").val())) {
                        result = 3;
                    }
                    else if( $(this).find("input[name=rcvCustHpTel2]").val().length < 7) {
                        result = 5;
                    }
                    else if(isEmpty($(this).find("textarea[name=mmsMsgCntn]").val())) {
                        result = 4;
                    }
                });
                
                if(result==1) {
                    alert("보내는 분이 입력되지 않았습니다.");
                    return false;
                }else if(result==2){
                    alert("받는 분이 입력되지 않았습니다.");
                    return false;
                }else if(result==3){
                    alert("받는 분 연락처가 입력되지 않았습니다.");
                    return false;
                }else if(result==4){
                    alert("메세지가 입력되지 않았습니다.");
                    return false;
                }else if(result==5){
                    alert("받는 분 연락처가 제대로 입력되지 않았습니다.");
                    return false;
                }
                
                $("#depth3Nm_1").text($(".giftMultiDlvArea div[name=mobileDlv]:eq(0) input[name=rcvCustNm]").val());
                var rcvCustHpTel2Nm = $(".giftMultiDlvArea div[name=mobileDlv]:eq(0) input[name=rcvCustHpTel2]").val();
                var rcvHpNm2 = rcvCustHpTel2Nm.slice(-4);
                var rcvHpNm1 = rcvCustHpTel2Nm.slice(0,-4);
                $("#depth3Hp_1").text($(".giftMultiDlvArea div[name=mobileDlv]:eq(0) select[name=rcvCustHpTel1] option:selected").val()+"-"+rcvHpNm1+"-"+rcvHpNm2);
      
                for(var i=1; i < cnt; i++) {
                    var idIndex = i+1;
                    
                    var custNm = $(".giftMultiDlvArea div[name=mobileDlv]:eq("+i+") input[name=rcvCustNm]").val();
                    var rcvCustHpTel2Nm = $(".giftMultiDlvArea div[name=mobileDlv]:eq("+i+") input[name=rcvCustHpTel2]").val();
                    var rcvHpNm2 = rcvCustHpTel2Nm.slice(-4);
                    var rcvHpNm1 = rcvCustHpTel2Nm.slice(0,-4);
                    var addressInfoHpIdntNo = $(".giftMultiDlvArea div[name=mobileDlv]:eq("+i+") select[name=rcvCustHpTel1] option:selected").val()+"-"+rcvHpNm1+"-"+rcvHpNm2;
                   
                    if(ischg && size != cnt)
                    {
                          if($("#depth3_content_" + idIndex).length == 0)
                        {
                            $("#domestic").append('<li name="domesticDstnLi"><input type="hidden" name="depth3_address_chg_' + idIndex + '" value="N"/><input type="hidden" name="depth3ErrorCode" value="0"/><div class="addr-area"><div class="name">받는분 ' + idIndex + '</div><div class="addr"><span id="depth3Nm_' + idIndex + '">'+ custNm + '</span> | <span class="txt-grey" id="depth3Hp_' + idIndex + '">' + addressInfoHpIdntNo + '</span></div></div><ul class="shipping-item-area" id="depth3_content_' + idIndex + '"></ul></li>');
                            //$("#depth3_content_" + idIndex).append($(".giftDepth3 ul").clone()); 
                        }
                        
                        if($("#depth3_content_" + idIndex).find("li").length == 0)
                        {
                            $("#depth3_content_" + idIndex).append($(".giftDepth3 ul li").clone()); 
                        }
                    }else{
                    	if($("#depth3Nm_"+idIndex).length >0){
                    		$("#depth3Nm_"+idIndex).text(custNm);
                    	}
                    	
                    	if($("#depth3Hp_"+idIndex).length >0){
                    		$("#depth3Hp_"+idIndex).text(addressInfoHpIdntNo);
                    	}
                    }
                     
                }
                
                for(var i=1; i <= cnt; i++) {
                    $("#domestic li").find("input[name=depth3_address_chg_" + i + "]").val("N");
                }
                return true;
            }

        function dept3Validation(){
            var errorCode = 0;
            var cnt = $(".shipping-step-1").find("input[name=multiCnt]").val();
            var errorCnt = 1;

            $("#domestic li[name='domesticDstnLi']").each(function () {
                errorCode += Number($(this).find("input[name=depth3ErrorCode]").val());
                if(errorCode == 0) errorCnt++;
            });

            if(errorCode > 0) {
                alertMsg(errorCnt + "번 배송지에\n주문수량보다 선택한 수량이 더 많습니다.");
                return false;
            }

            for(var i = 1; i <= cnt; i++) {
                var itemQty = 0;

                $("#depth3_content_" + i).find("li").each(function () {
                    itemQty += Number($(this).find("select[name=ordQty]").val());
                });

                if(itemQty == 0) {
                    $("#multiaddress4th ._loadingscreen").remove();
                    alertMsg(i + "번 배송지에 선택 된 상품이 없습니다.");
                    $(this).removeAttr("dg-subdata", "");
                    return;
                }
            }
            
            // 배송지별 상품 수량 확인
            var dstnQtyFlag = true;
            var dlvNdmtDtlFlag = true;
            $("#slitmInfDiv span").each(function() {
                var obj = $(this);
                var slitmCd = obj.data("slitmCd");
                var uitmCd = obj.data("uitmCd");
                var aspItemCd = obj.data("aspItemCd");
                var ordQty = Number(obj.data("ordQty"));

                $("#multiaddress4th div.multiaddress_depth4 li[name='domesticDstnLi']").each(function(idx) {
                    $(this).find("li[name='itemboxList']").each(function(index) {
                        var selectedSlitmCd = $(this).find("input[name='slitmCd']").val();
                        var selectedUitmCd = $(this).find("input[name='uitmCd']").val();
                        var selectedAspItemCd = $(this).find("input[name='aspItemCd']").val();
                        var selectedOrdQty = isEmpty($(this).find("select[name='ordQty']").val()) ? 0 : Number($(this).find("select[name='ordQty']").val());
                        

                        if ( slitmCd == selectedSlitmCd && uitmCd == selectedUitmCd && aspItemCd == selectedAspItemCd ) {
                            if(selectedOrdQty > 0){
                                var dlvNoMsg = "";
                                var itemDlvNdmtDtlList = isEmpty(obj.data("itemDlvNdmtDtlList")) ? new Array() : obj.data("itemDlvNdmtDtlList");
                                var apocGbcd = $("#multiaddress_depth2_a"+(idx+1)).find("input[name='apocGbcd']").val();
                                for(var i = 0; i < itemDlvNdmtDtlList.length; i++) {
                                    var dlvNdmtDtl = itemDlvNdmtDtlList[i];
                                    if(dlvNdmtDtl.cd == apocGbcd) {
                                        dlvNoMsg += (index + 1) + "번째 상품이 " + dlvNdmtDtl.cdNm + "지역으로  배송이 불가능한 상품입니다.\n해당 상품은 다른 배송지를 지정해주세요.";
                                    }
                                }

                                if(!isEmpty(dlvNoMsg)) {
                                    alert(dlvNoMsg);
                                    dlvNdmtDtlFlag = false;
                                    return;
                                }
                            }

                            ordQty = ordQty - selectedOrdQty;
                        }
                    });
                });
                if ( ordQty != 0 ) {
                    dstnQtyFlag = false;
                }
            });

            if(!dlvNdmtDtlFlag) {
                return;
            }

            if ( !dstnQtyFlag ) {
            	$("#multiaddress4th ._loadingscreen").remove();

                var giftOrderYn = $("input[name='giftOrderYn']").val();
                if( giftOrderYn=="Y"){
                    alertMsg("선물하시려는 상품의 갯수를 확인해주세요.");
                }else{
                    alertMsg("배송지가 등록되지 않은 상품이 있습니다.");
                }

                $(this).removeAttr("dg-subdata", "");
                return;
            } else {
            	alertMsg("배송지가 모두 등록되었습니다.");
            }
            
            // 배송비 선결제 2020.08.31
            // 도서지역 추가 배송비 여러곳으로 배송시에 사용안함 2020.09.07
            if(chkIrgnAreaMutiDlv()){
                return false;
            }

            return true;
        }

        function halfDlvValidation(){
            /*var cnt = $(".shipping-step-1").find("input[name=multiCnt]").val();
            var size = $("#domestic li[name='domesticDstnLi']").size();*/
            var chgAddressFirst = $("#domestic li[name='domesticDstnLi']").find("input[name=depth3_address_chg_1]").val();
            var ischg = false;
            var result = true;
            var baseYnCnt = 0;
            $(".shipping-step-1 .addr-list li").each(function() {
                var baseYn = $(this).find("input[name=baseYn]").val();
                var dstnSeq = $(this).find("input[name=dstnSeq]").val();

                if(isEmpty($(this).find("input[name=dstncustNo]").val())) {
                    result = false;
                }

                if(baseYn == "Y") {
                    $(".shipping-step-1 .addr-list li").each(function() {
                        var deffbaseYn = $(this).find("input[name=baseYn]").val();
                        var deffdstnSeq = $(this).find("input[name=dstnSeq]").val();
                        if(deffbaseYn == "Y" && dstnSeq != deffdstnSeq) {
                            baseYnCnt++;
                        }
                    });
                }
            });

            if(!result) {
                alert("배송지가 입력되지 않았습니다.");
                //$(this).removeAttr("dg-subdata", "");
                return false;
            }

            if(baseYnCnt > 1) {
                alert("기본으로 설정 된 배송지가 1개 이상입니다.\n다시 선택해주세요.");
                //$(this).removeAttr("dg-subdata", "");
                return false;
            }

            if(chgAddressFirst == "Y") {
                //추후 작업
                var baseYn = $("#addressInfoBaseYn_1").html();
                var custNm = $("#addressInfoCustNm_1").html();
                var addressInfoPtcAdr = $("#addressInfoPtcAdr_1").html();
                var addressInfoHpIdntNo = $("#addressInfoHpIdntNo_1").html();
                var addressInfoDstnTela = $("#addressInfoDstnTela_1").html();
                var firstDstnSeq = $("#multiaddress_depth2_a1").find("input[name='dstnSeq']").val();
                var secondDstnSeq = $("#secondDstnSeq").val();

                if(firstDstnSeq != secondDstnSeq){
                    $("#depth3Nm_1").html(custNm);
                    if (baseYn.indexOf("기본")>-1) {
                        $("#depth3baseYn_1").html("("+baseYn+")");
                    } else {
                    	$("#depth3baseYn_1").html("");
                    }
                    $("#depth3Add_1").html(addressInfoPtcAdr);
                    $("#depth3Hp_1").html(addressInfoHpIdntNo);
                    $("#depth3Tel_1").html(addressInfoDstnTela);
                    $("#secondDstnSeq").val(firstDstnSeq);

                    $("#multiaddress_depth4_dlvMemo_1 option:eq(0)").prop("selected",true);
                    changeDlvMemoSelectMulti($("#multiaddress_depth4_dlvMemo_1"));
                    $("#multiaddress_depth4_dlvMemo_1").siblings(".input-cnt-wrap.shipping-memo").removeClass("_active");
                }
            }

            var dstnSeq = $("#multiaddress_depth2_a2").find("input[name='dstnSeq']").val();
            var dept3DstnSeq = $("#depth3_dstnSeq_2").val();

            if(dstnSeq != dept3DstnSeq){
                $("#domestic li[name='domesticDstnLi']:gt(0)").remove();
                var idIndex = 2;
                var baseYn = $("#addressInfoBaseYn_" + idIndex).html();
                var custNm = $("#addressInfoCustNm_" + idIndex).html();
                var addressInfoPtcAdr = $("#addressInfoPtcAdr_" + idIndex).html();
                var addressInfoHpIdntNo = $("#addressInfoHpIdntNo_" + idIndex).html();
                var addressInfoDstnTela = $("#addressInfoDstnTela_" + idIndex).html();

                var innerHtml = "";
                innerHtml += "<li name='domesticDstnLi'>";
                innerHtml += "  <input type='hidden' name='depth3_address_chg_" + idIndex + "' value='N'/>";
                innerHtml += "  <input type='hidden' name='depth3_address_chg_" + idIndex + "' value='N'/>";
                innerHtml += "  <input type='hidden' id='depth3_dstnSeq_" + idIndex + "' value='"+dstnSeq+"'/>";
                innerHtml += "  <input type='hidden' name='depth3ErrorCode' value='0'/>";
                innerHtml += "  <div class='addr-area'>";
                innerHtml += "      <div class='name'>배송지" + idIndex + "</div>";
                innerHtml += "      <div class='addr'>";
                innerHtml += "          <span id='depth3Nm_" + idIndex + "'>"+custNm+"</span>";
                if ( baseYn.indexOf("기본배송지") > -1 ) {
                    innerHtml += "          <span class=''>(기본배송지)</span>";
                }
                innerHtml += "          <span id='depth3Add_" + idIndex + "'>" + addressInfoPtcAdr + "</span>";
                innerHtml += "      </div>";
                innerHtml += "      <div class='phone-number' id='depth3Hp_" + idIndex + "'>" + addressInfoHpIdntNo + " </div>";
                innerHtml += "      <div class='phone-number' id='depth3Tel_" + idIndex + "'>" + addressInfoDstnTela + " </div>";
                innerHtml += "  </div>";
                innerHtml += "  <ul class='shipping-item-area' id='depth3_content_" + idIndex + "'>";
                innerHtml += "  </ul>";
                innerHtml += "  <select class='select-shipping-memo' name='mmsMsgCntn' id='multiaddress_depth4_dlvMemo_" + idIndex + "' onchange='changeDlvMemoSelectMulti(this);'>";

                innerHtml += "  </select>";
                innerHtml += "  <span class='input-cnt-wrap shipping-memo' data-maxcnt='100'>";
                innerHtml += "      <span class='input-cnt'><span class='curr-cnt text_count'>0</span>/<span class='total-cnt'>100</span></span>";
                innerHtml += "      <textarea placeholder='배송메모를 입력하세요.' name='mmsMsgCntnMulti'  onkeyup='checkBytes(this, 100)'></textarea>";
                innerHtml += "  </span>";
                innerHtml += "  <input type='hidden' name='dsrvCoMsgInfCustInsrYn'>";
                innerHtml += "</li>";
                $("#domestic").append(innerHtml);
                $("#multiaddress_depth4_dlvMemo_"+idIndex).append($("#multiaddress_depth4_dlvMemo_1").html());

                $("#depth3_content_" + idIndex).append($("#depth3_content_1 li").clone());
            }

            return true;
        }

        function specialDlvBtn(){
        	
        	// 여러곳으로 배송 숨기기.
        	$("#multiDlv").show();

            var specialDlvType = $("input[name='shipping-type-select']:checked").val();
            var obj = $(".input-shipping-info."+specialDlvType);

            var name = $(obj).find("input[name='specialCustNm']").val();
            var addr = $(obj).find("input[name='specialDlvAdr']").val();
            var detailAddr = $(obj).find("input[name='specialDstnPtcAdr']").val();
            //var phone = $(obj).find("select[name=specialDlvPhone1] option:selected").val()+""+$(obj).find("input[name='specialDlvPhone2']").val();
            var postNo = $(obj).find("input[name='specialDstnPostNo']").val();
            
            if ( $(obj).find("li.on a").html() == "배송지 목록" ) {
            	$(obj).find("input[name=selectAddr]").each(function(){
            		if ( $(this).prop("checked") == true ) {
            			name = $(this).parent().siblings("input[name=rcvCustNmPrv]").val();
            			addr = $(this).parent().siblings("input[name=dstnBaseAdrPrv]").val();
            			detailAddr = $(this).parent().siblings("input[name=dstnPtcAdrPrv]").val();
            			//phone = $(this).parent().siblings("input[name='dstnHpIdntNoPrv']").val()+""+$(this).parent().siblings("input[name='dstnHpIntmNoPrv']").val()+""+$(this).parent().siblings("input[name='dstnHpBckNoPrv']").val();
            			postNo = $(this).parent().siblings("input[name=dstnPostNoPrv]").val();
            		}
            	});
            	if ( isEmpty(name) ) {
            		alert("배송지를 선택해 주세요.");
            		return;
            	}
            }

            if(name == "" || name == null || name == undefined){
                alert("받으실 분을 입력해 주세요.");
                return;
            }

            var dstnHpIdntNo = $(obj).find("select[name='specialDlvPhone1']").val();
            var dstnHpNo = $(obj).find("input[name='specialDlvPhone2']").val();
            if ( $(obj).find("li.on a").html() == "배송지 목록" ) {
                $(obj).find("input[name=selectAddr]").each(function(index){
                    if ( $(this).prop("checked") == true ) {
                    	dstnHpIdntNo = $(this).parent().siblings("input[name=dstnHpIdntNoPrv]").val();
                    	dstnHpNo = $(this).parent().siblings("input[name=dstnHpIntmNoPrv]").val()+$(this).parent().siblings("input[name=dstnHpBckNoPrv]").val();
                    }
                });
            }
            var dstnHpIntmNo;
            var dstnHpBckNo;

            if (isEmpty(dstnHpIdntNo) || isEmpty(dstnHpNo) || dstnHpNo.length < 7) {
                alert("휴대폰번호를 입력해주세요.");
                return false;
            }
            else {
                if (dstnHpNo.length == 7) {
                    dstnHpIntmNo = dstnHpNo.substring(0, 3);
                    dstnHpBckNo = dstnHpNo.substring(3, 7);
                }
                else {
                    dstnHpIntmNo = dstnHpNo.substring(0, 4);
                    dstnHpBckNo = dstnHpNo.substring(4, 8);
                }

                if (!chkPhone(dstnHpIdntNo, dstnHpIntmNo, dstnHpBckNo)) {
                    alert("휴대폰번호를 정확히 입력해주세요.");
                    return false;
                }
            }

            if(specialDlvType == 'type3'){
                //안심배송
                if(addr == "" || addr == null || addr == undefined){
                    alert("배송주소를 입력해 주세요.");
                    return;
                }

                $("#dstnTypeName").html("배송정보[안심 택배함]");
                deleveryTypeSelect("safe");

                $("input[name='adrKndGbcd']").val("2");
            }else if(specialDlvType == 'type5'){
                //편의점 픽업
                addr = $("#cvst_brn_nm").val();
                $("#dstnTypeName").html("배송정보[편의점 픽업]");
                deleveryTypeSelect("convenience");

                $("input[name='adrKndGbcd']").val("1");
            }else if(specialDlvType == 'type6'){
                //새벽배송
                if(addr == "" || addr == null || addr == undefined){
                    alert("배송주소를 입력해 주세요.");
                    return;
                }

                if(detailAddr == "" || detailAddr == null || detailAddr == undefined){
                    alert("배송지 상세주소를 입력해 주세요.");
                    return;
                }
                /*
                //공동현관 비밀번호 체크박스
                var passCodeStr =  $("input[name='mmsMsgCntnPwd']").val();
                if(passCodeStr.length > 0){
                    var passCodeChk = $("input[name='passCodeChk']").is(":checked");
                    if(!passCodeChk) {
                        alert("공동현관 비밀번호 수집 및 이용 동의 체크해주세요.");
                        return;
                    }
                }
                */
                $("#delivery_type_delivery1 #dawnAddInfo").remove();
                var addInfoHtml = "";
                addInfoHtml += "<div id='dawnAddInfo' class='input-shipping-info'>";
                addInfoHtml += "<div class='row-wrap'>";
                addInfoHtml += "<span class='row-title txt-wrap pt15'>주변 건물 및 배송 특이사항</span>";
                addInfoHtml += "<span class='row-value'>";
                addInfoHtml += "<span class='input-cnt-wrap' data-maxcnt='100'>";
                addInfoHtml += "<span class='input-cnt'><span class='curr-cnt text_count'>0</span>/<span class='total-cnt'>100</span></span>";
                addInfoHtml += "<textarea name='mmsMsgCntn' placeholder='찾기 어려운 건물이나 출입 제한이 있는 건물의경우, 건물 특징, 출입 방법, 공동현관 비밀번호 등을 적어주세요.' onkeyup='checkBytes(this, 100)'></textarea>";
                addInfoHtml += "</span>";
                addInfoHtml += "</span>";
                addInfoHtml += "</div>";
                addInfoHtml += "<div class='row-wrap'>";
                addInfoHtml += "<span class='row-title txt-wrap'>공동현관<br>비밀번호</span>";
                addInfoHtml += "<span class='row-value'>";
                addInfoHtml += "<span class='input-cnt-wrap' data-maxcnt='20'>";
                addInfoHtml += "<span class='input-cnt'><span class='curr-cnt text_count'>0</span>/<span class='total-cnt'>20</span></span>";
                addInfoHtml += "<input class='type-box' type='text' name='mmsMsgCntnPwd' onkeyup='checkBytes(this, 20)'>";
                addInfoHtml += "</span>";
                addInfoHtml += "</span>";
                addInfoHtml += "</div>";
                addInfoHtml += "<input type='checkbox' id='privacy-policy-2' name='passCodeChk'><label for='privacy-policy-2'>공동현관 비밀번호 수집 및 동의</label> <a class='btn-helper btn-slpopup' data-sub-lpopup='popup-privacy-policy2' href='javascript:;'>도움말</a>";
                addInfoHtml += "</div>";
                
                $("#delivery_type_delivery1").append(addInfoHtml);
                
                $("input[name='specialDstnBaseAdr']").val(addr);
                $(obj).find("input[name='specialDstnPtcAdr']").val(detailAddr);
                $(obj).find("input[name='specialDlvAdr']").val(addr);
                $(obj).find("input[name='specialDstnPostNo']").val(postNo);
                $("input[name='dawnDstnPtcAdr']").val($(obj).find("input[name='specialDstnPtcAdr']").val());
                
                $("#dstnTypeName").html("배송정보[새벽배송]");
                
                $("#delivery_type_special").removeClass("btn-lpopup-early");
                $("#delivery_type_special").removeClass("btn-lpopup-premium");
                $("#delivery_type_special").addClass("btn-lpopup-early");
                
                deleveryTypeSelect("dawn");
                // 여러곳으로 배송 숨기기.
                $("#multiDlv").hide();
            }else if(specialDlvType == 'type7'){
                //프리미엄(당일) 배송
                if(addr == "" || addr == null || addr == undefined){
                    alert("배송주소를 입력해 주세요.");
                    return;
                }

                if(detailAddr == "" || detailAddr == null || detailAddr == undefined){
                    alert("배송지 상세주소를 입력해 주세요.");
                    return;
                }
                
                $("input[name='specialDstnBaseAdr']").val(addr);
                $(obj).find("input[name='specialDstnPtcAdr']").val(detailAddr);
                $(obj).find("input[name='specialDlvAdr']").val(addr);
                $(obj).find("input[name='specialDstnPostNo']").val(postNo);
                $("input[name='premDstnPtcAdr']").val($(obj).find("input[name='specialDstnPtcAdr']").val());
                
                $("#dstnTypeName").html("배송정보[프리미엄(당일) 배송]");
                
                $("#delivery_type_special").removeClass("btn-lpopup-early");
                $("#delivery_type_special").removeClass("btn-lpopup-premium");
                $("#delivery_type_special").addClass("btn-lpopup-premium");
                
                deleveryTypeSelect("prem");
                // 여러곳으로 배송 숨기기.
                $("#multiDlv").hide();
            }else if(specialDlvType == 'type8'){
                //스토어픽
                $("#dstnTypeName").html("배송정보[스토어픽]");
                deleveryTypeSelect("safe");
            }

            //데이터 값 셋팅
            $("#multi_false input[name='dstnBaseAdr']").val($("input[name='specialDstnBaseAdr']").val());
            $("#multi_false input[name='dstnPtcAdr']").val($(obj).find("input[name='specialDstnPtcAdr']").val());
            $("#multi_false input[name='dlvAdr']").val($(obj).find("input[name='specialDlvAdr']").val());
            $("#multi_false input[name='dstnPostNo']").val($(obj).find("input[name='specialDstnPostNo']").val());
            $("#multi_false input[name='rcvCustNm']").val(name);
            $("#multi_false input[name='dstnHpIdntNo']").val(dstnHpIdntNo);
            $("#multi_false input[name='dstnHpIntmNo']").val(dstnHpIntmNo);
            $("#multi_false input[name='dstnHpBckNo']").val(dstnHpBckNo);

            //화면 값 셋팅
            $("#specialRcvCustNm").html(name);
            $("#specialDlvType").val(specialDlvType);
            $("#specialAddressInfoPtcAdr").html(addr);
            $("#specialAddressInfoHpIdntNo").html(dstnHpIdntNo+"-"+dstnHpIntmNo+"-"+dstnHpBckNo);

            closeLayerPopup();
        }
        
        function initSafeList() {
        	var si = "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)" == "" ? "서울특별시" : "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ").length > 0 ? "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ")[0] : "서울특별시";
            var gu = "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)" == "" ? "강동구" : "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ").length > 1 ? "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ")[1] : "강동구";
            $("div.type3 select[name=siNm] option[value="+si+"]").prop("selected", true);
            
            $.ajax({
                type: "post"
                ,url: "/m/oda/selectSafeAddress1.do"
                ,data: {siNm:si}
                ,dataType: "json"
                ,contentType:"application/x-www-form-urlencoded;charset=UTF-8"
                ,async:false
                ,success : function(data) {
                    
                    $("div.type3 select[name='guNm']").text("");
                    
                    var html = '<option value="">시/군/구</option>';
                    for(var i=0; i<data.guList.length; i++){
                          html += '<option value="'+data.guList[i].guNm+'"'+ (data.guList[i].guNm == gu?' selected':'') +' >'+data.guList[i].guNm+'</option>';                
                    }
                    
                    $("div.type3 select[name='guNm']").append(html);
                }
            });
            
            searchSafeAddr();
        }
        
        function initCvsList() {
            var si = "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)" == "" ? "서울특별시" : "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ").length > 0 ? "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ")[0] : "서울특별시";
            var gu = "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)" == "" ? "강동구" : "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ").length > 1 ? "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ")[1] : "강동구";
            // 안산시 케이스처리.
            var gu2 = "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ").length > 2 ? "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ")[1] + " " + "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)".split(" ")[2] : "";
            
            $("div.type5 select[name=siNm] option[value="+si+"]").prop("selected", true);
            
            $.ajax({
                type: "post"
                ,url: "/m/oda/cvsGuSearch.do"
                ,data: {siNm:si}
                ,dataType: "json"
                ,contentType:"application/x-www-form-urlencoded;charset=UTF-8"
                ,async:false
                ,success : function(data) {
                    
                    $("div.type5 select[name='guNm']").text("");
                    
                    var html = '<option value="">시/군/구</option>';
                    for(var i=0; i<data.guList.length; i++){
                        if ( data.guList[i] == gu || data.guList[i] == gu2 ) {
                            html += '<option value="'+data.guList[i]+'" selected>'+data.guList[i]+'</option>'; 
                        } else {
                          html += '<option value="'+data.guList[i]+'">'+data.guList[i]+'</option>'; 
                        }              
                    }
                    
                    $("div.type5 select[name='guNm']").append(html);
                }
            });
            
            searchCvsAddr();
        }
        
        function searchSafeAddr() {
            $.ajax({
                type: "post"
                , url: "/m/oda/selectSafeAddress.do"
                , dataType: "json"
                , data : {"siNm":$("div.type3 select[name=siNm] option:selected").val(), "guNm":$("div.type3 select[name=guNm] option:selected").val(), "searchNm":$("div.type3 input[name=searchNm]").val()}
                , success : function(data) {
                    $("#safeList div.no-result").remove();
                    $("#safeList ul.findlist").remove();
                    $("#safeSelect ul.findlist").remove();
                    var resultHtml = "";
                    if ( data.list.length > 0 ) {
                        resultHtml += "<ul class='findlist'>";
                        for ( var i = 0; i < data.list.length ; i++ ) {
                            console.log(data.list[i].siteNm);
                            resultHtml += "<li>";
                            resultHtml += "<strong>"+data.list[i].siteNm+"</strong>";
                            resultHtml += "<p>["+data.list[i].dstnPostNo+"]"+data.list[i].dstnBaseAdr+" "+data.list[i].dstnPtcAdr+"</p>";
                            resultHtml += "<div class='btngroup'>";
                            if ( data.list[i].latVal != null && data.list[i].lonVal != null ) {
                                resultHtml += "<button class='btn btn-linelgray sm' onclick='moveSafe(\""+data.list[i].latVal+"\", \""+data.list[i].lonVal+"\");'><span>위치보기</span></button>";
                            }
                            resultHtml += "<button class='btn btn-default sm' onclick='selectSafe(\""+data.list[i].siteNm+"\", \""+data.list[i].dstnPostNo+"\", \""+data.list[i].dstnBaseAdr+"\", \""+data.list[i].dstnPtcAdr+"\");'><span>선택</span></button>";
                            resultHtml += "</div>";
                            resultHtml += "</li>";
                        }
                        resultHtml += "</ul>";
                    } else {
                        resultHtml = "<div class='no-result'>검색결과가 없습니다.</div>";
                    }
                    $("#safeList").append(resultHtml);
                    $("#safeList").show();
                    $("#safeSelect").hide();
                }
                , error: function(data) {
                    alert("안심택배함 조회에 실패하였습니다.");
                }
            });
        }
        
        function searchCvsAddr() {
            $.ajax({
                type: "post"
                , url: "/m/smCvsSearch.do"
                , dataType: "json"
                , data : {"siNm":$("div.type5 select[name=siNm] option:selected").val(), "guNm":$("div.type5 select[name=guNm] option:selected").val(), "searchNm":$("div.type5 input[name=searchNm]").val()}
                , success : function(data) {
                    $("#cvsList div.no-result").remove();
                    $("#cvsList ul.findlist").remove();
                    $("#cvsSelect ul.findlist").remove();
                    var resultHtml = "";
                    if ( data.list.length > 0 ) {
                        resultHtml += "<ul class='findlist'>";
                        for ( var i = 0; i < data.list.length ; i++ ) {
                            resultHtml += "<li>";
                            resultHtml += "<strong>"+data.list[i].cvst_brn_nm+"</strong>";
                            resultHtml += "<p>["+data.list[i].post_no+"]"+data.list[i].base_adr+" "+data.list[i].ptc_adr+"</p>";
                            var cvsTelNo = "";
                            if ( !isEmpty(data.list[i].cvst_brn_tel) && data.list[i].cvst_brn_tel != "0" && data.list[i].cvst_brn_tel != "null" ) {
                                resultHtml += "<span class='field-phone'>"+data.list[i].cvst_brn_tel+"</span>";
                                cvsTelNo = data.list[i].cvst_brn_tel;
                            }
                            resultHtml += "<div class='btngroup'>";
                            if ( data.list[i].lat_val != null && data.list[i].lon_val != null ) {
                                resultHtml += "<button class='btn btn-linelgray sm' onclick='moveCvs(\""+data.list[i].lat_val+"\", \""+data.list[i].lon_val+"\");'><span>위치보기</span></button>";
                            }
                            resultHtml += "<button class='btn btn-default sm' onclick='selectCvs(\""+data.list[i].cvst_brn_nm+"\", \""+data.list[i].post_no+"\", \""+data.list[i].base_adr+"\", \""+data.list[i].ptc_adr+"\", \""+data.list[i].cvst_hofc_cd+"\", \""+cvsTelNo+"\", \""+data.list[i].cvst_brn_cd+"\");'><span>선택</span></button>";
                            resultHtml += "</div>";
                            resultHtml += "</li>";
                        }
                        resultHtml += "</ul>";
                    } else {
                        resultHtml = "<div class='no-result'>검색결과가 없습니다.</div>";
                    }
                    $("#cvsList").append(resultHtml);
                    $("#cvsList").show();
                    $("#cvsSelect").hide();
                }
                , error: function(data) {
                    alert("편의점 조회에 실패하였습니다.");
                }
            });
        }
        
        function selectSafe(name, postNo, addr, ptcAddr) {
        	$("#dstnTypeName").html("배송정보[안심 택배함]");
        	deleveryTypeSelect("safe");
        	
        	var obj = $(".input-shipping-info.type3");
        	$("input[name='specialDstnBaseAdr']").val(addr);
        	$(obj).find("input[name='specialDstnPtcAdr']").val(ptcAddr);
        	$(obj).find("input[name='specialDstnPostNo']").val(postNo)
        	
            $("#multi_false input[name='dstnBaseAdr']").val(addr);
            $("#multi_false input[name='dstnPtcAdr']").val(ptcAddr+" "+name);
            //$("#multi_false input[name='dlvAdr']").val($(obj).find("input[name='specialDlvAdr']").val());
            $("#multi_false input[name='dstnPostNo']").val(postNo);
            $("#multi_false input[name='rcvCustNm']").val(name);
            //$("#multi_false input[name='dstnHpIdntNo']").val(dstnHpIdntNo);
            //$("#multi_false input[name='dstnHpIntmNo']").val(dstnHpIntmNo);
            //$("#multi_false input[name='dstnHpBckNo']").val(dstnHpBckNo);

            //화면 값 셋팅
            $("#specialRcvCustNm").html(name);
            $("#specialDlvType").val(specialDlvType);
            $("#specialAddressInfoPtcAdr").html(addr+" " +ptcAddr);
            //$("#specialAddressInfoHpIdntNo").html(dstnHpIdntNo+"-"+dstnHpIntmNo+"-"+dstnHpBckNo);

            // 도서지역추가배송비 셋팅
            getIrgnAreaGbcd(postNo, 0);
        	
            var safeAddHtml = "";
            safeAddHtml += "<div class='input-shipping-info' id='safeAddInfo'>";
            safeAddHtml += "<div class='row-wrap'>";
            safeAddHtml += "<span class='row-title'>받으실 분</span>";
            safeAddHtml += "<span class='row-value'><input class='type-box' type='text' name='specialRcvCustNm' maxLength='10'></span>";
            safeAddHtml += "</div>";
            safeAddHtml += "<div class='row-wrap'>";
            safeAddHtml += "<span class='row-title'>휴대폰번호</span>";
            safeAddHtml += "<span class='row-value phone-number-area'>";
            safeAddHtml += "<select class='phone-number-sect1' name='specialRcvCustTel1'>";
            
            safeAddHtml += "<option value='010'>010</option>";
            
            safeAddHtml += "<option value='011'>011</option>";
            
            safeAddHtml += "<option value='016'>016</option>";
            
            safeAddHtml += "<option value='017'>017</option>";
            
            safeAddHtml += "<option value='018'>018</option>";
            
            safeAddHtml += "<option value='019'>019</option>";
            
            safeAddHtml += "<option value='02'>02</option>";
            
            safeAddHtml += "<option value='031'>031</option>";
            
            safeAddHtml += "<option value='032'>032</option>";
            
            safeAddHtml += "<option value='033'>033</option>";
            
            safeAddHtml += "<option value='041'>041</option>";
            
            safeAddHtml += "<option value='042'>042</option>";
            
            safeAddHtml += "<option value='043'>043</option>";
            
            safeAddHtml += "<option value='044'>044</option>";
            
            safeAddHtml += "<option value='051'>051</option>";
            
            safeAddHtml += "<option value='052'>052</option>";
            
            safeAddHtml += "<option value='053'>053</option>";
            
            safeAddHtml += "<option value='054'>054</option>";
            
            safeAddHtml += "<option value='055'>055</option>";
            
            safeAddHtml += "<option value='060'>060</option>";
            
            safeAddHtml += "<option value='061'>061</option>";
            
            safeAddHtml += "<option value='062'>062</option>";
            
            safeAddHtml += "<option value='063'>063</option>";
            
            safeAddHtml += "<option value='064'>064</option>";
            
            safeAddHtml += "<option value='070'>070</option>";
            
            safeAddHtml += "<option value='080'>080</option>";
            
            safeAddHtml += "</select>";
            safeAddHtml += "<span>-</span>";
            safeAddHtml += "<input class='type-box phone-number-sect2' type='number' name='specialRcvCustTel2' maxLength='8'>";
            safeAddHtml += "</span>";
            safeAddHtml += "</div>";
            
            $("#delivery_type_special").siblings("#safeAddInfo").remove();
            $("#delivery_type_special").after(safeAddHtml);
            
            $("#delivery_type_special").removeClass().addClass("btn-large-arrow btn-lpopup-safedelivery");
            
        	closeLayerPopup();
        }
        
        function selectCvs(name, postNo, addr, ptcAddr, cvstHofcCd, telNo, cvstBrnCd) {
        	$("#dstnTypeName").html("배송정보[편의점 픽업]");
            deleveryTypeSelect("convenience");
            
            var obj = $(".input-shipping-info.type5");
            $("input[name='specialDstnBaseAdr']").val(addr);
            $(obj).find("input[name='specialDstnPtcAdr']").val(ptcAddr);
            $(obj).find("input[name='specialDstnPostNo']").val(postNo)
            
            $("#multi_false input[name='dstnBaseAdr']").val(addr);
            $("#multi_false input[name='dstnPtcAdr']").val(ptcAddr+" "+name);
            //$("#multi_false input[name='dlvAdr']").val($(obj).find("input[name='specialDlvAdr']").val());
            $("#multi_false input[name='dstnPostNo']").val(postNo);
            // 1211 $("#multi_false input[name='rcvCustNm']").val(name);
            //$("#multi_false input[name='dstnHpIdntNo']").val(dstnHpIdntNo);
            //$("#multi_false input[name='dstnHpIntmNo']").val(dstnHpIntmNo);
            //$("#multi_false input[name='dstnHpBckNo']").val(dstnHpBckNo);

            //화면 값 셋팅
            $("#specialRcvCustNm").html(name);
            $("#specialDlvType").val(specialDlvType);
            $("#specialAddressInfoPtcAdr").html(addr+" " +ptcAddr);
            $("#specialAddressInfoHpIdntNo").html(telNo);
            
            if ( cvstHofcCd == "01" ) { // gs
                $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val("20");
            } else {
                $("form[name='orderDataForm'] input[name='dstnTypeGbcd']").val("21");
            }

            $("form[name='orderDataForm'] input[name='cvstBrnCd']").val(cvstBrnCd);
            $("form[name='orderDataForm'] input[name='cvstHofcCd']").val(cvstHofcCd);
            $("form[name='orderDataForm'] input[name='cvstBrnNm']").val(name);
            $("form[name='orderDataForm'] input[name='cvstBrnTel']").val(telNo);

            // 도서지역추가배송비 셋팅
            getIrgnAreaGbcd(postNo, 0);

            var safeAddHtml = "";
            safeAddHtml += "<div class='input-shipping-info' id='cvsAddInfo'>";
            safeAddHtml += "<div class='row-wrap'>";
            safeAddHtml += "<span class='row-title'>받으실 분</span>";
            safeAddHtml += "<span class='row-value'><input class='type-box' type='text' name='specialRcvCustNm' maxLength='10'></span>";
            safeAddHtml += "</div>";
            safeAddHtml += "<div class='row-wrap'>";
            safeAddHtml += "<span class='row-title'>휴대폰번호</span>";
            safeAddHtml += "<span class='row-value phone-number-area'>";
            safeAddHtml += "<select class='phone-number-sect1' name='specialRcvCustTel1'>";
            
            safeAddHtml += "<option value='010'>010</option>";
            
            safeAddHtml += "<option value='011'>011</option>";
            
            safeAddHtml += "<option value='016'>016</option>";
            
            safeAddHtml += "<option value='017'>017</option>";
            
            safeAddHtml += "<option value='018'>018</option>";
            
            safeAddHtml += "<option value='019'>019</option>";
            
            safeAddHtml += "<option value='02'>02</option>";
            
            safeAddHtml += "<option value='031'>031</option>";
            
            safeAddHtml += "<option value='032'>032</option>";
            
            safeAddHtml += "<option value='033'>033</option>";
            
            safeAddHtml += "<option value='041'>041</option>";
            
            safeAddHtml += "<option value='042'>042</option>";
            
            safeAddHtml += "<option value='043'>043</option>";
            
            safeAddHtml += "<option value='044'>044</option>";
            
            safeAddHtml += "<option value='051'>051</option>";
            
            safeAddHtml += "<option value='052'>052</option>";
            
            safeAddHtml += "<option value='053'>053</option>";
            
            safeAddHtml += "<option value='054'>054</option>";
            
            safeAddHtml += "<option value='055'>055</option>";
            
            safeAddHtml += "<option value='060'>060</option>";
            
            safeAddHtml += "<option value='061'>061</option>";
            
            safeAddHtml += "<option value='062'>062</option>";
            
            safeAddHtml += "<option value='063'>063</option>";
            
            safeAddHtml += "<option value='064'>064</option>";
            
            safeAddHtml += "<option value='070'>070</option>";
            
            safeAddHtml += "<option value='080'>080</option>";
            
            safeAddHtml += "</select>";
            safeAddHtml += "<span>-</span>";
            safeAddHtml += "<input class='type-box phone-number-sect2' type='number' name='specialRcvCustTel2' maxLength='8'>";
            safeAddHtml += "</span>";
            safeAddHtml += "</div>";
            
            $("#delivery_type_special").siblings("#cvsAddInfo").remove();
            $("#delivery_type_special").after(safeAddHtml);
            
            $("#delivery_type_special").removeClass().addClass("btn-large-arrow btn-lpopup-storepickup");
            
            closeLayerPopup();
            
        }
        
        function moveSafe(lat, lon) {
        	var coords = new kakao.maps.LatLng(lat, lon);
            // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
            safeMap.setCenter(coords);
            
            setSafeMarker(lat, lon);
        }
        
        function moveCvs(lat, lon) {
            var coords = new kakao.maps.LatLng(lat, lon);
            // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
            cvsMap.setCenter(coords);
            
            setCvsMarker(lat, lon);
        }
        
        function selectSafeMarker(infowindow) {
        	console.log("selectSafeMarker");
        	var siteNm, postNo, addr, ptcAddr;
        	var idx;
        	for ( var i = 0; i < safeInfoWindow.length ; i++ ) {
        		if ( infowindow == safeInfoWindow[i].infowindow ) {
        			siteNm = safeInfoWindow[i].siteNm;
        			postNo = safeInfoWindow[i].postNo;
        			addr = safeInfoWindow[i].addr;
        			ptcAddr = safeInfoWindow[i].ptcAddr;
        			idx = i;
        		} else {
        			safeInfoWindow[i].infowindow.close();
        		}
        	}
        	$("#safeList").hide();
        	$("#safeSelect ul.findlist").remove();
        	
        	var selectHtml = "";
        	selectHtml += "<ul class='findlist'>";
        	selectHtml += "<li>";
        	selectHtml += "<strong>"+siteNm+"</strong>";
        	selectHtml += "<p>["+postNo+"] "+addr+" "+ptcAddr+"</p>";
        	selectHtml += "<div class='btngroup'>";
        	selectHtml += "<button class='btn btn-linelgray sm' onclick='cancelSafeSelection(\""+idx+"\");'><span>취소</span></button>";
        	selectHtml += "<button class='btn btn-default sm' onclick='selectSafe(\""+siteNm+"\", \""+postNo+"\", \""+addr+"\", \""+ptcAddr+"\");'><span>선택</span></button>";
        	selectHtml += "</div>";
        	selectHtml += "</li>";
        	selectHtml += "</ul>";
        	
        	$("#safeSelect").append(selectHtml);
        	$("#safeSelect").show();
        }
        
        function selectCvsMarker(infowindow) {
            var siteNm, postNo, addr, ptcAddr, cvstHofcCd, telNo, cvstBrnCd;
            var idx;
            for ( var i = 0; i < cvsInfoWindow.length ; i++ ) {
                if ( infowindow == cvsInfoWindow[i].infowindow ) {
                    siteNm = cvsInfoWindow[i].siteNm;
                    postNo = cvsInfoWindow[i].postNo;
                    addr = cvsInfoWindow[i].addr;
                    ptcAddr = cvsInfoWindow[i].ptcAddr;
                    cvstHofcCd = cvsInfoWindow[i].cvstHofcCd;
                    telNo = cvsInfoWindow[i].telNo;
                    cvstBrnCd = cvsInfoWindow[i].cvstBrnCd;
                    idx = i;
                } else {
                	cvsInfoWindow[i].infowindow.close();
                }
            }
            $("#cvsList").hide();
            $("#cvsSelect ul.findlist").remove();
            
            var selectHtml = "";
            selectHtml += "<ul class='findlist'>";
            selectHtml += "<li>";
            selectHtml += "<strong>"+siteNm+"</strong>";
            selectHtml += "<p>["+postNo+"] "+addr+" "+ptcAddr+"</p>";
            selectHtml += "<div class='btngroup'>";
            selectHtml += "<button class='btn btn-linelgray sm' onclick='cancelCvsSelection(\""+idx+"\");'><span>취소</span></button>";
            selectHtml += "<button class='btn btn-default sm' onclick='selectCvs(\""+siteNm+"\", \""+postNo+"\", \""+addr+"\", \""+ptcAddr+"\", \""+cvstHofcCd+"\", \""+telNo+"\", \""+cvstBrnCd+"\");'><span>선택</span></button>";
            selectHtml += "</div>";
            selectHtml += "</li>";
            selectHtml += "</ul>";
            
            $("#cvsSelect").append(selectHtml);
            $("#cvsSelect").show();
        }
        
        function cancelSafeSelection(idx) {
        	safeInfoWindow[idx].infowindow.close();
        	$("#safeList").show();
            $("#safeSelect").hide();
        }
        
        function cancelCvsSelection(idx) {
            cvsInfoWindow[idx].infowindow.close();
            $("#cvsList").show();
            $("#cvsSelect").hide();
        }
        
        function setSafeMarker(lat, lng) {
            // 지도의 위, 경도로 표시할 편의점 목록을 가지고 옴.
            var bounds = safeMap.getBounds();
            // 영역의 남서쪽 좌표를 얻어옵니다 // swLatLng.getLat(), swLatLng.getLng()
            var swLatLng = bounds.getSouthWest(); 
            // 영역의 북동쪽 좌표를 얻어옵니다 // neLatLng.getLat(), neLatLng.getLng()
            var neLatLng = bounds.getNorthEast();
            
            $.ajax({
                type: "post"
                , url: "/m/oda/selectSafeAddressGeo.do"
                , dataType: "json"
                , data : {"latStartVal":swLatLng.getLat(), "latEndVal":neLatLng.getLat(), "lonStartVal":swLatLng.getLng(), "lonEndVal":neLatLng.getLng()}
                , success : function(data) {
                	var resultHtml = "";
                    if ( data.list.length > 0 ) {
                        if ( safeInfoWindow != null ) {
                            for ( var i = 0; i < safeInfoWindow.length; i++ ) {
                            	safeInfoWindow[i].infowindow.close();
                            }
                        }
                    	safeInfoWindow = new Array();

                        if ( safeMarker != null ) {
                            for ( var i = 0; i < safeMarker.length; i++ ) {
                                safeMarker[i].setMap(null);
                            }
                        }
                    	safeMarker = new Array();
                    	for ( var i = 0; i < data.list.length ; i++ ) {
                            var marker = new kakao.maps.Marker({
                                //map: map, // 마커를 표시할 지도
                                position: new kakao.maps.LatLng(data.list[i].latVal, data.list[i].lonVal), // 마커를 표시할 위치
                                text : data.list[i].siteNm//, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
                                //clickable: true//, // 마커를 클릭했을 때 지도의 클릭 이벤트가 발생하지 않도록 설정합니다
                                //image : "https://image.hmall.com/m/img/co/icon/ico-marker.png" // 마커 이미지 
                            });
                            marker.setMap(safeMap);
                            safeMarker.push(marker);
                            // 인포윈도우로 장소에 대한 설명을 표시합니다
                            var infowindow = new daum.maps.InfoWindow({
                                content: '<div class="maptooltip" style="width:150px;text-align:center;padding:6px 0;">'+data.list[i].siteNm+'</div>'
                            });
                            safeInfoWindow.push({infowindow:infowindow, siteNm:data.list[i].siteNm, postNo:data.list[i].dstnPostNo, addr:data.list[i].dstnBaseAdr, ptcAddr:data.list[i].dstnPtcAdr});
                            
                            kakao.maps.event.addListener(marker, 'click', showInfowindow(safeMap, marker, infowindow));
                            
                            if ( (lat != undefined && lat == data.list[i].latVal) && (lng != undefined && lng == data.list[i].lonVal) ) {
                            	kakao.maps.event.trigger(marker, 'click', 'custom event');
                            }
                        }
                    	safeMap.relayout()
                    }
                }
                , error: function(data) {
                    alert("안심택배함 조회에 실패하였습니다.");
                }
            });
        }
        function setCvsMarker(lat, lng) {
            // 지도의 위, 경도로 표시할 편의점 목록을 가지고 옴.
            var bounds = cvsMap.getBounds();
            // 영역의 남서쪽 좌표를 얻어옵니다 // swLatLng.getLat(), swLatLng.getLng()
            var swLatLng = bounds.getSouthWest(); 
            // 영역의 북동쪽 좌표를 얻어옵니다 // neLatLng.getLat(), neLatLng.getLng()
            var neLatLng = bounds.getNorthEast();
            
            $.ajax({
                type: "post"
                , url: "/m/smCvsSearchGeo.do"
                , dataType: "json"
                , data : {"latStartVal":swLatLng.getLat(), "latEndVal":neLatLng.getLat(), "lonStartVal":swLatLng.getLng(), "lonEndVal":neLatLng.getLng()}
                , success : function(data) {
                    var resultHtml = "";
                    if ( data.list.length > 0 ) {
                        if ( cvsInfoWindow != null ) {
                            for ( var i = 0; i < cvsInfoWindow.length; i++ ) {
                                cvsInfoWindow[i].infowindow.close();
                            }
                        }
                        cvsInfoWindow = new Array();

                        if ( cvsMarker != null ) {
                            for ( var i = 0; i < cvsMarker.length; i++ ) {
                                cvsMarker[i].setMap(null);
                            }
                        }
                        cvsMarker = new Array();
                        for ( var i = 0; i < data.list.length ; i++ ) {
                            var marker = new kakao.maps.Marker({
                                //map: map, // 마커를 표시할 지도
                                position: new kakao.maps.LatLng(data.list[i].lat_val, data.list[i].lon_val), // 마커를 표시할 위치
                                text : data.list[i].cvst_brn_nm//, // 마커의 타이틀, 마커에 마우스를 올리면 타이틀이 표시됩니다
                                //clickable: true//, // 마커를 클릭했을 때 지도의 클릭 이벤트가 발생하지 않도록 설정합니다
                                //image : "https://image.hmall.com/m/img/co/icon/ico-marker.png" // 마커 이미지 
                            });
                            marker.setMap(cvsMap);
                            cvsMarker.push(marker);
                            // 인포윈도우로 장소에 대한 설명을 표시합니다
                            var infowindow = new daum.maps.InfoWindow({
                                content: '<div class="maptooltip" style="width:150px;text-align:center;padding:6px 0;">'+data.list[i].cvst_brn_nm+'</div>'
                            });
                            cvsInfoWindow.push({infowindow:infowindow, siteNm:data.list[i].cvst_brn_nm, postNo:data.list[i].post_no, addr:data.list[i].base_adr, ptcAddr:data.list[i].ptc_adr, cvstHofcCd:data.list[i].cvst_hofc_cd, telNo:data.list[i].cvst_brn_tel, cvstBrnCd:data.list[i].cvst_brn_cd});
                            
                            kakao.maps.event.addListener(marker, 'click', showInfowindow(cvsMap, marker, infowindow));
                            
                            if ( (lat != undefined && lat == data.list[i].lat_val) && (lng != undefined && lng == data.list[i].lon_val) ) {
                                kakao.maps.event.trigger(marker, 'click', 'custom event');
                            }
                        }
                        cvsMap.relayout();
                    }
                }
                , error: function(data) {
                    alert("편의점 조회에 실패하였습니다.");
                }
            });
        }
        
        function showInfowindow(map, marker, infowindow) {
        	
        	return function() {
        		if ( $("input[name='shipping-type-select']:checked").val() == 'type5' ) {
        			selectCvsMarker(infowindow);
        		} else {
        			selectSafeMarker(infowindow);
        		}
        		infowindow.open(map, marker);
        		
        	}
        }
        
        function changeCvsSiNm(obj) {
        	var si = $(obj).find("option:selected").val();
        	
        	$("div.type5 select[name='guNm'] option").remove();
        	
            if ( si == '세종특별자치시' ) {
                $("div.type5 select[name='guNm']").append("<option value=''>시/군/구</option>");
                $("div.type5 select[name='guNm']").prop("disabled", true);
                return;
            } else {
            	$("div.type5 select[name='guNm']").prop("disabled", false);
            }
        	
            $.ajax({
                type: "post"
                ,url: "/m/oda/cvsGuSearch.do"
                ,data: {siNm:si}
                ,dataType: "json"
                ,contentType:"application/x-www-form-urlencoded;charset=UTF-8"
                ,async:false
                ,success : function(data) {
                    
                    $("div.type5 select[name='guNm']").text("");
                    
                    var html = '<option value="">시/군/구</option>';
                    for(var i=0; i<data.guList.length; i++){
                          html += '<option value="'+data.guList[i]+'"'+ (i == 0?' selected':'') +' >'+data.guList[i]+'</option>';                
                    }
                    
                    $("div.type5 select[name='guNm']").append(html);
                }
            });
        }
        
        
        var safeMap;
        var safeInfoWindow;
        var safeMarker;
        var cvsMap;
        var cvsInfoWindow;
        var cvsMarker;
        
        function specialConfirmBtn(){
            var specialDlvType = $("input[name='shipping-type-select']:checked").val();
            
            $("#cvsAddInfo").remove();
            $("#safeAddInfo").remove();
            $("#dawnAddInfo").remove();
            $("#set-default").siblings("label[for=set-default]").remove();
            $("#set-default").remove();

            if(specialDlvType == 'type1'){
                //일반배송
                $("#dstnTypeName").html("일반배송");
                $("#delivery_type_special").hide();
                deleveryTypeSelect('delivery1');
                backStateLayerPopup();

            }else if(specialDlvType == 'type3'){
            	$(".layer-popup.order").addClass("mapscroll");
            	
                //안심배송
                clearSafetyPopup();
                // 2020 기본주소의 위도, 경도를 가지고 와서 지도를 띄운다.
                kakao.maps.load(function(){
                    var mapContainer = document.getElementById("safe_map"); // 지도를 표시할 div
                    var mapOption = {
                                center: new daum.maps.LatLng(37.5390705719573, 127.125615628774), // 지도의 중심좌표 ! 홈쇼핑 본사!
                                // 37.53681209307392:127.12376949825274:37.541313171427085:127.12745437576639
                                level: 4 // 지도의 확대 레벨
                            };  
                    // 지도를 생성합니다    
                    if ( safeMap == null ) {
                    	safeMap = new daum.maps.Map(mapContainer, mapOption);
                    }
                    safeMap.relayout();
                    if ( "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)101동 404호" != "" ) {
                        // 주소-좌표 변환 객체를 생성합니다
                        var geocoder = new daum.maps.services.Geocoder();
                        // 주소로 좌표를 검색합니다
                        geocoder.addressSearch("서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트) 101동 404호", function(result, status) {
                             // 정상적으로 검색이 완료됐으면 
                             if (status === daum.maps.services.Status.OK) {
                                var coords = new daum.maps.LatLng(result[0].y, result[0].x);
                                // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
                                safeMap.setCenter(coords);
                                safeMap.relayout();
                            } 
                        });
                    }
                    
                    // 지도에 마커표시.
                    setSafeMarker();
                    
                    kakao.maps.event.addListener(safeMap, 'dragend', function() {
                    	setSafeMarker();
                    });
                });
                
                // 지도하단 목록.
                initSafeList();
                
                $("#specialDstnNm").html("안심 택배함");
                $("#specialDstnNm").parent().hide();
                goGaPage('주문/장바구니>주문서작성>특화배송','안심택배함');
                pushHistory();
            }else if(specialDlvType == 'type5'){
            	$(".layer-popup.order").addClass("mapscroll");

                //편의점 픽업
                clearCvsPopup();
                
                // 2020 기본주소의 위도, 경도를 가지고 와서 지도를 띄운다.
                kakao.maps.load(function(){
                    var mapContainer = document.getElementById("cvs_map"); // 지도를 표시할 div
                    var mapOption = {
                                center: new daum.maps.LatLng(37.5390705719573, 127.125615628774), // 지도의 중심좌표 ! 홈쇼핑 본사!
                                // 37.53681209307392:127.12376949825274:37.541313171427085:127.12745437576639
                                level: 4 // 지도의 확대 레벨
                            };  
                    // 지도를 생성합니다    
                    if ( cvsMap == null ) {
                        cvsMap = new daum.maps.Map(mapContainer, mapOption);
                    }
                    cvsMap.relayout();
                    if ( "서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)101동 404호" != "" ) {
                        // 주소-좌표 변환 객체를 생성합니다
                        var geocoder = new daum.maps.services.Geocoder();
                        // 주소로 좌표를 검색합니다
                        geocoder.addressSearch("서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트) 101동 404호", function(result, status) {
                             // 정상적으로 검색이 완료됐으면 
                             if (status === daum.maps.services.Status.OK) {
                                var coords = new daum.maps.LatLng(result[0].y, result[0].x);
                                // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
                                cvsMap.setCenter(coords);
                                cvsMap.relayout();
                            } 
                        });
                    }
                    
                    // 지도에 마커표시.
                    setCvsMarker();
                    
                    kakao.maps.event.addListener(cvsMap, 'dragend', function() {
                    	setCvsMarker();
                    });
                });
                
                // 지도하단 목록.
                initCvsList();

                $("#specialDstnNm").html("편의점 픽업");
                $("#specialDstnNm").parent().hide();
                goGaPage('주문/장바구니>주문서작성>특화배송','편의점픽업');
                pushHistory();
            }else if(specialDlvType == 'type6'){
            	//새벽배송
                dlvYn("Y",'dawn');
                $("#specialDstnNm").html("새벽배송");
                $("#specialDstnNm").parent().hide();
                
                // TODO 주소 목록을 가지고 와서... type7아래에 넣는다.
                $.ajax({
                    type: "get"
                    , url: "/m/selectDstnAdrList.do"
                    ,data: {'dstnSeq':'', 'multiIndex':0, 'dawnDlvYn':'Y'}
                    , dataType: "html"
                    , success : function(data) {
    
                        $("#shipping-type6-list").empty();
                        $("#shipping-type6-list").append(data);
                        //$("#shipping-type6-list").siblings("ul.tap").find("li").eq(0).trigger("click");
                        if ( $(data).find("li").length == 0) {
                        	$("#shipping-type6-list").siblings("ul.tap").find("li").eq(1).trigger("click");
                        } else {
                        	$("#shipping-type6-list").siblings("ul.tap").find("li").eq(0).trigger("click");
                        }
                        // 6,7일때는 버튼이 추가됨.
                        var btnHtml = '<div class="popup-footer">';
                        btnHtml += '<button class="btn-cancel" onclick="closeLayerPopup();">취소</button>';
                        btnHtml += '<button class="btn-confirm"  onclick="specialDlvBtn();">선택완료</button>';
                        btnHtml += '</div>';
                        $("#shipping-type6-list").append(btnHtml);
                    }
                    , error: function(data) {
                        alert("고객님 죄송합니다.\n30분이상 아무 동작을 안하셨거나 네트워크가 불안정하여 서버와의 연결이 끊겼습니다.\n주문을 다시 진행하여 주시기 바랍니다.같은 오류가 지속적으로 발생 시 고객센터 1600-000으로 문의 주시거나 고객센터 1:1문의를 통하여 문의 주시기 바랍니다.");
                        $(".popup_sublayer.address.nobtn").html("");
                    }
                });
                
                goGaPage('주문/장바구니>주문서작성>특화배송','새벽배송');
                pushHistory();
            }else if(specialDlvType == 'type7'){
            	//프리미엄(당일) 배송
                dlvYn("Y",'prem');
                $("#specialDstnNm").html("프리미엄(당일) 배송");
                $("#specialDstnNm").parent().hide();
                
                // TODO 주소 목록을 가지고 와서... type7아래에 넣는다.
	            $.ajax({
	                type: "get"
	                , url: "/m/selectDstnAdrList.do"
	                , data: {'dstnSeq':'', 'multiIndex':0, 'premDlvYn':'Y'}
	                , dataType: "html"
	                , success : function(data) {
	
	                    $("#shipping-type7-list").empty();
	                    $("#shipping-type7-list").append(data);
                        if ( $(data).find("li").length == 0) {
                            $("#shipping-type7-list").siblings("ul.tap").find("li").eq(1).trigger("click");
                        } else {
                            $("#shipping-type7-list").siblings("ul.tap").find("li").eq(0).trigger("click");
                        }
	                    // TODO : dawnDlvYn, premDlvYn 기본선택
	                    //$("input[name='selectAddr'][value='"+dstnSeq+"']").prop("checked",true);
                        // 6,7일때는 버튼이 추가됨.
                        var btnHtml = '<div class="popup-footer">';
                        btnHtml += '<button class="btn-cancel" onclick="closeLayerPopup();">취소</button>';
                        btnHtml += '<button class="btn-confirm"  onclick="specialDlvBtn();">선택완료</button>';
                        btnHtml += '</div>';
                        $("#shipping-type7-list").append(btnHtml);
	                }
	                , error: function(data) {
	                    alert("고객님 죄송합니다.\n30분이상 아무 동작을 안하셨거나 네트워크가 불안정하여 서버와의 연결이 끊겼습니다.\n주문을 다시 진행하여 주시기 바랍니다.같은 오류가 지속적으로 발생 시 고객센터 1600-000으로 문의 주시거나 고객센터 1:1문의를 통하여 문의 주시기 바랍니다.");
	                    $(".popup_sublayer.address.nobtn").html("");
	                }
	            });
                
                goGaPage('주문/장바구니>주문서작성>특화배송','프리미엄(당일)배송');
                pushHistory();
            }else if(specialDlvType == 'type8'){
                //스토어픽
                $("#specialDstnNm").html("스토어픽");
                $("#specialDstnNm").parent().show();
            }

            // 2019.10.30 HMALL개선이주형 일반배송일때만 무료배송비쿠폰 사용가능처리
            if (specialDlvType == 'type1') {
                if($("div[name='cuponSearch'] input[name^='freeDlvCopn_']").length > 0) {
                    $("div[name='cuponSearch'] input[name^='freeDlvCopn_']").prop("disabled", false);
                    $("#freeDlvCpnBtn").prop("disabled", false);
                }
            }
            else {
                if($("div[name='cuponSearch'] input[name^='freeDlvCopn_']").length > 0) {
                    $("div[name='cuponSearch'] input[name^='freeDlvCopn_']").each(function () {
                        if ($(this).hasClass("noneCopn")) {
                            $(this).prop("checked", true);
                            selectDlvCopn($(this).parents("div[name='cuponSearch']"));
                        }
                        $(this).prop("disabled", true);
                    });
                    $("#freeDlvCpnBtn").prop("disabled", true);
                }
            }

        }

        function chgReplacePdNoticDesc(yn){
            if(yn == "Y"){
                $("#replacePdNoticDesc").text("(안내받음)");
                goGaEvent('주문서', '품절 시 대체상품 안내' , '안내받겠음', '01');
            }else if(yn == "N"){
                $("#replacePdNoticDesc").text("(안내받지 않음)");
                goGaEvent('주문서', '품절 시 대체상품 안내' , '안내받지않고 주문취소', '01');
            }

        }

        function chgCashReceiptNum(){
            //초기화
            $("input[name='cashRcptCreditCrdNum']").hide();
            $("input[name='cashRcptCrdNum']").hide();
            var cashRcptType = $("select[name='cashRcptType']").val();

            if(cashRcptType == '1'){
                $("input[name='cashRcptCreditCrdNum']").show();
            }else if(cashRcptType == '2'){
                $("input[name='cashRcptCrdNum']").show();
            }

        }

        /*function chgCashRcpType(cashRcpType){
            //초기화
            $("#cashRcpType1").hide();
            $("#cashRcpType2").hide();

            if(cashRcpType == '0'){
                $("#cashRcpType1").show();
            }else if(cashRcpType == '1'){
                $("#cashRcpType2").show();
            }
        }*/

        function choicePayType(btnYn){

            var payType = $(".payment-wrap a.on").find("input[name=pay]").val();
            var payTypeNm = "";
            var totStlmAmt = isEmpty($("form[name='orderDataForm'] input[name='totStlmAmt']").val()) ? 0 : Number($("form[name='orderDataForm'] input[name='totStlmAmt']").val());

            if(totStlmAmt > 0 && isEmpty(payType)) {
                alert("결제수단을 선택해주세요.");
                return false;
            }

            var smileCrdExceptYn = "";
            smileCrdExceptYn = $("input[name='smileCrdExceptYn']").val(); //스마일카드 적용안될때 처리
            // 카드결제 팝업
            if (payType == "1") { // 신용카드
                var stlmCrdInf = $("select[name='stlmCrdInf'] option:selected").val();
                var stlmCrdAmt = Number($("form[name='orderDataForm'] input[name='stlmCrdAmt']").val());

                var smileCrdCdCheck = stlmCrdInf.split('|')[0];
                if(isEmpty(stlmCrdInf)) {
                    alert("카드종류를 선택해주세요.");
                    $("select[name='stlmCrdInf']").focus();
                    return false;
                }

                if((stlmCrdInf.split("|")[1] != "I") && isEmpty($("select[name='allotMonth'] option:selected").val()) && stlmCrdAmt >= 50000) {
                    alert("할부개월을 선택해주세요.");
                    return false;
                }

                payTypeNm = $("#stlmCrdInf option:checked").text() + "(" +$("#allotMonth option:checked").text() + ")";
                //현대카드아니면 스마일카드 포인트 무조건 안보여야해 (방어로직)
                if(smileCrdCdCheck != "04" || smileCrdExceptYn == "Y"){
                    $("form[name='orderDataForm'] input[name='smileCrdPointYn']").val("N");
                    $(".smileCrdArea").hide();
                    $("#smileCrdpoint1").prop("checked", false);
                    $("#smileCrdpoint2").prop("checked", false);
                }
                
            }
            else if (payType == "4") { // 무통장
                var wibkBankCd = $("select[name='wibkBankCd'] option:selected").val();
                var wibkCustNm = $("input[name='wibkCustNm']:eq(0)").val();

                if(isEmpty(wibkBankCd)) {
                    alert("입금은행을 선택해주세요.");
                    $("select[name='wibkBankCd']").focus();
                    return false;
                }

                if(isEmpty(wibkCustNm)) {
                    alert("입금자명을 입력해주세요.");
                    $("input[name='wibkCustNm']").focus();
                    return false;
                }

                var receiptYn = $("#receiptSelect input[name='receiptYn']").prop("checked");

                if(receiptYn) {
                    var rcptTskGbcd = $("input[name='rcptTskGbcd']:checked").val();

                    if(isEmpty(rcptTskGbcd)) {
                        alert("현금영수증 사용 용도를 선택해 주세요.");
                        return false;
                    }

                    if(rcptTskGbcd == "0") {

                        var cashRcptType = $("select[name='cashRcptType'] option:selected").val();
                        var cashRcptCustIdntVal = "";

                        if(cashRcptType == "1"){
                            var cashRcptCreditCrdNum = $("input[name='cashRcptCreditCrdNum']").val().replace(/-/g,"");
                            if(isEmpty(cashRcptCreditCrdNum) || (cashRcptCreditCrdNum.length < 16)) {
                                alert("소득공제용 현금영수증 발급을 위한 신용카드번호를 정확히 입력해 주세요.");
                                $("input[name='cashRcptCreditCrdNum']").focus();
                                return false;
                            }
                        }else if(cashRcptType == "2"){
                            var cashRcptCrdNum = $("input[name='cashRcptCrdNum']").val().replace(/-/g,"");
                            if(isEmpty(cashRcptCrdNum) || (cashRcptCrdNum.length < 18)) {
                                alert("소득공제용 현금영수증 발급을 위한 현금영수증카번호를 정확히 입력해 주세요.");
                                $("input[name='cashRcptCrdNum']").focus();
                                return false;
                            }
                        }else{
                            var cashRcptHpNum1 = $("#receiptSelect select[name='cashRcptHpNum1'] option:selected").val();
                            var cashRcptHpNum2 = $("#receiptSelect input[name='cashRcptHpNum2']").val();
                            if(isEmpty(cashRcptHpNum2) || (cashRcptHpNum2.length < 7)) {
                                alert("소득공제용 현금영수증 발급을 위한 전화번호를 정확히 입력해 주세요.");
                                $("#receiptSelect input[name='cashRcptHpNum2']").focus();
                                return false;
                            }
                        }
                    }

                    else if(rcptTskGbcd == "1") {
                        var rgno1 = $("#receiptSelect input[name='rgno1']").val();
                        var rgno2 = $("#receiptSelect input[name='rgno2']").val();
                        var rgno3 = $("#receiptSelect input[name='rgno3']").val();
                        if(isEmpty(rgno1) || isEmpty(rgno2) || isEmpty(rgno3) || rgno1.length != 3 || rgno2.length < 2 || rgno3.length < 5) {
                            alert("지출증빙용 현금영수증 사업자 번호를 정확히 입력해 주세요.");
                            $("#receiptSelect input[name='rgno1']").focus();
                            return false;
                        }

                        if (!isValidRno(rgno1, rgno2, rgno3)) {
                            alert("입력하신 사업자 번호가 유효하지 않습니다. 정확히 입력해 주세요.");
                            $("#receiptSelect input[name='rgno1']").focus();
                            return false;
                        }

                    }
                }

                stlmWayCd = wibkBankCd;
                payTypeNm = "무통장 입금";
            }
            else if (payType == "3") { // 휴대폰 결제
                payTypeNm = "휴대폰 결제";
            }
            else if (payType == "payco") { // 페이코
                payTypeNm = "페이코";
            }
            else if (payType == "samsungpay") { // 삼성페이
                payTypeNm = "삼성페이";
            }
            else if (payType == "naverpay") { // 네이버페이
                payTypeNm = "네이버페이";
            }
            else if (payType == "smilepay") { // 스마일페이
                payTypeNm = "스마일페이";
            }
            else if (payType == "newkakaopay") { // 신카카오페이
                payTypeNm = "카카오페이";
            }
            else if (payType == "callpay") { // 상담원결제
                payTypeNm = "상담원 결제";
            }
            else if (payType == "hpay") { // hmallpay
                var receiptYn = $("#receiptSelect input[name='receiptYn']").prop("checked");

                if(receiptYn) {
                    var rcptTskGbcd = $("input[name='rcptTskGbcd']:checked").val();

                    if(isEmpty(rcptTskGbcd)) {
                        alert("현금영수증 사용 용도를 선택해 주세요.");
                        return false;
                    }

                    if(rcptTskGbcd == "0") {

                        var cashRcptType = $("select[name='cashRcptType'] option:selected").val();
                        var cashRcptCustIdntVal = "";

                        if(cashRcptType == "1"){
                            var cashRcptCreditCrdNum = $("input[name='cashRcptCreditCrdNum']").val().replace(/-/g,"");
                            if(isEmpty(cashRcptCreditCrdNum) || (cashRcptCreditCrdNum.length < 16)) {
                                alert("소득공제용 현금영수증 발급을 위한 신용카드번호를 정확히 입력해 주세요.");
                                $("input[name='cashRcptCreditCrdNum']").focus();
                                return false;
                            }
                        }else if(cashRcptType == "2"){
                            var cashRcptCrdNum = $("input[name='cashRcptCrdNum']").val().replace(/-/g,"");
                            if(isEmpty(cashRcptCrdNum) || (cashRcptCrdNum.length < 18)) {
                                alert("소득공제용 현금영수증 발급을 위한 현금영수증카번호를 정확히 입력해 주세요.");
                                $("input[name='cashRcptCrdNum']").focus();
                                return false;
                            }
                        }else{
                            var cashRcptHpNum1 = $("#receiptSelect select[name='cashRcptHpNum1'] option:selected").val();
                            var cashRcptHpNum2 = $("#receiptSelect input[name='cashRcptHpNum2']").val();
                            if(isEmpty(cashRcptHpNum2) || (cashRcptHpNum2.length < 7)) {
                                alert("소득공제용 현금영수증 발급을 위한 전화번호를 정확히 입력해 주세요.");
                                $("#receiptSelect input[name='cashRcptHpNum2']").focus();
                                return false;
                            }
                        }


                    }
                    else if(rcptTskGbcd == "1") {
                        var rgno1 = $("#receiptSelect input[name='rgno1']").val();
                        var rgno2 = $("#receiptSelect input[name='rgno2']").val();
                        var rgno3 = $("#receiptSelect input[name='rgno3']").val();
                        if(isEmpty(rgno1) || isEmpty(rgno2) || isEmpty(rgno3) || rgno1.length != 3 || rgno2.length < 2 || rgno3.length < 5) {
                            alert("지출증빙용 현금영수증 사업자 번호를 정확히 입력해 주세요.");
                            $("#receiptSelect input[name='rgno1']").focus();
                            return false;
                        }

                        if (!isValidRno(rgno1, rgno2, rgno3)) {
                            alert("입력하신 사업자 번호가 유효하지 않습니다. 정확히 입력해 주세요.");
                            $("#receiptSelect input[name='rgno1']").focus();
                            return false;
                        }

                    }
                }

                payTypeNm = "Hmall Pay";
            }
            else if (payType == "toss") { // 토스
                payTypeNm = "토스";
            }
            
            else if (payType == "nfc") { // NFC 결제
                payTypeNm = "NFC 결제";
            }

            if(payTypeNm != null && payTypeNm != ""){
                $("#payTypeNm").text(payTypeNm);
                $("#payTypeNmAtag").addClass("mod");
            }


            if(payType != "1" || smileCrdExceptYn == "Y"){
                $("form[name='orderDataForm'] input[name='smileCrdPointYn']").val("N");
                $(".smileCrdArea").hide();
                $("#smileCrdpoint1").prop("checked", false);
                $("#smileCrdpoint2").prop("checked", false);
            }
            //버튼을 누른 케이스면 백
            if(btnYn=="Y"){
                backStateLayerPopup();
            }            

        }

        function discountChoice(){
            var totAlliDcTxt = isEmpty($("#totAlliDcTxt").text().replace(/,|-|원/g,"")) ? 0 : Number($("#totAlliDcTxt").text().replace(/,|-|원/g,""));
            var svmtDcTxt = isEmpty($("#svmtDcTxt").text().replace(/,|-|원/g,"")) ? 0 : Number($("#svmtDcTxt").text().replace(/,|-|원/g,""));
            var massDcTxt = isEmpty($("#massDcTxt").text().replace(/,|-|원/g,"")) ? 0 : Number($("#massDcTxt").text().replace(/,|-|원/g,""));
            var totArsDcAmtArea = isEmpty($("#totArsDcAmtArea").text().replace(/,|-|원/g,"")) ? 0 : Number($("#totArsDcAmtArea").text().replace(/,|-|원/g,""));
            var totSpymDcAmtArea = isEmpty($("#totSpymDcAmtArea").text().replace(/,|-|원/g,"")) ? 0 : Number($("#totSpymDcAmtArea").text().replace(/,|-|원/g,""));
            var totPrmoDcAmtArea = isEmpty($("#totPrmoDcAmtArea").text().replace(/,|-|원/g,"")) ? 0 : Number($("#totPrmoDcAmtArea").text().replace(/,|-|원/g,""));

            var discountTotal = totAlliDcTxt + svmtDcTxt + massDcTxt + totArsDcAmtArea + totSpymDcAmtArea + totPrmoDcAmtArea;

            $("#discountTotalPrice strong").text(gfn_appendComma(discountTotal));

            if(Number($("#discountTotalPrice strong").text().replace(/,|-|원/g,"")) == 0){
                $("#immtSaleAutoDcBtn").prop("checked",false);
            }else if(Number($("#discountTotalPrice strong").text().replace(/,|-|원/g,"")) > 0){
                $("#immtSaleAutoDcBtn").prop("checked",true);
            }

        }

        function copnChoice(){
            var gnrlCopnTxtTotal = 0;
            var plusCopnTxtTotal = 0;
            var freeDlvCopnTxtTotal = 0;

            $("span[id^=gnrlCopnTxt_]").each(function() {
                gnrlCopnTxtTotal += isEmpty($(this).text().replace(/,|-|원/g,"")) ? 0 : Number($(this).text().replace(/,|-|원/g,""));
            });

            $("span[id^=plusCopnTxt_]").each(function() {
                plusCopnTxtTotal += isEmpty($(this).text().replace(/,|-|원/g,"")) ? 0 : Number($(this).text().replace(/,|-|원/g,""));
            });

            $("span[id^=freeDlvCopnTxt]").each(function() {
                freeDlvCopnTxtTotal += isEmpty($(this).text().replace(/,|-|원/g,"")) ? 0 : Number($(this).text().replace(/,|-|원/g,""));
            });

            var stlmAmtDcTxt = isEmpty($("#stlmAmtDcTxt").text().replace(/,|-|원/g,"")) ? 0 : Number($("#stlmAmtDcTxt").text().replace(/,|-|원/g,""));

            var copntTotal = gnrlCopnTxtTotal + plusCopnTxtTotal + freeDlvCopnTxtTotal + stlmAmtDcTxt;

            $("#copnTotalPrice strong").text("-"+gfn_appendComma(copntTotal));

            if(Number($("#copnTotalPrice strong").text().replace(/,|-|원/g,"")) == 0){
                $("#copnSaleAutoDcBtn").prop("checked",false);
            }else if(Number($("#copnTotalPrice strong").text().replace(/,|-|원/g,"")) > 0){
                $("#copnSaleAutoDcBtn").prop("checked",true);
            }
        }

        function etcPointTotal(){
            var hanaPointTxt = isEmpty($("#useHanamoneyAmt").text().replace(/,|-|원|P/g,"")) ? 0 : Number($("#useHanamoneyAmt").text().replace(/,|-|원|P/g,""));
            var cultureCashTxt = isEmpty($("#useCultureCashAmt").text().replace(/,|-|원|P/g,"")) ? 0 : Number($("#useCultureCashAmt").text().replace(/,|-|원|P/g,""));
            var bluePointTxt = isEmpty($("#useBluePointAmt").text().replace(/,|-|원|P/g,"")) ? 0 : Number($("#useBluePointAmt").text().replace(/,|-|원|P/g,""));
            var etcPointTotal = 0;

            etcPointTotal = hanaPointTxt + cultureCashTxt + bluePointTxt;

            $("#etcPointTotal").text(gfn_appendComma(etcPointTotal)+"원");

        }

        function updateAddress(dstnSeq){
            var obj = $("#liAddr"+dstnSeq+"");

            $("#updateAddress_wrap input[name='rcvCustNm']").val(obj.find("input[name='rcvCustNmPrv']").val());
            $("#updateAddress_wrap input[name='dstnBaseAdr']").val(obj.find("input[name='dstnBaseAdrPrv']").val());
            $("#updateAddress_wrap input[name='newDstnBaseAdr']").val(obj.find("input[name='dstnBaseAdrPrv']").val());
            $("#updateAddress_wrap input[name='dstnPtcAdr']").val(obj.find("input[name='dstnPtcAdrPrv']").val());
            $("#updateAddress_wrap select[name='dstnHpIdntNo']").val(obj.find("input[name='dstnHpIdntNoPrv']").val());
            $("#updateAddress_wrap input[name='dstnHpIntmNo']").val(obj.find("input[name='dstnHpIntmNoPrv']").val() + obj.find("input[name='dstnHpBckNoPrv']").val());
            $("#updateAddress_wrap input[name='dstnHpBckNo']").val(obj.find("input[name='dstnHpBckNoPrv']").val());
            $("#updateAddress_wrap select[name='dstnTela']").val(obj.find("input[name='dstnTelaPrv']").val());
            $("#updateAddress_wrap input[name='dstnTels']").val(obj.find("input[name='dstnTelsPrv']").val() + obj.find("input[name='dstnTeliPrv']").val());
            $("#updateAddress_wrap input[name='dstnTeli']").val(obj.find("input[name='dstnTeliPrv']").val());
            $("#updateAddress_wrap input[name='dstncustNo']").val(obj.find("input[name='dstncustNo']").val());
            $("#updateAddress_wrap input[name='dstnSeq']").val(obj.find("input[name='dstnSeq']").val());
            if (obj.find("input[name='dstnBaseYn']").val() == "Y") {
                $("#updateAddress_wrap input[name='baseYn']").prop("checked", true).prop("disabled", true);
            }
            else {
                $("#updateAddress_wrap input[name='baseYn']").prop("checked", false).prop("disabled", false);
            }
            if (obj.find("input[name=dstnPostNoPrv]").val().length > 5) {
                $("#updateAddress_wrap input[name='dstnPostNo']").val("");
            }
            else {
                $("#updateAddress_wrap input[name='dstnPostNo']").val(obj.find("input[name=dstnPostNoPrv]").val());
            }
            $("#updateAddress_wrap input[name='adrKndGbcd']").val("2");
            $("#updateAddress_wrap input[name='dstnNknm']").val("");
            $("#updateAddress_wrap input[name='updateYn']").val("Y");
        }

        function backBtn(){
        	//뒤로가기했을시 선물하기 이미지 가지고오기 
            reDrawSlick();
        	
        	if(!$(".layer-popup.order").hasClass("_active")){
                history.back();
            }else{
                backStateLayerPopup();
            }
        }

        function onAddressAddBtnclick() {
            $("#newaddress_wrap input[name='rcvCustNm']").val("");
            $("#newaddress_wrap input[name='dstnBaseAdr']").val("");
            $("#newaddress_wrap input[name='newDstnBaseAdr']").val("");
            $("#newaddress_wrap input[name='dstnPtcAdr']").val("");
            $("#newaddress_wrap select[name='dstnHpIdntNo']").val("010");
            $("#newaddress_wrap input[name='dstnHpIntmNo']").val("");
            $("#newaddress_wrap input[name='dstnHpBckNo']").val("");
            $("#newaddress_wrap select[name='dstnTela']").val("02");
            $("#newaddress_wrap input[name='dstnTels']").val("");
            $("#newaddress_wrap input[name='dstnTeli']").val("");
            $("#newaddress_wrap input[name='baseYn']").attr("checked", false);
            $("#newaddress_wrap input[name='dstnPostNo']").val("");
            $("#newaddress_wrap input[name='adrKndGbcd']").val("2");
            $("#newaddress_wrap input[name='dstnNknm']").val("");
            $("#newaddress_wrap input[name='updateYn']").val("N");
        }

        function autoDcLoading(){
            showLoading("<span style='text-align:center'><span style='color:#ff5340'>최대 할인액</span> 기준으로<br/>쿠폰/할인이 자동 적용됩니다.</span>");
        }

        function cardPointChg(obj){

            if($(obj).is(":checked")){
                $("#point").prop("checked",true);
                $("#point2").prop("checked",true);
            }else{
                $("#point").prop("checked",false);
                $("#point2").prop("checked",false);
            }
        }

            function smileCardPointChg(obj){
                
                if($(obj).is(":checked")){
                     $("form[name='orderDataForm'] input[name='smileCrdPointYn']").val("Y");
                     $("#smileCrdpoint1").prop("checked", true);
                     $("#smileCrdpoint2").prop("checked", true);
                }else{
                    $("form[name='orderDataForm'] input[name='smileCrdPointYn']").val("N");
                    $("#smileCrdpoint1").prop("checked", false);
                    $("#smileCrdpoint2").prop("checked", false);
                }  
                calculateOrderAmt();
            }
            
        function pushHistory(){
            history.pushState(null, '', location.href);
        }

        function sendGiftReady(obj){
            var div = $(obj).parents("div[name='pickupInfoArea']");
            var idx = $("div[name='pickupInfoArea']").index(div);

            $("#saveGiftIndex").val(idx);
        }

        function deleteGiftInfo(obj){
            $(obj).parents("div[name='prsInfoArea']").hide();
            $(obj).siblings("span[name='prsInfo']").empty();
            $(obj).siblings("input[name='prsn_yn']").val("N");
        }

        function immtSaleAutoDc(isCheck, callback){
            // ars할인여부
            var arsDcYn = $("#discount0").length > 0 ? "Y" : "N";
            // 일시불할인여부
            var spymDcYn = $("#discount1").length > 0 ? "Y" : "N";
            // 깜짝할인여부
            var prmoDcYn = $("#discount2").length > 0 ? "Y" : "N";
            // 적립금즉시할인여부
            var svmtDcYn = $("#sale").length > 0 ? "Y" : "N";

            if(isCheck) {
                try {
                    isAutoDcIng = true;

                    if(arsDcYn == "Y") {
                        $("#discount0").prop("checked", true);
                        chkTotArsDcAmt($("#discount0")[0]);
                    }
                    if(spymDcYn == "Y") {
                        $("#discount1").prop("checked", true);
                        chkTotSpymDcAmt($("#discount1")[0]);
                    }
                    if(prmoDcYn == "Y") {
                        $("#discount2").prop("checked", true);
                        chkTotPrmoDcAmt($("#discount2")[0]);
                    }
                    if(svmtDcYn == "Y") {
                        $("#sale").prop("checked", true);
                        imdtUseHpoint();
                    }

                    if($("div.totAlliDcTxt-detail-select").length > 0) {
                        $("div.totAlliDcTxt-detail-select").find("input[name='discountType1']").each(function() {
                            if($(this).val() == "0000000704" || $(this).val() == "0000000429" || $(this).val() == "0000003583" || $(this).val() == "0000003586") {
                                $(this).prop("checked", true);
                                selectAlliCrd();
                            }
                        });
                    }

                    var isAplyEmpDc = false;

                    var limitEmpDcAmt = Number($("input[name='limitEmpDcAmt']").val());
                    var orderAmt = Number($("input[name='orderAmt']").val());
                    var totDcAmtCalc = Number($("input[name='totDcAmtCalc']").val());

                    if(limitEmpDcAmt > (orderAmt - totDcAmtCalc)){
                        if(hasHsPrchMdaYn == "Y" || hasDtvItmYn == "Y") {

                            var isHsEmpDc = false;

                            if($("div.totAlliDcTxt-detail-select").length > 0) {
                                $("div.totAlliDcTxt-detail-select").find("input[name='discountType1']").each(function() {
                                    if($(this).val() == "0000002991") {
                                        isHsEmpDc = true;
                                    }
                                });
                            }

                            if(isHsEmpDc){

                                //var totPrmoDcAmt = $("#totPrmoDcAmtArea").next("input[name=totPrmoDcAmt]").val();
                                var totPrmoDcAmt = 0;
                                var totCopnDcAmt = 0;
                                var totEmpDcAmt = 0;
                                var payCopnDcAmt = 0;

                                $("#slitmInfDiv span").each(function() {

                                    var obj = $(this);

                                    var slitmCd = obj.data("slitmCd");
                                    var uitmCd = obj.data("uitmCd");
                                    var aspItemCd = obj.data("aspItemCd");
                                    var sellPrc = Number(obj.data("sellPrc"));
                                    var ordQty = Number(obj.data("ordQty"));

                                    // 상품의 수량별로 할인금액 보관
                                    var dcAmtArr = new Array();

                                    // 상품의 수량만큼 loop
                                    for (var i=0; i<ordQty; i++) {

                                        var dcAmt = 0;
                                        var prmoDcAmt = 0;
                                        var copnDcAmt = 0;
                                        var stlmCopnDcAmt = 0;


                                        // 깜짝할인
                                        var prmoDcRate = $(this).data("dcRate");
                                        if(prmoDcRate > 0) {
                                            prmoDcAmt = Math.floor(sellPrc * Number(prmoDcRate) / 1000) * 10;
                                        } else {
                                            prmoDcAmt = Number(obj.data("dcAmt"));
                                        }
                                        totPrmoDcAmt += prmoDcAmt;
                                        dcAmt += prmoDcAmt;



                                        // 일반 쿠폰
                                        var copnInfArrString = $("#gnrlCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).val();

                                        if (!isEmpty(copnInfArrString)) {
                                            // (0:copnNo|1:slitmCd|2:uitmCd|3:aspItemCd|4:famtFxrtGbcd|5:famtFxrtVal|6:copnGb|7:itemIdx|8:copnPblcNo|9:maxDcPossAmt|10:copnTypeGbcd)
                                            var copnInfArr = copnInfArrString.split("|");
                                            var copnNo = copnInfArr[0];
                                            var copnItemIdx = copnInfArr[7];
                                            var maxDcPossAmt = copnInfArr[9];
                                            var copnTypeGbcd = copnInfArr[10];
                                            var prchMdaGbcd = copnInfArr[11];
                                            var dtvItemYn = copnInfArr[12];

                                            if(prchMdaGbcd == "20" || dtvItemYn == "Y") {

                                                var copnDcAmt = 0;
                                                var isVenCopn = false;

                                                for(var j = 0; j < afcoDcVenCopnList.length; j++){
                                                    if(afcoDcVenCopnList[j] == copnNo){
                                                        isVenCopn = true;
                                                        break;
                                                    }
                                                }

                                                if(isVenCopn || copnTypeGbcd == "03" || copnTypeGbcd == "04" || copnTypeGbcd == "05"){
                                                    if(copnInfArr[4] == '1') {
                                                        copnDcAmt = Math.floor(Number(copnInfArr[5]) * Number(sellPrc - dcAmt) / 1000) * 10;

                                                        if(maxDcPossAmt > 0 && copnDcAmt > maxDcPossAmt) {
                                                            copnDcAmt = Number(maxDcPossAmt);
                                                        }
                                                    } else {
                                                        copnDcAmt = Number(copnInfArr[5]);

                                                        if(maxDcPossAmt > 0 && copnDcAmt > maxDcPossAmt) {
                                                            copnDcAmt = Number(maxDcPossAmt);
                                                        }
                                                    }
                                                    totCopnDcAmt += copnDcAmt;
                                                    dcAmt += copnDcAmt;
                                                }
                                            }

                                            // 플러스 쿠폰
                                            copnInfArrString = $("#plusCopn_"+slitmCd+"_"+uitmCd+"_"+aspItemCd+"_"+i).val();

                                            if (!isEmpty(copnInfArrString)) {

                                                // (0:copnNo|1:slitmCd|2:uitmCd|3:aspItemCd|4:famtFxrtGbcd|5:famtFxrtVal|6:copnGb|7:itemIdx|8:copnPblcNo|9:maxDcPossAmt|10:copnTypeGbcd)
                                                var copnInfArr = copnInfArrString.split("|");
                                                var copnNo = copnInfArr[0];
                                                var copnItemIdx = copnInfArr[7];
                                                var maxDcPossAmt = copnInfArr[9];
                                                var copnTypeGbcd = copnInfArr[10];
                                                var prchMdaGbcd = copnInfArr[11];
                                                var dtvItemYn = copnInfArr[12];

                                                if(prchMdaGbcd == "20" || dtvItemYn == "Y") {
                                                    var plusCopnDcAmt = 0;
                                                    var isVenCopn = false;

                                                    for(var j = 0; j < afcoDcVenCopnList.length; j++){
                                                        if(afcoDcVenCopnList[j] == copnNo){
                                                            isVenCopn = true;
                                                            break;
                                                        }
                                                    }

                                                    if(isVenCopn || copnTypeGbcd == "03" || copnTypeGbcd == "04" || copnTypeGbcd == "05"){
                                                        if(copnInfArr[4] == '1') {
                                                            plusCopnDcAmt = Math.floor(Number(copnInfArr[5]) * Number(sellPrc - dcAmt) / 1000) * 10;

                                                            if(maxDcPossAmt > 0 && plusCopnDcAmt > maxDcPossAmt) {
                                                                plusCopnDcAmt = Number(maxDcPossAmt);
                                                            }
                                                        } else {
                                                            plusCopnDcAmt = Number(copnInfArr[5]);

                                                            if(maxDcPossAmt > 0 && plusCopnDcAmt > maxDcPossAmt) {
                                                                plusCopnDcAmt = Number(maxDcPossAmt);
                                                            }
                                                        }

                                                        totCopnDcAmt += plusCopnDcAmt;
                                                        dcAmt += plusCopnDcAmt;
                                                    }
                                                }
                                            }

                                        }

                                        dcAmtArr[i] = dcAmt;
                                    }


                                    var baseDcRate = isEmpty($(this).data("tcBaseDcRate")) ? 0 : Number($(this).data("tcBaseDcRate"));
                                    // 2018.07.19 할인한도액
                                    var tcDcRate = (isEmpty($(this).data("tcDcRate")) || $(this).data("tcDcRate") == 0)? baseDcRate : Number($(this).data("tcDcRate"));

                                    for (var i=0; i < dcAmtArr.length; i++) {
                                        var alliDcAmt = gfn_getTcDcAmt("3", sellPrc, tcDcRate, 1, $(this));
                                        totEmpDcAmt += alliDcAmt;
                                    }

                                });


                                $("input[name='paymentCopnInf']").each(function() {
                                    var copnNo = $(this).val().split("|")[0];
                                    for(var i = 0; i < afcoDcVenCopnList.length; i++){
                                        if(afcoDcVenCopnList[i] == copnNo){
                                            payCopnDcAmt = Number($("form[name='orderDataForm'] input[name='payCopnDcAmt']").val());
                                            break;
                                        }
                                    }
                                });

                                if((totPrmoDcAmt + totCopnDcAmt + payCopnDcAmt) > 0){
                                    if(totEmpDcAmt > (totPrmoDcAmt + totCopnDcAmt + payCopnDcAmt)){
                                        //깜짝 할인 해제
                                        if(totPrmoDcAmt > 0){
                                            $("#discount2").prop("checked", false);
                                            chkTotPrmoDcAmt($("#discount2")[0]);
                                        }

                                        $("div[class^='coupon-detail-select_']").each(function() {
                                            //바로사용 쿠폰  해제
                                            if(totCopnDcAmt > 0){
                                                if($(this).hasClass("gnrlCopn") || $(this).hasClass("plusCopn")){

                                                    if($(this).hasClass("gnrlCopn")){
                                                        //일반쿠폰
                                                        var copnInfArr = $(this).find("input[name^='gnrlCopn_']:checked").val().split("|");
                                                    }else{
                                                        //플러스쿠폰
                                                        var copnInfArr = $(this).find("input[name^='plusCopn_']:checked").val().split("|");
                                                    }


                                                    var copnNo = copnInfArr[0];
                                                    var copnTypeGbcd = copnInfArr[4];
                                                    var prchMdaGbcd = copnInfArr[12];
                                                    var dtvItemYn = copnInfArr[13];

                                                    if(prchMdaGbcd == "20" || dtvItemYn == "Y") {

                                                        var isVenCopn = false;

                                                        for(var i = 0; i < afcoDcVenCopnList.length; i++){
                                                            if(afcoDcVenCopnList[i] == copnNo){
                                                                isVenCopn = true;
                                                                break;
                                                            }
                                                        }

                                                        if(isVenCopn || copnTypeGbcd == "03" || copnTypeGbcd == "04" || copnTypeGbcd == "05"){
                                                            if($(this).hasClass("gnrlCopn")){
                                                                //일반쿠폰
                                                                $(this).find("input[name^='gnrlCopn_']:eq(0)").prop("checked", true);
                                                            }else{
                                                                //플러스쿠폰
                                                                $(this).find("input[name^='plusCopn_']:eq(0)").prop("checked", true);
                                                            }
                                                            selectCopn(this);
                                                        }
                                                    }
                                                }
                                            }

                                        });

                                        //결제수단 쿠폰 해제
                                        if(payCopnDcAmt > 0){
                                            if($(".stlmAmtDcTxt-detail-select").length > 0) {
                                                var copnNo = $("input[name='selPaymentCopn']:checked").val().split("|")[0];
                                                for(var i = 0; i < afcoDcVenCopnList.length; i++){
                                                    if(afcoDcVenCopnList[i] == copnNo){
                                                        $("input[name='selPaymentCopn']:eq(0)").prop("checked", true);
                                                        selectPaymentCopn();
                                                        break;
                                                    }
                                                }
                                            }
                                        }

                                        isAplyEmpDc = true;
                                    }
                                }else{
                                    isAplyEmpDc = true;
                                }
                            }
                        }else{
                            isAplyEmpDc = true;
                        }
                    }

                    if(isAplyEmpDc){ //임직원 할인 적용
                        if($("div.totAlliDcTxt-detail-select").length > 0) {
                            $("div.totAlliDcTxt-detail-select").find("input[name='discountType1']").each(function() {
                                if($(this).val() == "0000002991") {
                                    $(this).prop("checked", true);
                                    selectAlliCrd();
                                }
                            });
                        }
                    }

                    isAutoDcIng = false;

                } catch (e) {
                    isAutoDcIng = false;
                    console.log("error : " + e);
                    alert("죄송합니다. 고객님 추천할인 적용에 실패 하였습니다.\n할인수단은 개별로 적용 할 수 있습니다.");
                    $("#chk2").prop("checked", false);
                    callback(true);
                }
            } else {
                isAutoDcIng = false;

                if(arsDcYn == "Y") {
                    $("#discount0").prop("checked", false);
                    chkTotArsDcAmt($("#discount0")[0]);
                }
                if(spymDcYn == "Y") {
                    $("#discount1").prop("checked", false);
                    chkTotSpymDcAmt($("#discount1")[0]);
                }
                if(prmoDcYn == "Y") {
                    $("#discount2").prop("checked", false);
                    chkTotPrmoDcAmt($("#discount2")[0]);
                }
                if(svmtDcYn == "Y") {
                    $("#sale").prop("checked", false);
                    imdtUseHpoint();
                }

                if($("div.totAlliDcTxt-detail-select").length > 0) {
                    $("div.totAlliDcTxt-detail-select").find("input[name='discountType1']:eq(0)").prop("checked", true);
                    selectAlliCrd();
                }
            }

            if(isCheck) {
                setTimeout(function() {
                    callback(true);
                }, 1000);
            }

            calculateOrderAmt();
            calculateCashRcptAmt();
        }

        function copnSaleAutoDc(isCheck, callback){
            if(isCheck) {
                try {
                    isAutoDcIng = true;

                    if($("div[name='cuponSearch']").length > 0) {
                        setGnrlCupon();

                        var gnrlCupncnt = 0;
                        $("input[name^='gnrlCopn_']:checked").each(function() {
                            if(isEmpty($(this).val().split("|")[0])) {
                                gnrlCupncnt++;
                            }
                        });

                        if(gnrlCupncnt > 0) {
                            setGnrlCupon();
                        }

                        setPlusCupon();

                        var plusCupncnt = 0;
                        $("input[name^='plusCopn_']:checked").each(function() {
                            if(isEmpty($(this).val().split("|")[0])) {
                                plusCupncnt++;
                            }
                        });

                        if(plusCupncnt > 0) {
                            setPlusCupon();
                        }
                    }

                    if($("input[name='paymentCopnInf']").length > 0 && $("input[name='selPaymentCopn']").length > 0) {
                        var isDisabled = $("#stlmAmtDcDiv").css("display");
                        if(isDisabled != "none") {
                            var calDcAmtArr = new Array();
                            var maxDcAmt = 1000;

                            $("input[name='selPaymentCopn']").each(function(index) {
                                if($(this).css("display") != "none" && !$(this).prop("disabled") && !isEmpty($(this).val())) {
                                    $(this).prop("checked", true);
                                    selectPaymentCopn();
                                    var maxCopnData = $(this).val().split("|")[0];
                                    var tmpTotDcAmtCalc = Number($("input[name='orderAmt']:last").val()) - Number($("input[name=totDcAmtCalc]").val());

                                    if (tmpTotDcAmtCalc >= maxDcAmt) {
                                        calDcAmtArr.push($("input[name=totDcAmtCalc]").val() + "|" + index + "|" + maxCopnData);
                                    } else {
                                        $(this).remove();
                                    }
                                }
                            });

                            if(calDcAmtArr.length > 0){
                                $("input[name='selPaymentCopn']:eq(0)").prop("checked", true);
                                selectPaymentCopn();

                                var tmpTotDcAmtArray = new Array();
                                for(var i = 0; i < calDcAmtArr.length; i++) {
                                    var totDcAmtCalc = calDcAmtArr[i].split("|")[0];
                                    var arrayIndex = i < 10 ? "0" + i : String(i);

                                    tmpTotDcAmtArray.push(totDcAmtCalc + arrayIndex);
                                }

                                var maxIndexVal = String(Math.max.apply(null, tmpTotDcAmtArray));
                                var maxIndex = Number(maxIndexVal.substring(maxIndexVal.length -2, maxIndexVal.length));
                                var eqIndex = calDcAmtArr[maxIndex].split("|")[1];


                                $("input[name='selPaymentCopn']:eq("+eqIndex+")").prop("checked", true);

                                selectPaymentCopn();
                            }

                        } else {
                            //주문서 리뉴얼 추천할인 체크박스 확인
                            if(dcAreaCnt() == 0) {
                                $("#chk2").prop("checked", false);
                                $(".order2016_optionwrap").hide();
                            }
                        }
                    }

                    // 2019.10.08 HMALL개선이주형 무료배송비쿠폰 추천할인적용
                    var aplyDlvCopnArr = new Array();
                    if($("div[class^='coupon-detail-select_freeDlvCopn']").length > 0) {
                        // 랭킹매기기
                        var aArr = new Array();
                        $("div[class^='coupon-detail-select_freeDlvCopn']").each(function() {
                            var dlvCost = $(this).find("input[name='dcPrice']").val();
                            var slitmCd = $(this).find("input[name='slitmCd']").val();
                            aArr.push(dlvCost + "|" + slitmCd);
                        });
                        var bArr = new Array();
                        var rnk = aArr.length;
                        for (var i = 0; i < aArr.length; i++) {
                            rnk = 1;
                            for (var j = 0; j < aArr.length; j++) {
                                if (parseFloat(aArr[i].split("|")[0]) < parseFloat(aArr[j].split("|")[0])) rnk++;
                            }
                            for (var j = 0; j < bArr.length; j++) {
                                if (bArr[j].split("|")[2] == rnk) rnk++;
                            }
                            bArr[i] = aArr[i] + "|" + rnk;
                        }

                        // 랭킹순서로 적용
                        for (var j = 0; j < bArr.length; j++) {
                            for (var i = 0; i < bArr.length; i++) {
                                if ((j+1) == bArr[i].split("|")[2]) {
                                    var slitmCd = bArr[i].split("|")[1];

                                    $("div[class^='coupon-detail-select_freeDlvCopn']").each(function() {
                                        var defSlitmCd = $(this).find("input[name='slitmCd']").val();
                                        if (slitmCd == defSlitmCd) {
                                            // 옵션 루프
                                            // 가능쿠폰만 옵션에 들어가 있으므로 하나씩 적용
                                            var isSelected = false;
                                            $(this).find("input[name^='freeDlvCopn']").each(function() {
                                                if (!isEmpty($(this).val().split("|")[0])) {
                                                    var curCopn = $(this).val().split("|")[4];
                                                    var isDup = false;
                                                    for (var i = 0; i < aplyDlvCopnArr.length; i++) {
                                                        var chkCopn = aplyDlvCopnArr[i];
                                                        if (curCopn == chkCopn) {
                                                            isDup = true;
                                                        }
                                                    }
                                                    if (!isDup) {
                                                        aplyDlvCopnArr.push(curCopn);
                                                        isSelected = true;
                                                        $(this).prop("checked", true);
                                                        return false;
                                                    }
                                                }
                                            });
                                            if (isSelected) selectDlvCopn($(this));
                                        }
                                    });
                                }
                            }
                        }
                    }

                } catch (e) {
                    isAutoDcIng = false;
                    console.log("error : " + e);
                    alert("죄송합니다. 고객님 추천할인 적용에 실패 하였습니다.\n할인수단은 개별로 적용 할 수 있습니다.");
                    $("#chk2").prop("checked", false);
                    callback(true);
                }
            } else {
                isAutoDcIng = false;

                $("div[class^='coupon-detail-select_']").each(function() {

                    if($(this).hasClass("gnrlCopn")){
                        //일반쿠폰
                        $(this).find("input[name^='gnrlCopn_']:eq(0)").prop("checked", true);
                        $(this).find("input[name=setAutoDcDupYn]").val("");
                        selectCopn(this,"N");
                    }else if($(this).hasClass("plusCopn")){
                        //플러스쿠폰
                        $(this).find("input[name^='plusCopn_']:eq(0)").prop("checked", true);
                        $(this).find("input[name=setAutoDcDupYn]").val("");
                        selectCopn(this,"N");
                    }else if($(this).hasClass("freeDlvCopn")){
                        //배송비 쿠폰
                        $(this).find("input[name^='freeDlvCopn_']:eq(0)").prop("checked", true);
                        selectDlvCopn($(this));
                    }
                });

                //결제수단 쿠폰 초기화
                if($(".stlmAmtDcTxt-detail-select").length > 0) {
                    $("input[name='selPaymentCopn']:eq(0)").prop("checked", true);
                    selectPaymentCopn();
                }
            }

            if(isCheck) {
                setTimeout(function() {
                    callback(true);
                }, 1000);
            }

            calculateOrderAmt();
            calculateCashRcptAmt();
            if('N' != 'Y'){
            	restoreLastPayType();
            }            
        }

        function goGaEvent(category, action, label,eventType){
            try {
                if (!gaLoad.APP) {
                    var GAInfo = {};
                    if(eventType == "01"){
                        //주문서
                        GAInfo.title = "주문/장바구니>주문서작성>메인";
                        GAInfo[GACustomKey.Dimension31] = "주문/장바구니";
                        GAInfo[GACustomKey.Dimension32] = "주문/장바구니>주문서작성";
                        GAInfo[GACustomKey.Dimension33] = "주문/장바구니>주문서작성>메인";
                        GAInfo[GACustomKey.Dimension34] = "주문/장바구니>주문서작성>메인";
                    }else if(eventType == "02"){
                        //스토어픽
                        GAInfo.title = "주문/장바구니>주문서작성>특화배송>스토어픽";
                        GAInfo[GACustomKey.Dimension31] = "주문/장바구니";
                        GAInfo[GACustomKey.Dimension32] = "주문/장바구니>주문서작성>특화배송";
                        GAInfo[GACustomKey.Dimension33] = "주문/장바구니>주문서작성>특화배송";
                        GAInfo[GACustomKey.Dimension34] = "주문/장바구니>주문서작성>스토어픽";
                    }else if(eventType == "03"){
                        //편의점픽업
                        GAInfo.title = "주문/장바구니>주문서작성>특화배송>편의점픽업";
                        GAInfo[GACustomKey.Dimension31] = "주문/장바구니";
                        GAInfo[GACustomKey.Dimension32] = "주문/장바구니>주문서작성";
                        GAInfo[GACustomKey.Dimension33] = "주문/장바구니>주문서작성>특화배송";
                        GAInfo[GACustomKey.Dimension34] = "주문/장바구니>주문서작성>특화배송>편의점픽업";
                    }

                    GAInfo.hitType = 'event';
                    GAInfo.eventCategory = category;
                    GAInfo.eventAction = action;
                    GAInfo.eventLabel = label;
                    ga('gp.send', GAInfo);

                    //GA_Event(category , action, label);
                }else{
                    var emptyObject = JSON.parse(JSON.stringify(CustomObject));
                    emptyObject.type = 'E';
                    if(getCookieGAB('ReferCode') !== null){ emptyObject.dimension[GACustomKey.Dimension20] = getCookieGAB('ReferCode'); }
                    if(getCookieGAB('TcCode') !== null){
                        var tmpTcCode = getCookieGAB('TcCode');
                        if(tmpTcCode.split('|').length == 1){
                            emptyObject.dimension[GACustomKey.Dimension21] = getCookieGAB('TcCode');
                        }else if(tmpTcCode.split('|').length == 2){
                            emptyObject.dimension[GACustomKey.Dimension21] = tmpTcCode.split('|')[0];
                        }
                    }

                    if (category != null && category.length > 0) {
                        emptyObject['category'] = category;
                    }
                    if (action != null && action.length > 0) {
                        emptyObject['action'] = action;
                    }
                    if (label != null && label.length > 0) {
                        emptyObject['label'] = label;
                    }

                    if(eventType == "01"){
                        //주문서
                        emptyObject.title = "주문/장바구니>주문서작성>메인";
                        emptyObject[GACustomKey.Dimension31] = "주문/장바구니";
                        emptyObject[GACustomKey.Dimension32] = "주문/장바구니>주문서작성";
                        emptyObject[GACustomKey.Dimension33] = "주문/장바구니>주문서작성>메인";
                        emptyObject[GACustomKey.Dimension34] = "주문/장바구니>주문서작성>메인";
                    }else if(eventType == "02"){
                        //스토어픽
                        emptyObject.title = "주문/장바구니>주문서작성>특화배송>스토어픽";
                        emptyObject[GACustomKey.Dimension31] = "주문/장바구니";
                        emptyObject[GACustomKey.Dimension32] = "주문/장바구니>주문서작성>특화배송";
                        emptyObject[GACustomKey.Dimension33] = "주문/장바구니>주문서작성>특화배송";
                        emptyObject[GACustomKey.Dimension34] = "주문/장바구니>주문서작성>스토어픽";
                    }else if(eventType == "03"){
                        //편의점픽업
                        emptyObject.title = "주문/장바구니>주문서작성>특화배송>편의점픽업";
                        emptyObject[GACustomKey.Dimension31] = "주문/장바구니";
                        emptyObject[GACustomKey.Dimension32] = "주문/장바구니>주문서작성";
                        emptyObject[GACustomKey.Dimension33] = "주문/장바구니>주문서작성>특화배송";
                        emptyObject[GACustomKey.Dimension34] = "주문/장바구니>주문서작성>특화배송>편의점픽업";
                    }

                    if (browserInfo.indexOf(AndroidWebview) > -1 && window.AndroidJS && emptyObject['title'] !== undefined && emptyObject['title'].trim().length > 0)
                        window.AndroidJS.GA_DATA(JSON.stringify(emptyObject));
                    else if(typeof pageTemplateNm !== 'undefined' && browserInfo.indexOf(AndroidWebview) > -1 && window.AndroidJS){
                        window.AndroidJS.GA_DATA(JSON.stringify(emptyObject));
                    }
                    else if (browserInfo.indexOf(iOS_Webview_WK) > -1 && window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.gascriptCallbackHandler)
                        webkit.messageHandlers.gascriptCallbackHandler.postMessage(JSON.stringify(emptyObject));
                    else if (browserInfo.indexOf(iOS_WebView_UI) > -1) doRequest(Scheme + encodeURIComponent(JSON.stringify(emptyObject)));
                }
            } catch(e){}
        }

        function goGaPage(tabMn, tabNm){

            try {
                var virtual_Obj = new Object();
                virtual_Obj = setDimenData(virtual_Obj);

                var tabMnArr = tabMn.split(">");

                virtual_Obj[GACustomKey.Dimension31] = tabMnArr[0];

                if(tabMnArr.length > 1){
                    virtual_Obj[GACustomKey.Dimension32] = tabMnArr[0] +">"+ tabMnArr[1];
                }else{
                    virtual_Obj[GACustomKey.Dimension32] = tabMn +'>'+ tabNm;
                }

                if(tabMnArr.length > 2){
                    virtual_Obj[GACustomKey.Dimension33] = tabMnArr[0] +">"+ tabMnArr[1] +">"+ tabMnArr[2];
                }else{
                    virtual_Obj[GACustomKey.Dimension33] = tabMn +'>'+ tabNm;
                }

                virtual_Obj[GACustomKey.Dimension34] = tabMn +'>'+ tabNm;
                virtual_Obj[GAHitKey.Title] = tabMn +'>' + tabNm;

                GADataSend_Page(virtual_Obj);
                virtual_Obj[GAHitKey.URL] = undefined;

            } catch(e){}
            
        }
        
        
     // 선물하기 다중배송 추가  2020.07 김지영 
        function chkMultiGift(obj) {
            if (obj.checked) {
                //$("#mobileMulitDlvCnt").show(); 받을 인원 수 
                $(".flex_false").hide();
                
                //중복 id값 처리
                $(".input-shipping-info#mobileDlvArea").removeAttr("id");
                $(".shipping-step-2").find(".multiaddress_depth2").attr("id","mobileDlvArea");
            } else {
                //$("#mobileMulitDlvCnt").hide(); 
                $(".flex_false").show();
                
                //중복 id값 처리
                $(".shipping-step-2").find(".multiaddress_depth2").removeAttr("id");
                $(".input-shipping-info.flex_false").attr("id","mobileDlvArea");
                
                $("#multiSelectMobile").val("1");
                // 기본배송지중 1번째것 제외하고 삭제
                $("#mobileDlvArea div[name=mobileDlv]:gt(0)").remove();
            }
        }
        
        //선물하기 다중배송 연락처가져오기 2020.08 김지영
        function getAddPhoneList (obj){
                        var $obj = $(obj); 
            $("#addPhoneSeq").val($obj.attr("value"));
        }
        
        //선물하기 선물 카드 이미지 변경 시
        function chkPrsnMsgCrdImgNm (name ,obj ,msgCntnDesc){
            var $obj = $(obj); 
            
            $obj.parent().parent().parent().parent().find("input[name=prsnMsgCrdImgNm]").val(name);
            $obj.parent().parent().parent().parent().find("textarea[name=mmsMsgCntn]").val(msgCntnDesc);
        }


    </script>

    <script type="wisetracker/text" id="wiseTracker">
        WiseTracker.setPageIdentity("ODF");
    </script>

    <style type="text/css">
        iframe#cvsNetfrm{position:absolute;z-index:9999;width: 100%;height:580px;}
    </style>

</head>
<body data-touchevent-enabled="true" class="header-visibled header-fixed" style="overflow: auto;">
<input type="hidden" name="newHistoryBackYn" value="Y">

<script>
    // demo script
    $(function(){
        //로딩레이어
        $(document).on('click', ".loading-layer", function(){ hideLoading(); });
        
        // 안드로이드에서 키보드 올라올때 스크롤 튕기는 현상 수정
        $(".shipping-step-2 div[name=mobileDlv]").on('touchend', function() {
            var divIndex = $(this).index();
            
            $(this).find('input').on('click',function() {
                $(".layer-popup").css({"overflow":"hidden"});
            });
            $(this).find('textarea').on('click',function() {
                $(".layer-popup").css({"overflow":"hidden"});
            });
        }).on('touchstart', function() {
            $(".layer-popup").css({"overflow":"auto"});
        });

        //여러곳으로 배송 버튼 퍼블 js 컨트롤
        // 다중배송 하단 버튼 step 이동 event
        $(document).on('click', ".popup-multi-shipping .popup-footer > button", function(){

            var halfDlvYn = 'N';

            if(halfDlvYn == "Y"){
                //반반배송
                if($(".layer-popup._active ._active").hasClass("popup-multi-shipping")) var _multiShippingType = "popup-multi-shipping";
                else var _multiShippingType = "popup-multi-gift-shipping";
                // add. 0904 - 반반배송 구분 클래스 제거 추가
                var _currStep = parseInt($(this).parents("." + _multiShippingType).attr("class").replace(_multiShippingType,"").replace("_active","").replace("step","").replace("halfDlv","").replace("halfDlv_confirm","").trim());

                //2단계 넘어가기 벨리데이션
                if((_currStep+1) == 2){
                    if(!halfDlvValidation()){
                        return;
                    }
                }

                if($(this).hasClass("_next")){
                    if((_currStep+1) <= 2){
                        $("." + _multiShippingType).removeClass("step"+_currStep).addClass("step"+(_currStep+1));
                        if((typeof halfDlv !== 'undefined' && halfDlv) ? (_currStep+1) === 2 : (_currStep+1) === 3){  // add. 0904 - 반반배송 구분 닫힘 인덱스 조정
                            $("." + _multiShippingType + " .popup-footer > button").removeClass("_next");
                        }
                    }else{
                        // 2줄로 깨지는 현상이 있어서 <div> 으로 감싸도록 수정했음 - 김기호 2020.12.12                    	
                        $("#halfDlvTxt").html("<div>총 <strong class='txt-orange'>2</strong>개 배송지가 설정되어있습니다.</div>");
                        alertMsg("배송지가 모두 등록되었습니다.")

                        // 배송비 선결제 추가 배송비 계산 2020.08.31
                        calculateAddDlvAmt();
                        closeMultiShippingPopup();
                    }
                }
            }else{
                var _currStep = Number($(this).parents(".popup-multi-shipping").attr("class").replace("popup-multi-shipping","").replace("_active","").replace("step","").trim());

                //선물하기 추가 2020.09.01 김지영
                var giftOrderYn = $("input[name='giftOrderYn']").val();
                if($(this).hasClass("_next")){
                    if(Number(_currStep+1) <= 4){
                        //2단계 넘어가기 벨리데이션
                        //var cnt = $(".shipping-step-1").find("input[name=multiCnt]").val();
                        var cnt  = $("#multiSelect").val();
                        if(giftOrderYn =="Y"){
                            cnt  = $("#multiSelectMobile").val();
                        }
                        if(Number(_currStep+1) == 2 ){
                            if(Number(cnt) <= 1){
                                alert("최소 2군데 이상의 배송지를 선택해주시기 바랍니다.");
                                return;
                            }else{
                                if(giftOrderYn =="Y"){
                                    $(".input-shipping-info").addClass("_active");
                                    $(".shipping-memo").addClass("_active");

                                    goGaPage('주문/장바구니>주문서작성>여러곳으로선물','2단계');
                                }else{
                                    goGaPage('주문/장바구니>주문서작성>여러곳으로배송','2단계');
                                }
                            }
                        }

                        //2단계 넘어가기 벨리데이션
                        if(Number(_currStep+1) == 3){
                            if(giftOrderYn =="Y"){
                                if(!dept2GiftValidation()){
                                    return;
                                }else{
                                    goGaPage('주문/장바구니>주문서작성>여러곳으로선물','3단계');
                                }
                            }else{
                                if(!dept2Validation()){
                                    return;
                                }else{
                                    goGaPage('주문/장바구니>주문서작성>여러곳으로배송','3단계');
                                }
                            }
                        }

                        if(!$(".popup-multi-shipping .btn-cancel").hasClass("_back")) $(".popup-multi-shipping .popup-footer > .btn-cancel").addClass("_back");
                        $(".popup-multi-shipping").removeClass("step"+_currStep).addClass("step"+(_currStep+1));
                        if((_currStep+1) == 3){
                            $(".popup-multi-shipping .popup-footer > button").removeClass("_next");
                        }
                    }
                }else{
                    //3단계 넘어가기 벨리데이션
                    if((_currStep+1) == 4){
                        if(!dept3Validation()){
                            return;
                        }else{
                            var cnt  = $("#multiSelect").val();
                            if(giftOrderYn =="Y"){
                                cnt  = $("#multiSelectMobile").val();
                            }
                            if(giftOrderYn =="Y"){
                                //여려명에서 선물하기 3단계에서 옵션별/ 상품별로 총 주문수량이 부족할때 처리
                                var itemQty = 0;
                                $("#domestic li[name='domesticDstnLi']").find("li").each(function () {
                                    itemQty = itemQty + Number($(this).find("select[name=ordQty]").val());
                                });
                                if($("input[name='orderItemTotCount']").val() != itemQty)
                                {
                                    alert('주문수량이 선택수량과 일치하지않습니다.');
                                    return true;
                                }
                                $("#multiInfoTxt1").html("<strong>총 <span class='txt-orange'>" + cnt + "</span>분께  선물을 보내실 예정입니다.</strong>");
                            }else{
                                $("#multiInfoTxt1").html("<p class='txtmulti'>총 <strong class='txt-orange'>" + cnt + "</strong>개 배송지가 설정되어있습니다.</p>");
                            }
                            // 배송비 선결제 추가 배송비 계산 2020.08.31
                            calculateAddDlvAmt();
                            closeMultiShippingPopup();
                            window.scrollTo(0,0);
                        }
                    }
                }
            }           

            pushHistory();
        });

        // 현금영수증 발행여부 체크박스
        $(document).on('click', '#chk14', function() {
            if($(this).is(":checked")) {
                $("#cashRcptAmtSpan").show();
            }
            else {
                $("#cashRcptAmtSpan").hide();
                receiptInit();
            }
        });

        // 포커스시 원자를 제거 2016
        //20170414 박승택 uPoint 추가
        $(document).on('focus', '#hPoint ,#uPoint, #useGcAmt, #chkDepositInput, #useWPoint, #useBluePointAmt, #useHnmoAmt, #useCultureAmt', function() {
            if($(this).attr("id") == "chkDepositInput") {
                if(!$("#chkDeposit").is(":checked")) {
                    $("#chkDeposit").prop("checked", true);
                    useDeposit($("#chkDeposit"), false);
                }
            } else if($(this).attr("id") == "hPoint") {
                if(!$("#chk20").is(":checked")) {
                    $("#chk20").prop("checked", true);
                    useHPoint($("#chk20"), false);
                }
                //20170414 박승택 uPoint 추가
            } else if($(this).attr("id") == "uPoint") {
                if(!$("#chk21").is(":checked")) {
                    $("#chk21").prop("checked", true);
                    useUPoint($("#chk21"), false);
                }
            } else if($(this).attr("id") == "useWPoint") {
                if(!$("#wPoint").is(":checked")) {
                    $("#wPoint").prop("checked", true);
                    useWPoint($("#wPoint"), false);
                }
            }
            if($(this).attr("id") == "uPoint") {
                //통합포인트 추가 박승택 20170523
                var upntVal = $(this).val();
                upntVal = upntVal.replace("P", null);
                $(this).val(removeComma(upntVal));
            } else {
                $(this).val(removeComma(wonRemove($(this).val())));
            }
            $(this).attr("type", "number");
        });

        // 포커스아웃시 원자를 추가 2016
        //20170414 박승택 uPoint 추가
        $(document).on('blur', '#hPoint, #uPoint, #useGcAmt, #chkDepositInput, #useWPoint, #useBluePointAmt, #useHnmoAmt, #useCultureAmt', function() {
            $(this).attr("type", "text");
            var $id = $(this).attr("id");

            if($id == "hPoint") {
                focusOutHPoint(this);
            }

            //20170414 박승택 uPoint 추가
            if($id == "uPoint") {
                focusOutUPoint(this);
            }

            if($id == "chkDepositInput") {
                directInsertDeposit(this);
            }

            if($id == "useWPoint") {
                focusOutWPoint(this);
            }

            var amt = ufnToNum($(this).val());
            if(!$.isNumeric(amt)) amt = 0;

            if($id == "uPoint") {
                //20170414 박승택 uPoint 추가
                $(this).val(gfn_appendComma(amt) + "P");
            } else {
                $(this).val(gfn_appendComma(amt));
            }
        });
        
        var giftOrderYn = $("input[name='giftOrderYn']").val();
        if (giftOrderYn=="Y"){
            var arrImgDesc = new Array();
            //메세지카드 메세지명 배열
            $(".addr-area ul.gift-card-list li").each(function(){
                arrImgDesc.push($(this).attr("imgdesc"));   
            }); 
            
            // 선물하기 카드 이미지 슬라이딩 init 단건 시작 
            $(".addr-area .gift-card-list").slick({
                infinite: false,
                arrows: false,
                dots: true
            });
            $(".addr-area .gift-card-list").on('afterChange',function(event, slick, currentSlide){
                var $current = $("[data-slick-index='"+currentSlide+"']");
                var activeImgNm = $current.attr("imgnm");
                var activeImgDesc = $current.attr("imgdesc");
                $current.parent().parent().parent().parent().find("input[name=prsnMsgCrdImgNm]").val(activeImgNm);
                var currentMmsMsg = $current.parent().parent().parent().parent().find("textarea[name=mmsMsgCntn]").val();
                var chk =false;
                $.each(arrImgDesc,function(key,value){
                    if(currentMmsMsg == value){chk = true;}
                });
                if(chk){
                    $current.parent().parent().parent().parent().find("textarea[name=mmsMsgCntn]").val(activeImgDesc);
                    $current.parent().parent().parent().parent().find("textarea[name=mmsMsgCntn]").text(activeImgDesc);
                }
            });
        }
    });
    
    
    // 선물하기 카드 이미지 슬라이딩 init 다건 시작 
    $(document).on('click', "#step1ButtonNext", function() {
        if ($("#multiaddress4th").hasClass("step3")) {
            $(".input-shipping-info").removeClass("_active");
        }
        $(".giftMultiDlvArea div[name=mobileDlv]").each(function() {
            console.log("슬릭검사...");
            if (!$(this).find(".gift-card-list").hasClass("slick-initialized")) {
                console.log("슬릭 안먹은거 먹임");
                $(this).find(".gift-card-list").slick({
                    infinite: false,
                    arrows: false,
                    dots: true
                });
            }
        });
        $(".layer-popup").css({"overflow":"auto"});
        
    });

    $(document).on('click', '#immtSaleAutoDcBtn', function() {
        var isCheck = $(this).prop("checked");

        try {
            immtSaleAutoDc(isCheck, function(result) {

            });
        } catch (e) {
            console.log("chk2 click error : " + e);
        }
    });

    $(document).on('click', '#copnSaleAutoDcBtn', function() {
        var isCheck = $(this).prop("checked");

        try {
            copnSaleAutoDc(isCheck, function(result) {

            });
        } catch (e) {
            console.log("chk2 click error : " + e);
        }
    });
    
    function onlyNumber(obj){
        $(obj).keyup(function (){
            $(this).val($(this).val().replace(/[^0-9]/g,""));
        });
    }
    
    function blpntValidChk(obj){
		$(obj).keyup(function (){
            $(this).val($(this).val().replace(/[^0-9]/g,""));
		
			if($("#bluePointCardNo").val().length > 16) {
				alert("카드번호는 최대 16자리 숫자만 입력이 가능합니다.");
				$("#bluePointCardNo").val($("#bluePointCardNo").val().substring(0, 16));
				return ;
			}
			
			if($("#bluePointCardPwd").val().length > 4) {
				alert("비밀번호는 최대 4자리 숫자만 입력이 가능합니다.");
				$("#bluePointCardPwd").val($("#bluePointCardPwd").val().substring(0, 4));
				return ;
			}
        });
    }
    
    function chkIrgnAreaMutiDlv(){
        // 제주/ 도서지역일 경우 여러곳으로 배송 불가 처리
        var irgnAreaMutiDlv = false;
        $(".shipping-step-2 .addr-list li").each(function(addrIdx) {                    
            var irgnAreaGbcd = $(this).find("input[name=irgnAreaGbcd]").val();
           
            $("#depth3_content_" + (addrIdx+1)).each(function(itmIdx) {                       
                $(this).find("li[name='itemboxList']").each(function(index) { 
                    var areaDlvCostAddYn = $(this).find("input[name='itemAreaDlvCostAddYn']").val();
                    var jejuAddDlvCost   = Number($(this).find("input[name='itemJejuAddDlvCost']").val());
                    var irgnAddDlvCost   = Number($(this).find("input[name='itemIrgnAddDlvCost']").val());
                    var ordQty           = Number($(this).find("select[name=ordQty]").val());
                          
                    if(areaDlvCostAddYn == "Y" && ordQty > 0){
                        if(irgnAreaGbcd == "01" && jejuAddDlvCost > 0){ // 제주지역
                            irgnAreaMutiDlv = true;
                        }else if(irgnAreaGbcd == "02" && irgnAddDlvCost > 0){ // 도서지역
                            irgnAreaMutiDlv = true;
                        }
                    }
                });
                
            });
        });
        if(irgnAreaMutiDlv){
            alertMsg("제주/도서지역은 여러 곳으로 배송을 할 수 없습니다.\n다시 확인해 주시기 바랍니다.");            
        }
        return irgnAreaMutiDlv;
    }
    
    // 받는사람이 보내는사람과 다른경우 수신인알림처리.
    function checkRcvp() {
    	var custInfo = "01023606586"; // 고객전화번호
    	
    	// 비회원인경우.
    	if ( custInfo == "" ) {
    		return;
    	}
    	var dstnHp = $("#multi_false input[name=dstnHpIdntNo]").val()+$("#multi_false input[name=dstnHpIntmNo]").val()+$("#multi_false input[name=dstnHpBckNo]").val();
        var dstnTel = $("#multi_false input[name=dstnTela]").val()+$("#multi_false input[name=dstnTels]").val()+$("#multi_false input[name=dstnTeli]").val();
        // 최초주문시...배송지 없을때.
        if ( dstnHp == "" && dstnTel == "" ) {
        	return;
        }
        
    	// 비교.
        var halfDlvYn = 'N';
        if ( !$("#multi").prop("checked") && halfDlvYn != "Y") { // 단일배송 && 반반배송 아닐때
    		var compareFlag = false;
    	    
    		// 휴대전화번호나 전화번호가 일치하는지 체크. 
    		if ( custInfo == dstnHp	|| custInfo == dstnTel ) {
    			compareFlag = true;
    		}
    		// 일치하는게 있으면 체크가 있을때 삭제. 없으면 체크 추가.
    		$("a#multi_false").siblings("div#rcvCustSms").remove();
    		if ( !compareFlag ) {
    			//$("a#multi_false").after("<span id='rcvCustSms'><input type='checkbox' name='rcvCustSms' value='Y'/>주문자 수신인 알림</span>");
    			$("a#multi_false").parent().find("a").last().after("<div class='row-wrap' id='rcvCustSms'><span class='row-title'><input type='checkbox' id='taker-alarm' name='rcvCustSms' value='Y'><label for='taker-alarm'>받으실 분에게도 배송 알림 <button class='btn-linegray xs info btn-slpopup' data-sub-lpopup='popup-recipient-delivery-noti'><span>안내</span></button></label></span></div>");
    		}
    	}
    }

    
    function initAddrInput(objId) {
    	if ( objId == "addrSelect" ) {
	    	$("#"+objId+" #newaddress_wrap input[name=rcvCustNm]").val("");
	    	$("#"+objId+" #newaddress_wrap input[name=dstnPostNo]").val("");
	    	$("#"+objId+" #newaddress_wrap input[name=newDstnBaseAdr]").val("");
	    	$("#"+objId+" #newaddress_wrap input[name=dstnPtcAdr]").val("");
	    	$("#"+objId+" #newaddress_wrap input[name=dstnHpIntmNo]").val("");
	    	$("#"+objId+" #newaddress_wrap input[name=dstnTels]").val("");
    	} else {
            $("#"+objId+" input[name=specialCustNm]").val("");
            $("#"+objId+" input[name=specialDstnPostNo]").val("");
            $("#"+objId+" input[name=specialDlvAdr]").val("");
            $("#"+objId+" input[name=specialDstnPtcAdr]").val("");
            $("#"+objId+" input[name=specialDlvPhone2]").val("");
    	}
    }
    
    function initKakaoMap() {
    	 var kakaoSdk = document.createElement('script');
         kakaoSdk.type = 'text/javascript';
         kakaoSdk.async = true;
         kakaoSdk.src = 'https://dapi.kakao.com/v2/maps/sdk.js?appkey=029c8659da13166e1754b6e7ae2368c6&libraries=services&autoload=false';
         //kakaoSdk.src = 'https://dapi.kakao.com/v2/maps/sdk.js?appkey=74cb0f816efdc33713d58fa207d2ee83&libraries=services&autoload=false';
         document.body.appendChild(kakaoSdk);
    }
           

</script>

<div class="wrap orderwrap">

    <div class="nav-skip"><a href="#cntWrap">본문 콘텐츠로 건너뛰기</a></div>
    
    
    






    
    <script src="//image.hmall.com/gen/js/searchPopKeyWordList.js?ver=060106"></script>
    
    <script src="//image.hmall.com/gen/js/searchMblADTextList.js?ver=060106"></script>
    
    <script src="//image.hmall.com/gen/js/searchADLinkList.js?ver=060106"></script>
    
    <script src="//image.hmall.com/gen/js/searchMblSpecialShopLinkList.js?ver=060106"></script>
    
    <script src="//image.hmall.com/gen/js/searchBrndShopLinkList.js?ver=060106"></script>
    <link rel="stylesheet" type="text/css" href="//image.hmall.com/m/css/pd/search.css">
    
    
        
        
            <script type="text/javascript">
                var detailPageYn = false;
            </script>
        
    
    <script type="text/javascript">
        var gv_fileid = "";
        var gv_streamurl = "";
        var gv_nm = "";
        var gv_adKeywordReturnYn = "Y"; // 검색어 광고 조회상태
        var ga_search_type = "";
        /* 검색어 광고 관련 이미지 경로 추가 2018.07.03*/
        var popStart = 0; //인기검색어 1번만 로딩
        
        // header.js 분리에 따른 변수 선언
        var isBarCodeDisplay = "false";
        var LAST_SEARCH = "_LAST_SEARCH";
        var searchBaseKeywordHead = "A";
        var imgImg = "//image.hmall.com/m/img";
        var imageServer = "https://image.hmall.com";
        
        
        function setChangeGnb(gnbCd){
            
                
                
            
        }
        
        function clearSearchText(){
        	$("#searchHeaderinput").click();
        }
        
    </script>

    <script type="text/javascript" src="//image.hmall.com/m/js/co/header.js?806010626"></script>

    


    
        
        
        
        

        
        
        
            <!-- GNB 상단 -->
            
            <header class="header gnb-history" role="banner">
                <button class="btn btn-back" onclick="history.back();"><i class="icon"></i><span class="hiding">뒤로가기</span></button>
                <h1 class="hiding">현대Hmall</h1>
                <h2 class="htitle"><span>주문서 작성</span></h2>
                <button class="btn btn-search" name="searchActive"><i class="icon"></i><span class="hiding">검색</span></button>
                <a href="https://www.hmall.com/m/basktList.do" class="link-cart" onclick="GA_Event('공통', 'GNB', '장바구니');"><i class="icon"></i><span class="hiding">장바구니</span>
                    
                </a>
            </header>
            <!-- //.header -->
        
    

    <div class="nav-skip"><a href="#cntWrap">본문 콘텐츠로 건너뛰기</a></div>





    <div class="ly-uksearch" aria-label="전체검색">
		   
	        <div class="ly-searhead">
	            <button class="btn btn-back" id="backSearchLayer"><i class="icon"></i><span class="hiding">검색창 닫기</span></button>
	            <form method="get" name="searchdiv" action="/m/pde/search.do">
	                <div class="inputbox search selected" role="search">
	                    <input type="hidden" name="gnbSearchYn" value="Y">
	                    <input type="hidden" name="requestPath" value="w">
	                    <input type="hidden" name="tab" value="all">
	                    <input type="hidden" name="csfDepth">
	                    <input type="hidden" name="csfNameCode">
	                    <input type="hidden" name="gaSearchType">
                        <input type="hidden" name="popSrchYn">
	
	                    <label class="inplabel">
	                        
	                            
	                            
	                                <input type="search" id="searchinput" name="searchTerm" title="검색어 입력" autocomplete="off">
	                            
	                        
	                    </label>
	                    <button type="button" class="btn ico-clearabled"><i class="icon"></i><span class="hiding">지우기</span></button>
	                    <button class="btn btn-search" type="button" onclick="searchSubmit();"><i class="icon"></i><span class="hiding">검색</span></button>
	                </div>
	            </form>
	            <!-- APP 화면시 음성검색 -->
	            <button class="btn btn-voice lyopen" data-target="voicesearch"><i class="icon voice"></i><span class="hiding">음성검색</span></button>
	        </div>
        
		
        <!-- //.searhead -->

        <div class="ly-searbody">
            <div class="popular" id="favorite_search_list">
                <h3 class="major-headings">인기 검색어</h3>
                <ul><li><a href="javascript:clickSeachText('여성원피스','popKeyword')"><span>여성원피스</span></a></li><li><a href="javascript:clickSeachText('구찌가방','popKeyword')"><span>구찌가방</span></a></li><li><a href="javascript:clickSeachText('프라다가방','popKeyword')"><span>프라다가방</span></a></li><li><a href="javascript:clickSeachText('여성린넨자켓','popKeyword')"><span>여성린넨자켓</span></a></li><li><a href="javascript:clickSeachText('마스크','popKeyword')"><span>마스크</span></a></li><li><a href="javascript:clickSeachText('JBY정구호','popKeyword')"><span>JBY정구호</span></a></li><li><a href="javascript:clickSeachText('여성블라우스','popKeyword')"><span>여성블라우스</span></a></li><li><a href="javascript:clickSeachText('다이슨','popKeyword')"><span>다이슨</span></a></li><li><a href="javascript:clickSeachText('버버리가방','popKeyword')"><span>버버리가방</span></a></li><li><a href="javascript:clickSeachText('나이키','popKeyword')"><span>나이키</span></a></li></ul>
            </div>

            <div class="article banner-ad-area" id="adAreaFocus" style="display:none;">

            </div>

            <!-- APP 일경우 class app 추가 -->
            <div class="recent-area" id="recent-area" aria-hidden="최근검색어" style="display: none;">
                <h3 class="major-headings">최근 검색어</h3>
                <div class="recent">
                    <ul id="recent_search_list"></ul>
                    <button class="btn btn-delete" id="allDeleteCustKeyword"><i class="icon delete"></i><span>전체삭제</span></button>
                </div>
            </div>

            <!-- S : 검색어 자동완성 -->
            <div class="keyword-area hiding" id="keyword-area">
                <!-- 마크업 구조 변경 07/28 -->
                <div class="shopbox" style="display:none;">
                    <p class="spacialshop" id="spacialshop"></p>
                    <p class="brandshop" id="brandshop"></p>
                </div>
                <ul id="search_list"></ul>

                <div class="category-area" id="category-area" style="display:none;">
                    <h3 class="major-headings">카테고리</h3>
                    <ul id="recomm_category_list"></ul>
                </div>
            </div>

            <div class="banner-ad-area" id="adAreaKeyup" style="display:none;">

            </div>
            <!-- //.keyword-area -->

            <div class="not-recommended hiding">
                <p>입력하신 단어로 검색어를 추천할 수 없습니다.</p>
            </div>

            <div class="keyword-tag" id="nowNeed" style="display: none;">
                <h3 class="major-headings">지금 필요한 그것</h3>
                <ul>
                </ul>
            </div>
        </div>
        <!-- //.ly-searbody -->
        
     
         <!-- APP 음성검색일 때 레이어 class active 활성화 -->
         <div class="popup-layerwrap alert voicesearch" role="dialog" aria-label="음성검색">
             <div class="layer">
                 <h3 class="hiding">음성검색</h3>
                 <div class="layer-body">
                     <div class="bgvoice">
                         <span class="bgcircle"><i class="icon"></i></span>
                         <p id="search_talk">검색어를 말씀하세요</p>
                         <p id="search_please_talk" style="display: none">마이크 버튼을 누른 후<br>다시 한번 말씀해 주세요</p>
                     </div>
                     <p>음성검색 서비스는 daumkakao와 함께 합니다</p>
                 </div>
                 <!-- //.layer-body -->
                 <button class="btn btn-close lyclose" type="button" onclick="voiceSearchClose()"><i class="icon"></i><span class="hiding">닫기</span></button>
             </div>
             <!-- //.layer -->
         </div>
         <!-- //.voicesearch -->
         <script type="text/javascript">
         $(".bgvoice").on("click", function () {
        	 if ($('#search_please_talk').is(':visible')) {
        		 voiceSearch();
             }
         });
         
         function voiceSearchClose() {
        	 $('.voicesearch').hide();
         }
         </script>
     
    </div>
    <!-- //.cmain -->
    <form name="brndSearchMoveForm" action="https://www.hmall.com/m/dpa/smBrndSearchL.do" method="get">
        <input type="hidden" name="srchBrndCd" value="">
        <input type="hidden" name="tabGbn" value="전체">
        <input type="hidden" name="moveGbn" value="first">
    </form>


    <!-- 상품 상세일 경우에 보이는 디바이스별 하단 버튼 -->
    <!-- 하단 버튼영역 - 상품상세 App - app의 경우는 class app 추가 -->
    <div class="btngroup bgfixed btnlen2 app" style="display:none;">
        <button class="btn btn-cart"><span>장바구니</span></button>
        <button class="btn btn-purchase"><span>구매하기</span></button>
    </div>
    <!-- //.btngroup -->

    <!-- 하단 버튼영역 - 상품상세 모바일 Web -->
    <div class="btngroup bgfixed btnlen2" style="display:none;">
        <button class="btn btn-applink"><span>앱으로 연결</span></button>
        <button class="btn btn-purchase"><span>구매하기</span></button>
    </div>
    <!-- //.btngroup -->

    <!-- 하단 버튼영역 유형 선물하기 버튼이 있을 경우 - 상품상세 App, 모바일 Web - app의 경우는 class app 추가 - 시안 확정안됨 -->
    <div class="btngroup bgfixed btnlen3 app" style="display:none;">
        <button class="btn btn-cart"><span>장바구니</span></button>
        <button class="btn btn-present"><i class="icon"></i><span class="hiding">선물하기</span></button>
        <button class="btn btn-purchase"><span>바로구매</span></button>
    </div>
    <!-- //.btngroup -->
    <!-- //상품 상세일 경우에 보이는 디바이스별 하단 버튼 -->


<div class="loading-layer" style="top: 0px; display: none;"><div class="loading-content" style="top: 575.5px;"><img src="https://image.hmall.com/hmall/co/loadingfull_h.gif"><span class="loading-txt"></span></div></div>

    <main class="cmain" role="main">
        <div id="cntWrap" class="container" aria-label="주문서 본문내용">
            <h2 class="hiding">주문서 작성 본문내용</h2>

            <!--모바일 웹일 경우 is-web 클래스 추가-->
            
	            
	            
		            <section id="content" class="order is-web">
	            
            
            
            

<script src="https://image.hmall.com/mo/js/js_5.0/socket/socket.io.js"></script>

<script type="text/javascript">

$(document).ready(function() {
	
	if($(".live-banner-area").length > 0){
		//행사타이틀 2줄로 노출 요청 (방송타이틀은 노출x)
		var txt = $(".mlbLiveTitle").html();
		if(txt != undefined && txt != null){
	        if(txt.indexOf("\n") > -1){
	            $(".mlbLiveTitle").html(txt.split("\n")[0]);
	            $(".mlbLiveSubTitle").html(txt.split("\n")[1]);
	        }
		}
		
		connectSocket();
	}
    	
});

function connectSocket(){
	//20200623 상시 구매완료 메시지 노출 주문완료페이지에서만 노출
    var buyMsgExpsYn = ""; //구매메시지노출여부
    var bfmtNo = "";
    var nknm = "";
    
    if(buyMsgExpsYn == "Y"){
    	var url         = "wss://chat.hyundaihmall.com";
    	if (isEmpty(url)) url = "wss://chat.hyundaihmall.com";
    	
    	var socket = io.connect(url, { transports: ['websocket']}); //소켓연결
    	
    	var msg = nknm + "님이 구매완료하셨습니다.";
    	let dataObj = {
    			roomName    : "mlb"+bfmtNo,
                msg         : msg,
                msgCd       : "10"
              }; 
		socket.emit('roomSysMsg', dataObj );
    }
}

// 모바일라이브 방송으로 이동
function openMobileLive() {
    var vdoType = "";
    if (isEmpty(vdoType)) vdoType = "02";
    
    if (appYn == "Y") {
        window.location.href = "/m/goAppLiveChat.do?vdoType=" + vdoType;
    } else {
        window.location.href = "/m/smMobileLiveChat.do";
    }
}

function mlbClose(){
    $(".live-banner-area").hide();
}
</script>



		    
		    
		    
		
		    
		    
		    
		        
		        
		            
		
		            
		
		            
		                
		            
		
		            
		        
		    
		
		    
		        
		
		        
		
		        
		            
		
		            
		
		
		            
		
		            
		
		            
		                <div class="addr-area mt10" id="gnrlDlvDiv">
                            <h2 id="dstnTypeName">
                                
                                    
                                    일반배송
                                
                            </h2>
		                    <!-- 스토어픽일경우 미노출 -->
		                    
		                        
		                        
		                    
		
		                    <div class="addr-detail-area _active">
                                <a class="btn-large-arrow btn-lpopup" href="javascript:void(0);" data-lpopup="popup-shipping-addr" id="multi_false" onclick="goAddrList(this); dlvAddInfoReset(); goGaPage('주문/장바구니>주문서작성','배송지입력팝업');">
		                            <input type="hidden" name="notAdrYn" value="">
		                            <input type="hidden" name="dstnSeq" value="0000000003">
		                            <input type="hidden" name="baseYn" value="Y">
		                            <input type="hidden" name="rcvCustNm" value="주찬영">
		                            <input type="hidden" name="dstnPostNo" value="05408">
		                            <input type="hidden" name="dstnBaseAdr" value="서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)">
		                            <input type="hidden" name="dstnPtcAdr" value="101동 404호">
		                            <input type="hidden" name="dstnHpIdntNo" value="010">
		                            <input type="hidden" name="dstnHpIntmNo" value="2360">
		                            <input type="hidden" name="dstnHpBckNo" value="6586">
		                            <input type="hidden" name="dstnTela" value="010">
		                            <input type="hidden" name="dstnTels" value="6348">
		                            <input type="hidden" name="dstnTeli" value="0471">
		                            <input type="hidden" name="adrKndGbcd" value="2">
		                            <!-- 2020.08.11 추가배송비 지역구분코드 추가  -->
                                    <input type="hidden" name="irgnAreaGbcd" value="">
		
		                            <div id="selectDstnDesc" style="display:none">선택하여 배송지를 입력해 주세요.</div>
		
		                            <span class="field-name" id="firstDstnInfo">
		                                <span id="addressInfoCustNm">주찬영</span>
		                                <span class="sub-txt-label" id="addressInfoBaseYn">기본배송지</span>
		                            </span>
		                            <span class="field-addr" id="addressInfoPtcAdr">(05408) 서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트) 101동 404호</span>
		                            <span class="field-phone" id="addressInfoHpIdntNo">
		                                
		                                    
		                                        010-2360-6586
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                                    
		                                
		                            </span>
		
		                            <span class="field-phone" id="addressInfoDstnTela">
		                                
		                                    
		                                        
		                                            010-6348-0471
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                        
		                                    
		                                
		                            </span>
		                        </a>
		
		                        
		                            <a class="btn-large-arrow btn-lpopup-early" href="javascript:;" style="display:none" id="delivery_type_special">
		                                <span class="field-name">
		                                    <span id="specialRcvCustNm"></span>
		                                </span>
		                                <span class="field-addr" id="specialAddressInfoPtcAdr"></span>
		                                <span class="field-phone" id="specialAddressInfoHpIdntNo"></span>
		                                <input type="hidden" value="" id="specialDlvType">
		                                <input type="hidden" value="" name="premDstnPtcAdr">
		                                <input type="hidden" value="" name="dawnDstnPtcAdr">
		                            </a>
		                        

                                <div id="delivery_type_delivery1">
		                            
		                                
		                                    
		                                
		                            
		
		                            <div class="row-wrap ">
		                                <span class="row-title">주문자명</span>
		                                <span class="row-value"><input class="type-box" type="text" name="senderName" value="주찬영" maxlength="10"></span>
		                            </div>
		
		                            <input type="hidden" name="dsrvCoMsgInfCustInsrYn" value="N">
		                            <select class="select-shipping-memo" name="mmsMsgCntnSelect" onchange="changeDlvMemoSelect(this);">
		                                <option>요청사항 선택하기</option>
		                                
		                                <option>부재 시 경비실에 맡겨주세요</option>
		                                <option>부재 시 연락주세요</option>
		                                <option>배송 전 연락바랍니다</option>
		                                <option class="memo-custom">직접입력(저장됩니다)</option>
		                            </select>
		                            <span class="input-cnt-wrap shipping-memo" data-maxcnt="100">
		                                <span class="input-cnt" id="cntnLen"><span class="curr-cnt text_count">0</span>/<span class="total-cnt">100</span></span>
		                                <textarea placeholder="배송메모를 입력하세요." name="mmsMsgCntn" onkeyup="checkBytes(this, 100)"></textarea>
		                            </span>
		                        </div>

                                
		                    </div>
		                    <a class="btn-large-arrow btn-lpopup btn-multi-shipping" data-lpopup="popup-multi-shipping" id="multiInfoTxt1" onclick="goGaEvent('주문서', ' 복수배송지 입력안내' , '', '01'); goGaPage('주문/장바구니>주문서작성>여러곳으로배송','1단계');">
		                        선택하여 배송지를 입력해 주세요.
		                    </a>
		                </div>
		            
		
		            <!--스토어픽 영역-->
		            
		            <!--//스토어픽 영역-->
		
		            
		            
		            <div class="order-item-area mt10">
		                <!-- <a href="javascript:;" onclick="goGaEvent('주문서', '상품정보 더보기' , '', '01');"  > -->
		                <a href="javascript:;" onclick="GA_Event('주문서', '상품정보 더보기' , '');">
		                    <h2>상품정보</h2>
		                        <span class="order-amount">(<span class="txt-orange">1</span>개)</span>
		                </a>
		
		                <ul class="item-list order2020_item">
		                    
		                    
		                    
		                        
		                            <li name="itemInfoLi">
		                                <input type="hidden" name="slitmCd" value="2101185938">
		                                <input type="hidden" name="slitmNm" value="[나인닷] 비 런닝머신 ND1000 / 홈트레이닝 트레드밀 접이식런닝머신 워킹머신">
		                                <input type="hidden" name="uitmCd" value="00001">
		                                <input type="hidden" name="aspItemCd" value="0">
		                                <input type="hidden" name="itemOrdQty" value="1">
		                                <input type="hidden" name="dlvHopeDt" value="">
		                                <!-- 2020.08.11 추가배송비 선결제 추가  -->
		                                <input type="hidden" name="itemAreaDlvCostAddYn" value="N">
		                                <input type="hidden" name="itemJejuAddDlvCost" value="0">
		                                <input type="hidden" name="itemIrgnAddDlvCost" value="0">  
		                                <input type="hidden" name="grpItemNum" value="0">
		                                <input type="hidden" name="ItemNum" value="0">  
		                                <a href="javascript:;">
		                                    <img src="https://image.hmall.com/static/9/5/18/01/2101185938_0.jpg?RS=80x80&amp;AR=0" class="item-thumb" onerror="noImage(this, '//image.hmall.com/m/img/co/noimg-thumb.png')">
		                                    <div class="item-label-area">
		                                        <span class="item-label">[나인닷] 비 런닝머신 ND1000 / 홈트레이닝 트레드밀 접이식런...</span>
		                                        <span class="option-label">
		                                            
		                                            1개
		                                        </span>
		                                        <span class="price-label">
		                                            <strong>
		                                                
		                                                    
		                                                    
		                                                    
		                                                    
		                                                        1,490,000
		                                                    
		                                                
		                                            </strong>
		                                            
		                                                원
		                                            
		                                        </span>
		                                    </div>
		                                </a>
		
		                                
		
		                                
		
		                                <!--스토어픽 영역-->
		                                
		                            </li>
		
		                            
		                            
		                            
                                     		                            
		                        
		                    
		                </ul>
		            </div>
		        
		    
		
		    
		    
		    
		    
                    
		    
		    
		    
		
		    
		    
		    
		        
		    
		    
		    <!-- 적립금 적용 여부 -->
		    
		    <!-- h.point 적용 여부 -->
		    
		    
		        
		    
            
                
            

		
		    
		    
		
		    
		        <div class="order-dc-area mt10">
		            <h2>할인/포인트 적용</h2>
		
		            
		
		            
		
		            
		                <div class="point-area">
		                    
		                        
		                            
		                            
		                                <div class="row-wrap">
		                                <span class="row-title">
		                                    <input type="checkbox" id="chk18" name="chk18" onclick="useGcAmt(this);" class="chk-voucher">
		                                    <select id="ch08" name="selectGcKind" disabled="disabled" onchange="selectGcKind(this);">
		                                        <option value="0">상품권</option>
		                                        <option value="1">현대백화점</option>
		                                        <option value="1">삼성</option>
		                                        <option value="1">현대오일뱅크</option>
		                                        <option value="1">국민관광</option>
		                                        <option value="1">GS칼텍스</option>
		                                    </select>
		                                </span>
		
		                                    <span class="row-value">
		                                    <span class="point-input-wrap">
		                                        <input class="point-input" type="text" align="right" name="useGcAmt" value="0" id="useGcAmt" disabled="disabled" onkeyup="directInsertGc(this);">
		                                    </span>
		                                </span>
		                                </div>
		                            
		                        
		                    
		
		                    <!-- 예치금 -->
		                    
		
		                    <!-- H.Point 20170412 박승택 추가-->
		                    
		                        
		                            
		                                <div class="row-wrap">
		                                <span class="row-title">
		                                    <input type="checkbox" id="chk21" name="chk21" onclick="useUPoint(this, true);">
		                                    <label for="chk21">H.Point(<em>293</em>)</label>
		                                    <a class="btn-helper btn-slpopup" data-sub-lpopup="popup-hpoint-guide" href="javascript:;">도움말</a>
		                                </span>
		                                    <input type="hidden" name="uPoint" id="assetUpoint" value="293">
		
		                                    <span class="row-value">
		                                    <span class="point-input-wrap">
		                                        <input class="point-input" type="text" align="right" value="0" name="useUPoint" id="uPoint">
		                                    </span>
		                                </span>
		                                </div>
		                            
		                            
		                        
		                    
		                    
		
		                    <!-- 적립금 -->
		                    
		
		                    <!-- W포인트 -->
		                    
		
		                    
		                        <div class="row-wrap">
		                            <span class="row-title"><label>기타 포인트 사용</label><button class="btn-white br btn-lpopup" data-lpopup="popup-dc-point-select" onclick="goGaPage('주문/장바구니>주문서작성>할인포인트팝업','기타포인트');">조회/변경</button></span>
		                            <span class="row-value" id="etcPointTotal">0원</span>
		                        </div>
		                    
		                </div>
		            
		        </div>
		    
		
		    <div class="total-price-area mt10" id="totPriceDiv">
		    <!-- 
		        <a class="price-detail-btn btn-section-dropdown" href="javascript:;" onclick="goGaEvent('주문서', '총결제금액 더보기' , '', '01');">
		     -->
		        <a class="price-detail-btn btn-section-dropdown" href="javascript:;" onclick="GA_Event('주문서', '총결제금액 더보기' , '');">
		            <div class="row-wrap">
		                <span class="row-title">총 결제금액</span>
		                <span class="row-value txt-orange">
		                    <span class="dc-percent-flag" id="totDcPer" style="display: none;">0%</span>
		                    <strong id="lastStlmAmtTxt">1,490,000원</strong>
		                    <sub id="cardPrmoCmt"></sub>
		                </span>
		            </div>
		        </a>
		        <div class="price-detail-area">
		            <div class="row-wrap">
		                <span class="row-title">주문금액</span>
		                <span class="row-value"><strong>1,490,000원</strong></span>
		            </div>
		            <div class="row-wrap">
		                <span class="row-title">할인금액</span>
		                <span class="row-value"><strong id="totDcTxt">0원</strong></span>
		            </div>
		            <div class="row-wrap">
		                <span class="row-title">배송비</span>
		                <span class="row-value">
		                    <strong id="totDlvCostTxt">
		                       
		                           
		                               0원
		                           
		                           
		                       
		                    </strong>
		                </span>
		            </div>
		            <div class="row-wrap dcDlvCostArea" style="display: none;">
		                <span class="row-title">배송비할인</span>
		                <span class="row-value"><strong id="dcDlvCostTxt">0원</strong></span>
		            </div>
		            
		            <div class="row-wrap addDlvCostArea" style="display:none">
		                <span class="row-title">추가배송비 <a class="btn-helper btn-slpopup" data-sub-lpopup="popup-adddlvcost-guide" href="javascript:;">도움말</a></span>
                        <span class="row-value" id="totAddDlvCostTxt"><strong>(+)0원</strong></span>
		            </div>
		        </div>
		    </div>
		
		    
		
		    
		        <div class="payment-area mt10">
		            <h2>결제수단</h2>
		            
		                <span class="guide-benefit">카드 무이자 특별행사 안내 <a class="btn-helper btn-slpopup" data-sub-lpopup="popup-card-guide" onclick="goGaPage('주문/장바구니>주문서작성','카드무이자할부안내');">도움말</a></span>
		            
		
		            
		                
		                
		                
	                    <a class="banner-imgtype" href="javascript:void(0);">
	                        <div class="banner-wrap" style="background:#FFDCD9;">
	                            <div class="txt-area">
	                                <strong>Hmall Pay 결제시 H.Point 1% 자동 적립</strong>
	                                <p class="txt">5만원이상 결제 시 최대 1만P/6.1~30/<br>상품 출고일 7일 후 자동지급</p>
	                                
	                            </div>
	                            
	                            <div class="img">
	                                <img src="https://image.hmall.com/HM/HM026/20210208/082300/img-card-hmallpay.png" alt="Hmall Pay 결제시 H.Point 1% 자동 적립">
	                            </div>
	                            
	                        </div>
	                    </a>
		                
		            
		
		            <a class="btn-option label-select btn-lpopup mod" data-lpopup="popup-payment-select" id="payTypeNmAtag" onclick="goGaPage('주문/장바구니>주문서작성','결제수단선택');">
		                <span class="btn-label">
		                    <strong id="payTypeNm">KB국민카드(일시불)</strong>
		                </span>
		            </a>
		
		            <div class="crdPntArea" style="">
		                <input type="checkbox" id="point2" onchange="cardPointChg(this);">
		                <label for="point2">카드사 포인트 사용</label>
		                <a class="btn-helper btn-slpopup" data-sub-lpopup="popup-guide-card-point" href="javascript:;">도움말</a>
		            </div>
		
		            <div class="card-point-area smileCrdArea" style="display:none; margin-top:15px;">
		                <input type="checkbox" id="smileCrdpoint2" name="smileCrdPoint" onchange="smileCardPointChg(this);">
		                <label for="smileCrdpoint2">스마일카드 사용결제</label>
		            </div>
		            
		            <div name="pay1CardPrmo" class="payment-notice" style=""><span class="payment-notice"><strong>현대카드</strong> 결제 후 <strong>7%</strong> 즉시할인 받으시면 <strong>1,385,700원</strong> 입니다.</span><div class="sub-area">표시되는 즉시할인 예상금액은 1인당 일 최대 즉시할인 한도에 따라 달라질 수 있습니다. (이벤트안내 참고)</div></div>
		
		            
		            <div id="pay1CrdAftDmndPrmo" class="payment-notice" style="">
		
		            </div>
		
		            
		
		            
		        </div>
		
		        <!--현금영수증-->
		        
		            <div class="receipt-option-area mt10" id="receiptSelect" style="display: none;">
		                <div class="receipt-header">
		                    <span class="input-wrap">
		                        
		                        
		                            <input type="checkbox" class="receipt-checkbox" id="chk14" name="receiptYn">
		                        
		                        <label for="chk14">현금영수증 발행여부</label>
		                    </span>
		                    <span class="receipt-amount" id="cashRcptAmtSpan" style="display: none;">0원</span>
		                </div>
		                <div class="receipt-content">
		                    <span class="receipt-type-title">발행 용도</span>
		                    <div class="receipt-type-select">
		                    <span>
		                        <input type="radio" id="chk15" class="receipt-type-1" name="rcptTskGbcd" value="0" checked="checked"><label for="chk15">소득공제</label>
		                    </span>
		                        <span>
		                        <input type="radio" id="chk16" class="receipt-type-2" name="rcptTskGbcd" value="1"><label for="chk16">사업자증빙</label>
		                    </span>
		                    </div>
		
		                    <div class="row-wrap individual-area _active" id="cashRcpType1">
		                        <span class="row-title">
		                            <select class="evidence-type-select" id="bank_receipt_types" name="cashRcptType" onchange="chgCashReceiptNum();">
		                                <option class="phone-number" value="0">휴대폰번호</option>
		                                <option class="card-number" value="1">신용카드번호</option>
		                                <option class="receipt-card-number" value="2">현금영수증카드번호</option>
		                            </select>
		                        </span>
		                        <span class="row-value type-phone-number phone-number-area _active">
		                            <select class="phone-number-sect1" name="cashRcptHpNum1">
		                                
		                                    <option value="010" selected="selected">010</option>
		                                
		                                    <option value="011">011</option>
		                                
		                                    <option value="016">016</option>
		                                
		                                    <option value="017">017</option>
		                                
		                                    <option value="018">018</option>
		                                
		                                    <option value="019">019</option>
		                                
		                            </select>
		                            <span id="bar">-</span>
		                            <input class="type-box phone-number-sect2" type="number" pattern="[0-9]*" inputmode="numeric" min="0" name="cashRcptHpNum2" value="" oninput="maxLengthCheck(this);" maxlength="8">
		                        </span>
		                            <span class="row-value type-card-number">
		                                <input class="type-box" type="number" onkeydown="onlyNumber(this);" name="cashRcptCreditCrdNum" value="" oninput="maxLengthCheck(this);" maxlength="19" style="display:none">
		                                <input class="type-box" type="number" onkeydown="onlyNumber(this);" name="cashRcptCrdNum" value="" oninput="maxLengthCheck(this);" maxlength="21" style="display:none">
		                            </span>
		                    </div>
		                    <div class="row-wrap corporation-area">
		                        <span class="row-title">사업자등록번호</span>
		                        <span class="row-value co-number-area">
		                            <input class="type-box co-number-1" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="rgno1" maxlength="3" value="" oninput="maxLengthCheck(this);">
		                            <span>-</span>
		                            <input class="type-box co-number-2" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="rgno2" maxlength="2" value="" oninput="maxLengthCheck(this);">
		                            <span>-</span>
		                            <input class="type-box co-number-3" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="rgno3" maxlength="5" value="" oninput="maxLengthCheck(this);">
		                        </span>
		                    </div>
		                </div>
		            </div>
		        
		        <!--//현금영수증-->
		
		        <!-- 비회원 주문일 때는 노출이 안되게 한다 -->
		        
		            <!-- TODO 20170413 박승택 -->
		            <!-- HPoint마케팅개선 kjh 20190218 예상H.Point 프로모션금액 추가 시작 -->
		            
		                <div class="point-notice-area mt10" id="totUPointArea">
		                    <div class="row-wrap">
		                        <span class="row-label">적립예정 H.point</span>
		                        <span class="row-value" id="totUPointTxt">1,490P</span>
		                    </div>
		                </div>
		            
		            
		            <div class="point-notice-area mt10" id="totHPointArea" style="display: none;">
		                <div class="row-wrap">
		                    <span class="row-label">예상 적립금</span>
		                    <span class="row-value" id="totHPointTxt">0원</span>
		                </div>
		            </div>
		        
		    
		
		    <!-- 엄지펀딩 -->
		    
		    <!-- //엄지펀딩 -->
		
			
		    <!-- 170719 - 개인통관고유부호 - rlatkdals -->
		    <!-- 2019.04.22  스토어픽 주문일경우 개인통관번호 미 노출 -->
		    
		    <!-- //170719 - 개인통관고유부호 - rlatkdals -->
		
		
		    
		        <div class="payment-btn-area mt10">
		            
		                <div class="agreement-wrap">
		                    <input type="checkbox" id="agreeChk" name="ordAgreeChk"><label for="agreeChk">주문 상품, 가격, 배송정보에 동의</label>
		                </div>
		            
		            
		
		            
		
		            
		                <div id="dlvAdrSaveDiv" style="display:none;">
		                    <input type="checkbox" id="dlvAdrSaveYn" name="dlvAdrSaveYn" checked="checked" class="dlvAdrInfArea"><label class="ml5" for="dlvAdrSaveYn">입력한 배송지 재사용에 동의</label>
		                </div>
		            
		
		            
		
		            <button class="btn-confirm" onclick="premAddrCheck();">
		                <strong id="orderBtn">1,490,000원 결제하기</strong>
		            </button>
		        </div>
		    
		</section>
	</div></main>

<div class="layer-dim"></div>
<!--메인 레이어 팝업-->
<div class="layer-popup order">
    <!--쿠폰선택 팝업-->
    
    <!--//쿠폰선택 팝업-->

    <!--할인선택 팝업-->
    
    <!--//할인선택 팝업-->

    <!--포인트 팝업-->
    <div class="popup-dc-point-select">
        <div class="popup-header">
            <h3>기타포인트</h3>
        </div>
        <div class="popup-content">

            <!-- 하나머니 -->
            
                <!-- 엄지펀딩 추가 (20190519) -->
                
                    <div class="row-wrap">
                        <span class="row-title">
                            <input class="chk-etc-point" type="checkbox" data-etc-point="hanamoney" id="hanaCheck" onclick="useHanaMoneyPop(this);">
                            <label for="hanaCheck">하나머니</label>
                        </span>
                        <span class="row-value" id="useHanamoneyAmt" name="useHanamoneyAmt" value="0P" disabled="disabled">0P</span>
                    </div>
                
            

		    
            
            <!-- 블루포인트 -->
            
                <!-- 엄지펀딩 추가 (20190519) -->
				
		            <div class="row-wrap">
		                <span class="row-title">
		                	<input class="chk-etc-point" type="checkbox" data-etc-point="bluemembers" id="bluePointCheck" onclick="useBluePointPop('bluemembers');">
		                	<a class="btn-etc-point">블루멤버스</a>
		                </span>
		                <span class="row-value" id="useBluePointAmt" name="useBluePointAmt" disabled="disabled">0P</span>
		            </div>
		        
			
        </div>
        <div class="popup-footer fix-footer">
            <button class="btn-confirm" onclick="etcPointTotal(); backStateLayerPopup();">선택 완료</button>
        </div>
    </div>
    <!--//포인트 팝업-->

    <!--결제수단 선택 팝업-->
    <div class="popup-payment-select">
        <div class="popup-header">
            <h3>결제수단 선택</h3>
        </div>
        <div class="popup-content">
            <div class="payment-select-area">
                <div class="payment-wrap">
                    
                        <a href="javascript:;" class="type-hmallpay">
                            <input type="hidden" name="pay" value="hpay">
                            <span class="ico-payment">Hmall pay</span>
                        </a>
                    

                    <a href="javascript:;" class="type-card on">
                        <input type="hidden" name="pay" value="1">
                        <span class="ico-payment">카드결제</span>
                    </a>

                    <!-- KT 래퍼코드 a92로 진입시 ISP, 간편결제 히든처리 -->
                    
                        
                            
                                <!-- 펀딩 상품이 아닐때 휴대폰 결제 노출 -->
                                
                                    <a href="javascript:;" class="type-phone">
                                        <input type="hidden" name="pay" value="3">
                                        <span class="ico-payment">휴대폰 결제</span>
                                    </a>
                                
                            

                            
                                
                                    <!-- 펀딩 상품이 아닐때 무통장입금 노출 -->
                                    
                                        <a href="javascript:;" class="type-bankacc">
                                            <input type="hidden" name="pay" value="4">
                                            <span class="ico-payment">무통장 입금</span>
                                        </a>
                                    
                                
                            
                            <!-- 무통장 중복해서 보여서 삭제처리합니다. - 김기호
                                        <a href="javascript:;" class="type-bankacc">
                                            <input type="hidden" name="pay" value="4" />
                                            <span class="ico-payment">무통장 입금</span>
                                        </a>
                             -->
                            
                            	
	                                <!-- 펀딩 상품이 아닐때 nfc 결제 노출 -->
                                    
                                     	<a href="javascript:;" class="type-nfc" style="display: none;">
                                            <input type="hidden" name="pay" value="nfc">
                                            <span class="ico-payment">NFC결제</span>
                                        </a>
                                    
                                

                                
                                    <!-- 펀딩 상품이 아닐때 페이코 노출 -->
                                    
                                        <a href="javascript:;" class="type-payco">
                                            <input type="hidden" name="pay" value="payco">
                                            <span class="ico-payment">PAYCO</span>
                                        </a>
                                    
                                

                                
                                    <a href="javascript:;" class="type-samsungpay">
                                        <input type="hidden" name="pay" value="samsungpay">
                                        <span class="ico-payment">삼성페이</span>
                                    </a>
                                

                                
                                    <!-- 펀딩 상품이 아닐때 네이버페이 노출 -->
                                    
                                        <a href="javascript:;" class="type-naverpay">
                                            <input type="hidden" name="pay" value="naverpay">
                                            <span class="ico-payment">네이버페이</span>
                                        </a>
                                    
                                

                                
                                    <!-- 펀딩 상품이 아닐때 스마일페이 노출 -->
                                    
                                        <a href="javascript:;" class="type-smilepay">
                                            <input type="hidden" name="pay" value="smilepay">
                                            <span class="ico-payment">스마일페이</span>
                                        </a>
                                    
                                

                                
                                    <!-- 펀딩 상품이 아닐때 카카오페이 노출 -->
                                    
                                        <a href="javascript:;" class="type-kakaopay">
                                            <input type="hidden" name="pay" value="newkakaopay">
                                            <span class="ico-payment">카카오페이</span>
                                        </a>
                                    
                                

                                
                                    <!-- 펀딩 상품이 아닐때 토스 노출 -->
                                    
                                        <a href="javascript:;" class="type-toss">
                                            <input type="hidden" name="pay" value="toss">
                                            <span class="ico-payment">토스</span>
                                        </a>
                                    
                                
                                
								
                                    
                                        <!-- 펀딩 상품이 아닐때 상담원결제 노출 -->
                                        
                                            <a href="javascript:;" class="type-ars">
                                                <input type="hidden" name="pay" value="callpay">
                                                <span class="ico-payment">상담원 결제</span>
                                            </a>
                                        
                            		
                        		
                            
                        
                    
                </div>
            </div>
            <div class="payment-option-area" style="">
                <div class="bankacc-option-area" style="display:none" id="selectBank">
                    <select class="" name="wibkBankCd" id="wibkBankCd">
                        <option value="">입금은행을 선택해 주세요.</option>
                        
                            <option value="004">KB국민은행</option>
                        
                            <option value="026">신한은행</option>
                        
                            <option value="020">우리은행</option>
                        
                            <option value="081">KEB하나은행</option>
                        
                            <option value="011">NH농협</option>
                        
                            <option value="071">우체국</option>
                        
                            <option value="005">KEB하나은행(구.외환)</option>
                        
                            <option value="032">부산은행</option>
                        
                            <option value="031">대구은행</option>
                        
                            <option value="039">경남은행</option>
                        
                    </select>
                    <div class="duedate">입금마감일 : <strong>2021-06-02</strong></div>
                    <p>
                        고객전용 계좌번호가 생성됩니다.<br>
                        주문 완료 화면에서 확인하실 수 있습니다.<br>주문완료 후 2일 이내 입금하지 않으면 주문이 취소됩니다.<br>1~2시간 이후에 고객님의 휴대폰으로 안내됩니다.
                    </p>
                    <div class="bankacc-name-area">
                        <span>입금자명 : </span>
                        
                            
                                <input type="text" class="type-underline" name="wibkCustNm" id="uName" placeholder="홍길동" value="주찬영" maxlength="10">
                            
                            
                        
                        <span class="txt-orange">*실제 입금자명과 동일하게 입력</span>
                    </div>
                    
	                    
	                
	                    
	                
	                    
	                
	                    
	                
	                    
	                
	                    
	                
	                    
	                
	                    
	                

                    <input type="hidden" id="sms01" name="wibkAcntSmsYn" value="Y">
                    <input type="hidden" id="sms02" name="wibkIamtInfSmsYn" value="Y">
                </div>

                <div class="card-option-area" id="pay1" style="">
                    
                    <div class="card-select-area">
                        <select name="stlmCrdInf" class="selectsub_card" id="stlmCrdInf" onchange="selectCrdcCd(this);">
                            <option value="">신용카드 선택</option>
                            
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="04|N|4|06">현대카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="02|N|2|04">삼성카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="03|I||02">KB국민카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="07|N|6|08">신한카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="01|I||01">비씨카드(페이북)</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="08|N|5|07">롯데카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="40|N|14|09">농협NH카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="10|N|11|12">하나카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="06|N|1|03">하나카드(구.외환)</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="20|N|7|10">씨티카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="99|I||01">우리카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="16|I||02">카카오뱅크</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="90|I||">케이뱅크</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="15|I|9|">광주카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="13|I|10|">전북VISA</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="11|I|8|">수협VISA</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="12|I|6|">제주VISA</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="42|I||">MG새마을금고</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="41|I||">우체국체크카드</option>
                                
                            
                                <!-- 현대스마일카드 노출제외 -->
                                <option value="44|I||01">산림조합카드</option>
                                
                            
                                
                            
                        </select>

                        <select class="selectsub_installment" id="allotMonth" name="allotMonth" onchange="chgAllotMonth(this);">
                        <option value="0" class="Color1">일시불</option><option value="2" longwintpopyn="Y" class="color-ff5340">무이자 02개월</option><option value="3" longwintpopyn="Y" class="color-ff5340">무이자 03개월</option><option value="4" longwintpopyn="Y" class="color-ff5340">무이자 04개월</option><option value="5" longwintpopyn="Y" class="color-ff5340">무이자 05개월</option><option value="6" longwintpopyn="Y" class="color-ff5340">무이자 06개월</option><option value="7">유이자 07개월</option><option value="8">유이자 08개월</option><option value="9">유이자 09개월</option><option value="10">유이자 10개월</option><option value="11">유이자 11개월</option><option value="12">유이자 12개월</option><option value="13">유이자 13개월</option><option value="14">유이자 14개월</option><option value="15">유이자 15개월</option><option value="16">유이자 16개월</option><option value="17">유이자 17개월</option><option value="18">유이자 18개월</option></select>
                    </div>
                    
                   <div class="card-point-area smileCrdArea" style="display: none;">
                                <input type="checkbox" id="smileCrdpoint1" name="smileCrdPoint" onchange="smileCardPointChg(this);">
                                <label for="smileCrdpoint1">
                                                                    스마일카드 사용결제
                                </label>
                    </div> 
                    <span class="payment-notice" id="payshotDesc" style="display: none;">※복지카드 결제 시, 즉시/청구 할인 중복적용 불가<br> ※ 현대카드 페이샷(PayShot) 결제 시, 복지포인트 사용 불가</span>

                     <!-- <span class="payment-notice marginB10 crd01 crd03 crd11 crd12 crd13 crd30">
                        <input type="radio" id="rdo1 safe" name="paymentType" value="safe"><label for="rdo1 safe">페이북/ISP</label>
                    </span> -->

                    <div class="card-point-area crdPntArea" style="">
                        
                            
                                <input type="checkbox" id="point" name="cardPoint" value="Y" onchange="cardPointChg(this);">
                                <label for="point">
                                    <input type="hidden" name="mPoint" value="Y">
                                    카드사 포인트 사용
                                </label>
                                <a class="btn-helper btn-slpopup" data-sub-lpopup="popup-guide-card-point" href="javascript:;">도움말</a>
                            
                            
                        

                        <div id="noCardPointmsg" style="display:none;">
                            (무이자 20개월 이상 포인트 사용 제한)
                        </div>

                    </div>
                    
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    
                        
                    

                    

                    
                    <div name="pay1CardPrmo" style=""><span class="payment-notice"><strong>현대카드</strong> 결제 후 <strong>7%</strong> 즉시할인 받으시면 <strong>1,385,700원</strong> 입니다.</span><div class="sub-area">표시되는 즉시할인 예상금액은 1인당 일 최대 즉시할인 한도에 따라 달라질 수 있습니다. (이벤트안내 참고)</div></div>

                </div>
                
                
                
                    
	                    
	                    
	                    
	                    
	                    
	                    
	                    
	                     <!-- ft014_20190926_2019프로젝트HMALL_HmallPay 추가 -->
	                        
	                            <div class="sub-area pay13" style="display:none;">
	                                <p>HmallPay로 50,000원 이상 결제시
			                            
			                                
			                                    1%
			                                
			                                
			                            
			                             <!-- ft014_20190815_2019프로젝트HMALL_HmallPay 추가 -->
			                            H.Point적립 <!-- ft014_20190815_2019프로젝트HMALL_HmallPay 추가 -->
			                            <br>
			                             <!-- ft014_20190815_2019프로젝트HMALL_HmallPay 추가 -->
			                            <br>
			                            모바일에서 현금간편결제 Hmall Pay 5만원 이상 결제 시 H.Point 1% 적립(최대적립액 1만원,21.6.1~6.30)<br><br>※ 상품 출고일 + 7일 후 자동 적립(유효기간 60일)<br>※ 일부 상품 제외<br>※ 결제시점 및 부여시점에 H.Point 회원을 유지하셔야 자동 적립이 됩니다.<br>(결제 완료 후 H.Point 회원을 가입하시면 적립이 되지 않습니다.)<br>
			                        </p>
			                    </div>
			                    
	                        
	                    
	                    
	                    
                    
                
                
                
                
                
                    
                        
                            
                                
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                        
                        <div class="sub-area pay13" style="display:none;">
	                        <p>현금간편 결제(Hmall Pay)는 계좌등록 후 비밀번호 입력 한번으로 쉽고 빠르게 결제할 수 있는 서비스입니다.<br>- 하루 최대 500만원까지 결제가능 (당일 취소금액 포함)<br>- 은행 점검시간 현금간편결제(Hmall Pay) 이용불가</p>
                        </div>
                    
                
                    
                        
                            
                            
                                
                            
                            
                            
                            
                            
                            
                            
                            
                            
                        
                        <div class="sub-area hpDesc" style="display:none;">
	                        <p>휴대폰으로 결제하신 금액은 다음달 휴대폰 요금에 함께 청구됩니다. (한도 50만원)</p>
                        </div>
                    
                
                    
                        
                            
                            
                            
                                
                            
                            
                            
                            
                            
                            
                            
                            
                        
                        <div class="sub-area pay12" style="display:none;">
	                        <p>상담원 결제란 온라인으로 카드 결제가 어려울 경우 상담원과의 전화통화를 통해 결제할 수 있는 서비스 입니다.<br>- 결제하기 이후 주문완료 페이지에서 즉시 상담원 통화를 진행하실 수 있습니다.<br>- Hmall 신용카드 청구할인 적용 제외</p>
                        </div>
                    
                
                    
                        
                            
                            
                            
                            
                            
                                
                            
                            
                            
                            
                            
                            
                        
                        <div class="sub-area pay7" style="display:none;">
	                        <p>- 스마트폰 명의자와 카드 명의자가 동일한 경우에만 삼성페이 서비스에 카드 등록이 가능합니다.<br>- 삼성페이 지원 가능한 단말기는 삼성페이 홈페이지(www.samsung.com/sec/samsung-pay)에서 확인하실 수 있으며, 기타 문의 및 상담은 삼성페이 고객센터(1588-7456)로 문의 바랍니다.<br>- 삼성페이에 등록한 카드를 지문 또는 비밀번호로 인증하여, 안전하고 간편하게 결제할 수 있습니다.<br>- 결제 가능한 카드 : 신한, 삼성, KB, 하나, 현대, 롯데, NH농협, BC(Citi카드 제외)</p>
                        </div>
                    
                
                    
                        
                            
                            
                            
                            
                            
                            
                                
                            
                            
                            
                            
                            
                        
                        <div class="sub-area pay9" style="display:none;">
	                        <p>네이버페이는 네이버ID로 별도 앱 설치 없이 신용카드 또는 은행계좌정보를 등록하여 네이버페이지 비밀번호로 결제할 수 있는 간편결제 서비스 입니다.<br><br>- 결제가능카드 : 신한, 삼성, 현대, BC, 국민, 하나, 롯데, 씨티, NH농협<br>- 결제가능은행 : NH농협, 국민, 신한, 우리, 기업 SC제일, 부산, 경남, 수협, 우체국, 미래에셋대우, 광주, 대구, 전북, 새마을금고, 제주은행<br><br>- 단, 네이버페이로 결제할 경우 네이버페이에서 제공하는 카드사별 무이자, 청구할인 혜택만 제공됩니다.<br>· Hmall 신용카드 청구할인 적용 제외<br>· 무이자 할부도 네이버페이 기준으로 적용</p>
                        </div>
                    
                
                    
                        
                            
                            
                            
                            
                            
                            
                            
                                
                            
                            
                            
                            
                        
                        <div class="sub-area pay10" style="display:none;">
	                        <p>스마일페이는 G마켓/옥션/G9 ID로 별도 앱 설치 없이 신용카드를 등록하여 비밀번호로 결제할 수 있는 간편결제 서비스 입니다.<br><br>- 결제가능카드 : 국내 신용/체크카드<br>- 스마일페이는 신용카드, 은행계좌, 휴대폰 명의자와 SMS 인증받는 휴대폰 명의자가 동일해야 합니다.<br><br>- 단, 스마일페이로 결제할 경우 스마일페이에서 제공하는 카드사별 무이자, 즉시할인 혜택만 제공됩니다.<br>· Hmall 신용카드 즉시할인 적용 제외<br>· 무이자 할부도 스마일페이 기준으로 적용</p>
                        </div>
                    
                
                    
                        
                            
                            
                            
                            
                            
                            
                            
                            
                                
                            
                            
                            
                        
                        <div class="sub-area pay11" style="display:none;">
	                        <p>- 카카오페이(KakaoPay)란? <br>카카오톡 안에서 개인 신용카드(체크카드 포함)을 등록하여 다양한 곳에서 결제시 간단하게 비밀번호만으로 결제할 수 있는 모바일 결제 서비스입니다. 본인명의 휴대폰에서 본인명의 카드 등록 후 사용 가능합니다.<br>- 지원카드 : 모든 신용/체크카드 (하나BC, 국민BC, 신한BC, 시티(체크) 불가)<br>- Hmall 신용카드 즉시할인 적용 제외<br>- 무이자 할부도 카카오페이 기준으로 적용</p>
                        </div>
                    
                
                    
                        
                            
                            
                            
                            
                            
                            
                            
                            
                            
                                
                            
                            
                        
                        <div class="sub-area pay14" style="display:none;">
	                        <p>Toss는 ㈜비바리퍼블리카에서 운영하는 간편송금/결제 서비스이며, 등록된 계좌와 신용카드(체크카드) 통해 쉽게 결제할 수 있는 서비스입니다.<br><br>- Toss 간편결제 (머니/카드)로 결제할 경우 토스에서 제공하는 카드사별 무이자, 청구할인, 결제이벤트만 제공됩니다.<br>- 현금영수증은 자동으로 신청되며, Toss가 직접 발행합니다.<br>- 결제 및 사용관련 문의는 TOSS고객센터(1599-4905 / 24시간 연중무휴)를 이용 바랍니다.</p>
                        </div>
                    
                
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm" onclick="choicePayType('Y');">선택완료</button>
        </div>
    </div>
    <!--//결제수단 선택 팝업-->

    <!--배송주소 팝업-->
    <div class="popup-shipping-addr" id="addrSelect">
        <div class="popup-header">
            <h3>배송지 입력</h3>
        </div>
        <div class="popup-content">
            <ul class="tab ui-enabled">
                <li class="on"><a class="btn-addr-list">배송지 목록</a></li>
                <li><a class="btn-add-addr" onclick="initAddrInput('addrSelect');">배송지 추가</a></li>
            </ul>
            <!--배송지 목록-->
            <div class="addr-list-area" id="addrListArea">

            </div>
            <!--//배송지 목록-->

            <!--배송지 추가-->
            <div class="input-shipping-info newaddress_wrap" id="newaddress_wrap">
                <div class="row-wrap">
                    <span class="row-title marked">받으실 분</span>
                    <span class="row-value"><input class="type-box" type="text" maxlength="10" name="rcvCustNm"></span>
                </div>
                <div class="row-wrap">
                    <span class="row-title marked">배송주소</span>
                    <span class="row-value addr-subinfo-area">
                        <span class="addr-search-wrap"><input class="type-box" type="text" name="dstnPostNo" readonly="true"><button class="btn-grey btn-slpopup" data-sub-lpopup="popup-addr-search" onclick="openPostLayerPup();">우편번호 찾기</button></span>
                        <input class="type-box" type="text" name="newDstnBaseAdr" readonly="true">
                        <input class="type-box" type="text" name="dstnPtcAdr" maxlength="100" placeholder="상세 주소를 입력해 주세요.">
                    </span>
                </div>
                <div class="row-wrap">
                    <span class="row-title marked">전화번호1</span>
                    <span class="row-value phone-number-area">
                        <select class="phone-number-sect1" name="dstnHpIdntNo">
                            
                                <option value="010" selected="selected">010</option>
                            
                                <option value="011">011</option>
                            
                                <option value="016">016</option>
                            
                                <option value="017">017</option>
                            
                                <option value="018">018</option>
                            
                                <option value="019">019</option>
                            
                        </select>
                        <span>-</span>
                        <input class="type-box phone-number-sect2" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="dstnHpIntmNo" maxlength="8" oninput="maxLengthCheck(this);">
                    </span>
                </div>
                <div class="row-wrap">
                    <span class="row-title">전화번호2</span>
                    <span class="row-value phone-number-area">
                        <select class="phone-number-sect1" name="dstnTela">
                            
                                <option value="010">010</option>
                            
                                <option value="011">011</option>
                            
                                <option value="016">016</option>
                            
                                <option value="017">017</option>
                            
                                <option value="018">018</option>
                            
                                <option value="019">019</option>
                            
                                <option value="02" selected="selected">02</option>
                            
                                <option value="031">031</option>
                            
                                <option value="032">032</option>
                            
                                <option value="033">033</option>
                            
                                <option value="041">041</option>
                            
                                <option value="042">042</option>
                            
                                <option value="043">043</option>
                            
                                <option value="044">044</option>
                            
                                <option value="051">051</option>
                            
                                <option value="052">052</option>
                            
                                <option value="053">053</option>
                            
                                <option value="054">054</option>
                            
                                <option value="055">055</option>
                            
                                <option value="060">060</option>
                            
                                <option value="061">061</option>
                            
                                <option value="062">062</option>
                            
                                <option value="063">063</option>
                            
                                <option value="064">064</option>
                            
                                <option value="070">070</option>
                            
                                <option value="080">080</option>
                            
                        </select>
                        <span>-</span>
                        <input class="type-box phone-number-sect2" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="dstnTels" maxlength="8" oninput="maxLengthCheck(this);">
                    </span>
                </div>
                <input type="checkbox" id="baseYn" name="baseYn"><label for="baseYn">기본배송지</label>

                <input type="hidden" name="dstnBaseAdr" value="">
                <input type="hidden" name="adrKndGbcd" value="2"> <!-- 도로명주소로만 신규추가함 -->
                <input type="hidden" name="dstnNknm" value="">
                <input type="hidden" name="dstncustNo" value="201809357435">
                <input type="hidden" name="dstnSeq" value="">
                <input type="hidden" name="updateYn" value="N">
            </div>
            <!--//배송지 추가-->
        </div>
        <div class="popup-footer">
            <button class="btn-confirm" id="dstnBtnConfirm" onclick="dstnBtnConfirm()">선택완료</button>
        </div>
    </div>
    <!--//배송주소 팝업-->

    
        <!--다중배송 팝업-->
        <div class="popup-multi-shipping step1" id="multiaddress4th">
            <div class="popup-header">
                
                
                
                    <h3>여러 곳으로 배송</h3>
                
                
                <span class="progress-bar-area">
                    <span class="progress-bar"></span>
                    <span class="progress-step">
                        <span>1단계</span><span>2단계</span><span>3단계</span>
                    </span>
                </span>
            </div>
            <div class="popup-content">
                <!--1단계-->
                <div class="shipping-step-1">
                    <span>몇 군데로 보내실 예정이신가요?</span>
                    <select onchange="changeMultiAddress(this, 1, 30)" id="multiSelect">option
                        <option value="1">1</option>
                        
                            
                                
                            
                            
                        
                    </select>
                    <input type="hidden" name="multiCnt" value="1">
                </div>
                <!--//1단계-->
                <!--2단계-->
                <div class="shipping-step-2">
                
                    
                    
                    <span>배송지별로 주소를 입력해주세요.</span>
                    <ul class="addr-list">
                        <li>
                            <a class="addr-area btn-input-multi-addr" id="multiaddress_depth2_a1" onclick="goAddrList(this)" ;="">
                                <input type="hidden" name="multiIndex" value="1">
                                <input type="hidden" name="depth2_first_address" value="0">
                                <input type="hidden" name="dstncustNo" value="201809357435">
                                <input type="hidden" name="dstnSeq" value="0000000003">
                                <input type="hidden" name="baseYn" value="Y">
                                <input type="hidden" name="rcvCustNm" value="주찬영">
                                <input type="hidden" name="dstnPostNo" value="05408">
                                <input type="hidden" name="dstnBaseAdr" value="서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)">
                                <input type="hidden" name="dstnPtcAdr" value="101동 404호">
                                <input type="hidden" name="dstnHpIdntNo" value="010">
                                <input type="hidden" name="dstnHpIntmNo" value="2360">
                                <input type="hidden" name="dstnHpBckNo" value="6586">
                                <input type="hidden" name="dstnTela" value="010">
                                <input type="hidden" name="dstnTels" value="6348">
                                <input type="hidden" name="dstnTeli" value="0471">
                                <input type="hidden" name="adrKndGbcd" value="2">
                                <input type="hidden" name="apocGbcd" value="10">
                                <!-- 202008.11 추가배송비 선결제 추가 -->
                                <input type="hidden" name="irgnAreaGbcd" value="">
                                <div class="name">
                                    
                                        
                                            <strong class="txt-orange" id="addressInfoBaseYn_1">배송지1 기본배송지</strong>
                                        
                                        
                                    
                                    <span id="addressInfoCustNm_1">주찬영</span>
                                </div>
                                <div class="addr" id="addressInfoPtcAdr_1">
                                    
                                        
                                            (05408)서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)101동 404호
                                        
                                        
                                    
                                </div>
                                <div class="phone-number" id="addressInfoHpIdntNo_1">
                                    
                                        
                                            010-2360-6586
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                </div>
                                
                                    <div class="phone-number" id="addressInfoDstnTela_1">
                                        
                                            
                                                010-6348-0471
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                    </div>
                                
                            </a>
                        </li>
                    </ul>
                    
                    
                </div>
                <!--//2단계-->
                <!--3단계-->
                <div class="shipping-step-3 multiaddress_depth4">
                    
                    
                    
                    
                        <span>배송지별로 보낼 상품을 선택해주세요.</span>
                    
                    
                    <ul class="shipping-list giftmobileDepth3" id="domestic">
                        <!-- 선물하기 뎁스3 실제 시작-->
                        <li name="domesticDstnLi" class="giftDepth3">
                            <input type="hidden" name="dstncustNo" value="201809357435">
                            <input type="hidden" name="dstnSeq" value="0000000003">
                            <input type="hidden" name="baseYn" value="Y">
                            <input type="hidden" name="rcvCustNm" value="주찬영">
                            <input type="hidden" name="dstnPostNo" value="05408">
                            <input type="hidden" name="dstnBaseAdr" value="서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)">
                            <input type="hidden" name="dstnPtcAdr" value="101동 404호">
                            <input type="hidden" name="dstnHpIdntNo" value="010">
                            <input type="hidden" name="dstnHpIntmNo" value="2360">
                            <input type="hidden" name="dstnHpBckNo" value="6586">
                            <input type="hidden" name="dstnTela" value="010">
                            <input type="hidden" name="dstnTels" value="6348">
                            <input type="hidden" name="dstnTeli" value="0471">
                            <input type="hidden" name="adrKndGbcd" value="2">

                            <input type="hidden" name="depth3_address_chg_1" value="N">
                            <input type="hidden" name="depth3ErrorCode" value="0">
                            <!-- 2020.08.11 추가배송비 지역구분코드 추가  -->
                            <input type="hidden" name="irgnAreaGbcd" value="">

                            <div class="addr-area">
                                
                                
                                
                                    <div class="name">배송지1</div>
                                
                                
                                <div class="addr">
                                    <span id="depth3Nm_1">주찬영</span>
                                    
                                        
                                            <span class="txt-grey">(기본)</span>
                                        
                                        <span id="depth3Add_1">(05408)서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)101동 404호</span>
                                    
                                    
                                </div>
                                
                                <div class="phone-number" id="depth3Hp_1">
                                    
                                        
                                            010-2360-6586
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                        
                                    
                                    
                                </div>

                                
                                    <div class="phone-number" id="depth3Tel_1">
                                        
                                            
                                                010-6348-0471
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                            
                                        
                                    </div>

                                
                                
                            </div>
                            <ul class="shipping-item-area" id="depth3_content_1">
                                
                                    
                                        <li name="itemboxList">
                                            <img src="https://image.hmall.com/static/9/5/18/01/2101185938_0.jpg?RS=80x80&amp;AR=0" class="item-thumb" onerror="noImage(this, '//image.hmall.com/m/img/co/noimg-thumb.png')">
                                            <div class="item-label-area">
                                                <span class="item-label">[나인닷] 비 런닝머신 ND1000 / 홈트레이닝 트레드밀 접이식런...</span>
                                                <span class="option-label">
                                                    
                                                </span>
                                                <span class="price-label">
                                                    
                                                        
                                                        
                                                        
                                                        
                                                            <strong>1,490,000</strong>원
                                                        
                                                    
                                                </span>
                                            </div>
                                            <select name="ordQty" onchange="mulitDlvItemChange(this)">
                                                
                                                    <option>0</option>
                                                
                                                    <option>1</option>
                                                
                                            </select>

                                            <!-- 170711 - 배송메모 텍스트영역, 희망배송일 추가 - rlatkdals --> <!-- 170822 수정 -->
                                            

                                            <input type="hidden" name="slitmCd" value="2101185938">
                                            <input type="hidden" name="uitmCd" value="00001">
                                            <input type="hidden" name="aspItemCd" value="0">
                                            <input type="hidden" name="prsnMsgPossYn" value="N">
                                            <input type="hidden" name="dlvHopeDtDsntYn" value="N">
                                            <input type="hidden" name="hopeDtPlusDay" value="22">
                                            <input type="hidden" name="itemDScfCd" value="S7060101">
                                            <input type="hidden" name="slitmNm" value="[나인닷] 비 런닝머신 ND1000 / 홈트레이닝 트레드밀 접이식런닝머신 워킹머신">
                                            <input type="hidden" name="itemOrdQty" value="1">

                                            <!-- 2020.08.11 추가배송비 선결제 추가  -->
                                            <input type="hidden" name="itemAreaDlvCostAddYn" value="N">
                                            <input type="hidden" name="itemJejuAddDlvCost" value="0">
                                            <input type="hidden" name="itemIrgnAddDlvCost" value="0">
                                            <input type="hidden" name="grpItemNum" value="0">
                                            <input type="hidden" name="ItemNum" value="0">
                                        </li>
                                    
                                
                            </ul>
                            
                            <select class="select-shipping-memo" name="mmsMsgCntn" id="multiaddress_depth4_dlvMemo_1" onchange="changeDlvMemoSelectMulti(this);">
                                <option>요청사항 선택하기</option>
                                
                                <option>부재 시 경비실에 맡겨주세요</option>
                                <option>부재 시 연락주세요</option>
                                <option>배송 전 연락바랍니다</option>
                                <option class="memo-custom" value="5">직접입력(저장됩니다)</option>
                            </select>

                            <span class="input-cnt-wrap shipping-memo" data-maxcnt="100">
                                <span class="input-cnt"><span class="curr-cnt text_count">0</span>/<span class="total-cnt">100</span></span>
                                <textarea placeholder="배송메모를 입력하세요." name="mmsMsgCntnMulti" onkeyup="checkBytes(this, 100)"></textarea>
                            </span>
                            <input type="hidden" name="dsrvCoMsgInfCustInsrYn">
                            
                        </li>
                    </ul>
                </div>
                <!--//3단계-->
            </div>
            <div class="popup-footer">
                <button class="btn-confirm _next" onclick="javascript:reDrawSlick();" id="step1ButtonNext">다음단계</button>
            </div>
        </div>
    
    <!--//다중배송 팝업-->

    <!--반반배송 팝업-->
    
    <!--//반반배송 팝업-->

    <!--특화배송 선택 팝업-->
    <div class="popup-shipping-type-select">
        <div class="popup-header">
            <h3>특화배송 서비스 선택</h3>
        </div>
        <div class="popup-content">
            <ul class="shipping-type-list">
                <li class="shipping-type type1">
                    <span class="label-txt">일반배송</span>
                    <label>
                        <input class="type-check" type="radio" name="shipping-type-select" id="shipping-type1" value="type1" checked="">
                    </label>
                </li>
                
                
                

                
                
            </ul>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm" onclick="specialConfirmBtn()">선택완료 </button>
        </div>
    </div>
    <!--//특화배송 선택 팝업-->

    <!--특화배송 배송정보 입력 팝업-->
    <div class="popup-input-shipping-info">
        <div class="popup-content">
            <input type="hidden" name="specialDstnBaseAdr" value="">

            <!--안심택배함-->
            <div class="input-shipping-info type3">
                <div class="mapfind">
                    <div class="maptitle">
                        <h3>안심택배함 찾기</h3>
                        <button class="btn-popup-close"><span class="hiding">닫기</span></button>
                    </div>
                    <div class="mapfind-head">
                        <div class="selectbox">
                            <label class="sellabel">
                                <select name="siNm" id="siNm" onchange="changeSiNm(this);">
				                    
				                        <option value="경기도">경기도</option>
				                    
				                        <option value="경상남도">경상남도</option>
				                    
				                        <option value="경상북도">경상북도</option>
				                    
				                        <option value="광주광역시">광주광역시</option>
				                    
				                        <option value="대구광역시">대구광역시</option>
				                    
				                        <option value="대전광역시">대전광역시</option>
				                    
				                        <option value="부산광역시">부산광역시</option>
				                    
				                        <option value="서울특별시">서울특별시</option>
				                    
				                        <option value="인천광역시">인천광역시</option>
				                    
				                        <option value="전라남도">전라남도</option>
				                    
				                        <option value="전라북도">전라북도</option>
				                    
				                        <option value="제주특별자치도">제주특별자치도</option>
				                    
				                        <option value="충청남도">충청남도</option>
				                    
				                        <option value="충청북도">충청북도</option>
				                    
                                </select>
                            </label>
                            <label class="sellabel">
                                <select name="guNm" id="guNmList01">
                                </select>
                            </label>
                        </div>
                        <div class="inputbox">
                            <label class="inplabel">
                                <input type="text" name="searchNm" onkeyup="event.keyCode=='13'?searchSafeAddr():'';" placeholder="안심택배함명 검색">
                            </label>
                            <button class="btn btn-find" onclick="searchSafeAddr();"><i class="icon find"></i><span class="hiding">검색</span></button>
                        </div>
                    </div>
                    <div class="mapfind-body" id="safe_map" style="width: 100%; min-height: 977px; height: 977px;">
                        
                    </div>
                    <div class="mapfind-footer" id="safeList">
                        <button class="btn-toggle"><i class="icon"></i><span class="hiding">닫기</span></button>
                        <div class="no-result">검색결과가 없습니다.</div>
                    </div>
                    <div class="mapfind-footer choice" style="display:none;" id="safeSelect"></div>
                    
                </div>
                <!-- //.mapfind -->
            </div>
            <!--//안심택배함-->

            <!--편의점 픽업-->
            <div class="input-shipping-info type5">
                <input class="type-box" type="hidden" readonly="true" name="specialDstnPtcAdr">
                <input class="type-box" type="hidden" readonly="true" name="specialDlvAdr">
                <input class="type-box" type="hidden" readonly="true" name="specialDstnPostNo">
                
                <div class="mapfind">
                    <div class="maptitle">
                        <h3>편의점 픽업 찾기</h3>
                        <button class="btn-popup-close"><span class="hiding">닫기</span></button>
                    </div>
                    <div class="mapfind-head">
                        <div class="selectbox">
                            <label class="sellabel">
                                <select name="siNm" id="siNm" onchange="changeCvsSiNm(this);">
                                    
                                        <option value="강원도">강원도</option>
                                    
                                        <option value="경기도">경기도</option>
                                    
                                        <option value="경상남도">경상남도</option>
                                    
                                        <option value="경상북도">경상북도</option>
                                    
                                        <option value="광주광역시">광주광역시</option>
                                    
                                        <option value="대구광역시">대구광역시</option>
                                    
                                        <option value="대전광역시">대전광역시</option>
                                    
                                        <option value="부산광역시">부산광역시</option>
                                    
                                        <option value="서울시">서울시</option>
                                    
                                        <option value="서울특별시">서울특별시</option>
                                    
                                        <option value="세종특별자치시">세종특별자치시</option>
                                    
                                        <option value="울산광역시">울산광역시</option>
                                    
                                        <option value="인천광역시">인천광역시</option>
                                    
                                        <option value="전라남도">전라남도</option>
                                    
                                        <option value="전라북도">전라북도</option>
                                    
                                        <option value="제주특별자치도">제주특별자치도</option>
                                    
                                        <option value="충청남도">충청남도</option>
                                    
                                        <option value="충청북도">충청북도</option>
                                    
                                </select>
                            </label>
                            <label class="sellabel">
                                <select name="guNm">
                                </select>
                            </label>
                        </div>
                        <div class="inputbox">
                            <label class="inplabel">
                                <input type="text" name="searchNm" onkeyup="event.keyCode=='13'?searchCvsAddr():'';" placeholder="편의점명 검색">
                            </label>
                            <button class="btn btn-find" onclick="searchCvsAddr();"><i class="icon find"></i><span class="hiding">검색</span></button>
                        </div>
                    </div>
                    <div class="mapfind-body" id="cvs_map" style="width: 100%; min-height: 977px; height: 977px;">
                    </div>
                    <div class="mapfind-footer" id="cvsList">
                        <button class="btn-toggle"><i class="icon"></i><span class="hiding">닫기</span></button>
                        <div class="no-result"><strong>검색 결과가 없습니다.</strong><p>찾으시려는 주소에 잘못된 철자가 없는지,<br>정확한 주소인지 다시 한번 확인해 주세요.</p></div>
                    </div>
                    <div class="mapfind-footer choice" style="display:none" id="cvsSelect">
                    </div>
                </div>
                <!-- //.mapfind -->
            </div>
            <!--//편의점 픽업-->

            
                <!--새벽배송-->
                <div class="input-shipping-info type6" id="dawnDlvInfoDiv">
                    <div class="popup-delivery">
                        <div class="popup-header">
                            <h3>배송지 입력</h3>
                        </div>
                        <div class="popup-content tapgroup">
                            <!-- class on 활성화 -->
                            <ul class="tap">
                                <li class="on"><a href="#" class="btn-tap-addr">배송지 목록</a></li>
                                <li><a href="#" class="btn-tap-add" onclick="initAddrInput('dawnDlvInfoDiv');">배송지 추가</a></li>
                            </ul>
                            <!--배송지 목록-->
                            <div class="tapcnt-addr-area tapcnt on" id="shipping-type6-list">
                            </div>
                            <!--//배송지 목록-->
                            <!--배송지 추가-->
                            <div class="tapcnt-info-area tapcnt">
                                <div class="row-wrap">
                                    <span class="row-title marked">받는 분</span>
                                    <span class="row-value"><input class="type-box" type="text" name="specialCustNm" maxlength="10"></span>
                                </div>
                                <div class="row-wrap">
                                    <span class="row-title marked">배송주소</span>
                                    <span class="row-value addr-subinfo-area">
                                        <span class="addr-search-wrap"><input class="type-box" type="text" readonly="true" name="specialDstnPostNo"><button class="btn-slpopup btn-grey" data-sub-lpopup="popup-addr-search" onclick="openPostLayerPup('dawn');">우편번호 찾기</button></span>
                                        <input class="type-box" type="text" readonly="true" name="specialDlvAdr">
                                        <input class="type-box" type="text" name="specialDstnPtcAdr" placeholder="상세 주소를 입력해 주세요." maxlength="150">
                                    </span>
                                </div>
                                <div class="row-wrap">
                                    <span class="row-title marked">전화번호1</span>
                                    <span class="row-value phone-number-area">
                                        <select class="phone-number-sect1" name="specialDlvPhone1">
				                            
				                                <option value="010" selected="selected">010</option>
				                            
				                                <option value="011">011</option>
				                            
				                                <option value="016">016</option>
				                            
				                                <option value="017">017</option>
				                            
				                                <option value="018">018</option>
				                            
				                                <option value="019">019</option>
				                            
                                        </select>
                                        <span>-</span>
                                        <input class="type-box phone-number-sect2" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="specialDlvPhone2" maxlength="8" oninput="maxLengthCheck(this);">
                                    </span>
                                </div>
                                
                                <div class="popup-footer">
                                    <button class="btn-cancel" onclick="closeLayerPopup();">취소</button>
                                    <button class="btn-confirm" onclick="specialDlvBtn();">확인</button>
                                </div>
                            </div>
                            <!--//배송지 추가-->
                        </div>
                    </div>
                </div>
                <!--//새벽배송-->
            

            <!--프리미엄배송-->
            <div class="input-shipping-info type7" id="premDlvInfoDiv">
                <div class="popup-delivery">
                    <div class="popup-header">
                        <h3>배송지 입력 프리미엄</h3>
                    </div>
                    <div class="popup-content tapgroup">
                        <!-- class on 활성화 -->
                        <ul class="tap">
                            <li class="on"><a href="#" class="btn-tap-addr">배송지 목록</a></li>
                            <li><a href="#" class="btn-tap-add" onclick="initAddrInput('premDlvInfoDiv');">배송지 추가</a></li>
                        </ul>
                        <!--배송지 목록-->
                        <div class="tapcnt-addr-area tapcnt on" id="shipping-type7-list">
                        </div>
                        <!--//배송지 목록-->
                        <!--배송지 추가-->
                        <div class="tapcnt-info-area tapcnt">
                            <div class="row-wrap">
                                <span class="row-title marked">받는 분</span>
                                <span class="row-value"><input class="type-box" type="text" name="specialCustNm" maxlength="10"></span>
                            </div>
                            <div class="row-wrap">
                                <span class="row-title marked">배송주소</span>
                                <span class="row-value addr-subinfo-area">
                                    <span class="addr-search-wrap"><input class="type-box" type="text" name="specialDstnPostNo"><button class="btn-slpopup btn-grey" data-sub-lpopup="popup-addr-search" onclick="openPostLayerPup('prem');">우편번호 찾기</button></span>
                                    <input class="type-box" type="text" readonly="true" name="specialDlvAdr">
                                    <input class="type-box" type="text" name="specialDstnPtcAdr" placeholder="상세 주소를 입력해 주세요." maxlength="150">
                                </span>
                            </div>
                            <div class="row-wrap">
                                <span class="row-title marked">전화번호1</span>
                                <span class="row-value phone-number-area">
                                    <select class="phone-number-sect1" name="specialDlvPhone1">
			                            
			                                <option value="010" selected="selected">010</option>
			                            
			                                <option value="011">011</option>
			                            
			                                <option value="016">016</option>
			                            
			                                <option value="017">017</option>
			                            
			                                <option value="018">018</option>
			                            
			                                <option value="019">019</option>
			                            
                                    </select>
                                    <span>-</span>
                                    <input class="type-box phone-number-sect2" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="specialDlvPhone2" maxlength="8" oninput="maxLengthCheck(this);">
                                </span>
                            </div>
                            
                            <div class="popup-footer">
                                <button class="btn-cancel" onclick="closeLayerPopup();">취소</button>
                                <button class="btn-confirm" onclick="specialDlvBtn();">확인</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!--//프리미엄 배송-->
        </div>

    </div>
    <!--//특화배송 배송정보 입력 팝업-->

    <!--스토어픽 선물하기 정보 입력 팝업-->
    <div class="popup-input-gift-info" id="stpicGiftDiv">
        <div class="popup-header">
            <h3>선물하기</h3>
        </div>
        <div class="popup-content">
            <div class="input-shipping-info">
                <input type="hidden" id="saveGiftIndex" value="0">
                <div class="row-wrap">
                    <span class="row-title">받는 분</span>
                    <span class="row-value"><input class="type-box" type="text" name="rcvnCustNm" placeholder="받으시는 분" maxlength="10"></span>
                </div>
                <div class="row-wrap">
                    <span class="row-title">휴대폰번호</span>
                    <span class="row-value phone-number-area">
                        <input class="type-box phone-number-sect2" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="rcvnCustHpTel" placeholder="휴대폰 번호 ('-' 없이 숫자만 입력해주세요)" maxlength="11" oninput="maxLengthCheck(this);">
                    </span>
                </div>
                <div class="row-wrap">
                    <span class="row-title txt-wrap pt15">메세지</span>
                    <span class="row-value">
                        <span class="input-cnt-wrap" data-maxcnt="100">
                            <span class="input-cnt" id="cntnLen">
                                <span class="curr-cnt text_count">0</span>/<span class="total-cnt">100</span>
                            </span>
                            <textarea placeholder="메시지 입력" name="prsnMsg" onkeyup="checkBytes(this, 100)"></textarea>
                        </span>
                    </span>
                </div>
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm" onclick="javascript:fn_setPrsInfo();"> 저장 </button>
        </div>
    </div>
    <!--//스토어픽 선물하기 정보 입력 팝업-->

    <!--휴대폰 본인인증 팝업-->
    <div class="popup-auth-phone bg-grey">
        <div class="popup-header">
            <h3>휴대폰 본인인증</h3>
        </div>
        <div class="popup-content">
            <div class="row-wrap">
                <input class="type-box" id="nonMemberHpNo" type="text" placeholder="휴대폰번호('-' 없이 입력)">
                <button class="btn-white" onclick="nonMemberSmsSend();">인증번호 받기</button>
            </div>
            <div class="auth-code-wrap">
                <input id="smsSelfCertNo" class="type-box" type="text" placeholder="인증번호 6자리">
                <span id="smsCertReftTime" class="auth-timer">5:00</span>
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm" id="nonMemberSmsConfirmBtn" onclick="nonMemberSmsConfirm();" disabled="disabled">확인</button>
        </div>
    </div>
    <!--//휴대폰 본인인증 팝업-->

    <!-- 사은품 선택 -->
    <div class="popup-gift-select">
        <div class="popup-header">
            <h3>사은품 선택</h3>
        </div>
        <div class="popup-content">
            <ul class="item-list" id="giftSelection">

            </ul>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm" onclick="selectGift();">확인</button>
        </div>
    </div>
    <!-- // 사은품 선택 -->
    
</div>
<!--메인 레이어 팝업-->

<!--서브 레이어 팝업-->
<div class="layer-popup order sub-popup">
    <div class="coupon-detail-select dimpop">
        <a class="btn-popup-close" href="javascript:;">닫기</a>
        <div class="popup-header">
            <h3>쿠폰할인</h3>
        </div>
        <div class="popup-content">
            <div class="content-wrap">
                <div><input type="radio" name="coupon-detail-select" id="coupon-detail-1" checked="checked"><label for="coupon-detail-1">적용안함</label></div>
                <div><input type="radio" name="coupon-detail-select" id="coupon-detail-2"><label for="coupon-detail-2">2,000원(추가할인)</label></div>
                <div><input type="radio" name="coupon-detail-select" id="coupon-detail-3"><label for="coupon-detail-3">4,000원(장바구니 할인쿠폰)</label></div>
                <div><input type="radio" name="coupon-detail-select" id="coupon-detail-4"><label for="coupon-detail-4">10,000원(간편결제 전용쿠폰)</label></div>
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm grey">선택 완료</button>
        </div>
    </div>

    

    <!--특화배송 안내 보조팝업-->
    <div class="popup-shipping-guide">
        <div class="guide-contents type3">
            <div class="popup-header">
                <h3>안심 택배함</h3>
            </div>
            <div class="popup-content">
                <img src="https://image.hmall.com/m/img/od/spdelivery/spdelivery-guide-1.png">
            </div>
        </div>
        <div class="guide-contents type4">
            <div class="popup-header">
                <h3>지하철 사물함</h3>
            </div>
            <div class="popup-content">
                <img src="https://image.hmall.com/m/img/od/spdelivery/spdelivery-guide-2.png">
            </div>
        </div>
        <div class="guide-contents type5">
            <div class="popup-header">
                <h3>편의점 픽업</h3>
            </div>
            <div class="popup-content">
                <img src="https://image.hmall.com/m/img/od/spdelivery/spdelivery-guide-3.png">
            </div>
        </div>

        <div class="guide-contents type6">
            <div class="popup-header">
                <h3>새벽배송</h3>
            </div>
            <div class="popup-content">
                <img src="https://image.hmall.com/m/img/od/spdelivery/spdelivery-guide-4.png">
            </div>
        </div>

        <div class="guide-contents type7">
            <div class="popup-header">
                <h3>프리미엄(당일)배송</h3>
            </div>
            <div class="popup-content">
                <img src="https://image.hmall.com/m/img/od/spdelivery/spdelivery-guide-5.png">
            </div>
        </div>
        <div class="guide-contents type8">
            <div class="popup-header">
                <h3>스토어픽</h3>
            </div>
            <div class="popup-content">
                <img src="https://image.hmall.com/hmimg/stp/spdelivery-guide-4.png">
            </div>
        </div>
    </div>
    <!--//특화배송 안내 보조팝업-->

    <!--공동현관 비밀번호 수집동의안내 보조팝업 : 보안성검토 결과에 따라 popup-privacy-policy2 로 변경, 2021.01.31 김기호
    <div class="popup-privacy-policy">
        <div class="popup-header">
            <h3>공동현관 비밀번호 수집 및 이용동의</h3>
        </div>
        <div class="popup-content">
            <table class="guide-table">
                <thead>
                <tr>
                    <th>구분</th>
                    <th>선택</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>수집목적</td>
                    <td>새벽배송서비스 제공</td>
                </tr>
                <tr>
                    <td>수집항목</td>
                    <td>공동현관 비밀번호</td>
                </tr>
                <tr>
                    <td>보유기간</td>
                    <td>회원 탈퇴시 또는<br>법정 의무 보유 기간</td>
                </tr>
                <tr>
                    <td>거부 시<br>불이익 사항</td>
                    <td>새벽배송 이용불가</td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
    -->
    <!--//공동현관 비밀번호 수집동의안내 보조팝업-->

    <div class="popup-card-guide">
        <div class="popup-header">
            <h3>카드 무이자 할부 안내</h3>
        </div>
        <div class="popup-content">
            <table class="guide-table">
                <colgroup>
                    <col width="14%">
                    <col width="22%">
                    <col width="20%">
                    <col width="44%">
                </colgroup>
                <tbody>
                <tr>
                    <th>카드명</th>
                    <th>결제수단</th>
                    <th>금액기준<br>(이상)</th>
                    <th>행사 개월수</th>
                </tr>
                
                    <tr>
                        
                            <td style="text-align:center;" rowspan="3">비씨</td>
                        
                        <td class="highlight-cell" style="text-align:center;">스마일페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">토스결제</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">카카오페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                            <td style="text-align:center;" rowspan="4">KB국민</td>
                        
                        <td class="highlight-cell" style="text-align:center;">신용카드</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">스마일페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">토스결제</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">카카오페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                            <td style="text-align:center;" rowspan="3">삼성</td>
                        
                        <td class="highlight-cell" style="text-align:center;">스마일페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">토스결제</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">카카오페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                            <td style="text-align:center;" rowspan="3">현대</td>
                        
                        <td class="highlight-cell" style="text-align:center;">스마일페이</td>
                        <td style="text-align:center;">1만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6, 7</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">토스결제</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6, 7</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">카카오페이</td>
                        <td style="text-align:center;">1만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6, 7</td>
                    </tr>
                
                    <tr>
                        
                            <td style="text-align:center;" rowspan="2">롯데</td>
                        
                        <td class="highlight-cell" style="text-align:center;">스마일페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">토스결제</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4</td>
                    </tr>
                
                    <tr>
                        
                            <td style="text-align:center;" rowspan="4">신한</td>
                        
                        <td class="highlight-cell" style="text-align:center;">신용카드</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">스마일페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">토스결제</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">카카오페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                            <td style="text-align:center;" rowspan="3">NH농협</td>
                        
                        <td class="highlight-cell" style="text-align:center;">신용카드</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">토스결제</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">카카오페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                            <td style="text-align:center;" rowspan="2">씨티</td>
                        
                        <td class="highlight-cell" style="text-align:center;">신용카드</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                        <td class="highlight-cell" style="text-align:center;">스마일페이</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6</td>
                    </tr>
                
                    <tr>
                        
                            <td style="text-align:center;" rowspan="1">하나</td>
                        
                        <td class="highlight-cell" style="text-align:center;">토스결제</td>
                        <td style="text-align:center;">5만</td>
                        <td class="highlight-cell" style="text-align:center;">2, 3, 4, 5, 6, 7, 8</td>
                    </tr>
                
                </tbody>
            </table>

            
            <ul>
                <li>- 간편결제 (네이버페이/페이코/카카오페이/스마일페이/토스 등) 이용시 해당 간편결제의 무이자 할부 정책 적용<br>  (일반 신용카드 무이자 혜택 불가)<br>- 법인(개인사업자카드 포함)/체크/기프트카드 등 일부 카드 제외<br>- 카드사 제휴몰을 통해 접속 경우 적용 불가<br>- BC카드는 NON-BC카드 불가 <br>- 제휴사이트를 통한 접속 시 무이자 혜택이 제외될 수 있음 <br>※ 별도 고지없이 행사 내용/기간 변경될 수 있으며, 자세한 문의는 각 카드사로 부탁드립니다. </li>
            </ul>
            
        </div>
    </div>

    <!--기타 포인트 팝업 - 하나머니-->
    <div class="popup-etc-point hanamoney">
        <div class="popup-header">
            <h3>하나머니</h3>
        </div>
        <div class="popup-content">
            <input class="type-box" type="text" name="hnmoNm" placeholder="성명" value="">
            <input class="type-box" type="number" name="hnmoHp" maxlength="11" placeholder="전화번호" value="">
            <div class="agreement-area">
                <input type="checkbox" id="privacy-policy-agreement" name="hnmoAgree"><label for="privacy-policy-agreement">개인정보 수집ㆍ이용 동의</label> <a class="btn-section-dropdown btn-areement" href="javascript:;"></a>
                <div class="sub-area agreement-text">
                    하나머니 포인트조회를 위해 성명/전화번호를 수집 및 이용합니다. <strong>(일회성)</strong>
                </div>
            </div>
            <button class="btn-white" onclick="checkHanaMoney('Y');">포인트 조회</button>
            <div class="etc-point-area">
                <div class="row-wrap">
                    <span class="row-title">사용가능 포인트</span>
                    <span class="row-value"><input class="type-box" name="selectHnmoAmt" type="number" onkeydown="onlyNumber(this);" placeholder="" value="" align="right" disabled="disabled"></span>
                </div>
                <div class="row-wrap">
                    <span class="row-title">사용할 포인트 <button class="btn-white br" onclick="useHanaMoneyAll()">모두사용</button></span>
                    <span class="row-value"><input class="type-box" id="useHnmoAmt" name="useHnmoAmt" type="number" onkeydown="onlyNumber(this);" placeholder="" value="" align="right"></span>
                </div>
            </div>
            <input class="type-box" name="hnmoOtp" type="text" placeholder="인증번호를 입력하세요" value="">
            <button class="btn-confirm" onclick="useHanaMoney()">포인트 사용</button>
            <div class="sub-area">
                <ul class="type-dot">
                    <li>하나멤버스 가입시 등록한 아이디/패스워드로 조회하세요.</li>
                    <li>포인트 조회 시 등록한 휴대폰 번호로 인증번호가 발송됩니다.</li>
                </ul>
            </div>
        </div>
    </div>
    <!--//기타 포인트 팝업 - 하나머니-->
    <div class="popup-etc-point culture">
        <div class="popup-header">
            <h3>컬쳐캐쉬</h3>
        </div>
        <div class="popup-content">
            <input class="type-box" type="text" placeholder="컬쳐랜드 아이디" value="" name="culturelandId" id="culturelandId" maxlength="12">
            <input class="type-box" type="password" placeholder="컬쳐랜드 비밀번호" value="" name="culturelandPwd" id="culturelandPwd" maxlength="50">
            <button class="btn-white" onclick="checkCultureCash();">컬쳐캐쉬 조회</button>

            <div class="etc-point-area">
                <div class="row-wrap">
                    <span class="row-title">사용가능 컬쳐캐쉬</span>
                    <span class="row-value"><input class="type-box" type="number" onkeydown="onlyNumber(this);" placeholder="" value="" align="right" name="selectCultureAmt" disabled="disabled"></span>
                </div>
                <div class="row-wrap">
                    <span class="row-title">사용할 컬쳐캐쉬 <button class="btn-white br" onclick="useCultureCashAll();">모두사용</button></span>
                    <span class="row-value"><input class="type-box" type="number" onkeydown="onlyNumber(this);" placeholder="" value="" align="right" id="useCultureAmt" name="useCultureAmt"></span>
                </div>
            </div>
            <button class="btn-confirm" onclick="useCultureCash();">컬쳐캐쉬 사용</button>
            <div class="sub-area">
                <ul class="type-dot">
                    <li>컬쳐캐쉬 조회 및 사용을 위해 위해 회원ID와 비밀번호를 입력하세요.</li>
                    <li>컬쳐랜드 안심금고 및 보안서비스를 이용중인 경우 잔액이 표시되지 않습니다. (컬쳐랜드에서 설정 변경 후 이용)</li>
                </ul>
            </div>
        </div>
    </div>
    
	<div class="popup-etc-point bluemembers">
        <div class="popup-header">
            <h3>블루멤버스</h3>
        </div>
        <div class="popup-content">
            <input class="type-box" type="text" name="bluePointCardNo" id="bluePointCardNo" placeholder="카드번호 16자리 입력" value="" onkeydown="blpntValidChk(this);">
            <input class="type-box" type="password" name="bluePointCardPwd" id="bluePointCardPwd" placeholder="카드비밀번호 4자리 입력" value="" onkeydown="blpntValidChk(this);">
            <div class="agreement-area">
                <input type="checkbox" id="privacy-policy-agreement-bluemembers" name="bluePointAgree"><label for="privacy-policy-agreement-bluemembers">개인정보 수집ㆍ이용 동의</label> <a class="btn-section-dropdown btn-areement" href="javascript:;"></a>
                <div class="sub-area agreement-text">
                    제공받는자 : ㈜타미마케팅
                    <br><br>
                    <ul class="type-dot">
                        <li>제공목적 : 현대자동차블루멤버스 조회 및 사용</li>
                        <li>제공하는 항목 : 개인 식별 정보 블루멤버스 카드번호/비밀번호</li>
                        <li>보유 및 이용기간 : 서비스제공기간 (관련법령의 규정에 의하여 보존할 필요가 있는 경우 및 사전동의를 득한 경우 해당 보유기간)</li>
                    </ul>
                    <br>
                    회원님은 동의를 거부하실 권리가 있으나, 동의 거부 시 현대자동차블루멤버스 사용서비스를 위한 최소한의 정보가 제공되지 않아, 해당 서비스를 이용하실 수 없습니다.
                </div>
            </div>
            <button class="btn-white" onclick="checkBluePoint();">포인트 조회</button>
            <div class="etc-point-area">
                <div class="row-wrap">
                    <span class="row-title">사용가능 포인트</span>
                    <span class="row-value"><input class="type-box" type="number" id="selectBluePointAmt" name="selectBluePointAmt" onkeydown="onlyNumber(this);" placeholder="" value="" align="right" disabled="disabled"></span>
                </div>
                <div class="row-wrap">
                    <span class="row-title">사용할 포인트 <button class="btn-white br" onclick="useBluePointAll();">모두사용</button></span>
                    <span class="row-value"><input class="type-box" type="number" id="useBluePointAmt" name="useBluePointAmt" onkeydown="onlyNumber(this);" placeholder="" value="" align="right"></span>
                </div>
            </div>
            <button class="btn-confirm" onclick="useBluePoint();">포인트 사용</button>

            <div class="sub-area">
                <ul class="type-dot">
                    <li>현대자동차 블루멤버스 가입 카드번호/카드비밀번호로 조회하세요.</li>
                </ul>
            </div>
        </div>
    </div>

    <!--상품권 결제안내 팝업-->
    <div class="popup-voucher-guide">
        <div class="popup-header">
            <h3>지류상품권 결제 안내</h3>
        </div>
        <div class="popup-content">
            <h4>사용가능한 상품권</h4>
            현대백화점, 삼성, 현대오일뱅크, 국민관광, GS칼텍스
            <div class="sub-area type-box">
                <h4>1. 등기우편 발송방식</h4>
                <ol>
                    <li>해당 상품권을 선택하여 주문완료</li>
                    <li>우편물에 상품권을 동봉하고,<br>
                        주문번호, 주문고객명, 환불계좌번호/예금주명이 기재된 메모와 함께 <span class="txt-orange">유가증권등기</span>로 발송<br>
                        <sub>05328 서울 강동구 올림픽로70길 34<br>현대홈쇼핑 9층 재경팀 상품권 담당자</sub>
                    </li>
                    <li>상품권이 정상접수된 후 주문 처리 완료</li>
                </ol>
            </div>

            <div class="sub-area type-box">
                <h4>2. 현대백화점 방문 후 전환(현대백화점 상품권만)</h4>
                <ol>
                    <li>현대백화점 상품권 데스크 방문<br>(상품권, 신분증 지참)</li>
                    <li>전환신청 및 등록(본인만 가능)</li>
                    <li>신청/등록 후 익일 이후 전환금 부여</li>
                </ol>
            </div>

            <div class="sub-area">
                <h4>등기우편 발송방식 유의사항</h4>
                <ul class="type-dot">
                    <li>유가+증권등기 발송시 주문고객과 동일한 이름으로 발송하셔야 합니다.</li>
                    <li>서로 다른 상품권과 함께 사용하실 수 없습니다.</li>
                    <li>현대백화점 상품권은 유가증권등기 수수료만큼 적립금로 돌려 드립니다. (기타 상품권은 유가증권등기 수수료를 고객이 부담하셔야 합니다.)</li>
                    <li>상품권 금액의 60% 이상 결제하셔야 결제 잔액에 대해 환불이 가능합니다.</li>
                    <li>유가증권등기로 보내지 않을 경우 발생하는 문제에 대해서는 책임 지지 않습니다.</li>
                    <li>기프트 선불카드(신용카드)는 지류상품권이 아닙니다. 상기 주소로 보내셔도 결제가 불가능하니 유의하시기 바랍니다.</li>
                </ul>

                <h4>백화점 방문 후 전환 방식 유의사항</h4>
                <ul class="type-dot">
                    <li>상품권으로 결제했을 경우, 반드시 1600-0000에서 예치금으로 재결제하시기 바랍니다.</li>
                    <li>현금 환불은 전환금의 60% 이상 사용해야 하며, 잔액이 5만원 미만인 경우에만 현금으로 돌려드립니다.</li>
                    <li>전환 한도는 ID 1개당 월 1천만원으로 제한됩니다.</li>
                </ul>
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//상품권 결제안내 팝업-->

    <!--배송지수정 팝업-->
    <div class="popup-edit-shipping-addr">
        <div class="popup-header">
            <h3>배송지 수정</h3>
        </div>
        <div class="popup-content">
            <div class="input-shipping-info newaddress_wrap" id="updateAddress_wrap">
                <div class="row-wrap">
                    <span class="row-title marked">받으실 분</span>
                    <span class="row-value"><input class="type-box" type="text" maxlength="10" name="rcvCustNm"></span>
                </div>
                <div class="row-wrap">
                    <span class="row-title marked">배송주소</span>
                    <span class="row-value addr-subinfo-area">
                            <span class="addr-search-wrap"><input class="type-box" type="text" name="dstnPostNo" readonly="true"><button class="btn-slpopup btn-grey" data-popup-hiding="true" data-sub-lpopup="popup-addr-search" onclick="openPostLayerPup();">우편번호 찾기</button></span>
                            <input class="type-box" type="text" name="newDstnBaseAdr" readonly="true">
                            <input class="type-box" type="text" name="dstnPtcAdr" placeholder="상세 주소를 입력해 주세요." maxlength="150">
                        </span>
                </div>
                <div class="row-wrap">
                    <span class="row-title marked">전화번호1</span>
                    <span class="row-value phone-number-area">
                            <select class="phone-number-sect1" name="dstnHpIdntNo">
                                
                                    <option value="010" selected="selected">010</option>
                                
                                    <option value="011">011</option>
                                
                                    <option value="016">016</option>
                                
                                    <option value="017">017</option>
                                
                                    <option value="018">018</option>
                                
                                    <option value="019">019</option>
                                
                            </select>
                            <span>-</span>
                            <input class="type-box phone-number-sect2" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="dstnHpIntmNo" maxlength="8" oninput="maxLengthCheck(this);">
                        </span>
                </div>
                <div class="row-wrap">
                    <span class="row-title">전화번호2</span>
                    <span class="row-value phone-number-area">
                            <select class="phone-number-sect1" name="dstnTela">
                                
                                    <option value="010">010</option>
                                
                                    <option value="011">011</option>
                                
                                    <option value="016">016</option>
                                
                                    <option value="017">017</option>
                                
                                    <option value="018">018</option>
                                
                                    <option value="019">019</option>
                                
                                    <option value="02" selected="selected">02</option>
                                
                                    <option value="031">031</option>
                                
                                    <option value="032">032</option>
                                
                                    <option value="033">033</option>
                                
                                    <option value="041">041</option>
                                
                                    <option value="042">042</option>
                                
                                    <option value="043">043</option>
                                
                                    <option value="044">044</option>
                                
                                    <option value="051">051</option>
                                
                                    <option value="052">052</option>
                                
                                    <option value="053">053</option>
                                
                                    <option value="054">054</option>
                                
                                    <option value="055">055</option>
                                
                                    <option value="060">060</option>
                                
                                    <option value="061">061</option>
                                
                                    <option value="062">062</option>
                                
                                    <option value="063">063</option>
                                
                                    <option value="064">064</option>
                                
                                    <option value="070">070</option>
                                
                                    <option value="080">080</option>
                                
                            </select>
                            <span>-</span>
                            <input class="type-box phone-number-sect2" type="number" onkeydown="onlyNumber(this);" pattern="[0-9]*" inputmode="numeric" min="0" name="dstnTels" maxlength="8" oninput="maxLengthCheck(this);">
                        </span>
                </div>
                <input type="checkbox" name="baseYn"><label for="baseYn">기본배송지</label>

                <input type="hidden" name="dstnBaseAdr" value="">
                <input type="hidden" name="adrKndGbcd" value="2"> <!-- 도로명주소로만 신규추가함 -->
                <input type="hidden" name="dstnNknm" value="">
                <input type="hidden" name="dstncustNo" value="201809357435">
                <input type="hidden" name="dstnSeq" value="">
                <input type="hidden" name="updateYn" value="N">
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm" onclick="saveDstnAddr('Y');">저장</button>
        </div>
    </div>
    <!--//배송지수정 팝업-->

    <!--개인정보 수집/이용 동의 팝업-->
    <div class="popup-agreement-userinfo bg-grey">
        <div class="popup-header bg-white">
            <h3>개인정보 수집/이용 동의</h3>
        </div>
        <div class="popup-content">
            <!--유형에 따라서 노출/비노출 처리-->
            <div class="section-guide">
                <ul class="type-dot">
                    <li>고객님께서 본 화면에서 제공하신 정보(성명, 전화번호)는 무형 상품, 장기할부 관련 상품 및 서비스 안내, 계약 체결을 위하여 이용할 수 있습니다.</li>
                    <li>이용 기간 및 보유 기간은 2년입니다.<br>(당사 회원일 경우 동의 철회시까지 이용 및 보유)</li>
                    <li>고객님께서 동의 철회를 원하실 경우 1600-0000으로 연락주시기 바랍니다.</li>
                </ul>
            </div>
            <div class="section-guide mt10">
                <h4>고객님에게서 보험/상조/재무설계 관련 상품 및 서비스 안내에 필요한 최소한의 개인정보를 수집하고 있습니다.</h4>
                <ul class="type-decimal">
                    <li>고객님께서 본 화면에서 제공하신 정보(성명, 전화번호)는 무형 상품, 장기할부 관련 상품 및 서비스 안내, 계약 체결을 위하여 이용할 수 있습니다.</li>
                    <li>이용 기간 및 보유 기간은 2년입니다.<br>(당사 회원일 경우 동의 철회시까지 이용 및 보유)</li>
                    <li>고객님께서 동의 철회를 원하실 경우 1600-0000으로 연락주시기 바랍니다.</li>
                </ul>
            </div>
            <div class="section-guide mt10">
                <p>보험/상조/재무설계 관련 상품 및 서비스 안내에 필요한 최소한의 개인정보를 수집하고 있습니다.</p>
                <h4>수집 · 이용목적</h4>
                <ul class="type-dot">
                    <li>고객님께서 본 화면에서 제공하신 정보(성명, 전화번호)는 무형 상품, 장기할부 관련 상품 및 서비스 안내, 계약 체결을 위하여 이용할 수 있습니다.</li>
                </ul>
                <h4>개인정보 수집 항목</h4>
                <ul class="type-dot">
                    <li>성명, 전화번호, 생년월일, 성별(기존회원일 시)</li>
                </ul>
                <h4>보유 및 이용 기간</h4>
                <ul class="type-dot">
                    <li>목적 달성시 또는 동의 철회시까지</li>
                </ul>
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//개인정보 수집/이용 동의 팝업-->

    <!--개인정보 제 3자 제공 동의 팝업-->
    <div class="popup-agreement-provide-info bg-grey">
        <div class="popup-header bg-white">
            <h3>개인정보 제 3자 제공 동의</h3>
        </div>
        <div class="popup-content">
            <div class="section-guide">
                <h4>제공받는 자</h4>
                <ul class="type-dot">
                    
                        
                        
                            <li>메가(주)</li>
                        
                    
                </ul>
                <h4>제공항목</h4>
                <ul class="type-dot">
                    
                        
                        
                            <li>성명, 연락처, 생년월일, 거주지역, 성별(기존회원일 시)</li>
                        
                    
                </ul>
                <h4>제공목적</h4>
                <ul class="type-dot">
                    
                        
                        
                            <li>재무설계 관련 상품 및 서비스 안내</li>
                        
                    
                </ul>
                <h4>보유 및 이용 기간</h4>
                <ul class="type-dot">
                    
                        
                        
                            <li>목적 달성시 또는 동의 철회시까지</li>
                        
                    
                </ul>
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//개인정보 수집/이용 동의 팝업-->

    <!--쇼핑정보 및 기타 마케팅 수신 동의 팝업-->
    <div class="popup-agreement-marketing bg-grey">
        <div class="popup-header bg-white">
            <h3>쇼핑정보 및 기타 마케팅</h3>
        </div>
        <div class="popup-content">
            <div class="section-guide">
                <h4>개인정보 활용 목적</h4>
                <ul class="type-dot">
                    <li>새로운 서비스/신상품(보험, 상조, 렌탈, 신용카드 상품 포함)이나 이벤트 정보의 안내</li>
                    <li>개인 맞춤서비스의 제공 및 부가서비스 제공을 위한 제휴 협력사의 업무수행에 필요한 자료 제공</li>
                    <li>당사 카탈로그 발송</li>
                </ul>
                <h4>수집 항목</h4>
                <ul class="type-dot">
                    <li>성명, 성별, 법정생년월일, 휴대전화번호, 전화번호, 주소, e-mail, 결제정보</li>
                </ul>
                <h4>개인정보 보유기간</h4>
                <ul class="type-dot">
                    <li>정보제공 거부의사 표현시 혹은 회원탈퇴시까지</li>
                </ul>
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//개인정보 수집/이용 동의 팝업-->

    <!--카드포인트 사용 안내 팝업-->
    <div class="popup-guide-card-point">
        <div class="popup-header">
            <h3>결제가능한 카드 포인트 안내</h3>
        </div>
        <div class="popup-content">
            <ul class="list-type-box">
                <li>
                    <span class="main-label">삼성카드 보너스 포인트</span>
                    <span class="sub-label">1포인트 이상 적립시 사용</span>
                </li>
                <li>
                    <span class="main-label">KB포인트리</span>
                    <span class="sub-label">1점 이상부터 사용</span>
                </li>
                <li>
                    <span class="main-label">비씨TOP포인트</span>
                    <span class="sub-label">1포인트 이상부터 사용</span>
                </li>
                <li>
                    <span class="main-label">마이 신한포인트</span>
                    <span class="sub-label">5천원 이상 적립시 1포인트 단위로 사용 가능</span>
                </li>
                <li>
                    <span class="main-label">하나머니</span>
                    <span class="sub-label">1포인트 이상 적립시 사용</span>
                </li>
                <li>
                    <span class="main-label">시티카드 시티포인트</span>
                    <span class="sub-label">최대 결제금액의 10%까지 1포인트부터 사용 가능</span>
                </li>
                <li>
                    <span class="main-label">현대카드 M포인트</span>
                    <span class="sub-label">최대 결제금액의 10%까지 1포인트부터 사용 가능</span>
                    <span class="sub-label">현대카드 중 일부카드(스마일카드 등) 포인트 사용 제외</span>
                </li>
            </ul>

            <div class="sub-area">
                <h4>결제방법 및 유의사항</h4>
                <ul class="type-dot">
                    <li>포인트가 부족할 경우, 다음과 같은 메시지가 나올 수 있습니다. (유효기간 경과 카드, 할부개월 오류 등)</li>
                    <li>법인카드, 가족카드는 사용이 불가합니다.</li>
                    <li>포인트 관련 사항은 카드사 홈페이지에서 확인할 수 있습니다.</li>
                    <li>포인트 사용시 결제금액에서 포인트가 차감된 금액으로 청구됩니다.</li>
                </ul>
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//카드포인트 사용 안내 팝업-->

    <div class="popup-guide-gift _active" data-popup-stack="1">
            <div class="popup-header">
                <h3>선물하기 안내</h3>
            </div>
            <div class="popup-content">
                <ul class="type-dot">
                    <li>
                        선물 안내 메시지에는 다음과 같은 내용이 들어갑니다.<br>
                        <sub>보내는 분 성함 / 받는 분 성함 / 상품명 / 선물 받는 방법 / 배송지 입력기한 / 배송지 입력 URL</sub><br>
                        <p class="mt10">※ 받는 분이 카카오톡 사용을 안 하거나 현대홈쇼핑 알림톡을 차단한 경우 문자로 전송됩니다.</p>
                    </li>
                    <li>
                        배송지 입력 전, 선물 보내는분(주문자)의 '결제 취소' 또는 받는 분의 '선물 거절'이 가능하며, 결제 시점으로부터 3일 내 배송지 입력이 되지 않은 경우 자동으로 취소/환불 처리됩니다.<br>
                        <p class="mt10">※ 선물 수락/거절/취소 현황은 선물 보내는 분(주문자)의 카카오톡 알림톡 또는 문자로 알려드립니다.</p>
                    </li>
                    <li>사이즈, 색상 등 옵션이 있는 상품은 선물 받는 분이 직접 변경 가능합니다.</li>
                    <li>입력하신 배송지역이 제주/도서산간인 경우 보내는 분(주문자)께 추가배송비가 청구될 수 있습니다.</li>
                </ul>
            </div>
            <div class="popup-footer">
                <button class="btn-confirm confirm-close">확인</button>
            </div>
        </div>


    <!--청구할인 안내 팝업-->
    <div class="popup-notice-card-discount">
        <div class="popup-header">
            <h3>카드 청구할인 안내</h3>
        </div>
        <div class="popup-content">
            <p class="txt-grey">
                함께 주문하는 상품들 중,<br>
                <br>
                ① 카드 청구할인 제외 상품이 포함되었거나<br>
                ② 다른 청구할인율을 가진 상품이 포함되었습니다.<br>
                <br>
                위와 같은 경우, <span class="txt-orange">주문을 하시더라도 청구할인이 적용되지 않사오니</span> 상품별 혜택을 확인하시고 동일한 할인율 상품을 주문 바랍니다.<br>
                <br>
                <span class="sub-txt-label">(청구할인율은 각 상품상세화면 참고)</span>
            </p>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//청구할인 안내 팝업-->

    <!--개인통관고유부호 수집 및 이용 동의-->
    <div class="popup-notice-costoms-id">
        <div class="popup-header">
            <h3>개인통관고유부호 수집 및 이용동의</h3>
        </div>
        <div class="popup-content">
                <table class="guide-table">
                    <colgroup>
                        <col width="20%">
                        <col width="40%">
                        <col width="40%">
                    </colgroup>
                    <thead>
                    <tr>
                        <th>구분</th>
                        <th>필수</th>
                        <th>선택</th>
                    </tr>
                    </thead>
    
                    <tbody>
                    <tr>
                        <td>수집<br>목적</td>
                        <!-- [01/28]_수정(tms : 정보보호 보안성검토용 퍼블수정건 ppt 파일 기준 수정) -->
                        <td>구매상품 배송 및 통관업무 처리</td>
                        <td>수입신고를 위한 고객 편의성 제공 (재사용)</td>
                        <!--// [01/28] -->
                        <!-- [01/28]_수정(tms : 정보보호 보안성검토용 퍼블수정건 ppt 파일 기준 수정 텍스트 변경) -->
                        <!-- <td>해외직배송 상품의 수입신고</td>
                        <td>수입신고를 위한 고객 편의성 제공<br>(재사용)</td> -->
                        <!--// [01/28] -->
                    </tr>
                    <tr>
                        <td>수집<br>항목</td>
                        <td colspan="2">개인통관고유부호</td>
                    </tr>
                    <tr>
                        <td class="bold">보유<br>기간</td>
                        <!-- [01/28]_수정(tms : 정보보호 보안성검토용 퍼블수정건 ppt 파일 기준 수정) -->
                        <td colspan="2" class="bold">법정 의무 보유 기간</td>
                        <!--// [01/28] -->
                        <!-- [01/28]_수정(tms : 정보보호 보안성검토용 퍼블수정건 ppt 파일 기준 수정 텍스트 변경) -->
                        <!-- <td>회원탈퇴 시 또는 법정 의무 보유기간</td>
                        <td>동의 철회시</td> -->
                        <!--// [01/28] -->
                    </tr>
                    <!-- [10/23] 위키126 거부시불이익사항 제거
                    <tr>
                        <td>거부시<br>불이익<br>사항</td>
                        <td>해외직배송 상품 구매 불가</td>
                        <td>없음</td>
                    </tr> -->
                    </tbody>
                </table>
                <!-- [01/28]_수정(tms : 정보보호 보안성검토용 퍼블수정건 ppt 파일 기준 수정) -->
                <ul class="dotlist">
                    <li>개인정보 수집 및 이용에 거부하실 수 있으나, 이 경우 강품 구매가 제한될 수 있습니다. </li>
                </ul>
                <!--// [01/28] -->
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//개인통관고유부호 수집 및 이용 동의-->

    <!-- 카드 무이자 할부 혜택 -->
    

    <!--H.Point 이용안내-->
    <div class="popup-hpoint-guide">
        <div class="popup-header">
            <h3>H.Point 사용 안내</h3>
        </div>
        <div class="popup-content">
            H.Point는 100P 이상부터 사용이 가능합니다. <br>
            H.Point는 소멸 예정일이 가까운 포인트부터 자동으로 사용됩니다.
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//H.Point 이용안내-->

    <!--적립금 이용안내-->
    <div class="popup-reward-guide">
        <div class="popup-header">
            <h3>적립금 안내</h3>
        </div>
        <div class="popup-content">
            적립금은 1,000원 이상부터 사용이 가능합니다.
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//적립금 이용안내-->
    
    <!-- 추가배송비 안내 2020.08.10  추가배송비 선결제-->
    <div class="popup-adddlvcost-guide">
        <div class="popup-header">
            <h3>제주/도서지역 추가 배송비 부과 안내</h3>
        </div>
        <div class="popup-content">
            상품별 배송비, 배송지, 구매 수량에 따라 추가 배송비를 재계산합니다.<br><br>제주/도서지역 주문시, 부분취소/환불이 불가능합니다. 자세한 내용은 고객센터(1600-0000)로 연락하여 주십시오.
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>    
    <!-- // 추가배송비 안내 -->

    <!-- 수령인 배송알림 09/23 -->
    <div class="popup-recipient-delivery-noti">
        <div class="popup-header">
            <h3>수령인 배송알림</h3>
        </div>
        <div class="popup-content">
            <div class="sub-area">
                주문자와 수령인이 서로 다를 경우<br>수령인에게도 배송정보를 함께 알려드립니다.
            </div>
            <p class="etcnoti">수령인 배송알림은 알림톡으로 전송되며 알림톡 수신거부시 SMS로 전송됩니다.</p>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!-- // 수령인 배송알림 09/23 -->

    <!-- 비회원 개인정보 수집이용동의 팝업 -->
    <div class="popup-agreement-nonmember">
        <div class="popup-header bg-white">
            <h3>비회원 주문시 개인정보 수집/이용 항목 안내</h3>
        </div>
        <div class="popup-content">
            <div class="tblwrap">
                <table>
                    <colgroup><col width="14%"><col width="34%"><col width="38%"><col width="14%"></colgroup>
                    <caption></caption>
                    <thead>
                    <tr>
                        <th>구분</th>
                        <!-- [01/28]_수정(텍스트 변경 '수집항목' -> '항목') -->
                        <th>항목</th>
                        <th>이용목적</th>
                        <th>보유기간</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td rowspan="3">필수</td>
                        <td>성명, 성별, 생년월일, 통신사, 휴대폰번호</td>
                        <td>주문시 본인여부 확인, 서비스 이용 및 상담</td>
                        <td class="bd_tp_2 ptb tc" rowspan="4">법정 의무 보유기간</td>
                    </tr>
                    <tr>
                        <td>결제정보(카드정보, 계좌정보, 휴대폰번호)</td>
                        <td>주문 상품의 결제</td>
                    </tr>
                    <tr>
                        <td>배송정보(주문자?수취인 성명, 연락처, 이메일, 배송지 주소)</td>
                        <td>물품 배송</td>
                    </tr>
                    <tr>
                        <td>선택</td>
                        <td>휴대폰번호</td>
                        <td>현금영수증 발급</td>
                    </tr>
                    </tbody>
                </table>
                <div class="notice-area">
                    <ul class="type-dot">
                        <li>고객님은 위와 같이 당사의 개인정보 수집·이용 동의를 거부 할 권리가 있습니다. 그러나, 필수 항목의 동의를 거부할 경우 상품 주문 등 서비스가 제한될 수 있습니다.</li>
                        <li>선택 항목의 동의를 거부할 경우 현금영수증 발급 서비스가 제한될 수 있습니다.</li>
                        <li>비회원의 경우에도 주문 관련 정보는 교환이나 환불, CS의 원활한 처리를 위해 개인정보 유효기간제의 적용을 받아 서비스를 이용하지 않은 1년간 회원정보와 함께 보관하고, 이후 별도·분리된 DB에서 법정보유기간동안 보관됩니다.</li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!-- // 비회원 개인정보 수집이용동의 팝업 -->

    
    <!--공동현관 비밀번호 수집동의안내 보조팝업 // 01/28 asis 그대로 노출-->
    <div class="popup-privacy-policy2">
        <div class="popup-header">
            <h3>공동현관 비밀번호 수집 및 이용동의</h3>
        </div>
        <div class="popup-content">
            <table class="guide-table">
                <thead>
                <tr>
                    <th>구분</th>
                    <!-- [01/28]_수정(내용 수정) -->
                    <th>목적</th>
                    <th>항목</th>
                    <th>보유기간</th>
                    <!--// [01/28] -->
                    <!--  이전콘텐츠
                        <th>선택</th>
                    -->
                </tr>
                </thead>
                <tbody>
                <!-- [01/28]_수정(내용 수정) -->
                <tr>
                    <td>선택</td>
                    <td>새벽배송 서비스 제공</td>
                    <td>공동현관 비밀번호</td>
                     <td class="bold">회원 탈퇴 시 또는 법정의무 보유기간</td>
                </tr>
                <!--// [01/28] -->
                <!--  이전 컨텐츠
                <tr>
                    <td>수집목적</td>
                    <td>새벽배송서비스 제공</td>
                </tr>
                <tr>
                    <td>수집항목</td>
                    <td>공동현관 비밀번호</td>
                </tr>
                <tr>
                    <td>보유기간</td>
                    <td>회원 탈퇴시 또는<br>법정 의무 보유 기간</td>
                </tr>
                <tr>
                    <td>거부 시<br>불이익 사항</td>
                    <td>새벽배송 이용불가</td>
                </tr> -->
                </tbody>
            </table>
            <!-- [01/28]_수정(내용 추가) -->
            <ul class="dotlist">
                <li>공동현관 비밀번호 수집 및 이용에 거부하실 수 있으나, 이 경우 새벽배송 이용이 제한될 수 있습니다.</li>
            </ul>
            <!--// [01/28]_수정(내용 추가) -->
        </div>
        <div class="popup-footer">
            <button class="btn-confirm confirm-close">확인</button>
        </div>
    </div>
    <!--//공동현관 비밀번호 수집동의안내 보조팝업-->


    <!-- 우편번호 찾기 -->
    








<!-- commit시 jsServerV4 -> imgjsServerV4 -->
<script src="https://image.hmall.com/mo/js/js_4.0/gvia/sortableTable.js?8"></script> 
<script src="https://image.hmall.com/mo/js/js_4.0/gvia/zipCodeSearch_Ajax.js?8"></script>
<script src="https://image.hmall.com/mo/js/js_4.0/gvia/zipCodeSearch.js"></script> 

<script type="text/javascript">

// 팝업열기
function openPostLayerPup(specialDlvCd) {
    pushHistory();

	// 통합검색만 사용
	tab_gubun = 3;
	rd_chk_num = 20;
    
    //주소 검색창 화면 선택(일반 or 프리미엄,새벽배송) 및 초기화
    $("#cidoGungu").remove();

    if($("form[name='orderDataForm'] input[name='dawnDlvYn']").val() =="Y"){
        if(specialDlvCd != "dawn"){
            dawnDlvZipCode = "N";
            $("form[name='orderDataForm'] input[name='dawnDlvYn']").val("");
        }
    }

    if($("form[name='orderDataForm'] input[name='premDlvYn']").val() =="Y"){
        if(specialDlvCd != "prem"){
            premDlvZipCode = "N";
            $("form[name='orderDataForm'] input[name='premDlvYn']").val("");
        }
    }

    if($("form[name='orderDataForm'] input[name='premDlvYn']").val() =="Y"
    		|| $("form[name='orderDataForm'] input[name='dawnDlvYn']").val() =="Y"
    		|| $("input[name='myPageDawnDlvYn']").val() == "Y") { 
    	
    	var innnerHtml = "";
        innnerHtml +='<div class="filter-wrap" id="cidoGungu">';
        innnerHtml +='	<select id="cidoItem2" name="cidoItem2">';
        innnerHtml +='		<option>시/도</option>';
        innnerHtml +='	</select>';
        innnerHtml +='	<select id="gunguItem2" name="gunguItem2">';
        innnerHtml +='		<option>시/군/구</option>';
        innnerHtml +='	</select>';
        innnerHtml +='	<span class="list-count" id ="listCount"><em>0</em>건</span>';
        innnerHtml +='</div>';
        
    	$("#addrSearchTip").hide();
    	$("#specialAddrSearchResult").prepend(innnerHtml);
    	$("#specialAddrSearchResult").show();
    }else{
    	
    	var innnerHtml = "";
        innnerHtml +='<div class="filter-wrap" id="cidoGungu">';
        innnerHtml +='	<select id="cidoItem2" name="cidoItem2" onchange="btn_srch(); return false;">';
        innnerHtml +='		<option>시/도</option>';
        innnerHtml +='	</select>';
        innnerHtml +='	<select id="gunguItem2" name="gunguItem2" onchange="btn_srch(); return false;" disabled="disabled" >';
        innnerHtml +='		<option>시/군/구</option>';
        innnerHtml +='	</select>';
        innnerHtml +='	<span class="list-count" id ="listCount"><em>0</em>건</span>';
        innnerHtml +='</div>';
        
        $("#addrSearchTip").show();
        $("#specialAddrSearchResult").hide();
    	$("#addrSearchResult").prepend(innnerHtml);
    }
    
    // 초기화
    clearPopup();
    
    // 시, 도 정보를 가져온다.
    if($('#cidoItem2 option').length <= 1){
        selectStatus();
    }
    
    if($("form[name='orderDataForm'] input[name='premDlvYn']").val() =="Y") {    //프리미엄
        $("p[name='nonPremP']").hide();
        $("div[name='dawnP']").hide();
        $("div[name='premP']").show();
        $("h3[name='nonDawnH']").show();
        $("h3[name='dawnH']").hide();
        
        
    }else if($("form[name='orderDataForm'] input[name='dawnDlvYn']").val() =="Y" || $("input[name='myPageDawnDlvYn']").val() == "Y"){
    	$("p[name='nonPremP']").hide();
        $("div[name='dawnP']").show();
        $("div[name='premP']").hide();
        $("h3[name='dawnH']").show();
        $("h3[name='nonDawnH']").hide();
    }
    else {
        $("p[name='nonPremP']").show();
        $("div[name='dawnP']").hide();
        $("div[name='premP']").hide();
        $("h3[name='nonDawnH']").show();
        $("h3[name='dawnH']").hide();
    }
}

// 주소창 관련 내용 초기화
function clearPopup() {
	
	$("#cidoItem2 option").remove();
	$("#gunguItem2").html("<option value=\"\">시/군/구</option>");
	
	f_frm_addr_reset();
	
    /* $('#zipcodeResult').empty();
    $('#btnMorePostNo').hide();
    $(".guide_example_result").hide();
    $(".guide_example").show(); */
    
    $(".guide_example").show();
    $("#addrSearchResult").hide();
    $("#addrList").empty();
    
    $("input[name=search2]").val("");
}

// 검색버튼
function btn_srch() {
    
	/* if($("#cidoItem2 option:selected").val() == ''){
    alert("시/도를 선택 해주세요");
    return;
	}
	
	if(premDlvZipCode == "Y" || dawnDlvZipCode == "Y") {     //새벽배송추가_조유진
		var gunguItem2 = $("#gunguItem2").val();
		if(gunguItem2 == "" || gunguItem2 == null){
			alert("시/군/구를 선택해 주세요.");
			return ;
		}
	}
	
	fnSortValReset(0);
	$("#now_page").val(1);
	
	$('#zipcodeResult').empty();
	$('#btnMorePostNo').hide();
	$(".guide_example").hide();
	$(".guide_example_result").show();
	
	searchQuery('1'); */
	
	if(premDlvZipCode == "Y" || dawnDlvZipCode == "Y") {     //새벽배송추가_조유진
		if($("#cidoItem2 option:selected").val() == ''){
		    alert("시/도를 선택 해주세요");
		    return;
		}
	
		var gunguItem2 = $("#gunguItem2").val();
		if(gunguItem2 == "" || gunguItem2 == null){
			alert("시/군/구를 선택해 주세요.");
			return ;
		}
	}
	
	if($("#search2").val().length < 2){
		alert("검색어는 2글자 이상 입력하세요.");
		return;
	}
	
	$(".guide_example").hide();
	$("#now_page").val(1);
	$("#addrSearchResult").show();
	$("#addrSearchTip").hide();
	searchQuery('1');
}

// 주소리스트 클릭
function postListOnClick(obj) {

	var tmpPost = $(obj).attr("tmpPost");
	var roadfull = $(obj).attr("roadfull");
	var jibunfull = $(obj).attr("jibunfull");
	var rp_dong = $(obj).attr("rp_dong");
	
	if ($("form[name='orderDataForm'] input[name='premDlvYn']").val() == "Y") {
		
		var premDlvPostNoYn = '';
   	 	$.ajax({
            type: "get"
            , url: "/m/selectChkPremDlvPostNoYn.do"
            ,data: {'postNo':tmpPost}
            , dataType: "json"
            ,async:false
            , success : function(data) {
            	premDlvPostNoYn = data.premDlvPostNoYn;
            }
            , error: function(data) {
            	premDlvPostNoYn = 'E';
            }
        });
   	 	
   	 	if ( premDlvPostNoYn == 'N' ) {
   	 		alert("죄송합니다. 프리미엄배송 대상 지역이 아닙니다");
   	 		return false;
   	 	}
   	 	
   	 	if ( premDlvPostNoYn == 'E' ) {
   	 		alert("오류가 발생하였습니다.\n고객센터로 문의 주시기 바랍니다.");
   	 		return false;
   	 	}

        $(".popup-input-shipping-info").find("input[name='specialDstnBaseAdr']").val(roadfull);
        $(".input-shipping-info.type7").find("input[name='specialDlvAdr']").val(roadfull + " " + rp_dong);
        $(".input-shipping-info.type7").find("input[name='specialDstnPostNo']").val(tmpPost);
        $("input[name='premDstnPtcAdr']").val("");
		/*$("#premNewDstnBaseAdr").html(roadfull + " " + rp_dong);
	    $("#multi_false input[name='dstnBaseAdr']").val(roadfull + " " + rp_dong);
	    $("#multi_false input[name='dstnPostNo']").val(tmpPost);
	    $("input[name='premDstnPtcAdr']").val("");*/
	}
	//20180624_특화배송조유진
	if ($("form[name='orderDataForm'] input[name='dawnDlvYn']").val() == "Y") {
		
		//주문서 페이지에서 새벽배송 주소가능여부 체크
		var dawnDlvPostNoYn = '';
   	 	$.ajax({
            type: "get"
            , url: "/m/selectChkDawnDlvPostNoYn.do"
            ,data: {'postNo':tmpPost}
            , dataType: "json"
            ,async:false
            , success : function(data) {
            	dawnDlvPostNoYn = data.dawnDlvPostNoYn;
            }
            , error: function(data) {
            	dawnDlvPostNoYn = 'E';
            }
        });
   	 	
   	 	if ( dawnDlvPostNoYn == 'N' ) {
   	 		alert("새벽배송이 불가능한 주소입니다.\n새로운 배송지 주소를 입력해주세요.");
   	 		return false;
   	 	}
   	 	
   	 	if ( dawnDlvPostNoYn == 'E' ) {
   	 		alert("오류가 발생하였습니다.\n고객센터로 문의 주시기 바랍니다.");
   	 		return false;
   	 	}

        var cjDawndlvYn = 'N';
        if(cjDawndlvYn == "Y"){
            $("#dawnNewDstnBaseAdr").val(roadfull + " " + rp_dong);
            $("#multi_false input[name='dstnBaseAdr']").val(roadfull + " " + rp_dong);
            $("#multi_false input[name='dstnPostNo']").val(tmpPost);
            $("#dawnDstnPostNo").val(tmpPost);
            $("input[name='dawnDstnPtcAdr']").val("");
        }else{
            $(".popup-input-shipping-info").find("input[name='specialDstnBaseAdr']").val(roadfull);
            $(".input-shipping-info.type6").find("input[name='specialDlvAdr']").val(roadfull + " " + rp_dong);
            $(".input-shipping-info.type6").find("input[name='specialDstnPostNo']").val(tmpPost);
            $("input[name='dawnDstnPtcAdr']").val("");
        }

	}
	else {
		
		// 20180713 변진의 배송지 변경시사용 새벽배송인경우 체크
		if ($("#dawnDlvYn").val() == "Y") {
			var dawnDlvPostNoYn = '';
	   	 	$.ajax({
	            type: "get"
	            , url: "/m/selectChkDawnDlvPostNoYn.do"
	            ,data: {'postNo':tmpPost}
	            , dataType: "json"
	            ,async:false
	            , success : function(data) {
	            	dawnDlvPostNoYn = data.dawnDlvPostNoYn;
	            }
	            , error: function(data) {
	            	dawnDlvPostNoYn = 'E';
	            }
	        });
	   	 	
	   	 	if ( dawnDlvPostNoYn == 'N' ) {
	   	 		alert("죄송합니다. 새벽배송 대상 지역이 아닙니다.");
	   	 		return false;
	   	 	}
	   	 	
	   	 	if ( dawnDlvPostNoYn == 'E' ) {
	   	 		alert("오류가 발생하였습니다.\n고객센터로 문의 주시기 바랍니다.");
	   	 		return false;
	   	 	}
		}

		$(".newaddress_wrap input[name=newDstnBaseAdr]").val(roadfull + " " + rp_dong);
		$(".newaddress_wrap input[name=dstnBaseAdr]").val(roadfull + " " + rp_dong);
		$(".newaddress_wrap input[name=dstnPostNo]").val(tmpPost);
		$(".newaddress_wrap input[name=dstnPtcAdr]").val("");
	}
	
	/*if (appYn == "Y") window.history.back();
	else $("#btnBack").click();*/

    backStateLayerPopup();

}

//새벽배송일 경우 시/군/구 세팅 20180716 특화배송 조유진
var dawnGu = new Array();
var dawnGuList = "";
function selectGuNm(){
	
    var siNmVal= $("#cidoItem2 option:selected").text();
    dawnGu=new Array();
	$.ajax({
        type: "get"
        , url: "/m/selectDawnDlvGuNm.do"
        ,data: {'siNm':siNmVal,'orderYn':'Y'}
        ,dataType: "json"
        ,async:false
        , success : function(data) {
        	for(var i=0;i<data.dawnDlvGuList.length; i++){
        		dawnGu[i]=data.dawnDlvGuList[i].guNm;
        	}
        }
        , error: function(data) {
        }
    });

}

//>버튼
function btn_srch_more(){
    var now_page = $("#now_page").val();
    var now_page = Number(now_page) + 1;
    $("#now_page").val(now_page);
    searchQueryPaging('2', now_page);
}

// <버튼
function btn_srch_less(){
    var now_page = $("#now_page").val();
    var now_page = Number(now_page) - 1;
    $("#now_page").val(now_page);
    searchQueryPaging('2', now_page);
}

function deleteSearch(){
	$("#cidoItem2 option:eq(0)").prop("selected",true);
	$("#gunguItem2").html("<option value=\"\">시/군/구</option>");
	//$("#gunguItem2").prop("disabled", true);
	
	f_frm_addr_reset();
	
    /* $('#zipcodeResult').empty();
    $('#btnMorePostNo').hide();
    $(".guide_example_result").hide();
    $(".guide_example").show(); */
    
	    
    $("#addrSearchResult").hide();
    $("#addrSearchTip").show();
    $("#addrList").empty();
    
    $("input[name=search2]").val("");
} 
</script>

<form name="frm_addr" id="frm_addr">
    <input type="hidden" id="tot_post_str" name="tot_post_str">
    <input type="hidden" id="sidocd" name="sidocd">
    <input type="hidden" id="gungucd" name="gungucd">
    <input type="hidden" id="umdcd" name="umdcd">
    <input type="hidden" id="ricd" name="ricd">
    <input type="hidden" id="inputjusogubun" name="inputjusogubun">
    <input type="hidden" id="roadgungucd" name="roadgungucd">
    <input type="hidden" id="addr" name="addr">
    <input type="hidden" id="dongnm" name="dongnm">
    <input type="hidden" id="searchpostno" name="searchpostno">
    <input type="hidden" id="roadnm" name="roadnm">
    <input type="hidden" id="searchaddr" name="searchaddr">
    <input type="hidden" id="searchbuild" name="searchbuild">
    <input type="hidden" id="bsizonno" name="bsizonno">
    <input type="hidden" id="roadadd2" name="roadadd2">
    <input type="hidden" id="jibunadd2" name="jibunadd2">
    <input type="hidden" id="searchbuild2" name="searchbuild2">
    <input type="hidden" id="tot_post_str2" name="tot_post_str2" value="">
    <input type="hidden" id="districtzonno" name="districtzonno">
    <input type="hidden" id="bsi_mat_jibun" name="bsi_mat_jibun">
    <input type="hidden" id="bsi_mat_road" name="bsi_mat_road">
    <input type="hidden" id="pgyn" name="pgyn" value="Y">
    <input type="hidden" id="pgcd" name="pgcd">
    <input type="hidden" id="recordCall" name="recordCall">
    <input type="hidden" id="eng_addr_yn" name="eng_addr_yn" value="N">
    <input type="hidden" id="nBsizonnoYn" name="nBsizonnoYn" value="N">
    <input type="hidden" id="extendMode" name="extendMode" value="0">
</form>

<input type="hidden" id="jiRecordStRcd" name="jiRecordStRcd">
<input type="hidden" id="jiRecordCnt" name="jiRecordCnt">
<input type="hidden" id="roRecordStRcd" name="roRecordStRcd">
<input type="hidden" id="roRecordCnt" name="roRecordCnt">
<input type="hidden" id="tot_tab_ji_loading" name="tot_tab_ji_loading" value="N">
<input type="hidden" id="tot_tab_ro_loading" name="tot_tab_ro_loading" value="N">

<input type="hidden" id="startrecord" name="startrecord" value="0">
<input type="hidden" id="tot_tab" name="tot_tab">
<input type="hidden" id="tot_jiheader_num" name="tot_jiheader_num">
<input type="hidden" id="tot_roheader_num" name="tot_roheader_num">

<input type="hidden" id="now_page" name="now_page" value="1">
<input type="hidden" id="paging_size" name="paging_size" value="30">

<span class="btn_filter" style="display: none;">
    &nbsp;출력:<select id="road_paging_size" name="road_paging_size"><option value="500">500개</option><option value="200">200개</option><option value="100">100개</option><option value="50">50개</option><option value="40">40개</option><option value="30" selected="selected">30개</option><option value="20">20개</option><option value="10">10개</option></select>
</span>

<div class="popup-addr-search" dg-subdata="popup5" style="height: 500px" id="popupAddrSearch">
	<div class="addr-search-wrap">
		<div class="addr-search-result-wrap" id="specialAddrSearchResult" style="display:none">
            <br>
		</div>
		
	
		<div class="margin-wrap">
	        <span class="input-wrap">
	            <input class="addr-search-input" type="text" placeholder="주소를 입력해 주세요" name="search2" id="search2">
	            <button class="addr-remove-btn" onclick="deleteSearch();">지우기</button>
	            <button class="addr-search-btn" onclick="btn_srch();">찾기</button>
	        </span>
		</div>
        <div class="addr-search-result-wrap" id="addrSearchResult" style="display:none">
            
            <ul class="addr-list" id="addrList">
            	
            </ul>
            <div class="page-nav-area" id="pageArea">
                <button onclick="btn_srch_less();">&lt;</button>
                <span><strong>1</strong> / 100</span>
                <button onclick="btn_srch_more();">&gt;</button>
            </div>

            <div class="no-result margin-wrap" id="noResultAddr" style="display:none">
                <h3>검색 결과가 없습니다.</h3>
                찾으시려는 주소에 잘못된 철자가 없는지,<br>정확한 주소인지 다시한번 확인해 주세요.
            </div>
        </div>
        <div class="addr-search-tip margin-wrap" id="addrSearchTip">
            <h3><span class="addr-search-tip-ico">TIP</span>검색 방법</h3>
            <ul>
                <li>
                    도로명 + 건물번호
                    <span>(예: 판교역로 235, 올림픽로70길)</span>
                </li>
                <li>
                    동/읍/면/리 + 번지
                    <span>(예: 신천동 7-30, 수유동 567-92)</span>
                    
                </li>
                <li>
                    건물명, 아파트명
                     <span>(예: 현대아파트, 주공)</span>
                </li>
            </ul>
        </div>
        
        <div class="delivery-caution-info" name="premP">
            <p class="tit">프리미엄(당일) 배송 유의사항</p>
            <ul class="dotlist">
                <li>당일 00:00 ~ 13:00까지 주문하신 상품을 빠르게 받아보실 수 있습니다. (주문 후 3~5시간 내 배송)</li>
                <li>해당 매장에 상품 재고가 없을 경우, 취소 안내 연락드립니다.</li>
                <li>주말(토/일요일) 및 공휴일은 서비스가 불가합니다.</li>
                <li>서비스 가능 지역 : 서울9개구(강남구, 서구, 마포구, 서대문구, 서초구, 양천구, 영등포구, 용산구)</li>
            </ul>
        </div>
        
            
            
              <div class="delivery-caution-info" name="dawnP">
                  <p class="tit">새벽배송 유의사항</p>
                  <ul class="dotlist">
                      <li>새벽 배송 서비스는 서울 및 경기 일부 지역에 한해 제공됩니다.</li>
                      <li>주문취소는 상품별 주문마감 시간전까지 가능합니다.<br>(Hmall 상품 : ~16시까지 마감)</li>
                      <li>주문마감 시간 이후 주문취소가 어렵다는 점 유의해 주시기 바랍니다.</li>
                      <li>주문마감 시간 이후의 주문 건은 다음 배송일에 순차적으로 새벽배송 됩니다.</li>
                      <li>재판매 불가능 특성상 단순 변심으로 인한 교환이나 반품은 불가합니다.</li>
                      <li>관공서, 학교, 회사, 시장, 백화점 등은 새벽출입에 제한이 있어 배송이 불가합니다.</li>
                      <li>월요일 ~ 금요일 주문 시 다음날 새벽 배송이 가능합니다.<br>※ 토요일, 일요일 및 공휴일 주문 시 익일 새벽배송 불가</li>
                      <li class="bold">금요일 16시 이후 주문 시 차주 화요일 새벽에 배송됩니다.</li>
                  </ul>
              </div>
            
          
    </div>
</div>

    <!-- 특화배송지 찾기 -->
    

<script type="text/javascript">
 
var page =1;
var tagCnt= 0;

$(function () {
	clearSafetyPopup();
    clearCvsPopup();
});

// Enter key check
function keycheckSafe() {   
    if (event.keyCode == 13) {
        btn_safety_search(1);
    }
}

// 안심배송 조회
function btn_safety_search(searchGbn){
    //searchGbn 검색구분 1= 조회 , 2 = 더보기 
    if (searchGbn =='1') {
        $('.zipcode_result').empty();
        page=1;
        tagCnt=0;
    }
    
    var guNm = $("select[name='guNm']").val();
    var siNm = $("select[name='siNm']").val();
    
    
    
    if(guNm == 'N' || siNm == 'N'){
    	alert("'시/도'와 '시/군/구'를 선택해주세요.");
    	return ;
    }
    
    $(".zipcode_result").show();

    $.ajax({
        type: "post"
        , url: "/m/smSafetySearch.do"
        , data: {siNm : siNm, guNm : guNm
            ,page:page}
        , dataType: "json"
        , success : function(data) {
            if(!isEmpty(data.errorMessages)) {
                alert(data.errorMessages.join("\n"));
            }
            else {
                var ul = $(".zipcode_result");
                if (!isEmpty(data) && !isEmpty(data.list) && data.list.length > 0) {

                    $("#noSearchResultNone").hide();
                    for(var i = 0; i < data.list.length; i++) {
                        var post = data.list[i];
                        var liTag = $("<li></li>")
                        var aTag = $(
                            "<a href='javascript://' id ='adata"+tagCnt+"' onclick='setSafetyNetData(this);'>" +
                            "   <span class='list-title'>"+post.siteNm+"</span>" +
                            "   <span class='list-value' id ='adataAdr"+tagCnt+"'>"+post.dstnAdr+"</span>" +
                            "   <span class='list-value'>["+post.dstnPostNo+"]</span>" +
                            "   <input type='hidden' id ='adataBrnNm"+tagCnt+"' value='"+post.siteNm+"' />" +
                            "</a>" +
                            "<div class='wrap-btn'>" +
                            "   <a class='btn-white btn-map-detail' onclick='viewKakaoMap(this,"+tagCnt+");' name='select_map_btn'>지도</a>" +
                            "</div>" +
                            "<div class='map-area' id='select_map"+tagCnt+"'></div>"
                        );

                        aTag.data({
                            dstnPostNo : post.dstnPostNo,
                            dstnBaseAdr : post.dstnBaseAdr,
                            dstnPtcAdr : post.dstnPtcAdr,
                            dstnAdr : post.dstnAdr,
                            siteNm : post.siteNm,
                            siNm : post.siNm,
                            guNm : post.guNm,
                        });
                        liTag.append(aTag);
                        ul.append(liTag);
                        tagCnt++;
                    }
                    
                    if (page*10 < data.totalSafeCnt && data.totalSafeCnt >10) {
                        $('#layerPupListMoreBtn').text("더 보기(" + page*10 + "/" + data.totalSafeCnt + ")");
                        $('.safetyMbtn').show();
                    }
                    else {
                        $('.safetyMbtn').hide();
                    }
                    page++;
                    
                }
                else {
                       $("#noSearchResultNone").show();
                       $('.safetyMbtn').hide();
                }
              }
        }
        , error: function(data) {
            alert("조회에 실패 하였습니다.");
            clearSafetyPopup();
        }
    });  
}


function changeSiNm(obj){
    
	 $("select[name='guNm']").val('N');
	
    var siNm = $(obj).val();
    
    if(siNm == null){
        siNm = "서울특별시";
    }
    
    //alert("siNm : "+siNm);
    
    if(siNm == 'N'){
   	 $("select[name='guNm']").text("");
   	 var html = "<option>시/군/구</option>";
   	 $("select[name='guNm']").append(html);
        return ;
    }

    setSiGbcdNm1(siNm);
   
}

function setSiGbcdNm1(siNm){
    $.ajax({
        type: "post"
        ,url: "/m/oda/selectSafeAddress1.do"
        ,data: {siNm:siNm}
        ,dataType: "json"
        ,contentType:"application/x-www-form-urlencoded;charset=UTF-8"
        ,success : function(data) {
            
            $("select[name='guNm']").text("");
            
            var html = '<option value="N">시/군/구</option>';
            for(var i=0; i<data.guList.length; i++){
                  html += '<option value="'+data.guList[i].guNm+'">'+data.guList[i].guNm+'</option>';                
            }
            
            $("select[name='guNm']").append(html);
        }
    });
    
}

// 안심배송지 선택
function setSafetyNetData(obj) {
    $(".popup-input-shipping-info").find("input[name='specialDstnBaseAdr']").val($(obj).data("dstnBaseAdr"));
    $(".input-shipping-info.type3").find("input[name='specialDstnPtcAdr']").val($(obj).data("dstnPtcAdr"));
    $(".input-shipping-info.type3").find("input[name='specialDlvAdr']").val($(obj).data("dstnBaseAdr") + " "+$(obj).data("dstnPtcAdr"));
    $(".input-shipping-info.type3").find("input[name='specialDstnPostNo']").val($(obj).data("dstnPostNo"));

    //closeSafetyLayerPup();
    clearSafetyPopup();
    backStateLayerPopup();
}

// 안심배송 팝업 초기화 
function clearSafetyPopup(){
    $("#layerPupListMoreBtn").attr("onClick","btn_safety_search('2')");
    $(".zipcode_result").empty();
    $(".zipcode_result").hide();
    $("#siNm").val("N");
    $("#guNmList01").val("N")
    $('.safetyMbtn').hide();
}

// 지도보기 google 지도 연동 
function Safetyviewgui(obj, adata){
	var geocoder = new google.maps.Geocoder();
    var addr=$(obj).data("dstnAdr");
    var lat="";
    var lng="";
    
    var aTag = "<strong>"+$(obj).data('siteNm')+"</strong><br>"+$(obj).data('dstnPostNo');
     
    geocoder.geocode({'address':addr}, function(results, status) {
        if (results != "") {
            var location=results[0].geometry.location;
            lat=location.lat();
            lng=location.lng();
            var latlng = new google.maps.LatLng(lat , lng);
            var myOptions = {
                zoom: 16,
                center: latlng,
                mapTypeControl: true,
                mapTypeId: google.maps.MapTypeId.ROADMAP
            };
            
            var map = new google.maps.Map($(obj).next('#select_map')[0], myOptions);
            var marker = new google.maps.Marker({ 
                position: latlng, 
                map: map, 
                title: "안심배송지" 
            }); 
            var infowindow = new google.maps.InfoWindow({ 
                content: aTag
            }); 
            infowindow.open(map, marker);
        }
        else {
            $(obj).next('#select_map').html("위도와 경도를 찾을 수 없습니다.");
        }
    });
}

// Enter key check
function keycheckCon() {
    if(event.keyCode == 13) {
        btn_search(1);
    }
}

//편의점 조회
function btn_search(searchGbn){
    //searchGbn 검색구분 1= 조회 , 2 = 더보기
    if (searchGbn =='1') {
        $('.zipcode_result').empty();
        page=1;
        tagCnt=0;
    }
    var cvsName= $('#cvs_name').val();
    if (cvsName == ''){
        alert("편의점 명을 입력하세요.");
        return;
    }

    $(".zipcode_result").show();

    $.ajax({
        type: "post"
        , url: "/m/smcvsSearch.do"
        , data: {cvsName:cvsName
            ,page:page}
        , dataType: "json"
        , success : function(data) {
            if(!isEmpty(data.errorMessages)) {
                alert(data.errorMessages.join("\n"));
            }
            else {
                var ul = $(".zipcode_result");
                if (!isEmpty(data) && !isEmpty(data.list) && data.list.length > 0) {

                    $("#noSearchResultNone").hide();
                    for(var i = 0; i < data.list.length; i++) {
                        var post = data.list[i];
                        var liTag = $("<li></li>")
                        //var aTag = $("<a href='javascript://' id ='adata"+tagCnt+"' onclick='setCvsNetData(this);'><p>"+post.cvst_brn_nm+"</p><p>"+post.base_adr+post.ptc_adr+"</p><p>"+post.cvst_brn_tel+"</p></a><button class='small_btn color1' onclick='viewKakaoMap(this,"+tagCnt+");' name='kakaoMapBtn'>지도</button><div id='select_map"+tagCnt+"' style='display:none; width:100%;height:300px;'></div>");

                        var aTag = $(
                            "<a href='javascript://' id ='adata"+tagCnt+"' onclick='setCvsNetData(this);'>" +
                            "   <span class='list-title'>"+post.cvst_brn_nm+"</span>" +
                            "   <span class='list-value' id ='adataAdr"+tagCnt+"' >"+post.base_adr+post.ptc_adr+"</span>" +
                            "   <span class='list-value'>"+post.cvst_brn_tel+"</span>" +
                            "   <input type='hidden' id ='adataBrnNm"+tagCnt+"' value='"+post.cvst_brn_nm+"' />" +
                            "</a>" +
                            "<div class='wrap-btn'>" +
                            "   <a class='btn-white btn-map-detail' onclick='viewKakaoMap(this,"+tagCnt+");' name='kakaoMapBtn'>지도</a>" +
                            "</div>" +
                            "<div class='map-area' id='select_map"+tagCnt+"'></div>"
                        );

                        var adress = "";

                        aTag.data({
                            cvstHofcCd : post.cvst_hofc_cd,
                            cvstBrnCd : post.cvst_brn_cd,
                            cvstBrnNm : post.cvst_brn_nm,
                            dongNm : post.dong_nm,
                            postNo : post.post_no,
                            cvstBrnTel : post.cvst_brn_tel,
                            baseAdr : post.base_adr,
                            ptcAdr : post.ptc_adr,
                            beinDt : post.bein_dt,
                        });
                        liTag.append(aTag);
                        ul.append(liTag);
                        tagCnt++;
                    }

                    if (page*10 < data.totalCnt && data.totalCnt >10){
                        $('#layerPupListMoreBtn').text("더 보기(" + page*10 + "/" + data.totalCnt + ")");
                        $('.cvsMbtn').show();
                    }else {
                        $('.cvsMbtn').hide();
                    }
                    page++;

                } else {
                    $("#noSearchResultNone").show();
                    $('.cvsMbtn').hide();
                    $('.zipcode_result').hide();

                }

            }

        }
        , error: function(data) {
            alert("조회에 실패 하였습니다.");
            clearCvsPopup();
        }
    });

}
//편의점 선택
function setCvsNetData(obj){
    $(".popup-input-shipping-info").find("input[name='specialDstnBaseAdr']").val($(obj).data("baseAdr"));
    $(".input-shipping-info.type5").find("input[name='specialDstnPtcAdr']").val($(obj).data("ptcAdr") + " "+$(obj).data("cvstBrnNm"));
    $(".input-shipping-info.type5").find("input[name='specialDlvAdr']").val($(obj).data("baseAdr") + " "+$(obj).data("ptcAdr"));
    $(".input-shipping-info.type5").find("input[name='specialDstnPostNo']").val($(obj).data("postNo"));

    $("#cvst_brn_nm").val($(obj).data("cvstBrnNm"));
    $("#cvst_brn_tel").val($(obj).data("cvstBrnTel"));

    $("form[name='orderDataForm'] input[name='cvstBrnCd']").val($(obj).data("cvstBrnCd"));
    $("form[name='orderDataForm'] input[name='cvstHofcCd']").val($(obj).data("cvstHofcCd"));
    $("form[name='orderDataForm'] input[name='cvstBrnNm']").val($(obj).data("cvstBrnNm"));
    $("form[name='orderDataForm'] input[name='cvstBrnTel']").val($(obj).data("cvstBrnTel"));

    clearCvsPopup();
    backStateLayerPopup();
}

// 편의점 팝업 초기화
function clearCvsPopup(){
    $("#layerPupListMoreBtn").attr("onClick","btn_search('2')");
    $('.zipcode_result').hide();
    $('.zipcode_result').empty();
    $('input[name="cvs_name"]').val('');
    $('.cvsMbtn').hide();
}

</script>

<div class="popup-search-shipping bg-grey">
    <div class="popup-header">
        <!--특화배송 타입에 맞게 타이틀 수정-->
        <h3>안심배송지 찾기</h3>
    </div>
    <div class="popup-content">
        <div class="shipping-search-area type-cvs">
            <div class="search-input-wrap">
                <input type="text" placeholder="검색어를 입력해 주세요." onkeypress="keycheckCon()" id="cvs_name" name="cvs_name"><button onclick="btn_search(1)">찾기</button>
            </div>
            <span class="search-guide">편의점명이나 위치를 입력하세요. (GS25, CU)</span>
        </div>
        <div class="shipping-search-area type-subway">
            <div class="search-input-wrap">
                <input type="text" placeholder="검색어를 입력해 주세요."><button>찾기</button>
            </div>
            <span class="search-guide">서울 지하철 5, 6, 7, 8호선만 선택 가능합니다.</span>
        </div>
        <div class="shipping-search-area type-safe-shipping">
            <div class="row-wrap">
                <select class="dpth-group1" name="siNm" id="siNm" onchange="changeSiNm(this);">
                    <option value="N">시/도</option>
                    
                        <option value="경기도">경기도</option>
                    
                        <option value="경상남도">경상남도</option>
                    
                        <option value="경상북도">경상북도</option>
                    
                        <option value="광주광역시">광주광역시</option>
                    
                        <option value="대구광역시">대구광역시</option>
                    
                        <option value="대전광역시">대전광역시</option>
                    
                        <option value="부산광역시">부산광역시</option>
                    
                        <option value="서울특별시">서울특별시</option>
                    
                        <option value="인천광역시">인천광역시</option>
                    
                        <option value="전라남도">전라남도</option>
                    
                        <option value="전라북도">전라북도</option>
                    
                        <option value="제주특별자치도">제주특별자치도</option>
                    
                        <option value="충청남도">충청남도</option>
                    
                        <option value="충청북도">충청북도</option>
                    
                </select>
                <select class="dpth-group2" name="guNm" id="guNmList01">
                    <option value="N">시/군/구</option>
                </select>
            </div>
            <span class="search-guide"></span>
        </div>

        <div class="no-result" id="noSearchResultNone" style="display:none">
            검색결과가 없습니다.
        </div>

        <ul class="shipping-search-list zipcode_result" style="display:none"></ul>

        <div class="single-btn-wrap cvsMbtn safetyMbtn" style="display: none;">
            <button class="btn-white" onclick="btn_search('2')" id="layerPupListMoreBtn">더보기 (30/9,999)</button>
        </div>
    </div>
</div>

<script>
    //지도보기 카카오 지도 연동
    function viewKakaoMap(obj,adata){

        if($("#select_map"+adata+"").hasClass("on")){
            $("#select_map"+adata+"").removeClass("on");
        }else{
            $("#select_map"+adata+"").addClass("on");
        }

        $("#select_map"+adata+"").empty();

        var addr=$("#adataAdr"+adata+"").html();

        kakao.maps.load(function(){
            var mapContainer = document.getElementById("select_map"+adata+""), // 지도를 표시할 div
                mapOption = {
                    center: new daum.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
                    level: 3 // 지도의 확대 레벨
                };

            // 지도를 생성합니다
            var map = new daum.maps.Map(mapContainer, mapOption);

            // 주소-좌표 변환 객체를 생성합니다
            var geocoder = new daum.maps.services.Geocoder();

            // 주소로 좌표를 검색합니다
            geocoder.addressSearch(addr, function(result, status) {

                // 정상적으로 검색이 완료됐으면
                if (status === daum.maps.services.Status.OK) {

                    var coords = new daum.maps.LatLng(result[0].y, result[0].x);

                    // 결과값으로 받은 위치를 마커로 표시합니다
                    var marker = new daum.maps.Marker({
                        map: map,
                        position: coords
                    });

                    // 인포윈도우로 장소에 대한 설명을 표시합니다
                    var infowindow = new daum.maps.InfoWindow({
                        content: '<div style="width:150px;text-align:center;padding:6px 0;">'+$("#adataBrnNm"+adata+"").val()+'</div>'
                    });
                    infowindow.open(map, marker);

                    // 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
                    map.setCenter(coords);
                }
            });
        });

    }

</script>

    </div>
    


</div>
<!--//서브 레이어 팝업-->



<!-- footer -->

    
    
        <footer></footer>
        
    






<!-- 실제 개발시 삭제 로딩레이어 테스트 -->

<!-- // 실제 개발시 삭제 로딩레이어 테스트 -->



<form name="orderDataForm" method="post">
    <!-- 윤석준 프리미엄 배송 소스 추가 -->
    <input type="hidden" name="premOrderAmt" value="1490000">    <!-- 프리미엄배송 결제금액 -->
    <input type="hidden" name="premTotStlmAmt" value="1490000">    <!-- 프리미엄배송 결제금액 -->
    <input type="hidden" name="premRealStlmAmt" value="1490000">
    <input type="hidden" name="premDlvCost" value="0">
    <input type="hidden" name="premDlvYn" value="N">    <!-- 프리미엄배송여부 -->

    <input type="hidden" name="tmpOrderAmt" value="1490000">    <!-- 임시 결제금액 -->
    <input type="hidden" name="tmpTotStlmAmt" value="1490000">    <!-- 임시 결제금액 -->
    <input type="hidden" name="tmpRealStlmAmt" value="1490000">
    <!-- //윤석준 프리미엄 배송 소스 추가 -->
    <!-- 새벽배송 추가_20180623조유진 -->
    
        
            <input type="hidden" name="dawnOrderAmt" value="1490000">    <!-- 결제금액 -->
            <input type="hidden" name="dawnTotStlmAmt" value="1490000">    <!-- 결제금액 -->
            <input type="hidden" name="dawnRealStlmAmt" value="1490000">
            <input type="hidden" name="dawnDlvCost" value="0">
        
        
    
    <input type="hidden" name="dawnDlvYn" value="N">    <!-- 프리미엄배송여부 -->
    <!-- //새벽배송 추가_20180623조유진 -->
    <input type="hidden" name="orderAmt" value="1490000">
    
    <input type="hidden" name="totStlmAmt" value="1490000">
    
    <input type="hidden" name="realStlmAmt" value="1490000">
    <input type="hidden" name="stlmCrdAmt" value="0">
    <input type="hidden" name="stlmAcntAmt" value="0">
    <input type="hidden" name="stlmWibkAmt" value="0">
    <input type="hidden" name="stlmHppayAmt" value="0">
    <input type="hidden" name="stlmHPointAmt" value="0">
    
    <input type="hidden" name="stlmUPointAmt" value="0">
    <input type="hidden" name="stlmWPointAmt" value="0">
    <input type="hidden" name="stlmCdpstAmt" value="0">
    <input type="hidden" name="stlmOnlnGcAmt" value="0">
    <input type="hidden" name="stlmPaperGcAmt" value="0">
    <input type="hidden" name="stlmPaycoAmt" value="0">
    <input type="hidden" name="stlmSyrupPayAmt" value="0">
    <input type="hidden" name="stlmKakaoPayAmt" value="0"><!-- 카카오페이 결제 금액 -->
    <input type="hidden" name="stlmNaverpayAmt" value="0">
    <input type="hidden" name="stlmSmilepayAmt" value="0">
    <input type="hidden" name="stlmCallpayAmt" value="0">
    <input type="hidden" name="stlmNewkakaopayAmt" value="0">
    <input type="hidden" name="stlmHpayAmt" value="0">
    <input type="hidden" name="stlmTossAmt" value="0">
    <input type="hidden" name="stlmNfcAmt" value="0">
    <input type="hidden" name="hppayPrice" value="0">
    <input type="hidden" name="hppayTradeid" value="" class="hppayInfInput">
    <input type="hidden" name="hppayPrdtnm" value="" class="hppayInfInput">
    <input type="hidden" name="hppayMobilid" value="" class="hppayInfInput">
    <input type="hidden" name="hppayNo" value="" class="hppayInfInput">
    <input type="hidden" name="hppayUserkey" value="" class="hppayInfInput">
    <input type="hidden" name="hppayResultCd" value="" class="hppayInfInput">
    <input type="hidden" name="hppayResultmsg" value="" class="hppayInfInput">
    <input type="hidden" name="receiptYn" value="">
    <input type="hidden" name="cashRcptSendAmt" value="0">
    <input type="hidden" name="cashRcptCustIdntVal" value="">
    <input type="hidden" name="cashRcptRcptTskGbcd" value="">
    <input type="hidden" name="okCashCrdNo" value="">
    <input type="hidden" name="sk2CardNo" value="">
    <input type="hidden" name="asianaId" value="">
    <input type="hidden" name="wibkBankCd" value="" class="wibkInfInput">
    <input type="hidden" name="wibkAccountSmsYn" value="" class="wibkInfInput">
    <input type="hidden" name="wibkAcntSmsYn" value="" class="wibkInfInput">
    <input type="hidden" name="wibkIamtInfSmsYn" value="" class="wibkInfInput">
    <input type="hidden" name="wibkCustNm" value="주찬영" class="wibkInfInput">
    <input type="hidden" name="cardSelect" value="" class="cardInfInput">
    <input type="hidden" name="crdCd" value="" class="cardInfInput">
    <input type="hidden" name="cmCrdcCd" value="" class="cardInfInput">
    <input type="hidden" name="cardXid" value="" class="cardInfInput">
    <input type="hidden" name="cardEci" value="" class="cardInfInput">
    <input type="hidden" name="cardCavv" value="" class="cardInfInput">
    <input type="hidden" name="cardCardno" value="" class="cardInfInput">
    <input type="hidden" name="cardAllotMonth" value="0">
    <input type="hidden" name="crdStlmType" value="" class="cardInfInput">
    <input type="hidden" name="upopTid" value="" class="cardInfInput">
    <input type="hidden" name="cardProcess" value="" class="cardInfInput">
    <!-- 안심클릭카드용 파라메터 -->
    <input type="hidden" name="x_CARDTYPE" value="" class="cardInfInput">
    <!-- 간편결제여부 -->
    <input type="hidden" name="x_SP_CHAIN_CODE" value="" class="cardInfInput">

    <input type="hidden" name="kTCardNo" value="" class="cardInfInput">
    <input type="hidden" name="kTPassword" value="" class="cardInfInput">
    <input type="hidden" name="cardPointUseYn" value="" class="cardInfInput">
    <input type="hidden" name="saveServiceCode" value="" class="cardInfInput">
    <input type="hidden" name="acntSmTid" value="" class="acntInfInput">
    <input type="hidden" name="acntAmt" value="" class="acntInfInput">
    <input type="hidden" name="acntBankCode" value="" class="acntInfInput">
    <input type="hidden" name="acntAccOwner" value="" class="acntInfInput">
    <input type="hidden" name="rempEmno" value="">

    
        
            <input type="hidden" name="totDlvCost" value="0">
            <input type="hidden" name="tmpTotDlvCost" value="0">
        
        
    
    <input type="hidden" name="copnDcAmt" value="0">
    <input type="hidden" name="itemCopnDcAmt" value="0">
    <input type="hidden" name="alliCrdNo" value="">
    <input type="hidden" name="alliCrdType" value="">
    <input type="hidden" name="payAlliGbcd" value="">
    <input type="hidden" name="alliCrdDcYn" value="">
    <input type="hidden" name="alliCrdCd" value="">
    <input type="hidden" name="empDcAmt" value="0">
    <input type="hidden" name="aplyAlliRefCd" value="">
    <input type="hidden" name="aplyTcCd" value="">
    <input type="hidden" name="aplyAlliKind" value="">
    <input type="hidden" name="alliRefDcYn" value="">
    <input type="hidden" name="alliRefDcAmt" value="0">
    <input type="hidden" name="payCopnDcAmt" value="0">
    <input type="hidden" name="spdcYn" value="0">
    <input type="hidden" name="spdcAmt" value="0">
    <input type="hidden" name="spymDcYn" value="">
    <input type="hidden" name="spymDcAmt" value="0">
    <input type="hidden" name="svmtDcAmt" value="0">
    <input type="hidden" name="massBuyDcAmt" value="0">
    <input type="hidden" name="onlnGcGbcd" value="">
    <input type="hidden" name="happymoneySessionId" value="">
    <input type="hidden" name="culturelandHashNo" value="">
    <input type="hidden" name="culturelandCustId" value="">
    <input type="hidden" name="onlnGcId" value="">
    <input type="hidden" name="onlnGcPw" value="">
    <input type="hidden" name="orderHDAff" value="">
    
    <input type="hidden" name="useHDAffPoint" value="N">
    <input type="hidden" name="arsDcAmt" value="0">

    <input type="hidden" name="dlvAdrInfSaveYn" value="">
    <input type="hidden" name="sk2ItemYn" value="N">
    <input type="hidden" name="culItmYn" value="N">

    <input type="hidden" name="mltiDlvYn" value="N">
    
        <input type="hidden" name="senderName" value="주찬영">
        
    

    <input type="hidden" name="memberMobileDdd" value="010">
    <input type="hidden" name="memberMobilePhone1" value="2360">
    <input type="hidden" name="memberMobilePhone2" value="6586">

    
        
            <input type="hidden" name="senderMobileDdd" value="010">
            <input type="hidden" name="senderMobilePhone1" value="2360">
            <input type="hidden" name="senderMobilePhone2" value="6586">
        
        
    
    <input type="hidden" name="senderDstnTela" value="010">
    <input type="hidden" name="senderDstnTels" value="6348">
    <input type="hidden" name="senderDstnTeli" value="0471">
    <input type="hidden" name="senderEmail" value="cyjoo1988@naver.com">
    <input type="hidden" name="rcvCustNm" value="">
    <input type="hidden" name="rcvBymd" value="">
    <input type="hidden" name="rcvMobileDdd" value="">
    <input type="hidden" name="rcvMobilePhone1" value="">
    <input type="hidden" name="rcvMobilePhone2" value="">
    <input type="hidden" name="rcvDstnTela" value="">
    <input type="hidden" name="rcvDstnTels" value="">
    <input type="hidden" name="rcvDstnTeli" value="">
    <input type="hidden" name="dstnPostNo1" value="">
    <input type="hidden" name="dstnPostNo2" value="">
    <input type="hidden" name="dstnAdrKndGbcd" value="">
    <input type="hidden" name="dstnBaseAdr" value="">
    <input type="hidden" name="dstnPtcAdr" value="">
    <input type="hidden" name="dstnAdr" value="">
    <input type="hidden" name="dsrvCoMsg" value="">
    <input type="hidden" name="ordCustMsg" value="">
    <input type="hidden" name="rcvCustMsg" value="">
    <input type="hidden" name="insuAreaGbcd" value="">
    <input type="hidden" name="gaAgrYn" value="">
    
    <input type="hidden" name="rcvCustSms" value="">
    <input type="hidden" name="baseDstnYn" value="">

    <input type="hidden" name="cnryCd" value="">
    <input type="hidden" name="dsptCustNm" value="">
    <input type="hidden" name="frgnDstnTela" value="">
    <input type="hidden" name="frgnDstnTels" value="">
    <input type="hidden" name="frgnDstnTeli" value="">
    <input type="hidden" name="frgnDstnHpIdntNo" value="">
    <input type="hidden" name="frgnDstnHpIntmNo" value="">
    <input type="hidden" name="frgnDstnHpBckNo" value="">
    <input type="hidden" name="frgnDstnPostNo" value="">
    <input type="hidden" name="frgnDstnPtcAdr" value="">
    <input type="hidden" name="frgnDstnCityNm" value="">
    <input type="hidden" name="frgnDstnDistCd" value="">
    <input type="hidden" name="frgnDstnDistNm" value="">
    <input type="hidden" name="frdlvYn" value="">
    <input type="hidden" name="frgnDlvcoCd" value="">

    <input type="hidden" name="mmsMsgTitl" value="">
    <input type="hidden" name="mmsMsgCntn" value="">
    <input type="hidden" name="prsnMsgCrdImgNm" value="">

    <input type="hidden" name="dlvHopeDt" value="">
    <input type="hidden" name="gcItemYn" value="N">
    <input type="hidden" name="slitmNm" value="">
    <input type="hidden" name="slitmCd" value="">
    <input type="hidden" name="stlmWayScopGbcd" value="10">
    <input type="hidden" name="stlmWayExcldGcHpYn" value="N">
    <input type="hidden" name="wintInsmMths" value="0">

    <input type="hidden" name="dmndDcPrmoNo" value="">
    <input type="hidden" name="dmndDcProTotItemTrgtYn" value="">
    <!-- 카드즉시할인KJH -->
    <input type="hidden" name="crdImdtDcPrmoAmt" value="0">
    <input type="hidden" name="crdImdtDcPrmoNo" value="">
    <input type="hidden" name="crdImdtDcPrmoCondGrpSeq" value="">
    <input type="hidden" name="smileCrdPointYn" value="N"> 
    <input type="hidden" name="smileCrdExceptYn" value="Y">
    <input type="hidden" name="stlmDcPrmoNo" value="">
    <input type="hidden" name="stlmDcAmt" value="0">
    <input type="hidden" name="stlmDcPrmoYn" value="Y">

    <input type="hidden" name="mobileYn" value="N">
    <input type="hidden" name="mblCopnLimitCnt" value="">
    <input type="hidden" name="mblCopnTypeGbcd" value="">
    <input type="hidden" name="mblCopnNm" value="">
    <input type="hidden" name="giftOrderYn" value="N">
    <input type="hidden" name="boxPrsnPackGbcd" value="0">
    <input type="hidden" name="spbgPrsnPackGbcd" value="0">
    <!-- burujee -->
    <input type="hidden" name="mblGcVenCd" value="">

    <input type="hidden" name="KVP_SESSIONKEY" value="" class="cardInfInput">
    <input type="hidden" name="KVP_CURRENCY" value="" class="cardInfInput">
    <input type="hidden" name="KVP_PGID" value="" class="cardInfInput">
    <input type="hidden" name="KVP_ENCDATA" value="" class="cardInfInput">
    <input type="hidden" name="KVP_NOINT" value="" class="cardInfInput">
    <input type="hidden" name="KVP_QUOTA" value="" class="cardInfInput">
    <input type="hidden" name="KVP_CARDCODE" value="" class="cardInfInput">
    <input type="hidden" name="KVP_CONAME" value="" class="cardInfInput">
    <input type="hidden" name="KVP_RESERVED1" value="" class="cardInfInput">
    <input type="hidden" name="KVP_RESERVED2" value="" class="cardInfInput">
    <input type="hidden" name="KVP_RESERVED3" value="" class="cardInfInput">
    <input type="hidden" name="KVP_IMGURL" value="" class="cardInfInput">
    <input type="hidden" name="storeid" value="" class="cardInfInput">
    <input type="hidden" name="ordnm" value="" class="cardInfInput">
    <input type="hidden" name="KVP_GOODNAME" value="" class="cardInfInput">
    <input type="hidden" name="socid" value="" class="cardInfInput">
    <input type="hidden" name="KVP_PRICE" value="" class="cardInfInput">
    <input type="hidden" name="reply" value="" class="cardInfInput">
    <input type="hidden" name="KVP_NOINT_INF" value="" class="cardInfInput">
    <input type="hidden" name="KVP_QUOTA_INF" value="" class="cardInfInput">
    <input type="hidden" name="success" value="" class="cardInfInput">
    <input type="hidden" name="fail" value="" class="cardInfInput">
    <input type="hidden" name="VP_RET_SAVEPOINT" value="" class="cardInfInput">
    <input type="hidden" name="KVP_CARD_PREFIX" value="" class="cardInfInput">
    <input type="hidden" name="CARD_PAY_TYPE" value="" class="cardInfInput">
    <input type="hidden" name="cardCode" value="" class="cardInfInput">
    <input type="hidden" name="cardIssuerCode" value="" class="cardInfInput">


    <input type="hidden" name="addDlvAmt" value="0">
    <input type="hidden" name="opntCrdNo" value="">
    <input type="hidden" name="opntTrdGbcd" value="">
    <input type="hidden" name="opntTrdKey" value="">
    <input type="hidden" name="opntUseSvmt" value="0">
    <input type="hidden" name="opntTotSvmt" value="0">
    <input type="hidden" name="opntMaxUseAmt" value="0">
    <input type="hidden" name="opntUsableTotStlmAmt" value="0">
    <input type="hidden" name="ordPsnInfUseAgreeChk" value="N">

    <input type="hidden" name="allCrdDmndDcPrmoStr" value="">
    <input type="hidden" name="payNowInstmt" value="">
    <input type="hidden" name="payNowAllotValue" value="">
    <input type="hidden" name="payNowYn" value="">
    <input type="hidden" name="mobileGcYn" value="N">
    <input type="hidden" name="mltDlvLmtVenYn" value="N">
    <input type="hidden" name="payType" value="">

    <input type="hidden" name="samsungPayInstmt" value="">

    <input type="hidden" name="stlmWaySaveYn" value="Y">      <!-- 이전결제수단 체크여부 -->
    <input type="hidden" name="stlmNstdWayCd" value="">       <!-- STLM_WAY_CD -->
    <input type="hidden" name="stlmWaySaveCardCd" value=""> <!-- FNC_ISTN_CD -->


    <!-- 편의점배송 관련 -->

    <input type="hidden" name="dstnTypeGbcd" value="">  <!--  -->

    <input type="hidden" name="cvstBrnCd" value="">
    <input type="hidden" name="cvstHofcCd" value="">
    <input type="hidden" name="cvstBrnNm" value="">
    <input type="hidden" name="cvstBrnTel" value="">

    <input type="hidden" name="postNoChgYn" value="">

    <!-- KB앱카드 관련 관련(K-MOTION) -->
    <input type="hidden" name="tkey" value="">
    <input type="hidden" name="kMotionNoint_inf" value="">
    <input type="hidden" name="kMotionQuota_inf" value="">
    <input type="hidden" name="kMotionNoint_flag1" value="">
    <input type="hidden" name="kMotionIssue_code" value="">

    <input type="hidden" name="upntCustYn" value="Y"> 
    <input type="hidden" name="upntAvalPnt" value="293"> 

    <input type="hidden" name="psnCucrInntCode" value="">
    <input type="hidden" name="psnCucrReUseYn" value="">
    <input type="hidden" name="frgnDrctBuyYn" value="N">

    <input type="hidden" name="stlmHanaMoneyAmt" value="0">
    <input type="hidden" name="stlmBlpntAmt" value="0">

    <input type="hidden" name="cardEventYn" value="N">

    <input type="hidden" name="rplcItemChocYn">
    <input type="hidden" name="replacePdNoticeYn" value="N">

    <input type="hidden" name="longWintPopYn" value="">
    <input type="hidden" name="halfDlvYn" value="N">

    <!-- 스토어픽 주문여부  -->
    <input type="hidden" name="stpicOrderYn" value="N">

    
        
            <input type="hidden" name="limitEmpDcAmt" value="0">
        
        
    

    
    
        
            <input type="hidden" name="hFundingYn" value="N">
        
        
    
    
    
	<input type="hidden" name="stlmBlpntCrdNo" value="">
    <input type="hidden" name="stlmBlpntCrdPwd" value="">
    <input type="hidden" name="stlmBlpntCustNo" value="">
</form>



<input type="hidden" name="dlvCostExstYn" value="N">
<input type="hidden" name="orderAmt" value="1490000">

    
        <input type="hidden" name="custNo" value="">
    
    

<input type="hidden" name="hopeDtPassYn" value="N">
<input type="hidden" name="shopEventNo" value="">
<input type="hidden" name="alliRefCd" value="932">
<input type="hidden" name="isEmergency" value="">
<input type="hidden" name="orderItemTotCount" value="1">
<input type="hidden" name="grpCoMemberYn" value="N">
<input type="hidden" name="b2BCustDcAplyYn" value="N">
<input type="hidden" name="irgnAreaAddDlvCostUseYn" value="N">
<input type="hidden" name="stnAdrInf" value="주찬영" class="rcvCustNm">
<input type="hidden" name="stnAdrInf" value="010" class="dstnTela">
<input type="hidden" name="stnAdrInf" value="6348" class="dstnTels">
<input type="hidden" name="stnAdrInf" value="0471" class="dstnTeli">
<input type="hidden" name="stnAdrInf" value="010" class="dstnHpIdntNo">
<input type="hidden" name="stnAdrInf" value="2360" class="dstnHpIntmNo">
<input type="hidden" name="stnAdrInf" value="6586" class="dstnHpBckNo">
<input type="hidden" name="stnAdrInf" value="2" class="adrKndGbcd">
<input type="hidden" name="stnAdrInf" value="05408" class="dstnPostNo1">
<input type="hidden" name="stnAdrInf" value="" class="dstnPostNo2">
<input type="hidden" name="stnAdrInf" value="서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트)" class="dstnBaseAdr">
<input type="hidden" name="stnAdrInf" value="101동 404호" class="dstnPtcAdr">
<input type="hidden" name="stnAdrInf" value="서울특별시 강동구  강동대로55길 39 (성내동, 힐데스하임 올림픽파크아파트) 101동 404호" class="dlvAdr">
<input type="hidden" name="stnAdrInf" value="10" class="apocGbcd">
<input type="hidden" name="ordInfwPath" value="baskt">
<input type="hidden" name="serverHost" value="https://www.hmall.com">
<input type="hidden" name="ordInfwItemInf" value="/m/pda/itemPtc.do?">
<input type="hidden" name="memberCashRcptHpTel1" value="010">
<input type="hidden" name="memberCashRcptHpTel2" value="2360">
<input type="hidden" name="memberCashRcptHpTel3" value="6586">
<input type="hidden" name="memberCashRcptEvdnRgno1" value="">
<input type="hidden" name="memberCashRcptEvdnRgno2" value="">
<input type="hidden" name="memberCashRcptEvdnRgno3" value="">
<input type="hidden" name="totDcAmtCalc" value="0"><!-- 할인금액 2015-03-26 선할인을 위해서 추가 -->
<input type="hidden" name="hpntPrtyStlmYn" value="N"><!-- 2016-04-25 적립금 우선결제 상품여부-->
<input type="hidden" name="wpntCashRcptYn" value="">

<input type="hidden" name="hasAddItem" value="N">
<input type="hidden" name="paymentFlag" value="">

<input type="hidden" id="addrListCallId" value="">


<div id="slitmInfDiv"><span id="2101185938000010"></span></div>

<div id="slitmPupInfoDiv"></div>

<a href="javascript:;" class="btn-lpopup" data-lpopup="popup-gift-select" id="giftBtn" style="display:none">사은품 선택 팝업</a>


<div class="common-toast-view"></div></body></html>